<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://kubefleet.dev/docs/><link rel=alternate type=application/rss+xml href=https://kubefleet.dev/docs/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon.png><title>Welcome to KubeFleet Documentation | KubeFleet</title>
<meta name=description content="Learn more about KubeFleet, a CNCF sandbox project for simplified Kubernetes multi-cluster management at scale."><meta property="og:url" content="https://kubefleet.dev/docs/"><meta property="og:site_name" content="KubeFleet"><meta property="og:title" content="Welcome to KubeFleet Documentation"><meta property="og:description" content="Welcome âœ¨ This documentation can help you learn more about the KubeFleet project, get started with a KubeFleet deployment of your own, and complete common KubeFleet related tasks.
WIP We are actively working on the documentation site. About KubeFleet KubeFleet is a CNCF sandbox project that aims to simplify Kubernetes multi-cluster management. It can greatly enhance your multi-cluster management experience; specifically, with the help of KubeFleet, you can easily:"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Welcome to KubeFleet Documentation"><meta itemprop=description content="Welcome âœ¨ This documentation can help you learn more about the KubeFleet project, get started with a KubeFleet deployment of your own, and complete common KubeFleet related tasks.
WIP We are actively working on the documentation site. About KubeFleet KubeFleet is a CNCF sandbox project that aims to simplify Kubernetes multi-cluster management. It can greatly enhance your multi-cluster management experience; specifically, with the help of KubeFleet, you can easily:"><meta itemprop=wordCount content="259"><meta name=twitter:card content="summary"><meta name=twitter:title content="Welcome to KubeFleet Documentation"><meta name=twitter:description content="Welcome âœ¨ This documentation can help you learn more about the KubeFleet project, get started with a KubeFleet deployment of your own, and complete common KubeFleet related tasks.
WIP We are actively working on the documentation site. About KubeFleet KubeFleet is a CNCF sandbox project that aims to simplify Kubernetes multi-cluster management. It can greatly enhance your multi-cluster management experience; specifically, with the help of KubeFleet, you can easily:"><link rel=preload href=/scss/main.min.9dbd381173ff32a411282c4d4c12047d289d581adc6a714308894ed3662001cb.css as=style><link href=/scss/main.min.9dbd381173ff32a411282c4d4c12047d289d581adc6a714308894ed3662001cb.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg role="img" viewBox="119.76 200.76 1260.48 1098.48"><title>KubeFleet</title><defs><style>.cls-1{fill:#fff}</style></defs><path d="M629.63 844.46l-38.9-153.8 159.83-68.71 157.8 69.9-38.54 151.84-240.19.77z" class="cls-1"/><path d="M885.25 551.34V658.4l-132.84-57.93-137.55 60.04c-3.05 2.43-2.87-7.86-2.87-9.6v-99.56h273.26zm-29.07-79.23c.97.77-1.94 2.76-1.94 3.21v59.95c0 .65 2.45 1.64 1.94 3.21H643c-.52-1.57 1.94-2.56 1.94-3.21v-59.95c0-.65-2.45-1.64-1.94-3.21h213.18zm-155.04-55.67h98.84v44.96h-98.84zm461.95 323.44-26.99 103.81-199.43.71-27.45-103.41 127.01-56.75 126.86 55.64z" class="cls-1"/><path d="M1143.78 632.7v79.22l-107.54-45.11-111.45 47.23c-.95-.79 1.94-2.73 1.94-3.19v-74.94c0-.65-2.45-1.64-1.94-3.21h218.99zm-25.19-66.37v53.53H951.92V567.4l2.91-2.75c.79-.06 1.46 1.68 1.94 1.68h161.82zm-36.82-47.11v36.4h-93.02c3.3-10.04 2.69-22.86.47-33.28l2.44-3.12h90.12zm-488 220.56L563.8 844.83l-198.53-.37-27.36-103.47 126.64-56.36 129.22 55.15z" class="cls-1"/><path d="M574.38 632.7c.97.77-1.94 2.76-1.94 3.21v76.01l-107.52-45.13-107.6 47.27V632.7h217.05zm-25.19-68.52v55.67H382.52c-.52-1.57 1.94-2.56 1.94-3.21v-47.11c0-.54-2.29-1.71-1.12-3.24l5.88-2.22 159.97.1zm-127.91-44.96h91.09v36.4h-91.09z" class="cls-1"/><path d="M1053.6 225.51H447.4L144.3 750.5l303.1 524.99h606.2l303.1-524.99-303.1-524.99zm-31.06 996.17H478.47L206.44 750.5l272.03-471.18h544.07l272.03 471.18-272.03 471.18z" class="cls-1"/><path d="M265.07 901.28h973.01v53.81H265.07zm76.07 117.64h815v53.81h-815zm63.73 112.59h682.56v53.81H404.87z" class="cls-1"/></svg></span><span class=navbar-brand__name>KubeFleet</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class="nav-link active" href=/docs/><span>Docs</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><ul class=dropdown-menu><li><a class=dropdown-item href=/zh-cn/docs/>ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰</a></li></ul></div></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this siteâ€¦" aria-label="Search this siteâ€¦" autocomplete=off data-offline-search-index-json-src=/offline-search-index.1f09881b4ee7be9c5e03c1ff59792875.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/>Return to the regular view of this page</a>.</p></div><h1 class=title>Welcome to KubeFleet Documentation</h1><ul><li>1: <a href=#pg-dd948255948d6b59b32c471abcb62997>Concepts</a></li><ul><li>1.1: <a href=#pg-490f2b78db8fecdc0bed1e8d68c8c706>Fleet components</a></li><li>1.2: <a href=#pg-b62b5665dfb021b8bec0a6ab728a3a54>MemberCluster</a></li><li>1.3: <a href=#pg-b8f6b720329f015f06846c43b2d48212>ClusterResourcePlacement</a></li><li>1.4: <a href=#pg-364f0b84c038cb4dee1cc83252e9309e>ResourcePlacement</a></li><li>1.5: <a href=#pg-bd269a3c0871a350c7f51b81d2a79af9>Scheduler</a></li><li>1.6: <a href=#pg-e149527fa64d0c3eacbb2ff5e7b6ffea>Scheduling Framework</a></li><li>1.7: <a href=#pg-716d7f944c3423c5dfa17047db699aed>Properties and Property Providers</a></li><li>1.8: <a href=#pg-057b31916d61f2f113de30f88397f691>Safe Rollout</a></li><li>1.9: <a href=#pg-f14a979ac0ba3b2cbfcab451b17d9e7a>Override</a></li><li>1.10: <a href=#pg-8ddd4e0ab9f151e89ec11f8f8feb3f69>Staged Update</a></li><li>1.11: <a href=#pg-4289eaa321cf089fdf9ee9aab7a3ade8>Eviction and Placement Disruption Budget</a></li></ul><li>2: <a href=#pg-17b09a9dc5200475d8a306f18e63a0f9>Getting Started</a></li><ul><li>2.1: <a href=#pg-b2dc1a1b66163662e5965b95ed325462>Getting started with Fleet using KinD clusters</a></li><li>2.2: <a href=#pg-7d7f0216d2307a9e20af121afa63dd3e>Getting started with Fleet using on-premises clusters</a></li></ul><li>3: <a href=#pg-8688845c6027fb5b07b8644ad7348d4a>How-To Guides</a></li><ul><li>3.1: <a href=#pg-4072dca0095c74b9490cd7c99ea027d9>Managing clusters</a></li><li>3.2: <a href=#pg-7461dbc76e53ff75d54dd11074048123>Using the ClusterResourcePlacement API</a></li><li>3.3: <a href=#pg-955aa307885ef70e7d59d95b7fd1779d>Using the ResourcePlacement API</a></li><li>3.4: <a href=#pg-dae736fee36bb429124e070c298551ea>Using Affinity to Pick Clusters</a></li><li>3.5: <a href=#pg-ccbad31a9eb5ff37ffc3f405928edd58>Using Topology Spread Constraints to Spread Resources</a></li><li>3.6: <a href=#pg-8f6885002eeb6f5c362b9414ff970412>Using Property-Based Scheduling</a></li><li>3.7: <a href=#pg-06445baf57d9bbc7fde02bf249b4a0fa>Using Taints and Tolerations</a></li><li>3.8: <a href=#pg-f53861fa149aba83d55219c600a493a6>Using the ClusterResourceOverride API</a></li><li>3.9: <a href=#pg-4f07136e38cf9fb330102a16c2742234>Using the ResourceOverride API</a></li><li>3.10: <a href=#pg-b44fd8dfb69a651370335b35322594c6>Using Envelope Objects to Place Resources</a></li><li>3.11: <a href=#pg-9e6acaf2aaf7ab5737e91dce54ade3d3>Controlling How Fleet Handles Pre-Existing Resources</a></li><li>3.12: <a href=#pg-934276b9448b25f33e6f2421e293bbf7>Enabling Drift Detection in Fleet</a></li><li>3.13: <a href=#pg-305fa8c74ee8f62995ad9a0d77561184>Using the ReportDiff Apply Mode</a></li><li>3.14: <a href=#pg-dcd05a852eca01d185729a33f973f1ea>How to Roll Out and Roll Back Changes in Stage</a></li><li>3.15: <a href=#pg-3d9472b6f83afdc50046a1c5ab64a789>Evicting Resources and Setting up Disruption Budgets</a></li><li>3.16: <a href=#pg-4f4f59d184a40c4dcfcbee8f42acf039>Scheduling AI Jobs with Kueue and Fleet</a></li></ul><li>4: <a href=#pg-68ec2370d0409cc27325be36693f9368>Tutorials</a></li><ul><li>4.1: <a href=#pg-f30bed2e013ae9043ec31b7a759aae4e>Resource Migration Across Clusters</a></li><li>4.2: <a href=#pg-beb3175636ed99415e3048a146b6c625>Resource Migration With Overrides</a></li><li>4.3: <a href=#pg-1bfc1b59cc6e4f5f6eab261a68e88f97>KubeFleet and ArgoCD Integration</a></li></ul><li>5: <a href=#pg-cec98a3a5ff74162065d32be41bf560a>Troubleshooting Guides</a></li><ul><li>5.1: <a href=#pg-894ce2920918d9ff68e739cf22ea5092>ClusterResourcePlacement TSG</a></li><li>5.2: <a href=#pg-93d68ffad9a5f65589e402107316e989>CRP Schedule Failure TSG</a></li><li>5.3: <a href=#pg-23b95c381312caebb1798baf3bea7f4f>ResourcePlacement TSG</a></li><li>5.4: <a href=#pg-2ebda7b0ab75a3e1b8f7d1d152615e0c>CRP Rollout Failure TSG</a></li><li>5.5: <a href=#pg-a7815b1d1edbdbce187363a1b343e478>CRP Override Failure TSG</a></li><li>5.6: <a href=#pg-ac0342e775af869b5b77d564fc4c06f6>CRP Work-Synchronization Failure TSG</a></li><li>5.7: <a href=#pg-ad9e0d02d959cb98d7558d179b1eff6f>Work-Application Failure TSG</a></li><li>5.8: <a href=#pg-347b6a1d4f9443a8fb0b7d48994c2b21>Availability Failure TSG</a></li><li>5.9: <a href=#pg-866228f003ec1d19d9d3cd253f5a1bae>CRP Drift Detection and Configuration Difference Check Unexpected Result TSG</a></li><li>5.10: <a href=#pg-5b06c835fb960814634cfe57373e74dd>CRP Diff Reporting Failure TSG</a></li><li>5.11: <a href=#pg-7fd979ab5fd3ad74cbe20240c7d112a7>Staged Update Run TSG</a></li><li>5.12: <a href=#pg-d9ce62896f60f2efcc2db9da011ba5cf>ClusterResourcePlacementEviction TSG</a></li></ul><li>6: <a href=#pg-4588103fb9a692533044ee756a5f863f>Frequently Asked Questions</a></li><ul></ul><li>7: <a href=#pg-b5568d681972077a2a3f45e40a59d61a>API Reference</a></li><ul><li>7.1: <a href=#pg-b90e365793750eb7a6d0971588638d2f>cluster.kubernetes-fleet.io/v1</a></li><li>7.2: <a href=#pg-7f4c4e511a589ffe2f62357ed3ffc0b8>cluster.kubernetes-fleet.io/v1beta1</a></li><li>7.3: <a href=#pg-3a56fed116dbc1a8db44faabe552e290>placement.kubernetes-fleet.io/v1</a></li><li>7.4: <a href=#pg-68613d45807859d8e7bca8a9142e8162>placement.kubernetes-fleet.io/v1beta1</a></li></ul></ul><div class=content><p>Welcome âœ¨ This documentation can help you learn more about the KubeFleet project,
get started with a KubeFleet deployment of your own, and complete common KubeFleet related tasks.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>WIP</h4>We are actively working on the documentation site.</div><h2 id=about-kubefleet>About KubeFleet</h2><p>KubeFleet is a CNCF sandbox project that aims to simplify Kubernetes multi-cluster management.
It can greatly enhance your multi-cluster management experience; specifically, with the help of KubeFleet, you can easily:</p><ul><li>manage clusters through one unified API; and</li><li>place Kubernetes resources across a group of clusters with advanced scheduling capabilities; and</li><li>roll out changes progressively; and</li><li>perform administrative tasks easily, such as observing application status, detecting configuration drifts, and migrating workloads across clusters.</li></ul><h2 id=is-kubefleet-right-for-my-multi-cluster-setup>Is KubeFleet right for my multi-cluster setup?</h2><ul><li><p>âœ… KubeFleet can work with any Kubernetes clusters running supported Kubernetes versions, regardless of where they are set up.</p><p>You can set up KubeFleet with an on-premises cluster, a cluster hosted on public clouds such as
Azure, or even a local kind cluster.</p></li><li><p>âœ… KubeFleet can manage Kubernetes cluster groups of various sizes.</p><p>KubeFleet is designed with performance and scalablity in mind. It functions well with both
smaller Kubernetes cluster groups and those with up to hundreds of Kubernetes clusters and
thousands of nodes.</p></li><li><p>ðŸš€ KubeFleet is evolving fast.</p><p>We are actively developing new features and functionalities for KubeFleet. If you have any questions, suggestions, or feedbacks, please <a href=https://github.com/kubefleet-dev/kubefleet/issues>let us know</a>.</p></li></ul><h2 id=get-started>Get started</h2><p>Find out how to deploy KubeFleet with one of our <a href=/docs/getting-started/>Getting Started</a> tutorials. You can use a local setup to experiment with KubeFleet&rsquo;s features, and explore its UX.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-dd948255948d6b59b32c471abcb62997>1 - Concepts</h1><div class=lead>Core concepts in Fleet</div><div class="pageinfo pageinfo-primary"><p>The documentation in this section explains core Fleet concepts. Pick one below to proceed.</p></div></div><div class=td-content><h1 id=pg-490f2b78db8fecdc0bed1e8d68c8c706>1.1 - Fleet components</h1><div class=lead>Concept about the Fleet components</div><h1 id=components>Components</h1><p>This document provides an overview of the components required for a fully functional and operational Fleet setup.</p><p><img src=/images/en/docs/concepts/components/architecture.jpg alt></p><p>The fleet consists of the following components:</p><ul><li>fleet-hub-agent is a Kubernetes controller that creates and reconciles all the fleet related CRs in the hub cluster.</li><li>fleet-member-agent is a Kubernetes controller that creates and reconciles all the fleet related CRs in the member cluster.
The fleet-member-agent is pulling the latest CRs from the hub cluster and consistently reconciles the member clusters to
the desired state.</li></ul><p>The fleet implements agent-based pull mode. So that the working pressure can be distributed to the member clusters, and it
helps to breach the bottleneck of scalability, by dividing the load into each member cluster. On the other hand, hub
cluster does not need to directly access to the member clusters. Fleet can support the member clusters which only have
the outbound network and no inbound network access.</p><p>To allow multiple clusters to run securely, fleet will create a reserved namespace on the hub cluster to isolate the access permissions and
resources across multiple clusters.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b62b5665dfb021b8bec0a6ab728a3a54>1.2 - MemberCluster</h1><div class=lead>Concept about the MemberCluster API</div><h2 id=overview>Overview</h2><p>The fleet constitutes an implementation of a <a href=https://multicluster.sigs.k8s.io/api-types/cluster-set/><code>ClusterSet</code></a> and
encompasses the following attributes:</p><ul><li>A collective of clusters managed by a centralized authority.</li><li>Typically characterized by a high level of mutual trust within the cluster set.</li><li>Embraces the principle of Namespace Sameness across clusters:<ul><li>Ensures uniform permissions and characteristics for a given namespace across all clusters.</li><li>While not mandatory for every cluster, namespaces exhibit consistent behavior across those where they are present.</li></ul></li></ul><p>The <code>MemberCluster</code> represents a cluster-scoped API established within the hub cluster, serving as a representation of
a cluster within the fleet. This API offers a dependable, uniform, and automated approach for multi-cluster applications
(frameworks, toolsets) to identify registered clusters within a fleet. Additionally, it facilitates applications in querying
a list of clusters managed by the fleet or observing cluster statuses for subsequent actions.</p><p>Some illustrative use cases encompass:</p><ul><li>The Fleet Scheduler utilizing managed cluster statuses or specific cluster properties (e.g., labels, taints) of a <code>MemberCluster</code>
for resource scheduling.</li><li>Automation tools like GitOps systems (e.g., ArgoCD or Flux) automatically registering/deregistering clusters in compliance
with the <code>MemberCluster</code> API.</li><li>The <a href=https://multicluster.sigs.k8s.io/concepts/multicluster-services-api/>MCS API</a> automatically generating <code>ServiceImport</code> CRs
based on the <code>MemberCluster</code> CR defined within a fleet.</li></ul><p>Moreover, it furnishes a user-friendly interface for human operators to monitor the managed clusters.</p><h2 id=membercluster-lifecycle>MemberCluster Lifecycle</h2><h3 id=joining-the-fleet>Joining the Fleet</h3><p>The process to join the Fleet involves creating a <code>MemberCluster</code>. The <code>MemberCluster</code> controller, a constituent of the
hub-cluster-agent described in the <a href=/docs/concepts/components/>Component</a>, watches the <code>MemberCluster</code> CR and generates
a corresponding namespace for the member cluster within the hub cluster. It configures roles and role bindings within the
hub cluster, authorizing the specified member cluster identity (as detailed in the <code>MemberCluster</code> spec) access solely
to resources within that namespace. To collate member cluster status, the controller generates another internal CR named
<code>InternalMemberCluster</code> within the newly formed namespace. Simultaneously, the <code>InternalMemberCluster</code> controller, a component
of the member-cluster-agent situated in the member cluster, gathers statistics on cluster usage, such as capacity utilization,
and reports its status based on the <code>HeartbeatPeriodSeconds</code> specified in the CR. Meanwhile, the <code>MemberCluster</code> controller
consolidates agent statuses and marks the cluster as <code>Joined</code>.</p><h3 id=leaving-the-fleet>Leaving the Fleet</h3><p>Fleet administrators can deregister a cluster by deleting the <code>MemberCluster</code> CR. Upon detection of deletion events by
the <code>MemberCluster</code> controller within the hub cluster, it removes the corresponding <code>InternalMemberCluster</code> CR in the
reserved namespace of the member cluster. It awaits completion of the &ldquo;leave&rdquo; process by the <code>InternalMemberCluster</code>
controller of member agents, and then deletes role and role bindings and other resources including the member cluster reserved
namespaces on the hub cluster.</p><h2 id=taints>Taints</h2><p>Taints are a mechanism to prevent the Fleet Scheduler from scheduling resources to a <code>MemberCluster</code>. We adopt the concept of
<a href=https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/>taints and tolerations</a> introduced in Kubernetes to
the multi-cluster use case.</p><p>The <code>MemberCluster</code> CR supports the specification of list of taints, which are applied to the <code>MemberCluster</code>. Each Taint object comprises
the following fields:</p><ul><li><code>key</code>: The key of the taint.</li><li><code>value</code>: The value of the taint.</li><li><code>effect</code>: The effect of the taint, which can be <code>NoSchedule</code> for now.</li></ul><p>Once a <code>MemberCluster</code> is tainted with a specific taint, it lets the Fleet Scheduler know that the <code>MemberCluster</code> should not receive resources
as part of the workload propagation from the hub cluster.</p><p>The <code>NoSchedule</code> taint is a signal to the Fleet Scheduler to avoid scheduling resources from a <code>ClusterResourcePlacement</code> to the <code>MemberCluster</code>.
Any <code>MemberCluster</code> already selected for resource propagation will continue to receive resources even if a new taint is added.</p><p>Taints are only honored by <code>ClusterResourcePlacement</code> with <strong>PickAll</strong>, <strong>PickN</strong> placement policies. In the case of <strong>PickFixed</strong> placement policy
the taints are ignored because the user has explicitly specify the <code>MemberClusters</code> where the resources should be placed.</p><p>For detailed instructions, please refer to this <a href=/docs/how-tos/taints-tolerations/>document</a>.</p><h2 id=whats-next>What&rsquo;s next</h2><ul><li>Get hands-on experience <a href=/docs/how-tos/clusters/>how to add a member cluster to a fleet</a>.</li><li>Explore the <a href=crpc><code>ClusterResourcePlacement</code> concept to placement cluster scope resources among managed clusters</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-b8f6b720329f015f06846c43b2d48212>1.3 - ClusterResourcePlacement</h1><div class=lead>Concept about the ClusterResourcePlacement API</div><h2 id=overview>Overview</h2><p><code>ClusterResourcePlacement</code> concept is used to dynamically select cluster scoped resources (especially namespaces and all
objects within it) and control how they are propagated to all or a subset of the member clusters.
A <code>ClusterResourcePlacement</code> mainly consists of three parts:</p><ul><li><p><strong>Resource selection</strong>: select which cluster-scoped Kubernetes
resource objects need to be propagated from the hub cluster to selected member clusters.</p><p>It supports the following forms of resource selection:</p><ul><li>Select resources by specifying just the &lt;group, version, kind>. This selection propagates all resources with matching &lt;group, version, kind>.</li><li>Select resources by specifying the &lt;group, version, kind> and name. This selection propagates only one resource that matches the &lt;group, version, kind> and name.</li><li>Select resources by specifying the &lt;group, version, kind> and a set of labels using ClusterResourcePlacement -> LabelSelector.
This selection propagates all resources that match the &lt;group, version, kind> and label specified.</li></ul><p><strong>Note:</strong> When a namespace is selected, all the namespace-scoped objects under this namespace are propagated to the
selected member clusters along with this namespace.</p></li><li><p><strong>Placement policy</strong>: limit propagation of selected resources to a specific subset of member clusters.
The following types of target cluster selection are supported:</p><ul><li><strong>PickAll (Default)</strong>: select any member clusters with matching cluster <code>Affinity</code> scheduling rules. If the <code>Affinity</code>
is not specified, it will select all joined and healthy member clusters.</li><li><strong>PickFixed</strong>: select a fixed list of member clusters defined in the <code>ClusterNames</code>.</li><li><strong>PickN</strong>: select a <code>NumberOfClusters</code> of member clusters with optional matching cluster <code>Affinity</code> scheduling rules or topology spread constraints <code>TopologySpreadConstraints</code>.</li></ul></li><li><p><strong>Strategy</strong>: how changes are rolled out (rollout strategy) and how resources are applied on the member cluster side (apply strategy).</p></li></ul><p>A simple <code>ClusterResourcePlacement</code> looks like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>topologySpreadConstraints</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>maxSkew</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>topologyKey</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;env&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>whenUnsatisfiable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DoNotSchedule</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>revisionHistoryLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>100</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>rollingUpdate</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxSurge</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxUnavailable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>unavailablePeriodSeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=when-to-use-clusterresourceplacement>When To Use <code>ClusterResourcePlacement</code></h2><p><code>ClusterResourcePlacement</code> is useful when you want for a general way of managing and running workloads across multiple clusters.
Some example scenarios include the following:</p><ul><li>As a platform operator, I want to place my cluster-scoped resources (especially namespaces and all objects within it)
to a cluster that resides in the us-east-1.</li><li>As a platform operator, I want to spread my cluster-scoped resources (especially namespaces and all objects within it)
evenly across the different regions/zones.</li><li>As a platform operator, I prefer to place my test resources into the staging AKS cluster.</li><li>As a platform operator, I would like to separate the workloads for compliance or policy reasons.</li><li>As a developer, I want to run my cluster-scoped resources (especially namespaces and all objects within it) on 3 clusters.
In addition, each time I update my workloads, the updates take place with zero downtime by rolling out to these three clusters incrementally.</li></ul><h2 id=placement-workflow>Placement Workflow</h2><p><img src=/images/en/docs/concepts/crpc/placement-concept-overview.jpg alt></p><p>The placement controller will create <code>ClusterSchedulingPolicySnapshot</code> and <code>ClusterResourceSnapshot</code> snapshots by watching
the <code>ClusterResourcePlacement</code> object. So that it can trigger the scheduling and resource rollout process whenever needed.</p><p>The override controller will create the corresponding snapshots by watching the <code>ClusterResourceOverride</code> and <code>ResourceOverride</code>
which captures the snapshot of the overrides.</p><p>The placement workflow will be divided into several stages:</p><ol><li>Scheduling: multi-cluster scheduler makes the schedule decision by creating the <code>clusterResourceBinding</code> for a bundle
of resources based on the latest <code>ClusterSchedulingPolicySnapshot</code>generated by the <code>ClusterResourcePlacement</code>.</li><li>Rolling out resources: rollout controller applies the resources to the selected member clusters based on the rollout strategy.</li><li>Overriding: work generator applies the override rules defined by <code>ClusterResourceOverride</code> and <code>ResourceOverride</code> to
the selected resources on the target clusters.</li><li>Creating or updating works: work generator creates the work on the corresponding member cluster namespace. Each work
contains the (overridden) manifest workload to be deployed on the member clusters.</li><li>Applying resources on target clusters: apply work controller applies the manifest workload on the member clusters.</li><li>Checking resource availability: apply work controller checks the resource availability on the target clusters.</li></ol><h2 id=resource-selection>Resource Selection</h2><p>Resource selectors identify cluster-scoped objects to include based on standard Kubernetes identifiers - namely, the <code>group</code>,
<code>kind</code>, <code>version</code>, and <code>name</code> of the object. Namespace-scoped objects are included automatically when the namespace they
are part of is selected. The example <code>ClusterResourcePlacement</code> above would include the <code>test-deployment</code> namespace and
any objects that were created in that namespace.</p><p>The clusterResourcePlacement controller creates the <code>ClusterResourceSnapshot</code> to store a snapshot of selected resources
selected by the placement. The <code>ClusterResourceSnapshot</code> spec is immutable. Each time when the selected resources are updated,
the clusterResourcePlacement controller will detect the resource changes and create a new <code>ClusterResourceSnapshot</code>. It implies
that resources can change independently of any modifications to the <code>ClusterResourceSnapshot</code>. In other words, resource
changes can occur without directly affecting the <code>ClusterResourceSnapshot</code> itself.</p><p>The total amount of selected resources may exceed the 1MB limit for a single Kubernetes object. As a result, the controller
may produce more than one <code>ClusterResourceSnapshot</code>s for all the selected resources.</p><p><code>ClusterResourceSnapshot</code> sample:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourceSnapshot</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/number-of-enveloped-object</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/number-of-resource-snapshots</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/resource-hash</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>e0927e7d75c7f52542a6d4299855995018f4a6de46edf0f814cfaa6e806543f3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>creationTimestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-11-10T08:23:38Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/is-latest-snapshot</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/parent-CRP</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/resource-index</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;4&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-1-4-snapshot</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>ownerReferences</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>blockOwnerDeletion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>controller</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>757f2d2c-682f-433f-b85c-265b74c3090b</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1641940&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>d6e2108b-882b-4f6c-bb5e-c5ec5491dd20</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>kubernetes.io/metadata.name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>finalizers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#000>kubernetes</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>key1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>key2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>key3</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ConfigMap</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=placement-policy>Placement Policy</h2><p><code>ClusterResourcePlacement</code> supports three types of policy as mentioned above. <code>ClusterSchedulingPolicySnapshot</code> will be
generated whenever policy changes are made to the <code>ClusterResourcePlacement</code> that require a new scheduling. Similar to
<code>ClusterResourceSnapshot</code>, its spec is immutable.</p><p><code>ClusterSchedulingPolicySnapshot</code> sample:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterSchedulingPolicySnapshot</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/CRP-generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;5&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/number-of-clusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>creationTimestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-11-06T10:22:56Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/is-latest-snapshot</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/parent-CRP</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/policy-index</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-1-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>ownerReferences</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>blockOwnerDeletion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>controller</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>757f2d2c-682f-433f-b85c-265b74c3090b</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1639412&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>768606f2-aa5a-481a-aa12-6e01e6adbea2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policyHash</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NDc5ZjQwNWViNzgwOGNmYzU4MzY2YjI2NDg2ODBhM2E4MTVlZjkxNGZlNjc1NmFlOGRmMGQ2Zjc0ODg1NDE2YQ==</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-11-06T10:22:56Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all the clusters needed as specified by the scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>observedCRPGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>targetClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>aks-member-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusterScore</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>affinityScore</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>priorityScore</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>picked by scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>selected</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>aks-member-2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusterScore</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>affinityScore</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>priorityScore</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>picked by scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>selected</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p><img src=/images/en/docs/concepts/crpc/scheduling.jpg alt></p><p>In contrast to the original scheduler framework in Kubernetes, the multi-cluster scheduling process involves selecting a cluster for placement through a structured 5-step operation:</p><ol><li>Batch & PostBatch</li><li>Filter</li><li>Score</li><li>Sort</li><li>Bind</li></ol><p>The <em>batch & postBatch</em> step is to define the batch size according to the desired and current <code>ClusterResourceBinding</code>.
The postBatch is to adjust the batch size if needed.</p><p>The <em>filter</em> step finds the set of clusters where it&rsquo;s feasible to schedule the placement, for example, whether the cluster
is matching required <code>Affinity</code> scheduling rules specified in the <code>Policy</code>. It also filters out any clusters which are
leaving the fleet or no longer connected to the fleet, for example, its heartbeat has been stopped for a prolonged period of time.</p><p>In the <em>score</em> step (only applied to the pickN type), the scheduler assigns a score to each cluster that survived filtering.
Each cluster is given a topology spread score (how much a cluster would satisfy the topology spread
constraints specified by the user), and an affinity score (how much a cluster would satisfy the preferred affinity terms
specified by the user).</p><p>In the <em>sort</em> step (only applied to the pickN type), it sorts all eligible clusters by their scores, sorting first by topology
spread score and breaking ties based on the affinity score.</p><p>The <em>bind</em> step is to create/update/delete the <code>ClusterResourceBinding</code> based on the desired and current member cluster list.</p><h2 id=strategy>Strategy</h2><h3 id=rollout-strategy>Rollout strategy</h3><p>Use rollout strategy to control how KubeFleet rolls out a resource change made on the hub cluster to all member clusters.
Right now KubeFleet supports two types of rollout strategies out of the box:</p><ul><li>Rolling update: this rollout strategy helps roll out changes incrementally in a way that ensures system
availability, akin to how the Kubernetes Deployment API handles updates. For more information, see the
<a href=/docs/concepts/safe-rollout/>Safe Rollout</a> concept.</li><li>Staged update: this rollout strategy helps roll out changes in different stages; users may group clusters
into different stages and specify the order in which each stage receives the update. The strategy also allows
users to set up timed or approval-based gates between stages to fine-control the flow. For more information, see
the <a href=/docs/concepts/staged-update/>Staged Update</a> concept and <a href=/docs/how-tos/staged-update/>Staged Update How-To Guide</a>.</li></ul><h3 id=apply-strategy>Apply strategy</h3><p>Use apply strategy to control how KubeFleet applies a resource to a member cluster. KubeFleet currently features
three different types of apply strategies:</p><ul><li>Client-side apply: this apply strategy sets up KubeFleet to apply resources in a three-way merge that is similar to how
the Kubernetes CLI, <code>kubectl</code>, performs client-side apply.</li><li>Server-side apply: this apply strategy sets up KubeFleet to apply resources via the new server-side apply mechanism.</li><li>Report Diff mode: this apply strategy instructs KubeFleet to check for configuration differences between the resource
on the hub cluster and its counterparts among the member clusters; no apply op will be performed. For more information,
see the <a href=/docs/how-tos/reportdiff/>ReportDiff Mode How-To Guide</a>.</li></ul><blockquote><p>To learn more about the differences between client-side apply and server-side apply, see also the
<a href=https://kubernetes.io/docs/reference/using-api/server-side-apply/>Kubernetes official documentation</a>.</p></blockquote><p>KubeFleet apply strategy is also the place where users can set up KubeFleet&rsquo;s drift detection capabilities and takeover
settings:</p><ul><li>Drift detection helps users identify and resolve configuration drifts that are commonly observed in a multi-cluster
environment; through this feature, KubeFleet can detect the presence of drifts, reveal their details, and let users
decide how and when to handle them. See the <a href=/docs/how-tos/drift-detection/>Drift Detection How-To Guide</a> for more
information.</li><li>Takeover settings allows users to decide how KubeFleet can best handle pre-existing resources. When you join a cluster
with running workloads into a fleet, these settings can help bring the workloads under KubeFleet&rsquo;s management in a
way that avoids interruptions. For specifics, see the <a href=/docs/how-tos/takeover/>Takeover Settings How-To Guide</a>.</li></ul><h2 id=placement-status>Placement status</h2><p>After a <code>ClusterResourcePlacement</code> is created, details on current status can be seen by performing a <code>kubectl describe crp &lt;name></code>.
The status output will indicate both placement conditions and individual placement statuses on each member cluster that was selected.
The list of resources that are selected for placement will also be included in the describe output.</p><p>Sample output:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>         </span><span style=color:#000>crp-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>&lt;none&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>&lt;none&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>API Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>         </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Placement Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Resource Selectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>application-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Revision History Limit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Rolling Update</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Max Surge</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Max Unavailable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>             </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Unavailable Period Seconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                          </span><span style=color:#000>RollingUpdate</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>found all the clusters needed as specified by the scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>All 3 cluster(s) start rolling out the latest resource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ClusterResourcePlacementRolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ClusterResourcePlacementOverridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Works(s) are succcesfully created or updated in the 3 target clusters&#39; namespaces</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ClusterResourcePlacementWorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>The selected resources are successfully applied to 3 clusters</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>The selected resources in 3 cluster are available now</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>ResourceAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ClusterResourcePlacementAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Observed Resource Index</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Placement Statuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Cluster Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message:               Successfully scheduled resources for placement in kind-cluster-1 (affinity score: 0, topology spread score: 0)</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>picked by scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>The availability of work object crp-1-work is not trackable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>WorkNotTrackable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Cluster Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#000>kind-cluster-2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message:               Successfully scheduled resources for placement in kind-cluster-2 (affinity score: 0, topology spread score: 0)</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>picked by scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>The availability of work object crp-1-work is not trackable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>WorkNotTrackable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Cluster Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#000>kind-cluster-3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message:               Successfully scheduled resources for placement in kind-cluster-3 (affinity score: 0, topology spread score: 0)</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>picked by scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2024-04-29T09:58:20Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>The availability of work object crp-1-work is not trackable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>WorkNotTrackable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Selected Resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>application-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>ConfigMap</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>app-config-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>application-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Events</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Type    Reason                        Age    From                                   Message</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>---- <span style=color:#f8f8f8;text-decoration:underline>   </span>------ <span style=color:#f8f8f8;text-decoration:underline>                       </span>---- <span style=color:#f8f8f8;text-decoration:underline>  </span>---- <span style=color:#f8f8f8;text-decoration:underline>                                  </span>-------<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementRolloutStarted       3m46s  cluster-resource-placement-controller  Started rolling out the latest resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementOverriddenSucceeded  3m46s  cluster-resource-placement-controller  Placement has been successfully overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementWorkSynchronized     3m46s  cluster-resource-placement-controller  Work(s) have been created or updated successfully for the selected cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementApplied              3m46s  cluster-resource-placement-controller  Resources have been applied to the selected cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementRolloutCompleted     3m46s  cluster-resource-placement-controller  Resources are available in the selected clusters</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=clusterresourceplacementstatus>ClusterResourcePlacementStatus</h2><p>TheÂ <code>ClusterResourcePlacementStatus</code>Â (CRPS) is aÂ <strong>namespaced resource</strong>Â that mirrors the PlacementStatus of a correspondingÂ <strong>cluster-scoped</strong>Â <code>ClusterResourcePlacement</code>Â (CRP) object. It provides namespace-scoped access to cluster-scoped placement status information.</p><ul><li><strong>Namespace-scoped access</strong>: Allows users with namespace-level permissions to view placement status without requiring cluster-scoped access</li><li><strong>Status mirroring</strong>: Contains the same placement status information as the parent CRP, but accessible within a specific namespace</li><li><strong>Optional feature</strong>: Only created when <code>StatusReportingScope</code> is set to <code>NamespaceAccessible</code>. Once set, <code>StatusReportingScope</code> is immutable.</li></ul><p>When <code>StatusReportingScope</code> is set to <code>NamespaceAccessible</code> for a<code> ClusterResourcePlacement</code>, only one namespace resource selector is allowed, and it is immutable. Therefore, the namespace resource selector cannot be changed after creation.</p><p>For detailed instructions, please refer to this <a href=/docs/how-tos/crp/#statusreportingscope>document</a>.</p><h2 id=advanced-features>Advanced Features</h2><h3 id=tolerations>Tolerations</h3><p>Tolerations are a mechanism to allow the Fleet Scheduler to schedule resources to a <code>MemberCluster</code> that has taints specified on it.
We adopt the concept of <a href=https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/>taints & tolerations</a>
introduced in Kubernetes to the multi-cluster use case.</p><p>The <code>ClusterResourcePlacement</code> CR supports the specification of list of tolerations, which are applied to the <code>ClusterResourcePlacement</code>
object. Each Toleration object comprises the following fields:</p><ul><li><code>key</code>: The key of the toleration.</li><li><code>value</code>: The value of the toleration.</li><li><code>effect</code>: The effect of the toleration, which can be <code>NoSchedule</code> for now.</li><li><code>operator</code>: The operator of the toleration, which can be <code>Exists</code> or <code>Equal</code>.</li></ul><p>Each toleration is used to tolerate one or more specific taints applied on the <code>MemberCluster</code>. Once all taints on a <code>MemberCluster</code>
are tolerated by tolerations on a <code>ClusterResourcePlacement</code>, resources can be propagated to the <code>MemberCluster</code> by the scheduler for that
<code>ClusterResourcePlacement</code> resource.</p><p>Tolerations cannot be updated or removed from a <code>ClusterResourcePlacement</code>. If there is a need to update toleration a better approach is to
add another toleration. If we absolutely need to update or remove existing tolerations, the only option is to delete the existing <code>ClusterResourcePlacement</code>
and create a new object with the updated tolerations.</p><p>For detailed instructions, please refer to this <a href=/docs/how-tos/taints-tolerations/>document</a>.</p><h3 id=envelope-object>Envelope Object</h3><p>The <code>ClusterResourcePlacement</code> leverages the fleet hub cluster as a staging environment for customer resources. These resources are then propagated to member clusters that are part of the fleet, based on the <code>ClusterResourcePlacement</code> spec.</p><p>In essence, the objective is not to apply or create resources on the hub cluster for local use but to propagate these resources to other member clusters within the fleet.</p><p>Certain resources, when created or applied on the hub cluster, may lead to unintended side effects. These include:</p><ul><li>Validating/Mutating Webhook Configurations</li><li>Cluster Role Bindings</li><li>Resource Quotas</li><li>Storage Classes</li><li>Flow Schemas</li><li>Priority Classes</li><li>Ingress Classes</li><li>Ingresses</li><li>Network Policies</li></ul><p>To address this, we support the use of <code>ConfigMap</code> with a fleet-reserved annotation. This allows users to encapsulate resources that might have side effects on the hub cluster within the <code>ConfigMap</code>. For detailed instructions, please refer to this <a href=/docs/how-tos/envelope-object/>document</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-364f0b84c038cb4dee1cc83252e9309e>1.4 - ResourcePlacement</h1><div class=lead>Concept about the ResourcePlacement API</div><h2 id=overview>Overview</h2><p><code>ResourcePlacement</code> is a namespace-scoped API that enables dynamic selection and multi-cluster propagation of namespace-scoped resources. It provides fine-grained control over how specific resources within a namespace are distributed across member clusters in a fleet.</p><p><strong>Key Characteristics:</strong></p><ul><li><strong>Namespace-scoped</strong>: Both the ResourcePlacement object and the resources it manages exist within the same namespace</li><li><strong>Selective</strong>: Can target specific resources by type, name, or labels rather than entire namespaces</li><li><strong>Declarative</strong>: Uses the same placement patterns as ClusterResourcePlacement for consistent behavior</li></ul><p>A ResourcePlacement consists of three core components:</p><ul><li><strong>Resource Selectors</strong>: Define which namespace-scoped resources to include</li><li><strong>Placement Policy</strong>: Determine target clusters using PickAll, PickFixed, or PickN strategies</li><li><strong>Rollout Strategy</strong>: Control how changes propagate across selected clusters</li></ul><p>For detailed examples and implementation guidance, see the <a href=/docs/how-tos/rp/>ResourcePlacement How-To Guide</a>.</p><h2 id=motivation>Motivation</h2><p>In multi-cluster environments, workloads often consist of both cluster-scoped and namespace-scoped resources that need to be distributed across different clusters. While <code>ClusterResourcePlacement</code> (CRP) handles cluster-scoped resources effectively, particularly entire namespaces and their contents, there are scenarios where you need more granular control over namespace-scoped resources within existing namespaces.</p><p><code>ResourcePlacement</code> (RP) was designed to address this gap by providing:</p><ul><li><strong>Namespace-scoped resource management</strong>: Target specific resources within a namespace without affecting the entire namespace</li><li><strong>Operational flexibility</strong>: Allow a team to manage different resources within the same namespace independently</li><li><strong>Complementary functionality</strong>: Work alongside CRP to provide a complete multi-cluster resource management solution</li></ul><p><strong>Note</strong>: <code>ResourcePlacement</code> can be used together with <code>ClusterResourcePlacement</code> in namespace-only mode. For example, you can use CRP to deploy the namespace, while using RP for fine-grained management of specific resources like environment-specific ConfigMaps or Secrets within that namespace.</p><h3 id=addressing-real-world-namespace-usage-patterns>Addressing Real-World Namespace Usage Patterns</h3><p>While CRP assumes that namespaces represent application boundaries, real-world usage patterns are often more complex. Organizations frequently use namespaces as team boundaries rather than application boundaries, leading to several challenges that ResourcePlacement directly addresses:</p><p><strong>Multi-Application Namespaces</strong>: In many organizations, a single namespace contains multiple independent applications owned by the same team. These applications may have:</p><ul><li>Different lifecycle requirements (one application may need frequent updates while another remains stable)</li><li>Different cluster placement needs (development vs. production applications)</li><li>Independent scaling and resource requirements</li><li>Separate compliance or governance requirements</li></ul><p><strong>Individual Scheduling Decisions</strong>: Many workloads, particularly AI/ML jobs, require individual scheduling decisions:</p><ul><li><strong>AI Jobs</strong>: Machine learning workloads often consist of short-lived, resource-intensive jobs that need to be scheduled based on cluster resource availability, GPU availability, or data locality</li><li><strong>Batch Workloads</strong>: Different batch jobs within the same namespace may target different cluster types based on computational requirements</li></ul><p><strong>Complete Application Team Control</strong>: ResourcePlacement provides application teams with direct control over their resource placement without requiring platform team intervention:</p><ul><li><strong>Self-Service Operations</strong>: Teams can manage their own resource distribution strategies</li><li><strong>Independent Deployment Cycles</strong>: Different applications within a namespace can have completely independent rollout schedules</li><li><strong>Granular Override Capabilities</strong>: Teams can customize resource configurations per cluster without affecting other applications in the namespace</li></ul><p>This granular approach ensures that ResourcePlacement can adapt to diverse organizational structures and workload patterns while maintaining the simplicity and power of the Fleet scheduling framework.</p><h3 id=key-differences-between-resourceplacement-and-clusterresourceplacement>Key Differences Between ResourcePlacement and ClusterResourcePlacement</h3><table><thead><tr><th>Aspect</th><th>ResourcePlacement (RP)</th><th>ClusterResourcePlacement (CRP)</th></tr></thead><tbody><tr><td><strong>Scope</strong></td><td>Namespace-scoped resources only</td><td>Cluster-scoped resources (especially namespaces and their contents)</td></tr><tr><td><strong>Resource</strong></td><td>Namespace-scoped API object</td><td>Cluster-scoped API object</td></tr><tr><td><strong>Selection Boundary</strong></td><td>Limited to resources within the same namespace as the RP</td><td>Can select any cluster-scoped resource</td></tr><tr><td><strong>Typical Use Cases</strong></td><td>AI/ML Jobs, individual workloads, specific ConfigMaps/Secrets that need independent placement decisions</td><td>Application bundles, entire namespaces, cluster-wide policies</td></tr><tr><td><strong>Team Ownership</strong></td><td>Can be managed by namespace owners/developers</td><td>Typically managed by platform operators</td></tr></tbody></table><h3 id=similarities-between-resourceplacement-and-clusterresourceplacement>Similarities Between ResourcePlacement and ClusterResourcePlacement</h3><p>Both RP and CRP share the same core concepts and capabilities:</p><ul><li><strong>Placement Policies</strong>: Same three placement types (PickAll, PickFixed, PickN) with identical scheduling logic</li><li><strong>Resource Selection</strong>: Both support selection by group/version/kind, name, and label selectors</li><li><strong>Rollout Strategy</strong>: Identical rolling update mechanisms for zero-downtime deployments</li><li><strong>Scheduling Framework</strong>: Use the same multi-cluster scheduler with filtering, scoring, and binding phases</li><li><strong>Override Support</strong>: Both integrate with ClusterResourceOverride and ResourceOverride for resource customization</li><li><strong>Status Reporting</strong>: Similar status structures and condition types for placement tracking</li><li><strong>Tolerations</strong>: Same taints and tolerations mechanism for cluster selection</li><li><strong>Snapshot Architecture</strong>: Both use immutable snapshots (ResourceSnapshot vs ClusterResourceSnapshot) for resource and policy tracking</li></ul><p>This design allows teams familiar with one placement object to easily understand and use the other, while providing the appropriate level of control for different resource scopes.</p><h2 id=when-to-use-resourceplacement>When To Use ResourcePlacement</h2><p>ResourcePlacement is ideal for scenarios requiring granular control over namespace-scoped resources:</p><ul><li><strong>Selective Resource Distribution</strong>: Deploy specific ConfigMaps, Secrets, or Services without affecting the entire namespace</li><li><strong>Multi-tenant Environments</strong>: Allow different teams to manage their resources independently within shared namespaces</li><li><strong>Configuration Management</strong>: Distribute environment-specific configurations across different cluster environments</li><li><strong>Compliance and Governance</strong>: Apply different policies to different resource types within the same namespace</li><li><strong>Progressive Rollouts</strong>: Safely deploy resource updates across clusters with zero-downtime strategies</li></ul><p>For practical examples and step-by-step instructions, see the <a href=/docs/how-tos/resource-placement>ResourcePlacement How-To Guide</a>.</p><h2 id=working-with-clusterresourceplacement>Working with ClusterResourcePlacement</h2><p>ResourcePlacement is designed to work in coordination with ClusterResourcePlacement (CRP) to provide a complete multi-cluster resource management solution. Understanding this relationship is crucial for effective fleet management.</p><h3 id=namespace-prerequisites>Namespace Prerequisites</h3><p><strong>Important</strong>: ResourcePlacement can only place namespace-scoped resources to clusters that already have the target namespace. This creates a fundamental dependency on ClusterResourcePlacement for namespace establishment.</p><p><strong>Typical Workflow</strong>:</p><ol><li><strong>Fleet Admin</strong>: Uses ClusterResourcePlacement to deploy namespaces across the fleet</li><li><strong>Application Teams</strong>: Use ResourcePlacement to manage specific resources within those established namespaces</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Fleet admin creates namespace using CRP</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app-namespace-crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>selectionScope</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NamespaceOnly</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># only namespace itself is placed, no resources within the namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>---</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#8f5902;font-style:italic># Application team manages resources using RP</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app-configs-rp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ConfigMap</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-application</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickFixed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusterNames</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;prod-cluster-1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;prod-cluster-2&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=best-practices>Best Practices</h3><ul><li><strong>Establish Namespaces First</strong>: Always ensure namespaces are deployed via CRP before creating ResourcePlacement objects</li><li><strong>Monitor Dependencies</strong>: Use Fleet monitoring to ensure namespace-level CRPs are healthy before deploying dependent RPs</li><li><strong>Coordinate Policies</strong>: Align CRP and RP placement policies to avoid conflicts (e.g., if CRP places namespace on clusters A,B,C, RP can target any subset of those clusters)</li><li><strong>Team Boundaries</strong>: Use CRP for platform-managed resources (namespaces, RBAC) and RP for application-managed resources (app configs, secrets)</li></ul><p>This coordinated approach ensures that ResourcePlacement provides the flexibility teams need while maintaining the foundational infrastructure managed by platform operators.</p><h2 id=core-concepts>Core Concepts</h2><p>ResourcePlacement orchestrates multi-cluster resource distribution through a coordinated system of controllers and snapshots that work together to ensure consistent, reliable deployments.</p><h3 id=the-complete-flow>The Complete Flow</h3><p><img src=/images/en/docs/concepts/crpc/placement-concept-overview.jpg alt></p><p>When you create a ResourcePlacement, the system initiates a multi-stage process:</p><ol><li><strong>Resource Selection & Snapshotting</strong>: The placement controller identifies resources matching your selectors and creates immutable <code>ResourceSnapshot</code> objects capturing their current state</li><li><strong>Policy Evaluation & Snapshotting</strong>: Placement policies are evaluated and captured in <code>SchedulingPolicySnapshot</code> objects to ensure stable scheduling decisions</li><li><strong>Multi-Cluster Scheduling</strong>: The scheduler processes policy snapshots to determine target clusters through filtering, scoring, and selection</li><li><strong>Resource Binding</strong>: Selected clusters are bound to specific resource snapshots via <code>ResourceBinding</code> objects</li><li><strong>Rollout Execution</strong>: The rollout controller applies resources to target clusters according to the rollout strategy</li><li><strong>Override Processing</strong>: Environment-specific customizations are applied through override controllers</li><li><strong>Work Generation</strong>: Individual <code>Work</code> objects are created for each target cluster containing the final resource manifests</li><li><strong>Cluster Application</strong>: Work controllers on member clusters apply the resources locally and report status back</li></ol><h3 id=status-and-observability>Status and Observability</h3><p>ResourcePlacement provides comprehensive status reporting to track deployment progress:</p><ul><li><strong>Overall Status</strong>: High-level conditions indicating scheduling, rollout, and availability states</li><li><strong>Per-Cluster Status</strong>: Individual status for each target cluster showing detailed progress</li><li><strong>Events</strong>: Timeline of placement activities and any issues encountered</li></ul><p>Status information helps operators understand deployment progress, troubleshoot issues, and ensure resources are successfully propagated across the fleet.</p><p>For detailed troubleshooting guidance, see the <a href=/docs/troubleshooting/resourceplacement/>ResourcePlacement Troubleshooting Guide</a>.</p><h2 id=advanced-features>Advanced Features</h2><p>ResourcePlacement supports the same advanced features as ClusterResourcePlacement. For detailed documentation on these features, see the corresponding sections in the <a href=/docs/concepts/crp/#advanced-features>ClusterResourcePlacement Concept Guide - Advanced Features</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-bd269a3c0871a350c7f51b81d2a79af9>1.5 - Scheduler</h1><div class=lead>Concept about the Fleet scheduler</div><p>The scheduler component is a vital element in Fleet workload scheduling. Its primary responsibility is to determine the
schedule decision for a bundle of resources based on the latest <code>ClusterSchedulingPolicySnapshot</code>generated by the <code>ClusterResourcePlacement</code>.
By default, the scheduler operates in batch mode, which enhances performance. In this mode, it binds a <code>ClusterResourceBinding</code>
from a <code>ClusterResourcePlacement</code> to multiple clusters whenever possible.</p><h2 id=batch-in-nature>Batch in nature</h2><p>Scheduling resources within a <code>ClusterResourcePlacement</code> involves more dependencies compared with scheduling pods within
a deployment in Kubernetes. There are two notable distinctions:</p><ol><li>In a <code>ClusterResourcePlacement</code>, multiple replicas of resources cannot be scheduled on the same cluster, whereas pods
belonging to the same deployment in Kubernetes can run on the same node.</li><li>The <code>ClusterResourcePlacement</code> supports different placement types within a single object.</li></ol><p>These requirements necessitate treating the scheduling policy as a whole and feeding it to the scheduler, as opposed to
handling individual pods like Kubernetes today. Specially:</p><ol><li>Scheduling the entire <code>ClusterResourcePlacement</code> at once enables us to increase the parallelism of the scheduler if
needed.</li><li>Supporting the <code>PickAll</code> mode would require generating the replica for each cluster in the fleet to scheduler. This
approach is not only inefficient but can also result in scheduler repeatedly attempting to schedule unassigned replica when
there are no possibilities of placing them.</li><li>To support the <code>PickN</code> mode, the scheduler needs to compute the filtering and scoring for each replica. Conversely,
in batch mode, these calculations are performed once. Scheduler sorts all the eligible clusters and pick the top N clusters.</li></ol><h2 id=placement-decisions>Placement Decisions</h2><p>The output of the scheduler is an array of <code>ClusterResourceBinding</code>s on the hub cluster.</p><p><code>ClusterResourceBinding</code> sample:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourceBinding</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/previous-binding-state</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Bound</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>creationTimestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-11-06T09:53:11Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>finalizers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#000>kubernetes-fleet.io/work-cleanup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>8</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/parent-CRP</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-1-aks-member-1-2f8fe606</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1641949&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>3a443dec-a5ad-4c15-9c6d-05727b9e1d15</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>clusterDecision</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>aks-member-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusterScore</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>affinityScore</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>priorityScore</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>picked by scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>selected</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSnapshotName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-1-4-snapshot</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>schedulingPolicySnapshotName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-1-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>state</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Bound</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>targetCluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>aks-member-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-11-06T09:53:11Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>8</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Bound</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-11-10T08:23:38Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>8</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkHasBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p><code>ClusterResourceBinding</code> can have three states:</p><ul><li><em>Scheduled</em>: It indicates that the scheduler has selected this cluster for placing the resources. The resource is waiting
to be picked up by the rollout controller.</li><li><em>Bound</em>: It indicates that the rollout controller has initiated the placement of resources on the target cluster. The
resources are actively being deployed.</li><li><em>Unscheduled</em>: This states signifies that the target cluster is no longer selected by the scheduler for the placement.
The resource associated with this cluster are in the process of being removed. They are awaiting deletion from the cluster.</li></ul><p>The scheduler operates by generating scheduling decisions through the creating of new bindings in the &ldquo;scheduled&rdquo; state
and the removal of existing bindings by marking them as &ldquo;unscheduled&rdquo;. There is a separate rollout controller which is
responsible for executing these decisions based on the defined rollout strategy.</p><h2 id=enforcing-the-semantics-of-ignoreduringexecutiontime>Enforcing the semantics of &ldquo;IgnoreDuringExecutionTime&rdquo;</h2><p>The <code>ClusterResourcePlacement</code> enforces the semantics of &ldquo;IgnoreDuringExecutionTime&rdquo; to prioritize the stability of resources
running in production. Therefore, the resources should not be moved or rescheduled without explicit changes to the scheduling
policy.</p><p>Here are some high-level guidelines outlining the actions that trigger scheduling and corresponding behavior:</p><ol><li><p><code>Policy</code> changes trigger scheduling:</p><ul><li>The scheduler makes the placement decisions based on the latest <code>ClusterSchedulingPolicySnapshot</code>.</li><li>When it&rsquo;s just a scale out operation (<code>NumberOfClusters</code> of pickN mode is increased), the <code>ClusterResourcePlacement</code>
controller updates the label of the existing <code>ClusterSchedulingPolicySnapshot</code> instead of creating a new one, so that
the scheduler won&rsquo;t move any existing resources that are already scheduled and just fulfill the new requirement.</li></ul></li><li><p>The following cluster changes trigger scheduling:</p><ul><li>a cluster, originally ineligible for resource placement for some reason, becomes eligible, such as:<ul><li>the cluster setting changes, specifically <code>MemberCluster</code> labels has changed</li><li>an unexpected deployment which originally leads the scheduler to discard the cluster (for example, agents not joining,
networking issues, etc.) has been resolved</li></ul></li><li>a cluster, originally eligible for resource placement, is leaving the fleet and becomes ineligible</li></ul><blockquote><p>Note: The scheduler is only going to place the resources on the new cluster and won&rsquo;t touch the existing clusters.</p></blockquote></li><li><p>Resource-only changes <strong>do not</strong> trigger scheduling including:</p><ul><li><code>ResourceSelectors</code> is updated in the <code>ClusterResourcePlacement</code> spec.</li><li>The selected resources is updated without directly affecting the <code>ClusterResourcePlacement</code>.</li></ul></li></ol><h2 id=whats-next>What&rsquo;s next</h2><ul><li>Read about <a href=scheduler-framework>Scheduling Framework</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-e149527fa64d0c3eacbb2ff5e7b6ffea>1.6 - Scheduling Framework</h1><div class=lead>Concept about the Fleet scheduling framework</div><p>The fleet scheduling framework closely aligns with the native <a href=https://kubernetes.io/docs/concepts/scheduling-eviction/scheduling-framework/>Kubernetes scheduling framework</a>,
incorporating several modifications and tailored functionalities.</p><p><img src=/images/en/docs/concepts/scheduling-framework/scheduling-framework.jpg alt></p><p>The primary advantage of this framework lies in its capability to compile plugins directly into the scheduler. Its API
facilitates the implementation of diverse scheduling features as plugins, thereby ensuring a lightweight and maintainable
core.</p><p>The fleet scheduler integrates three fundamental built-in plugin types:</p><ul><li><strong>Topology Spread Plugin</strong>: Supports the TopologySpreadConstraints stipulated in the placement policy.</li><li><strong>Cluster Affinity Plugin</strong>: Facilitates the Affinity clause of the placement policy.</li><li><strong>Same Placement Affinity Plugin</strong>: Uniquely designed for the fleet, preventing multiple replicas (selected resources) from
being placed within the same cluster. This distinguishes it from Kubernetes, which allows multiple pods on a node.</li><li><strong>Cluster Eligibility Plugin</strong>: Enables cluster selection based on specific status criteria.</li><li>** Taint & Toleration Plugin**: Enables cluster selection based on taints on the cluster & tolerations on the ClusterResourcePlacement.</li></ul><p>Compared to the Kubernetes scheduling framework, the fleet framework introduces additional stages for the pickN placement type:</p><ul><li><strong>Batch & PostBatch</strong>:<ul><li>Batch: Defines the batch size based on the desired and current <code>ClusterResourceBinding</code>.</li><li>PostBatch: Adjusts the batch size as necessary. Unlike the Kubernetes scheduler, which schedules pods individually (batch size = 1).</li></ul></li><li><strong>Sort</strong>:<ul><li>Fleet&rsquo;s sorting mechanism selects a number of clusters, whereas Kubernetes&rsquo; scheduler prioritizes nodes with the highest scores.</li></ul></li></ul><p>To streamline the scheduling framework, certain stages, such as <code>permit</code> and <code>reserve</code>, have been omitted due to the absence
of corresponding plugins or APIs enabling customers to reserve or permit clusters for specific placements. However, the
framework remains designed for easy extension in the future to accommodate these functionalities.</p><h2 id=in-tree-plugins>In-tree plugins</h2><p>The scheduler includes default plugins, each associated with distinct extension points:</p><table><thead><tr><th>Plugin</th><th>PostBatch</th><th>Filter</th><th>Score</th></tr></thead><tbody><tr><td>Cluster Affinity</td><td>âŒ</td><td>âœ…</td><td>âœ…</td></tr><tr><td>Same Placement Anti-affinity</td><td>âŒ</td><td>âœ…</td><td>âŒ</td></tr><tr><td>Topology Spread Constraints</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>Cluster Eligibility</td><td>âŒ</td><td>âœ…</td><td>âŒ</td></tr><tr><td>Taint & Toleration</td><td>âŒ</td><td>âœ…</td><td>âŒ</td></tr></tbody></table><p>The Cluster Affinity Plugin serves as an illustrative example and operates within the following extension points:</p><ol><li><strong>PreFilter</strong>:
Verifies whether the policy contains any required cluster affinity terms. If absent, the plugin bypasses the subsequent
Filter stage.</li><li><strong>Filter</strong>:
Filters out clusters that fail to meet the specified required cluster affinity terms outlined in the policy.</li><li><strong>PreScore</strong>:
Determines if the policy includes any preferred cluster affinity terms. If none are found, this plugin will be skipped
during the Score stage.</li><li><strong>Score</strong>:
Assigns affinity scores to clusters based on compliance with the preferred cluster affinity terms stipulated in the policy.</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-716d7f944c3423c5dfa17047db699aed>1.7 - Properties and Property Providers</h1><div class=lead>Concept about cluster properties and property providers</div><p>This document explains the concepts of property provider and cluster properties in Fleet.</p><p>Fleet allows developers to implement a property provider to expose arbitrary properties about
a member cluster, such as its node count and available resources for workload placement. Platforms
could also enable their property providers to expose platform-specific properties via Fleet.
These properties can be useful in a variety of cases: for example, administrators could monitor the
health of a member cluster using related properties; Fleet also supports making scheduling
decisions based on the property data.</p><h2 id=property-provider>Property provider</h2><p>A property provider implements Fleet&rsquo;s property provider interface:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// PropertyProvider is the interface that every property provider must implement.</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>PropertyProvider</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Collect is called periodically by the Fleet member agent to collect properties.</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Note that this call should complete promptly. Fleet member agent will cancel the</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// context if the call does not complete in time.</span>
</span></span><span style=display:flex><span>	<span style=color:#000>Collect</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>PropertyCollectionResponse</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Start is called when the Fleet member agent starts up to initialize the property provider.</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// This call should not block.</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>//</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Note that Fleet member agent will cancel the context when it exits.</span>
</span></span><span style=display:flex><span>	<span style=color:#000>Start</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>config</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>rest</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Config</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>error</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>For the details, see the <a href=../../../pkg/propertyprovider/interface.go>Fleet source code</a>.</p><p>A property provider should be shipped as a part of the Fleet member agent and run alongside it.
Refer to the <a href=../../../cmd/memberagent/main.go>Fleet source code</a>
for specifics on how to set it up with the Fleet member agent.
At this moment, only one property provider can be set up with the Fleet member agent at a time.
Once connected, the Fleet member agent will attempt to start it when
the agent itself initializes; the agent will then start collecting properties from the
property provider periodically.</p><p>A property provider can expose two types of properties: resource properties, and non-resource
properties. To learn about the two types, see the section below. In addition, the provider can
choose to report its status, such as any errors encountered when preparing the properties,
in the form of Kubernetes conditions.</p><p>The Fleet member agent can run with or without a property provider. If a provider is not set up, or
the given provider fails to start properly, the agent will collect limited properties about
the cluster on its own, specifically the node count, plus the total/allocatable
CPU and memory capacities of the host member cluster.</p><h2 id=cluster-properties>Cluster properties</h2><p>A cluster property is an attribute of a member cluster. There are two types of properties:</p><ul><li><p>Resource property: the usage information of a resource in a member cluster, which consists of:</p><ul><li>the total capacity of the resource, which is the amount of the resource
installed in the cluster;</li><li>the allocatable capacity of the resource, which is the maximum amount of the resource
that can be used for running user workloads, as some amount of the resource might be
reserved by the OS, kubelet, etc.;</li><li>the available capacity of the resource, which is the amount of the resource that
is currently free for running user workloads.</li></ul><p>Note that you may report a virtual resource via the property provider, if applicable.</p></li><li><p>Non-resource property: a value that describes a member cluster.</p></li></ul><p>A property is uniquely identified by its name, which is formatted as a string of one or more
segments, separated by slashes (<code>/</code>). Each segment must be 63 characters or less, start and end
with an alphanumeric character, and can include dashes (<code>-</code>), underscores (<code>_</code>), dots (<code>.</code>), and
alphanumerics in between. Optionally, the property name can have a prefix, which must be a DNS
subdomain up to 253 characters, followed by a slash (<code>/</code>). Below are some examples of valid
property names:</p><ul><li><code>cpu</code></li><li><code>memory</code></li><li><code>kubernetes-fleet.io/node-count</code></li><li><code>kubernetes.azure.com/skus/Standard_B4ms/count</code></li></ul><p>Eventually, all cluster properties are exposed via the Fleet <code>MemberCluster</code> API, with the
non-resource properties in the <code>.status.properties</code> field and the resource properties
<code>.status.resourceUsage</code> field:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>MemberCluster</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>agentStatus</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>properties</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/node-count</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observationTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-30T14:54:24Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceUsage</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>allocatable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>cpu</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>32</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;16Gi&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>available</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>cpu</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;800Mi&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>capacity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>cpu</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>40</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;20Gi&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Note that conditions reported by the property provider (if any), would be available in the
<code>.status.conditions</code> array as well.</p><h3 id=core-properties>Core properties</h3><p>The following properties are considered core properties in Fleet, which should be supported
in all property provider implementations. Fleet agents will collect them even when no
property provider has been set up.</p><table><thead><tr><th>Property Type</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>Non-resource property</td><td><code>kubernetes-fleet.io/node-count</code></td><td>The number of nodes in a cluster.</td></tr><tr><td>Resource property</td><td><code>cpu</code></td><td>The usage information (total, allocatable, and available capacity) of CPU resource in a cluster.</td></tr><tr><td>Resource property</td><td><code>memory</code></td><td>The usage information (total, allocatable, and available capacity) of memory resource in a cluster.</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-057b31916d61f2f113de30f88397f691>1.8 - Safe Rollout</h1><div class=lead>Concept about rolling out changes safely in Fleet</div><p>One of the most important features of Fleet is the ability to safely rollout changes across multiple clusters. We do
this by rolling out the changes in a controlled manner, ensuring that we only continue to propagate the changes to the
next target clusters if the resources are successfully applied to the previous target clusters.</p><h2 id=overview>Overview</h2><p>We automatically propagate any resource changes that are selected by a <code>ClusterResourcePlacement</code> from the hub cluster
to the target clusters based on the placement policy defined in the <code>ClusterResourcePlacement</code>. In order to reduce the
blast radius of such operation, we provide users a way to safely rollout the new changes so that a bad release
won&rsquo;t affect all the running instances all at once.</p><h2 id=rollout-strategy>Rollout Strategy</h2><p>We currently only support the <code>RollingUpdate</code> rollout strategy. It updates the resources in the selected target clusters
gradually based on the <code>maxUnavailable</code> and <code>maxSurge</code> settings.</p><h2 id=in-place-update-policy>In place update policy</h2><p>We always try to do in-place update by respecting the rollout strategy if there is no change in the placement. This is to avoid unnecessary
interrupts to the running workloads when there is only resource changes. For example, if you only change the tag of the
deployment in the namespace you want to place, we will do an in-place update on the deployments already placed on the
targeted cluster instead of moving the existing deployments to other clusters even if the labels or properties of the
current clusters are not the best to match the current placement policy.</p><h2 id=how-to-use-rollingupdateconfig>How To Use RollingUpdateConfig</h2><p>RolloutUpdateConfig is used to control behavior of the rolling update strategy.</p><h3 id=maxunavailable-and-maxsurge>MaxUnavailable and MaxSurge</h3><p><code>MaxUnavailable</code> specifies the maximum number of connected clusters to the fleet compared to <code>target number of clusters</code>
specified in <code>ClusterResourcePlacement</code> policy in which resources propagated by the <code>ClusterResourcePlacement</code> can be
unavailable. Minimum value for <code>MaxUnavailable</code> is set to 1 to avoid stuck rollout during in-place resource update.</p><p><code>MaxSurge</code> specifies the maximum number of clusters that can be scheduled with resources above the <code>target number of clusters</code>
specified in <code>ClusterResourcePlacement</code> policy.</p><blockquote><p><strong>Note:</strong> <code>MaxSurge</code> only applies to rollouts to newly scheduled clusters, and doesn&rsquo;t apply to rollouts of workload triggered by
updates to already propagated resource. For updates to already propagated resources, we always try to do the updates in
place with no surge.</p></blockquote><p><code>target number of clusters</code> changes based on the <code>ClusterResourcePlacement</code> policy.</p><ul><li>For PickAll, it&rsquo;s the number of clusters picked by the scheduler.</li><li>For PickN, it&rsquo;s the number of clusters specified in the <code>ClusterResourcePlacement</code> policy.</li><li>For PickFixed, it&rsquo;s the length of the list of cluster names specified in the <code>ClusterResourcePlacement</code> policy.</li></ul><h4 id=example-1>Example 1:</h4><p>Consider a fleet with 4 connected member clusters (cluster-1, cluster-2, cluster-3 & cluster-4) where every member
cluster has label <code>env: prod</code>. The hub cluster has a namespace called <code>test-ns</code> with a deployment in it.</p><p>The <code>ClusterResourcePlacement</code> spec is defined as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>prod</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>rollingUpdate</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxUnavailable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxSurge</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The rollout will be as follows:</p><ul><li><p>We try to pick 3 clusters out of 4, for this scenario let&rsquo;s say we pick cluster-1, cluster-2 & cluster-3.</p></li><li><p>Since we can&rsquo;t track the initial availability for the deployment, we rollout the namespace with deployment to
cluster-1, cluster-2 & cluster-3.</p></li><li><p>Then we update the deployment with a bad image name to update the resource in place on cluster-1, cluster-2 & cluster-3.</p></li><li><p>But since we have <code>maxUnavailable</code> set to 1, we will rollout the bad image name update for deployment to one of the clusters
(which cluster the resource is rolled out to first is non-deterministic).</p></li><li><p>Once the deployment is updated on the first cluster, we will wait for the deployment&rsquo;s availability to be true before
rolling out to the other clusters</p></li><li><p>And since we rolled out a bad image name update for the deployment it&rsquo;s availability will always be false and hence the
rollout for the other two clusters will be stuck</p></li><li><p>Users might think <code>maxSurge</code> of 1 might be utilized here but in this case since we are updating the resource in place
<code>maxSurge</code> will not be utilized to surge and pick cluster-4.</p></li></ul><blockquote><p><strong>Note:</strong> <code>maxSurge</code> will be utilized to pick cluster-4, if we change the policy to pick 4 cluster or change placement
type to <code>PickAll</code>.</p></blockquote><h4 id=example-2>Example 2:</h4><p>Consider a fleet with 4 connected member clusters (cluster-1, cluster-2, cluster-3 & cluster-4) where,</p><ul><li>cluster-1 and cluster-2 has label <code>loc: west</code></li><li>cluster-3 and cluster-4 has label <code>loc: east</code></li></ul><p>The hub cluster has a namespace called <code>test-ns</code> with a deployment in it.</p><p>Initially, the <code>ClusterResourcePlacement</code> spec is defined as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1          </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>loc</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>west</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>rollingUpdate</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxSurge</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The rollout will be as follows:</p><ul><li>We try to pick clusters (cluster-1 and cluster-2) by specifying the label selector <code>loc: west</code>.</li><li>Since we can&rsquo;t track the initial availability for the deployment, we rollout the namespace with deployment to cluster-1
and cluster-2 and wait till they become available.</li></ul><p>Then we update the <code>ClusterResourcePlacement</code> spec to the following:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1          </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>loc</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>east</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>rollingUpdate</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxSurge</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The rollout will be as follows:</p><ul><li>We try to pick clusters (cluster-3 and cluster-4) by specifying the label selector <code>loc: east</code>.</li><li>But this time around since we have <code>maxSurge</code> set to 2 we are saying we can propagate resources to a maximum of
4 clusters but our target number of clusters specified is 2, we will rollout the namespace with deployment to both
cluster-3 and cluster-4 before removing the deployment from cluster-1 and cluster-2.</li><li>And since <code>maxUnavailable</code> is always set to 25% by default which is rounded off to 1, we will remove the
resource from one of the existing clusters (cluster-1 or cluster-2) because when <code>maxUnavailable</code> is 1 the policy
mandates at least one cluster to be available.</li></ul><h3 id=unavailableperiodseconds>UnavailablePeriodSeconds</h3><p><code>UnavailablePeriodSeconds</code> is used to configure the waiting time between rollout phases when we cannot determine if the
resources have rolled out successfully or not. This field is used only if the availability of resources we propagate
are not trackable. Refer to the <a href=/docs/concepts/safe-rollout/#data-only-objects>Data only object</a> section for more details.</p><h2 id=availability-based-rollout>Availability based Rollout</h2><p>We have built-in mechanisms to determine the availability of some common Kubernetes native resources. We only mark them
as available in the target clusters when they meet the criteria we defined.</p><h3 id=how-it-works>How It Works</h3><p>We have an agent running in the target cluster to check the status of the resources. We have specific criteria for each
of the following resources to determine if they are available or not. Here are the list of resources we support:</p><h4 id=deployment>Deployment</h4><p>We only mark a <code>Deployment</code> as available when all its pods are running, ready and updated according to the latest spec.</p><h4 id=daemonset>DaemonSet</h4><p>We only mark a <code>DaemonSet</code> as available when all its pods are available and updated according to the latest spec on all
desired scheduled nodes.</p><h4 id=statefulset>StatefulSet</h4><p>We only mark a <code>StatefulSet</code> as available when all its pods are running, ready and updated according to the latest revision.</p><h4 id=job>Job</h4><p>We only mark a <code>Job</code> as available when it has at least one succeeded pod or one ready pod.</p><h4 id=service>Service</h4><p>For <code>Service</code> based on the service type the availability is determined as follows:</p><ul><li>For <code>ClusterIP</code> & <code>NodePort</code> service, we mark it as available when a cluster IP is assigned.</li><li>For <code>LoadBalancer</code> service, we mark it as available when a <code>LoadBalancerIngress</code> has been assigned along with an IP or Hostname.</li><li>For <code>ExternalName</code> service, checking availability is not supported, so it will be marked as available with not trackable reason.</li></ul><h4 id=data-only-objects>Data only objects</h4><p>For the objects described below since they are a data resource we mark them as available immediately after creation,</p><ul><li>Namespace</li><li>Secret</li><li>ConfigMap</li><li>Role</li><li>ClusterRole</li><li>RoleBinding</li><li>ClusterRoleBinding</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-f14a979ac0ba3b2cbfcab451b17d9e7a>1.9 - Override</h1><div class=lead>Concept about the override APIs</div><h2 id=overview>Overview</h2><p>The <code>ClusterResourceOverride</code> and <code>ResourceOverride</code> provides a way to customize resource configurations before they are propagated
to the target cluster by the <code>ClusterResourcePlacement</code>.</p><h2 id=difference-between-clusterresourceoverride-and-resourceoverride>Difference Between <code>ClusterResourceOverride</code> And <code>ResourceOverride</code></h2><p><code>ClusterResourceOverride</code> represents the cluster-wide policy that overrides the cluster scoped resources to one or more
clusters while <code>ResourceOverride</code> will apply to resources in the same namespace as the namespace-wide policy.</p><blockquote><p><strong>Note:</strong> If a namespace is selected by the <code>ClusterResourceOverride</code>, ALL the resources under the namespace are selected
automatically.</p></blockquote><p>If the resource is selected by both <code>ClusterResourceOverride</code> and <code>ResourceOverride</code>, the <code>ResourceOverride</code> will win
when resolving the conflicts.</p><h2 id=when-to-use-override>When To Use Override</h2><p>Overrides is useful when you want to customize the resources before they are propagated from the hub cluster to the target clusters.
Some example use cases are:</p><ul><li>As a platform operator, I want to propagate a clusterRoleBinding to cluster-us-east and cluster-us-west and would like to
grant the same role to different groups in each cluster.</li><li>As a platform operator, I want to propagate a clusterRole to cluster-staging and cluster-production and would like to
grant more permissions to the cluster-staging cluster than the cluster-production cluster.</li><li>As a platform operator, I want to propagate a namespace to all the clusters and would like to customize the labels for
each cluster.</li><li>As an application developer, I would like to propagate a deployment to cluster-staging and cluster-production and would
like to always use the latest image in the staging cluster and a specific image in the production cluster.</li><li>As an application developer, I would like to propagate a deployment to all the clusters and would like to use different
commands for my container in different regions.</li></ul><h2 id=limits>Limits</h2><ul><li>Each resource can be only selected by one override simultaneously. In the case of namespace scoped resources, up to two
overrides will be allowed, considering the potential selection through both <code>ClusterResourceOverride</code> (select its namespace)
and <code>ResourceOverride</code>.</li><li>At most 100 <code>ClusterResourceOverride</code> can be created.</li><li>At most 100 <code>ResourceOverride</code> can be created.</li></ul><h2 id=placement>Placement</h2><p>This specifies which placement the override should be applied to.</p><h2 id=resource-selector>Resource Selector</h2><p><code>ClusterResourceSelector</code> of <code>ClusterResourceOverride</code> selects which cluster-scoped resources need to be overridden before
applying to the selected clusters.</p><p>It supports the following forms of resource selection:</p><ul><li>Select resources by specifying the &lt;group, version, kind> and name. This selection propagates only one resource that
matches the &lt;group, version, kind> and name.</li></ul><blockquote><p><strong>Note:</strong> Label selector of <code>ClusterResourceSelector</code> is not supported.</p></blockquote><p><code>ResourceSelector</code> of <code>ResourceOverride</code> selects which namespace-scoped resources need to be overridden before applying to
the selected clusters.</p><p>It supports the following forms of resource selection:</p><ul><li>Select resources by specifying the &lt;group, version, kind> and name. This selection propagates only one resource that
matches the &lt;group, version, kind> and name under the <code>ResourceOverride</code> namespace.</li></ul><h2 id=override-policy>Override Policy</h2><p>Override policy defines how to override the selected resources on the target clusters.</p><p>It contains an array of override rules and its order determines the override order. For example, when there are two rules
selecting the same fields on the target cluster, the last one will win.</p><p>Each override rule contains the following fields:</p><ul><li><code>ClusterSelector</code>: which cluster(s) the override rule applies to. It supports the following forms of cluster selection:<ul><li>Select clusters by specifying the cluster labels.</li><li>An empty selector selects ALL the clusters.</li><li>A nil selector selects NO target cluster.</li></ul><blockquote><p>IMPORTANT:
Only <code>labelSelector</code> is supported in the <code>clusterSelectorTerms</code> field.</p></blockquote></li><li><code>OverrideType</code>: which type of the override should be applied to the selected resources. The default type is <code>JSONPatch</code>.<ul><li><code>JSONPatch</code>: applies the JSON patch to the selected resources using <a href=https://datatracker.ietf.org/doc/html/rfc6902>RFC 6902</a>.</li><li><code>Delete</code>: deletes the selected resources on the target cluster.</li></ul></li><li><code>JSONPatchOverrides</code>: a list of JSON path override rules applied to the selected resources following <a href=https://datatracker.ietf.org/doc/html/rfc6902>RFC 6902</a> when the override type is <code>JSONPatch</code>.</li></ul><blockquote><p><strong>Note:</strong> Updating the fields in the TypeMeta (e.g., <code>apiVersion</code>, <code>kind</code>) is not allowed.</p></blockquote><blockquote><p><strong>Note:</strong> Updating the fields in the ObjectMeta (e.g., <code>name</code>, <code>namespace</code>) excluding annotations and labels is not allowed.</p></blockquote><blockquote><p><strong>Note:</strong> Updating the fields in the Status (e.g., <code>status</code>) is not allowed.</p></blockquote><h3 id=reserved-variables-in-the-json-patch-override-value>Reserved Variables in the JSON Patch Override Value</h3><p>There is a list of reserved variables that will be replaced by the actual values used in the <code>value</code> of the JSON patch override rule:</p><ul><li><code>${MEMBER-CLUSTER-NAME}</code>: this will be replaced by the name of the <code>memberCluster</code> that represents this cluster.</li></ul><p>For example, to add a label to the <code>ClusterRole</code> named <code>secret-reader</code> on clusters with the label <code>env: prod</code>,
you can use the following configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-cro</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>clusterResourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rbac.authorization.k8s.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterRole</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>secret-reader</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>overrideRules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>clusterSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>prod</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>jsonPatchOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>add</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/metadata/labels</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span>{<span style=color:#4e9a06>&#34;cluster-name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;${MEMBER-CLUSTER-NAME}&#34;</span>}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <code>ClusterResourceOverride</code> object above will add a label <code>cluster-name</code> with the value of the <code>memberCluster</code> name to the <code>ClusterRole</code> named <code>secret-reader</code> on clusters with the label <code>env: prod</code>.</p><h2 id=when-to-trigger-rollout>When To Trigger Rollout</h2><p>It will take the snapshot of each override change as a result of <code>ClusterResourceOverrideSnapshot</code> and
<code>ResourceOverrideSnapshot</code>. The snapshot will be used to determine whether the override change should be applied to the existing
<code>ClusterResourcePlacement</code> or not. If applicable, it will start rolling out the new resources to the target clusters by
respecting the rollout strategy defined in the <code>ClusterResourcePlacement</code>.</p><h2 id=examples>Examples</h2><h3 id=add-annotations-to-the-configmap-by-using-clusterresourceoverride>add annotations to the configmap by using clusterResourceOverride</h3><p>Suppose we create a configmap named <code>app-config-1</code> under the namespace <code>application-1</code> in the hub cluster, and we want to
add an annotation to it, which is applied to all the member clusters.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ConfigMap</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>creationTimestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app-config-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>application-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1434&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b4109de8-32f2-4ac8-9e1a-9cb715b3261d</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Create a <code>ClusterResourceOverride</code> named <code>cro-1</code> to add an annotation to the namespace <code>application-1</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>creationTimestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>finalizers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>kubernetes-fleet.io/override-cleanup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cro-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1436&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>32237804</span>-<span style=color:#000>7eb2-4d5f-9996-ff4d8ce778e7</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>clusterResourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>application-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>overrideRules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>clusterSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>jsonPatchOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>add</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/metadata/annotations</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>cro-test-annotation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cro-test-annotation-val</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Check the configmap on one of the member cluster by running <code>kubectl get configmap app-config-1 -n application-1 -o yaml</code> command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ConfigMap</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cro-test-annotation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cro-test-annotation-val</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/last-applied-configuration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;{&#34;apiVersion&#34;:&#34;v1&#34;,&#34;data&#34;:{&#34;data&#34;:&#34;test&#34;},&#34;kind&#34;:&#34;ConfigMap&#34;,&#34;metadata&#34;:{&#34;annotations&#34;:{&#34;cro-test-annotation&#34;:&#34;cro-test-annotation-val&#34;,&#34;kubernetes-fleet.io/spec-hash&#34;:&#34;4dd5a08aed74884de455b03d3b9c48be8278a61841f3b219eca9ed5e8a0af472&#34;},&#34;name&#34;:&#34;app-config-1&#34;,&#34;namespace&#34;:&#34;application-1&#34;,&#34;ownerReferences&#34;:[{&#34;apiVersion&#34;:&#34;placement.kubernetes-fleet.io/v1beta1&#34;,&#34;blockOwnerDeletion&#34;:false,&#34;kind&#34;:&#34;AppliedWork&#34;,&#34;name&#34;:&#34;crp-1-work&#34;,&#34;uid&#34;:&#34;77d804f5-f2f1-440e-8d7e-e9abddacb80c&#34;}]}}&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubernetes-fleet.io/spec-hash</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>4dd5a08aed74884de455b03d3b9c48be8278a61841f3b219eca9ed5e8a0af472</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>creationTimestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app-config-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>application-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>ownerReferences</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>blockOwnerDeletion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AppliedWork</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-1-work</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>77d804f5-f2f1-440e-8d7e-e9abddacb80c</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1449&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>a8601007-1e6b-4b64-bc05-1057ea6bd21b</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=add-annotations-to-the-configmap-by-using-resourceoverride>add annotations to the configmap by using resourceOverride</h3><p>You can use the <code>ResourceOverride</code> to add an annotation to the configmap <code>app-config-1</code> explicitly in the namespace <code>application-1</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>creationTimestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:25:31Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>finalizers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#000>kubernetes-fleet.io/override-cleanup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ro-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>application-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;3859&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>b4117925-bc3c-438d-a4f6-067bc4577364</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>overrideRules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>jsonPatchOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>add</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/metadata/annotations</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>ro-test-annotation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ro-test-annotation-val</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ConfigMap</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app-config-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=how-to-validate-if-overrides-are-applied>How To Validate If Overrides Are Applied</h2><p>You can validate if the overrides are applied by checking the <code>ClusterResourcePlacement</code> status. The status output will
indicate both placement conditions and individual placement statuses on each member cluster that was overridden.</p><p>Sample output:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all the clusters needed as specified by the scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All 3 cluster(s) start rolling out the latest resource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementRolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources are successfully overridden in the 3 clusters</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OverriddenSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementOverridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Works(s) are succcesfully created or updated in the 3 target clusters&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>namespaces</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementWorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources are successfully applied to 3 clusters</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources in 3 cluster are available now</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>observedResourceIndex</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementStatuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>applicableClusterResourceOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>cro-1-0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in kind-cluster-1 (affinity
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        score: 0, topology spread score: 0): picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully applied the override rules on the resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OverriddenSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-05-07T08:06:27Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The availability of work object crp-1-work is not trackable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkNotTrackable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p><code>applicableClusterResourceOverrides</code> in <code>placementStatuses</code> indicates which <code>ClusterResourceOverrideSnapshot</code> that is applied
to the target cluster. Similarly, <code>applicableResourceOverrides</code> will be set if the <code>ResourceOverrideSnapshot</code> is applied.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-8ddd4e0ab9f151e89ec11f8f8feb3f69>1.10 - Staged Update</h1><div class=lead>Concept about Staged Update</div><p>While users can rely on the <code>RollingUpdate</code> rollout strategy in the placement to safely roll out their workloads,
many organizations require more sophisticated deployment control mechanisms for their fleet operations.
Standard rolling updates, while effective for individual rollout, lack the granular control and coordination capabilities needed for complex, multi-cluster environments.</p><h2 id=why-staged-rollouts>Why Staged Rollouts?</h2><p>Staged rollouts address critical deployment challenges that organizations face when managing workloads across distributed environments:</p><h3 id=strategic-grouping-and-ordering>Strategic Grouping and Ordering</h3><p>Traditional rollout strategies treat all target clusters uniformly, but real-world deployments often require strategic sequencing. Staged rollouts enable you to:</p><ul><li><strong>Group clusters by environment</strong> (development â†’ staging â†’ production)</li><li><strong>Prioritize by criticality</strong> (test clusters before business-critical systems)</li><li><strong>Sequence by dependencies</strong> (deploy foundational services before dependent applications)</li></ul><p>This grouping capability ensures that updates follow your organization&rsquo;s risk management and operational requirements rather than arbitrary ordering.</p><h3 id=enhanced-control-and-approval-gates>Enhanced Control and Approval Gates</h3><p>Automated rollouts provide speed but can propagate issues rapidly across your entire fleet. Staged rollouts introduce deliberate checkpoints that give teams control over the rollout progression:</p><ul><li><strong>Manual approval gates</strong> between stages allow human validation of rollout health</li><li><strong>Automated wait periods</strong> provide time for monitoring and observation</li></ul><h2 id=dual-scope-architecture>Dual-Scope Architecture</h2><p>Kubefleet provides staged update capabilities at two different scopes to address different organizational roles and operational requirements:</p><ol><li><strong>Cluster-scoped staged updates</strong> for fleet administrators who need to manage rollouts across entire clusters</li><li><strong>Namespace-scoped staged updates</strong> for application teams who need to manage rollouts within their specific namespaces</li></ol><p>This dual approach enables fleet administrators to maintain oversight of infrastructure-level changes while empowering application teams with autonomous control over their specific workloads.</p><p><img src=/images/en/docs/concepts/staged-update/updaterun.jpg alt></p><h2 id=overview>Overview</h2><p>Kubefleet provides staged update capabilities at two scopes to serve different organizational needs:</p><p><strong>Cluster-Scoped</strong>: <code>ClusterStagedUpdateStrategy</code>, <code>ClusterStagedUpdateRun</code>, and <code>ClusterApprovalRequest</code> for fleet administrators managing infrastructure-level changes across clusters.</p><p><strong>Namespace-Scoped</strong>: <code>StagedUpdateStrategy</code>, <code>StagedUpdateRun</code>, and <code>ApprovalRequest</code> for application teams managing rollouts within their specific namespaces.</p><p>Both systems follow the same pattern:</p><ol><li><strong>Strategy</strong> resources define reusable orchestration patterns with stages, ordering, and approval gates</li><li><strong>UpdateRun</strong> resources execute the strategy for specific rollouts using a target placement, resource snapshot, and strategy name</li><li><strong>External rollout</strong> strategy must be set on the target placement to enable staged updates</li></ol><h3 id=key-differences-by-persona>Key Differences by Persona</h3><table><thead><tr><th>Aspect</th><th>Fleet Administrators (Cluster-Scoped)</th><th>Application Teams (Namespace-Scoped)</th></tr></thead><tbody><tr><td><strong>Scope</strong></td><td>Entire clusters and infrastructure</td><td>Individual applications within namespaces</td></tr><tr><td><strong>Resources</strong></td><td><code>ClusterStagedUpdateStrategy</code>, <code>ClusterStagedUpdateRun</code>, <code>ClusterApprovalRequest</code></td><td><code>StagedUpdateStrategy</code>, <code>StagedUpdateRun</code>, <code>ApprovalRequest</code></td></tr><tr><td><strong>Target</strong></td><td><code>ClusterResourcePlacement</code></td><td><code>ResourcePlacement</code> (namespace-scoped)</td></tr><tr><td><strong>Use Cases</strong></td><td>Fleet-wide updates, infrastructure changes</td><td>Application rollouts, service updates</td></tr><tr><td><strong>Permission</strong></td><td>Requires cluster-admin permissions</td><td>Operates within namespace boundaries</td></tr></tbody></table><h2 id=configure-external-rollout-strategy>Configure External Rollout Strategy</h2><p>Both placement types require setting the rollout strategy to <code>External</code> to enable staged updates:</p><p><strong>Cluster-scoped example:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-placement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>External</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># enables staged updates</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p><strong>Namespace-scoped example:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-namespace-placement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-app-namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;apps&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-application</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>External</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># enables staged updates</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=define-staged-update-strategies>Define Staged Update Strategies</h2><p>Staged update strategies define reusable orchestration patterns that organize target clusters into stages with specific rollout sequences and approval gates. Both scopes use similar configurations but operate at different levels.</p><h3 id=cluster-scoped-strategy>Cluster-Scoped Strategy</h3><p><code>ClusterStagedUpdateStrategy</code> organizes member clusters into stages:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterStagedUpdateStrategy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster-config-strategy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>stages</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>staging</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>environment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>staging</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>afterStageTasks</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>TimedWait</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>waitTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>1h</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>canary</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>environment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>canary</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>afterStageTasks</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Approval</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>production</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>environment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>production</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>sortingLabelKey</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>order</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>afterStageTasks</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Approval</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>TimedWait</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>waitTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>1h</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=namespace-scoped-strategy>Namespace-Scoped Strategy</h3><p><code>StagedUpdateStrategy</code> follows the same pattern but operates within namespace boundaries:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>StagedUpdateStrategy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app-rollout-strategy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-app-namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>stages</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>dev-clusters</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>environment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>development</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>afterStageTasks</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>TimedWait</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>waitTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>30m</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>production-clusters</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>environment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>production</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>sortingLabelKey</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>deployment-order</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>afterStageTasks</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Approval</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=stage-configuration>Stage Configuration</h3><p>Each stage includes:</p><ul><li><strong>name</strong>: Unique identifier for the stage</li><li><strong>labelSelector</strong>: Selects target clusters for this stage</li><li><strong>sortingLabelKey</strong> (optional): Label whose integer value determines update sequence within the stage</li><li><strong>afterStageTasks</strong> (optional): Tasks that must complete before proceeding to the next stage</li></ul><h3 id=after-stage-tasks>After-Stage Tasks</h3><p>Two task types to control stage progression:</p><ul><li><strong>TimedWait</strong>: Waits for a specified duration before proceeding</li><li><strong>Approval</strong>: Requires manual approval via an approval request object</li></ul><p>For approval tasks, the system automatically creates an approval request object named <code>&lt;updateRun-name>-&lt;stage-name></code>. The approval request type depends on the scope:</p><ul><li><strong>Cluster-scoped</strong>: Creates <code>ClusterApprovalRequest</code> (short name: <code>careq</code>) - a cluster-scoped resource containing a spec with <code>parentStageRollout</code> (the UpdateRun name) and <code>targetStage</code> (the stage name). The spec is immutable after creation.</li><li><strong>Namespace-scoped</strong>: Creates <code>ApprovalRequest</code> (short name: <code>areq</code>) within the same namespace - a namespace-scoped resource with the same spec structure as <code>ClusterApprovalRequest</code>.</li></ul><p>Both approval request types use status conditions to track approval state:</p><ul><li><code>Approved</code> condition (status <code>True</code>): indicates the request was approved by a user</li><li><code>ApprovalAccepted</code> condition (status <code>True</code>): indicates the approval was processed and accepted by the system</li></ul><p>Approve manually by setting the <code>Approved</code> condition to <code>True</code> using kubectl patch:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># For cluster-scoped approvals</span>
</span></span><span style=display:flex><span>kubectl patch clusterapprovalrequests example-run-canary --type<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;merge&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  -p <span style=color:#4e9a06>&#39;{&#34;status&#34;:{&#34;conditions&#34;:[{&#34;type&#34;:&#34;Approved&#34;,&#34;status&#34;:&#34;True&#34;,&#34;reason&#34;:&#34;approved&#34;,&#34;message&#34;:&#34;approved&#34;}]}}&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  --subresource<span style=color:#ce5c00;font-weight:700>=</span>status
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># For namespace-scoped approvals</span>
</span></span><span style=display:flex><span>kubectl patch approvalrequests app-run-canary -n my-app-namespace --type<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;merge&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  -p <span style=color:#4e9a06>&#39;{&#34;status&#34;:{&#34;conditions&#34;:[{&#34;type&#34;:&#34;Approved&#34;,&#34;status&#34;:&#34;True&#34;,&#34;reason&#34;:&#34;approved&#34;,&#34;message&#34;:&#34;approved&#34;}]}}&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  --subresource<span style=color:#ce5c00;font-weight:700>=</span>status
</span></span></code></pre></div><h2 id=trigger-staged-rollouts>Trigger Staged Rollouts</h2><p>UpdateRun resources execute strategies for specific rollouts. Both scopes follow the same pattern with three required parameters:</p><p><strong>Cluster-scoped example:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterStagedUpdateRun</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-run</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-placement             </span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># Target ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSnapshotIndex</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#8f5902;font-style:italic># Resource version to deploy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>stagedRolloutStrategyName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-strategy  </span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># Strategy to execute</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p><strong>Namespace-scoped example:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>StagedUpdateRun</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app-rollout-v1-2-3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-app-namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-namespace-placement   </span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># Target ResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSnapshotIndex</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;5&#34;</span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#8f5902;font-style:italic># Resource version to deploy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>stagedRolloutStrategyName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app-rollout-strategy</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># Strategy to execute</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=updaterun-execution>UpdateRun Execution</h3><p>UpdateRuns execute in two phases:</p><ol><li><strong>Initialization</strong>: Captures strategy snapshot, collects target bindings, generates cluster update sequence</li><li><strong>Execution</strong>: Processes stages sequentially, updates clusters within each stage, enforces after-stage tasks</li></ol><h3 id=important-constraints-and-validation>Important Constraints and Validation</h3><p><strong>Immutable Fields</strong>: Once created, the following UpdateRun spec fields cannot be modified:</p><ul><li><code>placementName</code>: Target placement resource name</li><li><code>resourceSnapshotIndex</code>: Resource version to deploy</li><li><code>stagedRolloutStrategyName</code>: Strategy to execute</li></ul><p><strong>Strategy Limits</strong>: Each strategy can define a maximum of 31 stages to ensure reasonable execution times.</p><h2 id=monitor-updaterun-status>Monitor UpdateRun Status</h2><p>UpdateRun status provides detailed information about rollout progress across stages and clusters. The status includes:</p><ul><li><strong>Overall conditions</strong>: Initialization, progression, and completion status</li><li><strong>Stage status</strong>: Progress and timing for each stage</li><li><strong>Cluster status</strong>: Individual cluster update results</li><li><strong>After-stage task status</strong>: Approval and wait task progress</li></ul><p>Use <code>kubectl describe</code> to view detailed status:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Cluster-scoped (can use short name &#39;csur&#39;)</span>
</span></span><span style=display:flex><span>kubectl describe clusterstagedupdaterun example-run
</span></span><span style=display:flex><span>kubectl describe csur example-run
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Namespace-scoped (can use short name &#39;sur&#39;)</span>
</span></span><span style=display:flex><span>kubectl describe stagedupdaterun app-rollout-v1-2-3 -n my-app-namespace
</span></span><span style=display:flex><span>kubectl describe sur app-rollout-v1-2-3 -n my-app-namespace
</span></span></code></pre></div><h2 id=updaterun-and-placement-relationship>UpdateRun and Placement Relationship</h2><p>UpdateRuns and Placements work together to orchestrate rollouts, with each serving a distinct purpose:</p><h3 id=the-trigger-mechanism>The Trigger Mechanism</h3><p>UpdateRuns serve as the trigger that initiates rollouts for their respective placement resources:</p><ul><li><strong>Cluster-scoped</strong>: <code>ClusterStagedUpdateRun</code> triggers <code>ClusterResourcePlacement</code></li><li><strong>Namespace-scoped</strong>: <code>StagedUpdateRun</code> triggers <code>ResourcePlacement</code></li></ul><h3 id=before-an-updaterun-is-created>Before an UpdateRun is Created</h3><p>When you create a Placement with <code>strategy.type: External</code>, the system schedules which clusters should receive the resources, but <strong>does not deploy anything yet</strong>. The Placement remains in a scheduled but not available state, waiting for an UpdateRun to trigger the actual rollout.</p><h3 id=after-an-updaterun-is-created>After an UpdateRun is Created</h3><p>Once you create an UpdateRun, the system begins executing the staged rollout. Both resources provide status information, but at different levels of detail:</p><p><strong>UpdateRun Status</strong> - High-level rollout orchestration:</p><ul><li>Which stage is currently executing</li><li>Which clusters have started/completed updates</li><li>Whether after-stage tasks (approvals, waits) are complete</li><li>Overall rollout progression through stages</li></ul><p><strong>Placement Status</strong> - Detailed deployment information for each cluster:</p><ul><li>Success or failure of individual resource creation (e.g., did the Deployment create successfully?)</li><li>Whether overrides were applied correctly</li><li>Specific error messages if resources failed to deploy</li><li>Detailed conditions for troubleshooting</li></ul><p>This separation of concerns allows you to:</p><ol><li>Monitor high-level rollout progress and stage execution through the UpdateRun</li><li>Drill down into specific deployment issues on individual clusters through the Placement</li><li>Understand whether a problem is with the staged rollout orchestration or with resource deployment itself</li></ol><h2 id=concurrent-updateruns>Concurrent UpdateRuns</h2><p>Multiple UpdateRuns can execute concurrently for the same placement with one constraint: all concurrent runs must use identical strategy configurations to ensure consistent behavior.</p><h2 id=next-steps>Next Steps</h2><ul><li>Learn how to <a href=/docs/how-tos/staged-update/>rollout and rollback CRP resources with Staged Update Run</a></li><li>Learn how to <a href=docs/troubleshooting/ClusterStagedUpdateRun>troubleshoot a Staged Update Run</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-4289eaa321cf089fdf9ee9aab7a3ade8>1.11 - Eviction and Placement Disruption Budget</h1><div class=lead>Concept about Eviction and Placement Disrupiton Budget</div><p>This document explains the concept of <code>Eviction</code> and <code>Placement Disruption Budget</code> in the context of the fleet.</p><h2 id=overview>Overview</h2><p><code>Eviction</code> provides a way to force remove resources from a target cluster once the resources have already been propagated from the hub cluster by a <code>Placement</code> object.
<code>Eviction</code> is considered as an voluntary disruption triggered by the user. <code>Eviction</code> alone doesn&rsquo;t guarantee that resources won&rsquo;t be propagated to target cluster again by the scheduler.
The users need to use <a href=../howtos/taint-toleration.md>taints</a> in conjunction with <code>Eviction</code> to prevent the scheduler from picking the target cluster again.</p><p>The <code>Placement Disruption Budget</code> object protects against voluntary disruptions.</p><p>The only voluntary disruption that can occur in the fleet is the eviction of resources from a target cluster which can be achieved by creating the <code>ClusterResourcePlacementEviction</code> object.</p><p>Some cases of involuntary disruptions in the context of fleet,</p><ul><li>The removal of resources from a member cluster by the scheduler due to scheduling policy changes.</li><li>Users manually deleting workload resources running on a member cluster.</li><li>Users manually deleting the <code>ClusterResourceBinding</code> object which is an internal resource the represents the placement of resources on a member cluster.</li><li>Workloads failing to run properly on a member cluster due to misconfiguration or cluster related issues.</li></ul><p>For all the cases of involuntary disruptions described above, the <code>Placement Disruption Budget</code> object does not protect against them.</p><h2 id=clusterresourceplacementeviction>ClusterResourcePlacementEviction</h2><p>An eviction object is used to remove resources from a member cluster once the resources have already been propagated from the hub cluster.</p><p>The eviction object is only reconciled once after which it reaches a terminal state. Below is the list of terminal states for <code>ClusterResourcePlacementEviction</code>,</p><ul><li><code>ClusterResourcePlacementEviction</code> is valid and it&rsquo;s executed successfully.</li><li><code>ClusterResourcePlacementEviction</code> is invalid.</li><li><code>ClusterResourcePlacementEviction</code> is valid but it&rsquo;s not executed.</li></ul><p>To successfully evict resources from a cluster, the user needs to specify:</p><ul><li>The name of the <code>ClusterResourcePlacement</code> object which propagated resources to the target cluster.</li><li>The name of the target cluster from which we need to evict resources.</li></ul><p>When specifying the <code>ClusterResourcePlacement</code> object in the eviction&rsquo;s spec, the user needs to consider the following cases:</p><ul><li>For <code>PickFixed</code> CRP, eviction is not allowed; it is recommended that one directly edit the list of target clusters on the CRP object.</li><li>For <code>PickAll</code> & <code>PickN</code> CRPs, eviction is allowed because the users cannot deterministically pick or unpick a cluster based on the placement strategy; it&rsquo;s up to the scheduler.</li></ul><blockquote><p><strong>Note:</strong> After an eviction is executed, there is no guarantee that the cluster won&rsquo;t be picked again by the scheduler to propagate resources for a <code>ClusterResourcePlacement</code> resource.
The user needs to specify a <a href=../howtos/taint-toleration.md>taint</a> on the cluster to prevent the scheduler from picking the cluster again. This is especially true for <code>PickAll ClusterResourcePlacement</code> because
the scheduler will try to propagate resources to all the clusters in the fleet.</p></blockquote><h2 id=clusterresourceplacementdisruptionbudget>ClusterResourcePlacementDisruptionBudget</h2><p>The <code>ClusterResourcePlacementDisruptionBudget</code> is used to protect resources propagated by a <code>ClusterResourcePlacement</code> to a target cluster from voluntary disruption, i.e., <code>ClusterResourcePlacementEviction</code>.</p><blockquote><p><strong>Note:</strong> When specifying a <code>ClusterResourcePlacementDisruptionBudget</code>, the name should be the same as the <code>ClusterResourcePlacement</code> that it&rsquo;s trying to protect.</p></blockquote><p>Users are allowed to specify one of two fields in the <code>ClusterResourcePlacementDisruptionBudget</code> spec since they are mutually exclusive:</p><ul><li>MaxUnavailable - specifies the maximum number of clusters in which a placement can be unavailable due to any form of disruptions.</li><li>MinAvailable - specifies the minimum number of clusters in which placements are available despite any form of disruptions.</li></ul><p>for both <code>MaxUnavailable</code> and <code>MinAvailable</code>, the user can specify the number of clusters as an integer or as a percentage of the total number of clusters in the fleet.</p><blockquote><p><strong>Note:</strong> For both MaxUnavailable and MinAvailable, involuntary disruptions are not subject to the disruption budget but will still count against it.</p></blockquote><p>When specifying a disruption budget for a particular <code>ClusterResourcePlacement</code>, the user needs to consider the following cases:</p><table><thead><tr><th>CRP type</th><th><code>MinAvailable</code> DB with an integer</th><th><code>MinAvailable</code> DB with a percentage</th><th><code>MaxUnavailable</code> DB with an integer</th><th><code>MaxUnavailable</code> DB with a percentage</th></tr></thead><tbody><tr><td><code>PickFixed</code></td><td>âŒ</td><td>âŒ</td><td>âŒ</td><td>âŒ</td></tr><tr><td><code>PickAll</code></td><td>âœ…</td><td>âŒ</td><td>âŒ</td><td>âŒ</td></tr><tr><td><code>PickN</code></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr></tbody></table><blockquote><p><strong>Note:</strong> We don&rsquo;t allow eviction for <code>PickFixed</code> CRP and hence specifying a <code>ClusterResourcePlacementDisruptionBudget</code> for <code>PickFixed</code> CRP does nothing.
And for <code>PickAll</code> CRP, the user can only specify <code>MinAvailable</code> because total number of clusters selected by a <code>PickAll</code> CRP is non-deterministic.
If the user creates an invalid <code>ClusterResourcePlacementDisruptionBudget</code> object, when an eviction is created, the eviction won&rsquo;t be successfully executed.</p></blockquote></div><div class=td-content style=page-break-before:always><h1 id=pg-17b09a9dc5200475d8a306f18e63a0f9>2 - Getting Started</h1><div class=lead>Getting started with Fleet</div><div class="pageinfo pageinfo-primary"><p>Fleet documentation features a number of getting started tutorials to help you learn
about Fleet with an environment of your preference. Pick one below to proceed.</p><p>If you are not sure about which one is the best option, for simplicity reasons, it is
recommended that you start with the
<a href=/docs/getting-started/kind/>Getting started with Fleet using KinD clusters</a>.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-b2dc1a1b66163662e5965b95ed325462>2.1 - Getting started with Fleet using KinD clusters</h1><div class=lead>Use KinD clusters to learn about Fleet</div><p>In this tutorial, you will try Fleet out using
<a href=https://kind.sigs.k8s.io/>KinD</a> clusters, which are Kubernetes clusters running on your own
local machine via <a href=https://docker.com>Docker</a> containers. This is the easiest way
to get started with Fleet, which can help you understand how Fleet simiplify the day-to-day multi-cluster management experience with very little setup needed.</p><blockquote><p>Note</p><p>kind is a tool for setting up a Kubernetes environment for experimental purposes;
some instructions below for running Fleet in the kind environment may not apply to other
environments, and there might also be some minor differences in the Fleet
experience.</p></blockquote><h2 id=before-you-begin>Before you begin</h2><p>To complete this tutorial, you will need:</p><ul><li>The following tools on your local machine:<ul><li><code>kind</code>, for running Kubernetes clusters on your local machine</li><li>Docker</li><li><code>git</code></li><li><code>curl</code></li><li><code>helm</code>, the Kubernetes package manager</li><li><code>jq</code></li><li><code>base64</code></li></ul></li></ul><h2 id=spin-up-a-few-kind-clusters>Spin up a few kind clusters</h2><p>The Fleet open-source project manages a multi-cluster environment using a hub-spoke pattern,
which consists of one hub cluster and one or more member clusters:</p><ul><li>The hub cluster is the portal to which every member cluster connects; it also serves as an
interface for centralized management, through which you can perform a number of tasks,
primarily orchestrating workloads across different clusters.</li><li>A member cluster connects to the hub cluster and runs your workloads as orchestrated by the
hub cluster.</li></ul><p>In this tutorial you will create two kind clusters; one of which serves as the Fleet
hub cluster, and the other the Fleet member cluster. Run the commands below to create them:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace YOUR-KIND-IMAGE with a kind node image name of your</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># choice. It should match with the version of kind installed</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># on your system; for more information, see</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># [kind releases](https://github.com/kubernetes-sigs/kind/releases).</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>KIND_IMAGE</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-KIND-IMAGE
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace YOUR-KUBECONFIG-PATH with the path to a Kubernetes</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># configuration file of your own, typically $HOME/.kube/config.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>KUBECONFIG_PATH</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-KUBECONFIG-PATH
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># The names of the kind clusters; you may use values of your own if you&#39;d like to.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>HUB_CLUSTER</span><span style=color:#ce5c00;font-weight:700>=</span>hub
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>MEMBER_CLUSTER</span><span style=color:#ce5c00;font-weight:700>=</span>member-1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kind create cluster --name <span style=color:#000>$HUB_CLUSTER</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --image<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$KIND_IMAGE</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --kubeconfig<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$KUBECONFIG_PATH</span>
</span></span><span style=display:flex><span>kind create cluster --name <span style=color:#000>$MEMBER_CLUSTER</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --image<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$KIND_IMAGE</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --kubeconfig<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$KUBECONFIG_PATH</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Export the configurations for the kind clusters.</span>
</span></span><span style=display:flex><span>kind <span style=color:#204a87>export</span> kubeconfig -n <span style=color:#000>$HUB_CLUSTER</span>
</span></span><span style=display:flex><span>kind <span style=color:#204a87>export</span> kubeconfig -n <span style=color:#000>$MEMBER_CLUSTER</span>
</span></span></code></pre></div><h1 id=set-up-the-fleet-hub-cluster>Set up the Fleet hub cluster</h1><p>To set up the hub cluster, run the commands below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>HUB_CLUSTER_CONTEXT</span><span style=color:#ce5c00;font-weight:700>=</span>kind-<span style=color:#000>$HUB_CLUSTER</span>
</span></span><span style=display:flex><span>kubectl config use-context <span style=color:#000>$HUB_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># The variables below uses the Fleet images kept in the Microsoft Container</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Registry (MCR) and will retrieve the latest version from the Fleet GitHub</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># repository. This pulls from the Azure Fleet repository while the kubefleet</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># containers are being developed.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># You can also build the Fleet images of your own; see the repository README</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># for more information.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>REGISTRY</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;mcr.microsoft.com/aks/fleet&#34;</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>FLEET_VERSION</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>curl <span style=color:#4e9a06>&#34;https://api.github.com/repos/Azure/fleet/tags&#34;</span> <span style=color:#000;font-weight:700>|</span> jq -r <span style=color:#4e9a06>&#39;.[0].name&#39;</span><span style=color:#204a87;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>HUB_AGENT_IMAGE</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;hub-agent&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Clone the Fleet repository from GitHub.</span>
</span></span><span style=display:flex><span>git clone https://github.com/kubefleet-dev/kubefleet.git
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Install the helm chart for running Fleet agents on the hub cluster.</span>
</span></span><span style=display:flex><span>helm install hub-agent kubefleet/charts/hub-agent/ <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set image.pullPolicy<span style=color:#ce5c00;font-weight:700>=</span>Always <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set image.repository<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$REGISTRY</span>/<span style=color:#000>$HUB_AGENT_IMAGE</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set image.tag<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$FLEET_VERSION</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set <span style=color:#000>logVerbosity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>2</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set <span style=color:#000>namespace</span><span style=color:#ce5c00;font-weight:700>=</span>fleet-system <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set <span style=color:#000>enableWebhook</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set <span style=color:#000>webhookClientConnectionType</span><span style=color:#ce5c00;font-weight:700>=</span>service <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set <span style=color:#000>enableV1Alpha1APIs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set <span style=color:#000>enableV1Beta1APIs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
</span></span></code></pre></div><p>It may take a few seconds for the installation to complete. Once it finishes, verify that
the Fleet hub agents are up and running with the commands below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n fleet-system
</span></span></code></pre></div><p>You should see that all the pods are in the ready state.</p><h2 id=set-up-the-fleet-member-custer>Set up the Fleet member custer</h2><p>Next, you will set up the other kind cluster you created earlier as the Fleet
member cluster, which requires that you install the Fleet member agent on
the cluster and connect it to the Fleet hub cluster.</p><p>For your convenience, Fleet provides a script that can automate the process of joining a cluster
into a fleet. To use the script, follow the steps below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Query the API server address of the hub cluster.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>HUB_CLUSTER_ADDRESS</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://</span><span style=color:#204a87;font-weight:700>$(</span>docker inspect <span style=color:#000>$HUB_CLUSTER</span>-control-plane --format<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}&#39;</span><span style=color:#204a87;font-weight:700>)</span><span style=color:#4e9a06>:6443&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>MEMBER_CLUSTER_CONTEXT</span><span style=color:#ce5c00;font-weight:700>=</span>kind-<span style=color:#000>$MEMBER_CLUSTER</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Run the script.</span>
</span></span><span style=display:flex><span>chmod +x kubefleet/hack/membership/join.sh
</span></span><span style=display:flex><span>./kubefleet/hack/membership/join.sh
</span></span></code></pre></div><p>It may take a few minutes for the script to finish running. Once it is completed, verify
that the cluster has joined successfully with the command below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context <span style=color:#000>$HUB_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span>kubectl get membercluster <span style=color:#000>$MEMBER_CLUSTER</span>
</span></span></code></pre></div><p>The newly joined cluster should have the <code>JOINED</code> status field set to <code>True</code>. If you see that
the cluster is still in an unknown state, it might be that the member cluster
is still connecting to the hub cluster. Should this state persist for a prolonged
period, refer to the <a href=/docs/troubleshooting/>Troubleshooting Guide</a> for
more information.</p><blockquote><p>Note</p><p>If you would like to know more about the steps the script runs, or would like to join
a cluster into a fleet manually, refer to the <a href=/docs/how-tos/clusters/>Managing Clusters</a> How-To
Guide.</p></blockquote><h2 id=use-the-clusterresourceplacement-api-to-orchestrate-resources-among-member-clusters>Use the <code>ClusterResourcePlacement</code> API to orchestrate resources among member clusters.</h2><p>Fleet offers an API, <code>ClusterResourcePlacement</code>, which helps orchestrate workloads, i.e., any group
Kubernetes resources, among all member clusters. In this last part of the tutorial, you will use
this API to place some Kubernetes resources automatically into the member clusters via the hub
cluster, saving the trouble of having to create them one by one in each member cluster.</p><h3 id=create-the-resources-for-placement>Create the resources for placement</h3><p>Run the commands below to create a namespace and a config map, which will be placed onto the
member clusters.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl create namespace work
</span></span><span style=display:flex><span>kubectl create configmap app -n work --from-literal<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>test</span>
</span></span></code></pre></div><p>It may take a few seconds for the commands to complete.</p><h3 id=create-the-clusterresourceplacement-api-object>Create the <code>ClusterResourcePlacement</code> API object</h3><p>Next, create a <code>ClusterResourcePlacement</code> API object in the hub cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterResourcePlacement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: crp
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSelectors:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - group: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      kind: Namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      version: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      name: work
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  policy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    placementType: PickAll
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><p>Note that the CRP object features a resource selector, which targets the <code>work</code> namespace you
just created. This will instruct the CRP to place the namespace itself, and all resources
registered under the namespace, such as the config map, to the target clusters. Also, in the <code>policy</code>
field, a <code>PickAll</code> placement type has been specified. This allows the CRP to automatically perform
the placement on all member clusters in the fleet, including those that join after the CRP object
is created.</p><p>It may take a few seconds for Fleet to successfully place the resources. To check up on the
progress, run the commands below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get clusterresourceplacement crp
</span></span></code></pre></div><p>Verify that the placement has been completed successfully; you should see that the <code>APPLIED</code> status
field has been set to <code>True</code>. You may need to repeat the commands a few times to wait for
the completion.</p><h3 id=confirm-the-placement>Confirm the placement</h3><p>Now, log into the member clusters to confirm that the placement has been completed.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context <span style=color:#000>$MEMBER_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span>kubectl get ns
</span></span><span style=display:flex><span>kubectl get configmap -n work
</span></span></code></pre></div><p>You should see the namespace <code>work</code> and the config map <code>app</code> listed in the output.</p><h2 id=clean-things-up>Clean things up</h2><p>To remove all the resources you just created, run the commands below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># This would also remove the namespace and config map placed in all member clusters.</span>
</span></span><span style=display:flex><span>kubectl delete crp crp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl delete ns work
</span></span><span style=display:flex><span>kubectl delete configmap app -n work
</span></span></code></pre></div><p>To uninstall Fleet, run the commands below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context <span style=color:#000>$HUB_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span>helm uninstall hub-agent
</span></span><span style=display:flex><span>kubectl config use-context <span style=color:#000>$MEMBER_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span>helm uninstall member-agent
</span></span></code></pre></div><h2 id=whats-next>What&rsquo;s next</h2><p>Congratulations! You have completed the getting started tutorial for Fleet. To learn more about
Fleet:</p><ul><li><a href=/docs/concepts/>Read about Fleet concepts</a></li><li><a href=/docs/how-tos/crp/>Read about the ClusterResourcePlacement API</a></li><li><a href=/docs/api-reference/>Read the Fleet API reference</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-7d7f0216d2307a9e20af121afa63dd3e>2.2 - Getting started with Fleet using on-premises clusters</h1><div class=lead>Use on-premises clusters of your own to learn about Fleet</div><p>In this tutorial, you will try Fleet out using a few of your own Kubernetes clusters; Fleet can
help you manage workloads seamlessly across these clusters, greatly simplifying the experience
of day-to-day Kubernetes management.</p><blockquote><p>Note</p><p>This tutorial assumes that you have some experience of performing administrative tasks for
Kubernetes clusters. If you are just gettings started with Kubernetes, or do not have much
experience of setting up a Kubernetes cluster, it is recommended that you follow the
<a href=/docs/getting-started/kind/>Getting started with Fleet using Kind clusters</a> tutorial instead.</p></blockquote><h2 id=before-you-begin>Before you begin</h2><p>To complete this tutorial, you will need:</p><ul><li>At least two Kubernetes clusters of your own.<ul><li>Note that one of these clusters will serve as your hub cluster; other clusters must be able
to reach it via the network.</li></ul></li><li>The following tools on your local machine:<ul><li><code>docker</code>, to build kubefleet agent images.</li><li><code>kubectl</code>, the Kubernetes CLI tool.</li><li><code>git</code></li><li><code>curl</code></li><li><code>helm</code>, the Kubernetes package manager</li><li><code>jq</code></li><li><code>base64</code></li></ul></li></ul><h2 id=set-up-a-fleet-hub-cluster>Set up a Fleet hub cluster</h2><p>The Fleet open-source project manages a multi-cluster environment using a hub-spoke pattern,
which consists of one hub cluster and one or more member clusters:</p><ul><li>The hub cluster is the portal to which every member cluster connects; it also serves as an
interface for centralized management, through which you can perform a number of tasks,
primarily orchestrating workloads across different clusters.</li><li>A member cluster connects to the hub cluster and runs your workloads as orchestrated by the
hub cluster.</li></ul><p>Any Kubernetes cluster running a supported version of Kubernetes can serve as the hub cluster;
it is recommended that you reserve a cluster specifically for this responsibility, and do not run heavy workloads on it.</p><p>To set up the hub cluster, run the commands below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace YOUR-HUB-CLUSTER-CONTEXT with the name of the kubeconfig context for your hub cluster.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>HUB_CLUSTER_CONTEXT</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-HUB-CLUSTER-CONTEXT
</span></span><span style=display:flex><span>kubectl config use-context <span style=color:#000>$HUB_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Please replace the following env variables with the values of your own; see the repository README for</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># more information.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>REGISTRY</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;YOUR CONTAINER REGISTRY&#34;</span> <span style=color:#8f5902;font-style:italic># Replace with your own container registry</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>TARGET_ARCH</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;amd64&#34;</span> <span style=color:#8f5902;font-style:italic># Replace with your architecture, we support amd64 and arm64</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>TAG</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>curl <span style=color:#4e9a06>&#34;https://api.github.com/repos/kubefleet-dev/kubefleet/tags&#34;</span> <span style=color:#000;font-weight:700>|</span> jq -r <span style=color:#4e9a06>&#39;.[0].name&#39;</span><span style=color:#204a87;font-weight:700>)</span> <span style=color:#8f5902;font-style:italic># Replace with your desired tag</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Clone the KubeFleet repository from GitHub and navigate to the root directory of the repository.</span>
</span></span><span style=display:flex><span>git clone https://github.com/kubefleet-dev/kubefleet.git
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> kubefleet
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Build and push the hub agent image to your container registry. </span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>OUTPUT_TYPE</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;type=registry&#34;</span>
</span></span><span style=display:flex><span>make docker-build-hub-agent
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Install the helm chart for running Fleet agents on the hub cluster.</span>
</span></span><span style=display:flex><span>helm upgrade --install hub-agent ./charts/hub-agent/ <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>        --set image.pullPolicy<span style=color:#ce5c00;font-weight:700>=</span>Always <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>        --set image.repository<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$REGISTRY</span>/<span style=color:#000>$HUB_AGENT_IMAGE</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>        --set image.tag<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$TAG</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>        --set <span style=color:#000>namespace</span><span style=color:#ce5c00;font-weight:700>=</span>fleet-system <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>        --set <span style=color:#000>logVerbosity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>5</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>        --set <span style=color:#000>enableGuardRail</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>        --set <span style=color:#000>forceDeleteWaitTime</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;3m0s&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>        --set <span style=color:#000>clusterUnhealthyThreshold</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;5m0s&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>        --set <span style=color:#000>logFileMaxSize</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>100000</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>        --set <span style=color:#000>MaxConcurrentClusterPlacement</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>200</span> 
</span></span></code></pre></div><p>It may take a few seconds for the installation to complete. Once it finishes, verify that
the Fleet hub agents are up and running with the commands below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n fleet-system
</span></span></code></pre></div><p>You should see that all the pods are in the ready state.</p><h2 id=connect-a-member-cluster-to-the-hub-cluster>Connect a member cluster to the hub cluster</h2><p>Next, you will set up a cluster as the member cluster for your fleet. This cluster should
run a supported version of Kubernetes and be able to connect to the hub cluster via the network.</p><p>For your convenience, Fleet provides a script that can automate the process of joining a cluster
into a fleet. To use the script, follow the steps below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the value of MEMBER_CLUSTER with the name you would like to assign to the new member</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># cluster.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Note that Fleet will recognize your cluster with this name once it joins.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>MEMBER_CLUSTER</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-MEMBER-CLUSTER
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the value of MEMBER_CLUSTER_CONTEXT with the name of the kubeconfig context you use</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># for accessing your member cluster.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>MEMBER_CLUSTER_CONTEXT</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-MEMBER-CLUSTER-CONTEXT
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Build and push the member agent image to your container registry. </span>
</span></span><span style=display:flex><span>make docker-build-member-agent
</span></span><span style=display:flex><span>make docker-build-refresh-token
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Run the script.</span>
</span></span><span style=display:flex><span>chmod +x ./hack/membership/joinMC.sh
</span></span><span style=display:flex><span>./hack/membership/joinMC.sh  <span style=color:#000>$TAG</span> &lt;HUB-CLUSTER-NAME&gt; &lt;MEMBER-CLUSTER-NAME-1&gt; &lt;MEMBER-CLUSTER-NAME-2&gt; &lt;MEMBER-CLUSTER-CONTEXT-3&gt; ...
</span></span></code></pre></div><p>It may take a few minutes for the script to finish running. Once it is completed, the script will print out something
like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>NAME              JOINED   AGE   MEMBER-AGENT-LAST-SEEN   NODE-COUNT   AVAILABLE-CPU   AVAILABLE-MEMORY
</span></span><span style=display:flex><span>routing-cluster   True     30s   28s                      <span style=color:#0000cf;font-weight:700>2</span>            5748m           28780328Ki
</span></span></code></pre></div><p>The newly joined cluster should have the <code>JOINED</code> status field set to <code>True</code>. If you see that
the cluster is still in an unknown state, it might be that the member cluster
is still connecting to the hub cluster. Should this state persist for a prolonged
period, refer to the <a href=/docs/troubleshooting/>Troubleshooting Guide</a> for more information.</p><h2 id=use-the-clusterresourceplacement-api-to-orchestrate-resources-among-member-clusters>Use the <code>ClusterResourcePlacement</code> API to orchestrate resources among member clusters.</h2><p>Fleet offers an API, <code>ClusterResourcePlacement</code>, which helps orchestrate workloads, i.e., any group
Kubernetes resources, among all member clusters. In this last part of the tutorial, you will use
this API to place some Kubernetes resources automatically into the member clusters via the hub
cluster, saving the trouble of having to create them one by one in each member cluster.</p><h3 id=create-the-resources-for-placement>Create the resources for placement</h3><p>Run the commands below to create a namespace and a config map, which will be placed onto the
member clusters.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl create namespace work
</span></span><span style=display:flex><span>kubectl create configmap app -n work --from-literal<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>test</span>
</span></span></code></pre></div><p>It may take a few seconds for the commands to complete.</p><h3 id=create-the-clusterresourceplacement-api-object>Create the <code>ClusterResourcePlacement</code> API object</h3><p>Next, create a <code>ClusterResourcePlacement</code> API object in the hub cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterResourcePlacement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: crp
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSelectors:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - group: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      kind: Namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      version: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      name: work
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  policy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    placementType: PickAll
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><p>Note that the CRP object features a resource selector, which targets the <code>work</code> namespace you
just created. This will instruct the CRP to place the namespace itself, and all resources
registered under the namespace, such as the config map, to the target clusters. Also, in the <code>policy</code>
field, a <code>PickAll</code> placement type has been specified. This allows the CRP to automatically perform
the placement on all member clusters in the fleet, including those that join after the CRP object
is created.</p><p>It may take a few seconds for Fleet to successfully place the resources. To check up on the
progress, run the commands below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get clusterresourceplacement crp
</span></span></code></pre></div><p>Verify that the placement has been completed successfully; you should see that the <code>APPLIED</code> status
field has been set to <code>True</code>. You may need to repeat the commands a few times to wait for
the completion.</p><h3 id=confirm-the-placement>Confirm the placement</h3><p>Now, log into the member clusters to confirm that the placement has been completed.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context <span style=color:#000>$MEMBER_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span>kubectl get ns
</span></span><span style=display:flex><span>kubectl get configmap -n work
</span></span></code></pre></div><p>You should see the namespace <code>work</code> and the config map <code>app</code> listed in the output.</p><h2 id=clean-things-up>Clean things up</h2><p>To remove all the resources you just created, run the commands below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># This would also remove the namespace and config map placed in all member clusters.</span>
</span></span><span style=display:flex><span>kubectl delete crp crp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl delete ns work
</span></span><span style=display:flex><span>kubectl delete configmap app -n work
</span></span></code></pre></div><p>To uninstall Fleet, run the commands below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context <span style=color:#000>$HUB_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span>helm uninstall hub-agent
</span></span><span style=display:flex><span>kubectl config use-context <span style=color:#000>$MEMBER_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span>helm uninstall member-agent
</span></span></code></pre></div><h2 id=whats-next>What&rsquo;s next</h2><p>Congratulations! You have completed the getting started tutorial for Fleet. To learn more about
Fleet:</p><ul><li><a href=/docs/concepts/>Read about Fleet concepts</a></li><li><a href=/docs/how-tos/crp/>Read about the ClusterResourcePlacement API</a></li><li><a href=/docs/api-reference/>Read the Fleet API reference</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-8688845c6027fb5b07b8644ad7348d4a>3 - How-To Guides</h1><div class=lead>Guides for completing common Fleet tasks</div><div class="pageinfo pageinfo-primary"><p>Fleet documentation features a number of how-to guides to help you complete
common Fleet tasks. Pick one below to proceed.</p></div></div><div class=td-content><h1 id=pg-4072dca0095c74b9490cd7c99ea027d9>3.1 - Managing clusters</h1><div class=lead>How to join or remove a cluster from a fleet, and how to view the status of and label a member cluster</div><p>This how-to guide discusses how to manage clusters in a fleet, specifically:</p><ul><li>how to join a cluster into a fleet; and</li><li>how to set a cluster to leave a fleet; and</li><li>how to add labels to a member cluster</li></ul><h2 id=joining-a-cluster-into-a-fleet>Joining a cluster into a fleet</h2><p>A cluster can join in a fleet if:</p><ul><li>it runs a supported Kubernetes version; it is recommended that you use Kubernetes 1.24 or later
versions, and</li><li>it has network connectivity to the hub cluster of the fleet.</li></ul><p>For your convenience, Fleet provides a script that can automate the process of joining a cluster
into a fleet. To use the script, run the commands below:</p><blockquote><p>Note</p><p>To run this script, make sure that you have already installed the following tools in your
system:</p><ul><li><code>kubectl</code>, the Kubernetes CLI</li><li><code>helm</code>, a Kubernetes package manager</li><li><code>curl</code></li><li><code>jq</code></li><li><code>base64</code></li></ul></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the value of HUB_CLUSTER_CONTEXT with the name of the kubeconfig context you use for</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># accessing your hub cluster.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>HUB_CLUSTER_CONTEXT</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-HUB-CLUSTER-CONTEXT
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the value of HUB_CLUSTER_ADDRESS with the address of your hub cluster API server.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>HUB_CLUSTER_ADDRESS</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-HUB-CLUSTER-ADDRESS
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the value of MEMBER_CLUSTER with the name you would like to assign to the new member</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># cluster.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Note that Fleet will recognize your cluster with this name once it joins.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>MEMBER_CLUSTER</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-MEMBER-CLUSTER
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the value of MEMBER_CLUSTER_CONTEXT with the name of the kubeconfig context you use</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># for accessing your member cluster.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>MEMBER_CLUSTER_CONTEXT</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-MEMBER-CLUSTER-CONTEXT
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Clone the Fleet GitHub repository.</span>
</span></span><span style=display:flex><span>git clone https://github.com/kubefleet-dev/kubefleet.git
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Run the script.</span>
</span></span><span style=display:flex><span>chmod +x kubefleet/hack/membership/joinMC.sh
</span></span><span style=display:flex><span>./kubefleet/hack/membership/joinMC.sh
</span></span></code></pre></div><p>It may take a few minutes for the script to finish running. Once it is completed, verify
that the cluster has joined successfully with the command below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context <span style=color:#000>$HUB_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span>kubectl get membercluster <span style=color:#000>$MEMBER_CLUSTER</span>
</span></span></code></pre></div><p>If you see that the cluster is still in an unknown state, it might be that the member cluster
is still connecting to the hub cluster. Should this state persist for a prolonged
period, refer to the <a href=/docs/troubleshooting/>Troubleshooting Guide</a> for
more information.</p><p>Alternatively, if you would like to find out the exact steps the script performs, or if you feel
like fine-tuning some of the steps, you may join a cluster manually to your fleet with the
instructions below:</p><details><summary>Joining a member cluster manually</summary><ol><li><p>Make sure that you have installed <code>kubectl</code>, <code>helm</code>, <code>curl</code>, <code>jq</code>, and <code>base64</code> in your
system.</p></li><li><p>Create a Kubernetes service account in your hub cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the value of HUB_CLUSTER_CONTEXT with the name of the kubeconfig</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># context you use for accessing your hub cluster.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>HUB_CLUSTER_CONTEXT</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;YOUR-HUB-CLUSTER-CONTEXT&#34;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the value of MEMBER_CLUSTER with a name you would like to assign to the new</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># member cluster.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Note that the value of MEMBER_CLUSTER will be used as the name the member cluster registers</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># with the hub cluster.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>MEMBER_CLUSTER</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;YOUR-MEMBER-CLUSTER&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>SERVICE_ACCOUNT</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;</span><span style=color:#000>$MEMBER_CLUSTER</span><span style=color:#4e9a06>-hub-cluster-access&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl config use-context <span style=color:#000>$HUB_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># The service account can, in theory, be created in any namespace; for simplicity reasons,</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># here you will use the namespace reserved by Fleet installation, `fleet-system`.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Note that if you choose a different value, commands in some steps below need to be</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># modified accordingly.</span>
</span></span><span style=display:flex><span>kubectl create serviceaccount <span style=color:#000>$SERVICE_ACCOUNT</span> -n fleet-system
</span></span></code></pre></div></li><li><p>Create a Kubernetes secret of the service account token type, which the member cluster will
use to access the hub cluster.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>SERVICE_ACCOUNT_SECRET</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;</span><span style=color:#000>$MEMBER_CLUSTER</span><span style=color:#4e9a06>-hub-cluster-access-token&#34;</span>
</span></span><span style=display:flex><span>cat <span style=color:#4e9a06>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: Secret
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    name: $SERVICE_ACCOUNT_SECRET
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    namespace: fleet-system
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    annotations:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        kubernetes.io/service-account.name: $SERVICE_ACCOUNT
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>type: kubernetes.io/service-account-token
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><p>After the secret is created successfully, extract the token from the secret:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>TOKEN</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>kubectl get secret <span style=color:#000>$SERVICE_ACCOUNT_SECRET</span> -n fleet-system -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.data.token}&#39;</span> <span style=color:#000;font-weight:700>|</span> base64 -d<span style=color:#204a87;font-weight:700>)</span>
</span></span></code></pre></div><blockquote><p>Note</p><p>Keep the token in a secure place; anyone with access to this token can access the hub cluster
in the same way as the Fleet member cluster does.</p></blockquote><p>You may have noticed that at this moment, no access control has been set on the service
account; Fleet will set things up when the member cluster joins. The service account will be
given the minimally viable set of permissions for the Fleet member cluster to connect to the
hub cluster; its access will be restricted to one namespace, specifically reserved for the
member cluster, as per security best practices.</p></li><li><p>Register the member cluster with the hub cluster; Fleet manages cluster membership using the
<code>MemberCluster</code> API:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat <span style=color:#4e9a06>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: cluster.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: MemberCluster
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    name: $MEMBER_CLUSTER
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    identity:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        name: $SERVICE_ACCOUNT
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        kind: ServiceAccount
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        namespace: fleet-system
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        apiGroup: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    heartbeatPeriodSeconds: 60
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div></li><li><p>Set up the member agent, the Fleet component that works on the member cluster end, to enable
Fleet connection:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Clone the Fleet repository from GitHub.</span>
</span></span><span style=display:flex><span>git clone https://github.com/kubefleet-dev/kubefleet.git
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Install the member agent helm chart on the member cluster.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the value of MEMBER_CLUSTER_CONTEXT with the name of the kubeconfig context you use</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># for member cluster access.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>MEMBER_CLUSTER_CONTEXT</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;YOUR-MEMBER-CLUSTER-CONTEXT&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the value of HUB_CLUSTER_ADDRESS with the address of the hub cluster API server.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>HUB_CLUSTER_ADDRESS</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;YOUR-HUB-CLUSTER-ADDRESS&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># The variables below uses the Fleet images kept in the Microsoft Container</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Registry (MCR) and will retrieve the latest version from the Fleet GitHub</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># repository. This pulls from the Azure Fleet repository while the kubefleet</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># containers are being developed.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># You can also build the Fleet images of your own; see the repository README</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># for more information.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>REGISTRY</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;mcr.microsoft.com/aks/fleet&#34;</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>FLEET_VERSION</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>curl <span style=color:#4e9a06>&#34;https://api.github.com/repos/Azure/fleet/tags&#34;</span> <span style=color:#000;font-weight:700>|</span> jq -r <span style=color:#4e9a06>&#39;.[0].name&#39;</span><span style=color:#204a87;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>MEMBER_AGENT_IMAGE</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;member-agent&#34;</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>REFRESH_TOKEN_IMAGE</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;refresh-token&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl config use-context <span style=color:#000>$MEMBER_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Create the secret with the token extracted previously for member agent to use.</span>
</span></span><span style=display:flex><span>kubectl create secret generic hub-kubeconfig-secret --from-literal<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>token</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$TOKEN</span>
</span></span><span style=display:flex><span>helm install member-agent kubefleet/charts/member-agent/ <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set config.hubURL<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$HUB_CLUSTER_ADDRESS</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set image.repository<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$REGISTRY</span>/<span style=color:#000>$MEMBER_AGENT_IMAGE</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set image.tag<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$FLEET_VERSION</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set refreshtoken.repository<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$REGISTRY</span>/<span style=color:#000>$REFRESH_TOKEN_IMAGE</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set refreshtoken.tag<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$FLEET_VERSION</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set image.pullPolicy<span style=color:#ce5c00;font-weight:700>=</span>Always <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set refreshtoken.pullPolicy<span style=color:#ce5c00;font-weight:700>=</span>Always <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set config.memberClusterName<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;</span><span style=color:#000>$MEMBER_CLUSTER</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set <span style=color:#000>logVerbosity</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>5</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set <span style=color:#000>namespace</span><span style=color:#ce5c00;font-weight:700>=</span>fleet-system <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set <span style=color:#000>enableV1Alpha1APIs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set <span style=color:#000>enableV1Beta1APIs</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
</span></span></code></pre></div></li><li><p>Verify that the installation of the member agent is successful:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n fleet-system
</span></span></code></pre></div><p>You should see that all the returned pods are up and running. Note that it may take a few
minutes for the member agent to get ready.</p></li><li><p>Verify that the member cluster has joined the fleet successfully:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context <span style=color:#000>$HUB_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span>kubectl get membercluster <span style=color:#000>$MEMBER_CLUSTER</span>
</span></span></code></pre></div></li></ol></details><h2 id=setting-a-cluster-to-leave-a-fleet>Setting a cluster to leave a fleet</h2><p>Fleet uses the <code>MemberCluster</code> API to manage cluster memberships. To remove a member cluster
from a fleet, simply delete its corresponding <code>MemberCluster</code> object from your hub cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the value of MEMBER-CLUSTER with the name of the member cluster you would like to</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># remove from a fleet.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>MEMBER_CLUSTER</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-MEMBER-CLUSTER
</span></span><span style=display:flex><span>kubectl delete membercluster <span style=color:#000>$MEMBER_CLUSTER</span>
</span></span></code></pre></div><p>It may take a while before the member cluster leaves the fleet successfully. Fleet will perform
some cleanup; all the resources placed onto the cluster will be removed.</p><p>After the member cluster leaves, you can remove the member agent installation from it using Helm:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the value of MEMBER_CLUSTER_CONTEXT with the name of the kubeconfig context you use</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># for member cluster access.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>MEMBER_CLUSTER_CONTEXT</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-MEMBER-CLUSTER-CONTEXT
</span></span><span style=display:flex><span>kubectl config use-context <span style=color:#000>$MEMBER_CLUSTER_CONTEXT</span>
</span></span><span style=display:flex><span>helm uninstall member-agent
</span></span></code></pre></div><p>It may take a few moments before the uninstallation completes.</p><h2 id=viewing-the-status-of-a-member-cluster>Viewing the status of a member cluster</h2><p>Similarly, you can use the <code>MemberCluster</code> API in the hub cluster to view the status of a
member cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the value of MEMBER-CLUSTER with the name of the member cluster of which you would like</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># to view the status.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>MEMBER_CLUSTER</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-MEMBER-CLUSTER
</span></span><span style=display:flex><span>kubectl get membercluster <span style=color:#000>$MEMBER_CLUSTER</span> -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;{.status}&#34;</span>
</span></span></code></pre></div><p>The status consists of:</p><ul><li><p>an array of conditions, including:</p><ul><li>the <code>ReadyToJoin</code> condition, which signals whether the hub cluster is ready to accept
the member cluster; and</li><li>the <code>Joined</code> condition, which signals whether the cluster has joined the fleet; and</li><li>the <code>Healthy</code> condition, which signals whether the cluster is in a healthy state.</li></ul><p>Typically, a member cluster should have all three conditions set to true. Refer to the
<a href=/docs/troubleshooting/>Troubleshooting Guide</a> for help if a cluster fails to join
into a fleet.</p></li><li><p>the resource usage of the cluster; at this moment Fleet reports the capacity and
the allocatable amount of each resource in the cluster, summed up from all nodes in the cluster.</p></li><li><p>an array of agent status, which reports the status of specific Fleet agents installed in
the cluster; each entry features:</p><ul><li>an array of conditions, in which <code>Joined</code> signals whether the specific agent has been
successfully installed in the cluster, and <code>Healthy</code> signals whether the agent is in a
healthy state; and</li><li>the timestamp of the last received heartbeat from the agent.</li></ul></li></ul><h2 id=adding-labels-to-a-member-cluster>Adding labels to a member cluster</h2><p>You can add labels to a <code>MemberCluster</code> object in the same as with any other Kubernetes object.
These labels can then be used for targeting specific clusters in resource placement. To add a label,
run the command below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace the values of MEMBER_CLUSTER, LABEL_KEY, and LABEL_VALUE with those of your own.</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>MEMBER_CLUSTER</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-MEMBER-CLUSTER
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>LABEL_KEY</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-LABEL-KEY
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>LABEL_VALUE</span><span style=color:#ce5c00;font-weight:700>=</span>YOUR-LABEL-VALUE
</span></span><span style=display:flex><span>kubectl label membercluster <span style=color:#000>$MEMBER_CLUSTER</span> <span style=color:#000>$LABEL_KEY</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>$LABEL_VALUE</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-7461dbc76e53ff75d54dd11074048123>3.2 - Using the ClusterResourcePlacement API</h1><div class=lead>How to use the <code>ClusterResourcePlacement</code> API</div><p>This guide provides an overview of how to use the Fleet <code>ClusterResourcePlacement</code> (CRP) API to orchestrate workload distribution across your fleet.</p><h2 id=overview>Overview</h2><p>The CRP API is a core Fleet API that facilitates the distribution of specific resources from the hub cluster to
member clusters within a fleet. This API offers scheduling capabilities that allow you to target the most suitable
group of clusters for a set of resources using a complex rule set. For example, you can distribute resources to
clusters in specific regions (North America, East Asia, Europe, etc.) and/or release stages (production, canary, etc.).
You can even distribute resources according to certain topology spread constraints.</p><h2 id=api-components>API Components</h2><p>The CRP API generally consists of the following components:</p><ul><li><strong>Resource Selectors</strong>: These specify the set of resources selected for placement.</li><li><strong>Scheduling Policy</strong>: This determines the set of clusters where the resources will be placed.</li><li><strong>Rollout Strategy</strong>: This controls the behavior of resource placement when the resources themselves and/or the
scheduling policy are updated, minimizing interruptions caused by refreshes.</li><li><strong>StatusReportingScope</strong>: This controls where ClusterResourcePlacement status information is made available.</li></ul><p>The following sections discuss these components in depth.</p><h2 id=resource-selectors>Resource selectors</h2><p>A <code>ClusterResourcePlacement</code> object may feature one or more resource selectors,
specifying which resources to select for placement. To add a resource selector, edit
the <code>resourceSelectors</code> field in the <code>ClusterResourcePlacement</code> spec:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;rbac.authorization.k8s.io&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterRole</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1          </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>secretReader</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The example above will pick a <code>ClusterRole</code> named <code>secretReader</code> for resource placement.</p><p>It is important to note that, as its name implies, <code>ClusterResourcePlacement</code> <strong>selects only
cluster-scoped resources</strong>. However, if you select a namespace, all the resources under the
namespace will also be placed.</p><h3 id=different-types-of-resource-selectors>Different types of resource selectors</h3><p>You can specify a resource selector in many different ways:</p><ul><li><p>To select <strong>one specific resource</strong>, such as a namespace, specify its API GVK (group, version, and
kind), and its name, in the resource selector:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># As mentioned earlier, all the resources under the namespace will also be selected.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1          </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>work</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div></li><li><p>Alternately, you may also select a set of resources of the same API GVK using a label selector;
it also requires that you specify the API GVK and the filtering label(s):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># As mentioned earlier, all the resources under the namespaces will also be selected.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1          </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>system</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>critical</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>In the example above, all the namespaces in the hub cluster with the label <code>system=critical</code>
will be selected (along with the resources under them).</p><p>Fleet uses standard Kubernetes label selectors; for its specification and usage, see the
<a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#labelselector-v1-meta>Kubernetes API reference</a>.</p></li><li><p>Very occasionally, you may need to select all the resources under a specific GVK; to achieve
this, use a resource selector with only the API GVK added:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;rbac.authorization.k8s.io&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterRole</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1          </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>In the example above, all the cluster roles in the hub cluster will be picked.</p></li></ul><h3 id=multiple-resource-selectors>Multiple resource selectors</h3><p>You may specify up to 100 different resource selectors; Fleet will pick a resource if it matches
any of the resource selectors specified (i.e., all selectors are OR&rsquo;d).</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># As mentioned earlier, all the resources under the namespace will also be selected.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1          </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>work</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;rbac.authorization.k8s.io&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterRole</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>secretReader      </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>In the example above, Fleet will pick the namespace <code>work</code> (along with all the resources
under it) and the cluster role <code>secretReader</code>.</p><blockquote><p>Note</p><p>You can find the GVKs of built-in Kubernetes API objects in the
<a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/>Kubernetes API reference</a>.</p></blockquote><h2 id=scheduling-policy>Scheduling policy</h2><p>Each scheduling policy is associated with a placement type, which determines how Fleet will
pick clusters. The <code>ClusterResourcePlacement</code> API supports the following placement types:</p><table><thead><tr><th>Placement type</th><th>Description</th></tr></thead><tbody><tr><td><code>PickFixed</code></td><td>Pick a specific set of clusters by their names.</td></tr><tr><td><code>PickAll</code></td><td>Pick all the clusters in the fleet, per some standard.</td></tr><tr><td><code>PickN</code></td><td>Pick a count of N clusters in the fleet, per some standard.</td></tr></tbody></table><blockquote><p>Note</p><p>Scheduling policy itself is optional. If you do not specify a scheduling policy,
Fleet will assume that you would like to use
a scheduling of the <code>PickAll</code> placement type; it effectively sets Fleet to pick
all the clusters in the fleet.</p></blockquote><p>Fleet does not support switching between different placement types; if you need to do
so, re-create a new <code>ClusterResourcePlacement</code> object.</p><h3 id=pickfixed-placement-type><code>PickFixed</code> placement type</h3><p><code>PickFixed</code> is the most straightforward placement type, through which you directly tell Fleet
which clusters to place resources at. To use this placement type, specify the target cluster
names in the <code>clusterNames</code> field, such as</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickFixed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusterNames</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> 
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#000>bravelion</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#000>smartfish </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The example above will place resources to two clusters, <code>bravelion</code> and <code>smartfish</code>.</p><h3 id=pickall-placement-type><code>PickAll</code> placement type</h3><p><code>PickAll</code> placement type allows you to pick all clusters in the fleet per some standard. With
this placement type, you may use affinity terms to fine-tune which clusters you would like
for Fleet to pick:</p><ul><li><p>An affinity term specifies a requirement that a cluster needs to meet, usually the presence
of a label.</p><p>There are two types of affinity terms:</p><ul><li><code>requiredDuringSchedulingIgnoredDuringExecution</code> terms are requirements that a cluster
must meet before it can be picked; and</li><li><code>preferredDuringSchedulingIgnoredDuringExecution</code> terms are requirements that, if a
cluster meets, will set Fleet to prioritize it in scheduling.</li></ul><p>In the scheduling policy of the <code>PickAll</code> placement type, you may only use the
<code>requiredDuringSchedulingIgnoredDuringExecution</code> terms.</p></li></ul><blockquote><p>Note</p><p>You can learn more about affinities in <a href=/docs/how-tos/affinities/>Using Affinities to Pick Clusters</a> How-To
Guide.</p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                            </span><span style=color:#204a87;font-weight:700>system</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>critical</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <code>ClusterResourcePlacement</code> object above will pick all the clusters with the label
<code>system:critical</code> on them; clusters without the label will be ignored.</p><p>Fleet is forward-looking with the <code>PickAll</code> placement type: any cluster that satisfies the
affinity terms of a <code>ClusterResourcePlacement</code> object, even if it joins after the
<code>ClusterResourcePlacement</code> object is created, will be picked.</p><blockquote><p>Note</p><p>You may specify a scheduling policy of the <code>PickAll</code> placement with no affinity; this will set
Fleet to select all clusters currently present in the fleet.</p></blockquote><h3 id=pickn-placement-type><code>PickN</code> placement type</h3><p><code>PickN</code> placement type allows you to pick a specific number of clusters in the fleet for resource
placement; with this placement type, you may use affinity terms and topology spread constraints
to fine-tune which clusters you would like Fleet to pick.</p><ul><li><p>An affinity term specifies a requirement that a cluster needs to meet, usually the presence
of a label.</p><p>There are two types of affinity terms:</p><ul><li><code>requiredDuringSchedulingIgnoredDuringExecution</code> terms are requirements that a cluster
must meet before it can be picked; and</li><li><code>preferredDuringSchedulingIgnoredDuringExecution</code> terms are requirements that, if a
cluster meets, will set Fleet to prioritize it in scheduling.</li></ul></li><li><p>A topology spread constraint can help you spread resources evenly across different groups
of clusters. For example, you may want to have a database replica deployed in each region
to enable high-availability.</p></li></ul><blockquote><p>Note</p><p>You can learn more about affinities in <a href=/docs/how-tos/affinities/>Using Affinities to Pick Clusters</a>
How-To Guide, and more about topology spread constraints in
<a href=/docs/how-tos/topology-spread-constraints/>Using Topology Spread Constraints to Pick Clusters</a> How-To Guide.</p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>preferredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span>- <span style=color:#204a87;font-weight:700>weight</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>preference</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                            </span><span style=color:#204a87;font-weight:700>critical-level</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <code>ClusterResourcePlacement</code> object above will pick first clusters with the <code>critical-level=1</code>
on it; if only there are not enough (less than 3) such clusters, will Fleet pick clusters with no
such label.</p><p>To be more precise, with this placement type, Fleet scores clusters on how well it satisfies the
affinity terms and the topology spread constraints; Fleet will assign:</p><ul><li>an affinity score, for how well the cluster satisfies the affinity terms; and</li><li>a topology spread score, for how well the cluster satisfies the topology spread constraints.</li></ul><blockquote><p>Note</p><p>For more information on the scoring specifics, see
<a href=/docs/how-tos/affinities/>Using Affinities to Pick Clusters</a> How-To Guide (for affinity score) and
<a href=/docs/how-tos/topology-spread-constraints/>Using Topology Spread Constraints to Pick Clusters</a> How-To
Guide (for topology spread score).</p></blockquote><p>After scoring, Fleet ranks the clusters using the rule below and picks the top N clusters:</p><ul><li><p>the cluster with the highest topology spread score ranks the highest;</p></li><li><p>if there are multiple clusters with the same topology spread score, the one with the highest
affinity score ranks the highest;</p></li><li><p>if there are multiple clusters with same topology spread score and affinity score, sort their
names by alphanumeric order; the one with the most significant name ranks the highest.</p><p>This helps establish deterministic scheduling behavior.</p></li></ul><p>Both affinity terms and topology spread constraints are optional. If you do not specify
affinity terms or topology spread constraints, all clusters will be assigned 0 in
affinity score or topology spread score respectively. When neither is added in the scheduling
policy, Fleet will simply rank clusters by their names, and pick N out of them, with
most significant names in alphanumeric order.</p><h4 id=when-there-are-not-enough-clusters-to-pick>When there are not enough clusters to pick</h4><p>It may happen that Fleet cannot find enough clusters to pick. In this situation, Fleet will
keep looking until all N clusters are found.</p><p>Note that Fleet will stop looking once all N clusters are found, even if there appears a
cluster that scores higher.</p><h4 id=up-scaling-and-downscaling>Up-scaling and downscaling</h4><p>You can edit the <code>numberOfClusters</code> field in the scheduling policy to pick more or less clusters.
When up-scaling, Fleet will score all the clusters that have not been picked earlier, and find
the most appropriate ones; for downscaling, Fleet will unpick the clusters that ranks lower
first.</p><blockquote><p>Note</p><p>For downscaling, the ranking Fleet uses for unpicking clusters is composed when the scheduling
is performed, i.e., it may not reflect the latest setup in the Fleet.</p></blockquote><h3 id=a-few-more-points-about-scheduling-policies>A few more points about scheduling policies</h3><h4 id=responding-to-changes-in-the-fleet>Responding to changes in the fleet</h4><p>Generally speaking, once a cluster is picked by Fleet for a <code>ClusterResourcePlacement</code> object,
it will not be unpicked even if you modify the cluster in a way that renders it unfit for
the scheduling policy, e.g., you have removed a label for the cluster, which is required for
some affinity term. Fleet will also not remove resources from the cluster even if the cluster
becomes unhealthy, e.g., it gets disconnected from the hub cluster. This helps reduce service
interruption.</p><p>However, Fleet will unpick a cluster if it leaves the fleet. If you are using a scheduling
policy of the <code>PickN</code> placement type, Fleet will attempt to find a new cluster as replacement.</p><h4 id=finding-the-scheduling-decisions-fleet-makes>Finding the scheduling decisions Fleet makes</h4><p>You can find out why Fleet picks a cluster in the status of a <code>ClusterResourcePlacement</code> object.
For more information, see the
<a href=crp-status>Understanding the Status of a <code>ClusterResourcePlacement</code></a> How-To Guide.</p><h4 id=available-fields-for-each-placement-type>Available fields for each placement type</h4><p>The table below summarizes the available scheduling policy fields for each placement type:</p><table><thead><tr><th></th><th><code>PickFixed</code></th><th><code>PickAll</code></th><th><code>PickN</code></th></tr></thead><tbody><tr><td><code>placementType</code></td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td><code>numberOfClusters</code></td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr><tr><td><code>clusterNames</code></td><td>âœ…</td><td>âŒ</td><td>âŒ</td></tr><tr><td><code>affinity</code></td><td>âŒ</td><td>âœ…</td><td>âœ…</td></tr><tr><td><code>topologySpreadConstraints</code></td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr></tbody></table><h2 id=rollout-strategy>Rollout strategy</h2><p>After a <code>ClusterResourcePlacement</code> is created, you may want to</p><ul><li>Add, update, or remove the resources that have been selected by the
<code>ClusterResourcePlacement</code> in the hub cluster</li><li>Update the resource selectors in the <code>ClusterResourcePlacement</code></li><li>Update the scheduling policy in the <code>ClusterResourcePlacement</code></li></ul><p>These changes may trigger the following outcomes:</p><ul><li>New resources may need to be placed on all picked clusters</li><li>Resources already placed on a picked cluster may get updated or deleted</li><li>Some clusters picked previously are now unpicked, and resources must be removed from such clusters</li><li>Some clusters are newly picked, and resources must be added to them</li></ul><p>Most outcomes can lead to service interruptions. Apps running on member clusters may temporarily become
unavailable as Fleet dispatches updated resources. Clusters that are no longer selected will lose all placed resources,
resulting in lost traffic. If too many new clusters are selected and Fleet places resources on them simultaneously,
your backend may become overloaded. The exact interruption pattern may vary depending on the resources you place using Fleet.</p><p>To minimize interruption, Fleet allows users to configure the rollout strategy, similar to native Kubernetes deployment,
to transition between changes as smoothly as possible. Currently, Fleet supports only one rollout strategy: rolling update.
This strategy ensures changes, including the addition or removal of selected clusters and resource refreshes,
are applied incrementally in a phased manner at a pace suitable for you. This is the default option and applies to all changes you initiate.</p><p>This rollout strategy can be configured with the following parameters:</p><ul><li><p><code>maxUnavailable</code> determines how many clusters may become unavailable during a change for the selected set of resources.
It can be set as an absolute number or a percentage. The default is 25%, and zero should not be used for this value.</p><ul><li><p>Setting this parameter to a lower value will result in less interruption during a change but will lead to slower rollouts.</p></li><li><p>Fleet considers a cluster as unavailable if resources have not been successfully applied to the cluster.</p></li><li><details><summary>How Fleet interprets this value</summary>Fleet, in actuality, makes sure that at any time, there are **at least** N - `maxUnavailable`
number of clusters available, where N is:<ul><li>for scheduling policies of the <code>PickN</code> placement type, the <code>numberOfClusters</code> value given;</li><li>for scheduling policies of the <code>PickFixed</code> placement type, the number of cluster names given;</li><li>for scheduling policies of the <code>PickAll</code> placement type, the number of clusters Fleet picks.</li></ul><p>If you use a percentage for the <code>maxUnavailable</code> parameter, it is calculated against N as
well.</p></details></li></ul></li><li><p><code>maxSurge</code> determines the number of additional clusters, beyond the required number, that will receive resource placements.
It can also be set as an absolute number or a percentage. The default is 25%, and zero should not be used for this value.</p><ul><li><p>Setting this parameter to a lower value will result in fewer resource placements on additional
clusters by Fleet, which may slow down the rollout process.</p></li><li><details><summary>How Fleet interprets this value</summary>Fleet, in actuality, makes sure that at any time, there are **at most** N + `maxSurge`
number of clusters available, where N is:<ul><li>for scheduling policies of the <code>PickN</code> placement type, the <code>numberOfClusters</code> value given;</li><li>for scheduling policies of the <code>PickFixed</code> placement type, the number of cluster names given;</li><li>for scheduling policies of the <code>PickAll</code> placement type, the number of clusters Fleet picks.</li></ul><p>If you use a percentage for the <code>maxUnavailable</code> parameter, it is calculated against N as well.</p></details></li></ul></li><li><p><code>unavailablePeriodSeconds</code> allows users to inform the fleet when the resources are deemed &ldquo;ready&rdquo;.
The default value is 60 seconds.</p><ul><li>Fleet only considers newly applied resources on a cluster as &ldquo;ready&rdquo; once <code>unavailablePeriodSeconds</code> seconds
have passed <strong>after</strong> the resources have been <strong>successfully</strong> applied to that cluster.</li><li>Setting a lower value for this parameter will result in faster rollouts. However, we <strong>strongly</strong>
recommend that users set it to a value that all the initialization/preparation tasks can be completed within
that time frame. This ensures that the resources are typically ready after the <code>unavailablePeriodSeconds</code> have passed.</li><li>We are currently designing a generic &ldquo;ready gate&rdquo; for resources being applied to clusters. Please feel free to raise
issues or provide feedback if you have any thoughts on this.</li></ul></li></ul><blockquote><p>Note</p><p>Fleet will round numbers up if you use a percentage for <code>maxUnavailable</code> and/or <code>maxSurge</code>.</p></blockquote><p>For example, if you have a <code>ClusterResourcePlacement</code> with a scheduling policy of the <code>PickN</code>
placement type and a target number of clusters of 10, with the default rollout strategy, as
shown in the example below,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>rollingUpdate</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxUnavailable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxSurge</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>unavailablePeriodSeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>60</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Every time you initiate a change on selected resources, Fleet will:</p><ul><li>Find <code>10 * 25% = 2.5, rounded up to 3</code> clusters, which will receive the resource refresh;</li><li>Wait for 60 seconds (<code>unavailablePeriodSeconds</code>), and repeat the process;</li><li>Stop when all the clusters have received the latest version of resources.</li></ul><p>The exact period of time it takes for Fleet to complete a rollout depends not only on the
<code>unavailablePeriodSeconds</code>, but also the actual condition of a resource placement; that is,
if it takes longer for a cluster to get the resources applied successfully, Fleet will wait
longer to complete the rollout, in accordance with the rolling update strategy you specified.</p><blockquote><p>Note</p><p>In very extreme circumstances, rollout may get stuck, if Fleet just cannot apply resources
to some clusters. You can identify this behavior if CRP status; for more information, see
<a href=crp-status>Understanding the Status of a <code>ClusterResourcePlacement</code></a> How-To Guide.</p></blockquote><h2 id=statusreportingscope>StatusReportingScope</h2><p>The two supported values for <code>StatusReportingScope</code> are:</p><ul><li><strong>ClusterScopeOnly</strong>: Default behavior, placement status is part of the <code>ClusterResourcePlacement</code> object.</li><li><strong>NamespaceAccessible</strong>: A <code>ClusterResourcePlacementStatus</code> object is created in the namespace selected by the <code>ClusterResourcePlacement</code>.</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>statusReportingScope</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NamespaceAccessible</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Lets take a look at the <code>ClusterResourcePlacment</code> object&rsquo;s status,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>% kubectl get clusterresourceplacements.v1beta1.placement.kubernetes-fleet.io test-crp -o yaml</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all cluster needed as specified by the scheduling policy, found</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully created or updated ClusterResourcePlacementStatus in namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#4e9a06>&#39;test-ns&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>StatusSyncSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementStatusSynced</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># Only present for NamespaceAccessible CRPs to indicate corresponding ClusterResourcePlacementStatus is created/updated successfully.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All 3 cluster(s) start rolling out the latest resource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementRolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementOverridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Works(s) are succcesfully created or updated in 3 target cluster(s)&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>namespaces</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementWorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources are successfully applied to 3 cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources in 3 cluster(s) are available now</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ConfigMap</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-cm</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Let&rsquo;s take a look at the corresponding <code>ClusterResourcePlacementStatus</code> object created in <code>test-ns</code> namespace selected by our NamespaceAccessible <code>ClusterResourcePlacement</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>% kubectl get clusterresourceplacementstatus.v1beta1.placement.kubernetes-fleet.io test-crp -n test-ns -o yaml</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementStatus</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>lastUpdatedTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>creationTimestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>11</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>ownerReferences</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>blockOwnerDeletion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>controller</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>7877ff66-74db-4f13-b84a-91e43da5d06e</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1837&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>df6adcc3-54a3-41d8-b954-a72992a4e35f</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>sourceStatus</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all cluster needed as specified by the scheduling policy, found</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All 3 cluster(s) start rolling out the latest resource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementRolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementOverridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Works(s) are succcesfully created or updated in 3 target cluster(s)&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>namespaces</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementWorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources are successfully applied to 3 cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources in 3 cluster(s) are available now</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ConfigMap</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-cm</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><blockquote><p>Note: From the output above we can see that the <code>ClusterResourcePlacementSyncedCondition</code> condition is not part of the copied status from the <code>ClusterResourcePlacement</code>.</p></blockquote><p>This allows users with only namespace-level access to view the status of the cluster-scoped <code>ClusterResourcePlacement</code> object within the target namespace.</p><h2 id=snapshots-and-revisions>Snapshots and revisions</h2><p>Internally, Fleet keeps a history of all the scheduling policies you have used with a
<code>ClusterResourcePlacement</code>, and all the resource versions (snapshots) the
<code>ClusterResourcePlacement</code> has selected. These are kept as <code>ClusterSchedulingPolicySnapshot</code>
and <code>ClusterResourceSnapshot</code> objects respectively.</p><p>You can list and view such objects for reference, but you should not modify their contents
(in a typical setup, such requests will be rejected automatically). To control the length
of the history (i.e., how many snapshot objects Fleet will keep for a <code>ClusterResourcePlacement</code>),
configure the <code>revisionHistoryLimit</code> field:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>revisionHistoryLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The default value is 10.</p><blockquote><p>Note</p><p>In this early stage, the history is kept for reference purposes only; in the future, Fleet
may add features to allow rolling back to a specific scheduling policy and/or resource version.</p></blockquote></div><div class=td-content style=page-break-before:always><h1 id=pg-955aa307885ef70e7d59d95b7fd1779d>3.3 - Using the ResourcePlacement API</h1><div class=lead>How to use the <code>ResourcePlacement</code> API</div><p>This guide provides an overview of how to use the KubeFleet <code>ResourcePlacement</code> (RP) API to orchestrate workload distribution across your fleet.</p><blockquote><p>NOTE: The <code>ResourcePlacement</code> is a namespace-scoped CR.</p></blockquote><h2 id=overview>Overview</h2><p>The RP API is a core KubeFleet API that facilitates the distribution of specific resources from the hub cluster to
member clusters within a fleet. This API offers scheduling capabilities that allow you to target the most suitable
group of clusters for a set of resources using a complex rule set. For example, you can distribute resources to
clusters in specific regions (North America, East Asia, Europe, etc.) and/or release stages (production, canary, etc.).
You can even distribute resources according to certain topology spread constraints.</p><h2 id=api-components>API Components</h2><p>The RP API generally consists of the following components:</p><ul><li><strong>Resource Selectors</strong>: These specify the set of resources selected for placement.</li><li><strong>Scheduling Policy</strong>: This determines the set of clusters where the resources will be placed.</li><li><strong>Rollout Strategy</strong>: This controls the behavior of resource placement when the resources themselves and/or the
scheduling policy are updated, minimizing interruptions caused by refreshes.</li></ul><p>The following sections discuss these components in depth.</p><h2 id=resource-selectors>Resource selectors</h2><p>A <code>ResourcePlacement</code> object may feature one or more resource selectors,
specifying which resources to select for placement. To add a resource selector, edit
the <code>resourceSelectors</code> field in the <code>ResourcePlacement</code> spec:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;rbac.authorization.k8s.io&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Role</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1          </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>secretReader</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The example above will pick a <code>Role</code> named <code>secretReader</code> for resource placement.</p><p>It is important to note that, as its name implies, <code>ResourcePlacement</code> <strong>selects only
namespace-scoped resources</strong>. It only places the resources selected within the namespaces
where the <code>ResourcePlacement</code> object itself resides.</p><h3 id=different-types-of-resource-selectors>Different types of resource selectors</h3><p>You can specify a resource selector in many different ways:</p><ul><li><p>To select <strong>one specific resource</strong>, such as a deployment, specify its API GVK (group, version, and
kind), and its name, in the resource selector:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># As mentioned earlier, the resource selector will only pick resources under the same namespace as the RP object.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1          </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>work</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div></li><li><p>Alternately, you may also select a set of resources of the same API GVK using a label selector;
it also requires that you specify the API GVK and the filtering label(s):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># As mentioned earlier, the resource selector will only pick resources under the same namespace as the RP object.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1           </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>system</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>critical</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>In the example above, all the deployments in namespace <code>test-ns</code> with the label <code>system=critical</code> in the hub cluster
will be selected.</p><p>Fleet uses standard Kubernetes label selectors; for its specification and usage, see the
<a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#labelselector-v1-meta>Kubernetes API reference</a>.</p></li><li><p>Very occasionally, you may need to select all the resources under a specific GVK; to achieve
this, use a resource selector with only the API GVK added:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1          </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>In the example above, all the deployments in <code>test-ns</code> in the hub cluster will be picked.</p></li></ul><h3 id=multiple-resource-selectors>Multiple resource selectors</h3><p>You may specify up to 100 different resource selectors; Fleet will pick a resource if it matches
any of the resource selectors specified (i.e., all selectors are OR&rsquo;d).</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1          </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>work</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;rbac.authorization.k8s.io&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Role</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>secretReader      </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>In the example above, Fleet will pick the deployment <code>work</code> and the role <code>secretReader</code> in the namespace <code>test-ns</code>.</p><blockquote><p>Note</p><p>You can find the GVKs of built-in Kubernetes API objects in the
<a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/>Kubernetes API reference</a>.</p></blockquote><h2 id=scheduling-policy>Scheduling policy</h2><p>Each scheduling policy is associated with a placement type, which determines how KubeFleet will
pick clusters. The <code>ResourcePlacement</code> API supports the same placement types as <code>ClusterResourcePlacement</code>;
for more information about placement types, see the <a href=/docs/how-tos/crp/#scheduling-policy>ClusterResourcePlacement - Scheduling Policy</a> How-To Guide.</p><h2 id=rollout-strategy>Rollout strategy</h2><p>The rollout strategy controls how KubeFleet rolls out changes; for more information, see the <a href=/docs/how-tos/crp/#rollout-strategy>ClusterResourcePlacement - Rollout Strategy</a> How-To Guide.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-dae736fee36bb429124e070c298551ea>3.4 - Using Affinity to Pick Clusters</h1><div class=lead>How to use affinity settings in the <code>ClusterResourcePlacement</code> API to fine-tune Fleet scheduling decisions</div><p>This how-to guide discusses how to use affinity settings to fine-tune how Fleet picks clusters
for resource placement.</p><p>Affinities terms are featured in the <code>ClusterResourcePlacement</code> API, specifically the scheduling
policy section. Each affinity term is a particular requirement that Fleet will check against clusters;
and the fulfillment of this requirement (or the lack of) would have certain effect on whether
Fleet would pick a cluster for resource placement.</p><p>Fleet currently supports two types of affinity terms:</p><ul><li><code>requiredDuringSchedulingIgnoredDuringExecution</code> affinity terms; and</li><li><code>perferredDuringSchedulingIgnoredDuringExecution</code> affinity terms</li></ul><p>Most affinity terms deal with cluster labels. To manage member clusters, specifically
adding/removing labels from a member cluster, see <a href=/docs/how-tos/clusters/>Managing Member Clusters</a> How-To
Guide.</p><h2 id=requiredduringschedulingignoredduringexecution-affinity-terms><code>requiredDuringSchedulingIgnoredDuringExecution</code> affinity terms</h2><p>The <code>requiredDuringSchedulingIgnoredDuringExecution</code> type of affinity terms serves as a hard
constraint that <strong>a cluster must satisfy</strong> before it can be picked. Each term may feature:</p><ul><li>a label selector, which specifies a set of labels that a cluster must have or not have before
it can be picked;</li><li>a property selector, which specifies a cluster property requirement that a cluster must satisfy
before it can be picked;</li><li>a combination of both.</li></ul><p>For the specifics about property selectors, see the
<a href=/docs/how-tos/property-based-scheduling/>How-To Guide: Using Property-Based Scheduling</a>.</p><h3 id=matchlabels><code>matchLabels</code></h3><p>The most straightforward way is to specify <code>matchLabels</code> in the label selector, as showcased below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                        </span><span style=color:#204a87;font-weight:700>system</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>critical</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The example above includes a <code>requiredDuringSchedulingIgnoredDuringExecution</code> term which requires
that the label <code>system=critical</code> must be present on a cluster before Fleet can pick it for the
<code>ClusterResourcePlacement</code>.</p><p>You can add multiple labels to <code>matchLabels</code>; any cluster that satisfy this affinity term would
have <strong>all</strong> the labels present.</p><h3 id=matchexpressions><code>matchExpressions</code></h3><p>For more complex logic, consider using <code>matchExpressions</code>, which allow you to use operators to
set rules for validating labels on a member cluster. Each <code>matchExpressions</code> requirement
includes:</p><ul><li><p>a key, which is the key of the label; and</p></li><li><p>a list of values, which are the possible values for the label key; and</p></li><li><p>an operator, which represents the relationship between the key and the list of values.</p><p>Supported operators include:</p><ul><li><code>In</code>: the cluster must have a label key with one of the listed values.</li><li><code>NotIn</code>: the cluster must have a label key that is not associated with any of the listed values.</li><li><code>Exists</code>: the cluster must have the label key present; any value is acceptable.</li><li><code>NotExists</code>: the cluster must not have the label key.</li></ul><p>If you plan to use <code>Exists</code> and/or <code>NotExists</code>, you must leave the list of values empty.</p></li></ul><p>Below is an example of <code>matchExpressions</code> affinity term using the <code>In</code> operator:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>matchExpressions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span>- <span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>system</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>In</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span><span style=color:#204a87;font-weight:700>values</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span>- <span style=color:#000>critical</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span>- <span style=color:#000>standard</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Any cluster with the label <code>system=critical</code> or <code>system=standard</code> will be picked by Fleet.</p><p>Similarly, you can also specify multiple <code>matchExpressions</code> requirements; any cluster that
satisfy this affinity term would meet all the requirements.</p><h3 id=using-both-matchlabels-and-matchexpressions-in-one-affinity-term>Using both <code>matchLabels</code> and <code>matchExpressions</code> in one affinity term</h3><p>You can specify both <code>matchLabels</code> and <code>matchExpressions</code> in one <code>requiredDuringSchedulingIgnoredDuringExecution</code> affinity term, as showcased below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span><span style=color:#204a87;font-weight:700>region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>east</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>matchExpressions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span>- <span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>system</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Exists</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>With this affinity term, any cluster picked must:</p><ul><li>have the label <code>region=east</code> present;</li><li>have the label <code>system</code> present, any value would do.</li></ul><h3 id=using-multiple-affinity-terms>Using multiple affinity terms</h3><p>You can also specify multiple <code>requiredDuringSchedulingIgnoredDuringExecution</code> affinity terms,
as showcased below; a cluster will be picked if it can satisfy <strong>any</strong> affinity term.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span><span style=color:#204a87;font-weight:700>region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>west</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>matchExpressions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span>- <span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>system</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DoesNotExist</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>With these two affinity terms, any cluster picked must:</p><ul><li>have the label <code>region=west</code> present; <strong>or</strong></li><li>does not have the label <code>system</code></li></ul><h2 id=preferredduringschedulingignoredduringexecution-affinity-terms><code>preferredDuringSchedulingIgnoredDuringExecution</code> affinity terms</h2><p>The <code>preferredDuringSchedulingIgnoredDuringExecution</code> type of affinity terms serves as a soft
constraint for clusters; any cluster that satisfy such terms would receive an affinity score,
which Fleet uses to rank clusters when processing <code>ClusterResourcePlacement</code> with scheduling
policy of the <code>PickN</code> placement type.</p><p>Each term features:</p><ul><li>a weight, between -100 and 100, which is the affinity score that Fleet would assign to a
cluster if it satisfies this term; and</li><li>a label selector, or a property sorter.</li></ul><p>Both are required for this type of affinity terms to function.</p><p>The label selector is of the same struct as the one used in
<code>requiredDuringSchedulingIgnoredDuringExecution</code> type of affinity terms; see
<a href=/docs/how-tos/affinities/#requiredduringschedulingignoredduringexecution-affinity-terms>the documentation above</a> for usage.</p><p>For the specifics about property sorters, see the
<a href=/docs/how-tos/property-based-scheduling/>How-To Guide: Using Property-Based Scheduling</a>.</p><p>Below is an example with a <code>preferredDuringSchedulingIgnoredDuringExecution</code> affinity term:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>preferredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>weight</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>preference</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>west</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Any cluster with the <code>region=west</code> label would receive an affinity score of 20.</p><h3 id=using-multiple-affinity-terms-1>Using multiple affinity terms</h3><p>Similarly, you can use multiple <code>preferredDuringSchedulingIgnoredDuringExection</code> affinity terms,
as showcased below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>preferredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>weight</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>preference</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#204a87;font-weight:700>region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>west</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>weight</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>-<span style=color:#0000cf;font-weight:700>20</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>preference</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>environment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>prod</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Cluster will be validated against each affinity term individually; the affinity scores it
receives will be summed up. For example:</p><ul><li>if a cluster has only the <code>region=west</code> label, it would receive an affinity score of 20; however</li><li>if a cluster has both the <code>region=west</code> and <code>environment=prod</code> labels, it would receive an
affinity score of <code>20 + (-20) = 0</code>.</li></ul><h2 id=use-both-types-of-affinity-terms>Use both types of affinity terms</h2><p>You can, if necessary, add both <code>requiredDuringSchedulingIgnoredDuringExecution</code> and
<code>preferredDuringSchedulingIgnoredDuringExection</code> types of affinity terms. Fleet will
first run all clusters against all the <code>requiredDuringSchedulingIgnoredDuringExecution</code> type
of affinity terms, filter out any that does not meet the requirements, and then
assign the rest with affinity scores per <code>preferredDuringSchedulingIgnoredDuringExection</code> type of
affinity terms.</p><p>Below is an example with both types of affinity terms:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>matchExpressions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span>- <span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>system</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Exists</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>preferredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>weight</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>preference</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#204a87;font-weight:700>region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>west</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>With these affinity terms, only clusters with the label <code>system</code> (any value would do) can be
picked; and among them, those with the <code>region=west</code> will be prioritized for resource placement
as they receive an affinity score of 20.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-ccbad31a9eb5ff37ffc3f405928edd58>3.5 - Using Topology Spread Constraints to Spread Resources</h1><div class=lead>How to use topology spread constraints in the <code>ClusterResourcePlacement</code> API to fine-tune Fleet scheduling decisions</div><p>This how-to guide discusses how to use topology spread constraints to fine-tune how Fleet picks
clusters for resource placement.</p><p>Topology spread constraints are features in the <code>ClusterResourcePlacement</code> API, specifically
the scheduling policy section. Generally speaking, these constraints can help you spread
resources evenly across different groups of clusters in your fleet; or in other words, it
assures that Fleet will not pick too many clusters from one group, and too little from another.
You can use topology spread constraints to, for example:</p><ul><li>achieve high-availability for your database backend by making sure that there is at least
one database replica in each region; or</li><li>verify if your application can support clusters of different configurations; or</li><li>eliminate resource utilization hotspots in your infrastructure through spreading jobs
evenly across sections.</li></ul><h2 id=specifying-a-topology-spread-constraint>Specifying a topology spread constraint</h2><p>A topology spread constraint consists of three fields:</p><ul><li><p><code>topologyKey</code> is a label key which Fleet uses to split your clusters from a fleet into different
groups.</p><p>Specifically, clusters are grouped by the label values they have. For example, if you have
three clusters in a fleet:</p><ul><li>cluster <code>bravelion</code> with the label <code>system=critical</code> and <code>region=east</code>; and</li><li>cluster <code>smartfish</code> with the label <code>system=critical</code> and <code>region=west</code>; and</li><li>cluster <code>jumpingcat</code> with the label <code>system=normal</code> and <code>region=east</code>,</li></ul><p>and you use <code>system</code> as the topology key, the clusters will be split into 2 groups:</p><ul><li>group 1 with cluster <code>bravelion</code> and <code>smartfish</code>, as they both have the value <code>critical</code>
for label <code>system</code>; and</li><li>group 2 with cluster <code>jumpingcat</code>, as it has the value <code>normal</code> for label <code>system</code>.</li></ul><p>Note that the splitting concerns only one label <code>system</code>; other labels,
such as <code>region</code>, do not count.</p><p>If a cluster does not have the given topology key, it <strong>does not</strong> belong to any group.
Fleet may still pick this cluster, as placing resources on it does not violate the
associated topology spread constraint.</p><p>This is a required field.</p></li><li><p><code>maxSkew</code> specifies how <strong>unevenly</strong> resource placements are spread in your fleet.</p><p>The skew of a set of resource placements are defined as the difference in count of
resource placements between the group with the most and the group with
the least, as split by the topology key.</p><p>For example, in the fleet described above (3 clusters, 2 groups):</p><ul><li>if Fleet picks two clusters from group A, but none from group B, the skew would be
<code>2 - 0 = 2</code>; however,</li><li>if Fleet picks one cluster from group A and one from group B, the skew would be
<code>1 - 1 = 0</code>.</li></ul><p>The minimum value of <code>maxSkew</code> is 1. The less you set this value with, the more evenly
resource placements are spread in your fleet.</p><p>This is a required field.</p><blockquote><p>Note</p><p>Naturally, <code>maxSkew</code> only makes sense when there are no less than two groups. If you
set a topology key that will not split the Fleet at all (i.e., all clusters with
the given topology key has exactly the same value), the associated topology spread
constraint will take no effect.</p></blockquote></li><li><p><code>whenUnsatisfiable</code> specifies what Fleet would do when it exhausts all options to satisfy the
topology spread constraint; that is, picking any cluster in the fleet would lead to a violation.</p><p>Two options are available:</p><ul><li><p><code>DoNotSchedule</code>: with this option, Fleet would guarantee that the topology spread constraint
will be enforced all time; scheduling may fail if there is simply no possible way to satisfy
the topology spread constraint.</p></li><li><p><code>ScheduleAnyway</code>: with this option, Fleet would enforce the topology spread constraint
in a best-effort manner; Fleet may, however, pick clusters that would violate the topology
spread constraint if there is no better option.</p></li></ul><p>This is an optional field; if you do not specify a value, Fleet will use <code>DoNotSchedule</code> by
default.</p></li></ul><p>Below is an example of topology spread constraint, which tells Fleet to pick clusters evenly
from different groups, split based on the value of the label <code>system</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>topologySpreadConstraints</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>maxSkew</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>topologyKey</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>system</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>whenUnsatisfiable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DoNotSchedule</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=how-fleet-enforces-topology-spread-constraints-topology-spread-scores>How Fleet enforces topology spread constraints: topology spread scores</h2><p>When you specify some topology spread constraints in the scheduling policy of
a <code>ClusterResourcePlacement</code> object, Fleet will start picking clusters <strong>one at a time</strong>.
More specifically, Fleet will:</p><ul><li><p>for each cluster in the fleet, evaluate how skew would change if resources were placed on it.</p><p>Depending on the current spread of resource placements, there are three possible outcomes:</p><ul><li>placing resources on the cluster reduces the skew by 1; or</li><li>placing resources on the cluster has no effect on the skew; or</li><li>placing resources on the cluster increases the skew by 1.</li></ul><p>Fleet would then assign a topology spread score to the cluster:</p><ul><li><p>if the provisional placement reduces the skew by 1, the cluster receives a topology spread
score of 1; or</p></li><li><p>if the provisional placement has no effect on the skew, the cluster receives a topology
spread score of 0; or</p></li><li><p>if the provisional placement increases the skew by 1, but does not yet exceed the max skew
specified in the constraint, the cluster receives a topology spread score of -1; or</p></li><li><p>if the provisional placement increases the skew by 1, and has exceeded the max skew specified in the constraint,</p><ul><li>for topology spread constraints with the <code>ScheduleAnyway</code> effect, the cluster receives a topology spread score of -1000; and</li><li>for those with the <code>DoNotSchedule</code> effect, the cluster will be removed from
resource placement consideration.</li></ul></li></ul></li><li><p>rank the clusters based on the topology spread score and other factors (e.g., affinity),
pick the one that is most appropriate.</p></li><li><p>repeat the process, until all the needed count of clusters are found.</p></li></ul><p>Below is an example that illustrates the process:</p><p>Suppose you have a fleet of 4 clusters:</p><ul><li>cluster <code>bravelion</code>, with label <code>region=east</code> and <code>system=critical</code>; and</li><li>cluster <code>smartfish</code>, with label <code>region=east</code>; and</li><li>cluster <code>jumpingcat</code>, with label <code>region=west</code>, and <code>system=critical</code>; and</li><li>cluster <code>flyingpenguin</code>, with label <code>region=west</code>,</li></ul><p>And you have created a <code>ClusterResourcePlacement</code> as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>topologySpreadConstraints</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>maxSkew</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>topologyKey</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>region</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>whenUnsatisfiable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DoNotSchedule</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Fleet will first scan all the 4 clusters in the fleet; they all have the <code>region</code> label, with
two different values <code>east</code> and <code>west</code> (2 cluster in each of them). This divides the clusters
into two groups, the <code>east</code> and the <code>west</code></p><p>At this stage, no cluster has been picked yet, so there is no resource placement at all. The
current skew is thus 0, and placing resources on any of them would increase the skew by 1. This
is still below the <code>maxSkew</code> threshold given, so all clusters would receive a topology spread
score of -1.</p><p>Fleet could not find the most appropriate cluster based on the topology spread score so far,
so it would resort to other measures for ranking clusters. This would lead Fleet to pick cluster
<code>smartfish</code>.</p><blockquote><p>Note</p><p>See <a href=/docs/how-tos/crp/>Using <code>ClusterResourcePlacement</code> to Place Resources</a> How-To Guide for more
information on how Fleet picks clusters.</p></blockquote><p>Now, one cluster has been picked, and one more is needed by the <code>ClusterResourcePlacement</code>
object (as the <code>numberOfClusters</code> field is set to 2). Fleet scans the left 3 clusters again,
and this time, since <code>smartfish</code> from group <code>east</code> has been picked, any more resource placement
on clusters from group <code>east</code> would increase the skew by 1 more, and would lead to violation
of the topology spread constraint; Fleet will then assign the topology spread score of -1000 to
cluster <code>bravelion</code>, which is in group <code>east</code>. On the contrary, picking a cluster from any
cluster in group <code>west</code> would reduce the skew by 1, so Fleet assigns the topology spread score
of 1 to cluster <code>jumpingcat</code> and <code>flyingpenguin</code>.</p><p>With the higher topology spread score, <code>jumpingcat</code> and <code>flyingpenguin</code> become the leading
candidate in ranking. They have the same topology spread score, and based on the rules Fleet
has for picking clusters, <code>jumpingcat</code> would be picked finally.</p><h2 id=using-multiple-topology-spread-constraints>Using multiple topology spread constraints</h2><p>You can, if necessary, use multiple topology spread constraints. Fleet will evaluate each of them
separately, and add up topology spread scores for each cluster for the final ranking. A cluster
would be removed from resource placement consideration if placing resources on it would violate
any one of the <code>DoNotSchedule</code> topology spread constraints.</p><p>Below is an example where two topology spread constraints are used:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>topologySpreadConstraints</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>maxSkew</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>topologyKey</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>region</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>whenUnsatisfiable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DoNotSchedule</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>maxSkew</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>topologyKey</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>environment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>whenUnsatisfiable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ScheduleAnyway</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><blockquote><p>Note</p><p>It might be very difficult to find candidate clusters when multiple topology spread constraints
are added. Considering using the <code>ScheduleAnyway</code> effect to add some leeway to the scheduling,
if applicable.</p></blockquote></div><div class=td-content style=page-break-before:always><h1 id=pg-8f6885002eeb6f5c362b9414ff970412>3.6 - Using Property-Based Scheduling</h1><div class=lead>How to use property-based scheduling to produce scheduling decisions</div><p>This how-to guide discusses how to use property-based scheduling to produce scheduling decisions
based on cluster properties.</p><blockquote><p>Note</p><p>The availability of properties depend on which (and if) you have a property provider
set up in your Fleet deployment. For more information, see the
<a href=/concepts/properties>Concept: Property Provider and Cluster Properties</a>
documentation.</p><p>It is also recommended that you read the
<a href=/docs/how-tos/affinities/>How-To Guide: Using Affinity to Pick Clusters</a> first before following
instructions in this document.</p></blockquote><p>Fleet allows users to pick clusters based on exposed cluster properties via the affinity
terms in the <code>ClusterResourcePlacement</code> API:</p><ul><li>for the <code>requiredDuringSchedulingIgnoredDuringExecution</code> affinity terms, you may specify
property selectors to filter clusters based on their properties;</li><li>for the <code>preferredDuringSchedulingIgnoredDuringExecution</code> affinity terms, you may specify
property sorters to prefer clusters with a property that ranks higher or lower.</li></ul><h1 id=property-selectors-in-requiredduringschedulingignoredduringexecution-affinity-terms>Property selectors in <code>requiredDuringSchedulingIgnoredDuringExecution</code> affinity terms</h1><p>A property selector is an array of expression matchers against cluster properties.
In each matcher you will specify:</p><ul><li><p>A name, which is the name of the property.</p><p>If the property is a non-resource one, you may refer to it directly here; however, if the
property is a resource one, the name here should be of the following format:</p><pre tabindex=0><code>resources.kubernetes-fleet.io/[CAPACITY-TYPE]-[RESOURCE-NAME]
</code></pre><p>where <code>[CAPACITY-TYPE]</code> is one of <code>total</code>, <code>allocatable</code>, or <code>available</code>, depending on
which capacity (usage information) you would like to check against, and <code>[RESOURCE-NAME]</code> is
the name of the resource.</p><p>For example, if you would like to select clusters based on the available CPU capacity of
a cluster, the name used in the property selector should be</p><pre tabindex=0><code>resources.kubernetes-fleet.io/available-cpu
</code></pre><p>and for the allocatable memory capacity, use</p><pre tabindex=0><code>resources.kubernetes-fleet.io/allocatable-memory
</code></pre></li><li><p>A list of values, which are possible values of the property.</p></li><li><p>An operator, which describes the relationship between a cluster&rsquo;s observed value of the given
property and the list of values in the matcher.</p><p>Currently, available operators are</p><ul><li><code>Gt</code> (Greater than): a cluster&rsquo;s observed value of the given property must be greater than
the value in the matcher before it can be picked for resource placement.</li><li><code>Ge</code> (Greater than or equal to): a cluster&rsquo;s observed value of the given property must be
greater than or equal to the value in the matcher before it can be picked for resource placement.</li><li><code>Lt</code> (Less than): a cluster&rsquo;s observed value of the given property must be less than
the value in the matcher before it can be picked for resource placement.</li><li><code>Le</code> (Less than or equal to): a cluster&rsquo;s observed value of the given property must be
less than or equal to the value in the matcher before it can be picked for resource placement.</li><li><code>Eq</code> (Equal to): a cluster&rsquo;s observed value of the given property must be equal to
the value in the matcher before it can be picked for resource placement.</li><li><code>Ne</code> (Not equal to): a cluster&rsquo;s observed value of the given property must be
not equal to the value in the matcher before it can be picked for resource placement.</li></ul><p>Note that if you use the operator <code>Gt</code>, <code>Ge</code>, <code>Lt</code>, <code>Le</code>, <code>Eq</code>, or <code>Ne</code>, the list of values
in the matcher should have exactly one value.</p></li></ul><p>Fleet will evaluate each cluster, specifically their exposed properties, against the matchers;
failure to satisfy <strong>any</strong> matcher in the selector will exclude the cluster from resource
placement.</p><p>Note that if a cluster does not have the specified property for a matcher, it will automatically
fail the matcher.</p><p>Below is an example that uses a property selector to select only clusters with a node count of
at least 5 for resource placement:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span>- <span style=color:#204a87;font-weight:700>propertySelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>matchExpressions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;kubernetes-fleet.io/node-count&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Ge</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span><span style=color:#204a87;font-weight:700>values</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span>- <span style=color:#4e9a06>&#34;5&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>You may use both label selector and property selector in a
<code>requiredDuringSchedulingIgnoredDuringExecution</code> affinity term. Both selectors must be satisfied
before a cluster can be picked for resource placement:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span><span style=color:#204a87;font-weight:700>region</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>east</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>propertySelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>matchExpressions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;kubernetes-fleet.io/node-count&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Ge</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span><span style=color:#204a87;font-weight:700>values</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span>- <span style=color:#4e9a06>&#34;5&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>In the example above, Fleet will only consider a cluster for resource placement if it has the
<code>region=east</code> label and a node count no less than 5.</p><h1 id=property-sorters-in-preferredduringschedulingignoredduringexecution-affinity-terms>Property sorters in <code>preferredDuringSchedulingIgnoredDuringExecution</code> affinity terms</h1><p>A property sorter ranks all the clusters in the Fleet based on their values of a specified
property in ascending or descending order, then yields weights for the clusters in proportion
to their ranks. The proportional weights are calculated based on the weight value given in the
<code>preferredDuringSchedulingIgnoredDuringExecution</code> term.</p><p>A property sorter consists of:</p><ul><li><p>A name, which is the name of the property; see the format in the previous section for more
information.</p></li><li><p>A sort order, which is one of <code>Ascending</code> and <code>Descending</code>, for ranking in ascending and
descending order respectively.</p><p>As a rule of thumb, when the <code>Ascending</code> order is used, Fleet will prefer clusters with lower
observed values, and when the <code>Descending</code> order is used, clusters with higher observed values
will be preferred.</p></li></ul><p>When using the sort order <code>Descending</code>, the proportional weight is calculated using the formula:</p><pre tabindex=0><code>((Observed Value - Minimum observed value) / (Maximum observed value - Minimum observed value)) * Weight
</code></pre><p>For example, suppose that you would like to rank clusters based on the property of available CPU
capacity in descending order and currently, you have a fleet of 3 clusters with the available CPU
capacities as follows:</p><table><thead><tr><th>Cluster</th><th>Available CPU capacity</th></tr></thead><tbody><tr><td>bravelion</td><td>100</td></tr><tr><td>smartfish</td><td>20</td></tr><tr><td>jumpingcat</td><td>10</td></tr></tbody></table><p>The sorter would yield the weights below:</p><table><thead><tr><th>Cluster</th><th>Available CPU capacity</th><th>Weight</th></tr></thead><tbody><tr><td>bravelion</td><td>100</td><td>(100 - 10) / (100 - 10) = 100% of the weight</td></tr><tr><td>smartfish</td><td>20</td><td>(20 - 10) / (100 - 10) = 11.11% of the weight</td></tr><tr><td>jumpingcat</td><td>10</td><td>(10 - 10) / (100 - 10) = 0% of the weight</td></tr></tbody></table><p>And when using the sort order <code>Ascending</code>, the proportional weight is calculated using the formula:</p><pre tabindex=0><code>(1 - ((Observed Value - Minimum observed value) / (Maximum observed value - Minimum observed value))) * Weight
</code></pre><p>For example, suppose that you would like to rank clusters based on their per CPU core cost
in ascending order and currently across the fleet, you have a fleet of 3 clusters with the
per CPU core costs as follows:</p><table><thead><tr><th>Cluster</th><th>Per CPU core cost</th></tr></thead><tbody><tr><td>bravelion</td><td>1</td></tr><tr><td>smartfish</td><td>0.2</td></tr><tr><td>jumpingcat</td><td>0.1</td></tr></tbody></table><p>The sorter would yield the weights below:</p><table><thead><tr><th>Cluster</th><th>Per CPU core cost</th><th>Weight</th></tr></thead><tbody><tr><td>bravelion</td><td>1</td><td>1 - ((1 - 0.1) / (1 - 0.1)) = 0% of the weight</td></tr><tr><td>smartfish</td><td>0.2</td><td>1 - ((0.2 - 0.1) / (1 - 0.1)) = 88.89% of the weight</td></tr><tr><td>jumpingcat</td><td>0.1</td><td>1 - (0.1 - 0.1) / (1 - 0.1) = 100% of the weight</td></tr></tbody></table><p>The example below showcases a property sorter using the <code>Descending</code> order:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>preferredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>weight</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>preference</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>propertySorter</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kubernetes-fleet.io/node-count</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>sortOrder</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Descending</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>In this example, Fleet will prefer clusters with higher node counts. The cluster with the highest
node count would receive a weight of 20, and the cluster with the lowest would receive 0. Other
clusters receive proportional weights calculated using the formulas above.</p><p>You may use both label selector and property sorter in a
<code>preferredDuringSchedulingIgnoredDuringExecution</code> affinity term. A cluster that fails the label
selector would receive no weight, and clusters that pass the label selector receive proportional
weights under the property sorter.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>preferredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>weight</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>20</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>preference</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>prod</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>propertySorter</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>resources.kubernetes-fleet.io/total-cpu</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>sortOrder</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Descending</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>In the example above, a cluster would only receive additional weight if it has the label
<code>env=prod</code>, and the more total CPU capacity it has, the more weight it will receive, up to the
limit of 20.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-06445baf57d9bbc7fde02bf249b4a0fa>3.7 - Using Taints and Tolerations</h1><div class=lead>How to use taints and tolerations to fine-tune scheduling decisions</div><p>This how-to guide discusses how to add/remove taints on <code>MemberCluster</code> and how to add tolerations on <code>ClusterResourcePlacement</code>.</p><h2 id=adding-taint-to-membercluster>Adding taint to MemberCluster</h2><p>In this example, we will add a taint to a <code>MemberCluster</code>. Then try to propagate resources to the <code>MemberCluster</code> using a <code>ClusterResourcePlacement</code>
with <strong>PickAll</strong> placement policy. The resources should not be propagated to the <code>MemberCluster</code> because of the taint.</p><p>We will first create a namespace that we will propagate to the member cluster,</p><pre tabindex=0><code>kubectl create ns test-ns
</code></pre><p>Then apply the <code>MemberCluster</code> with a taint,</p><p>Example <code>MemberCluster</code> with taint:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>MemberCluster</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>identity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>fleet-member-agent-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ServiceAccount</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>fleet-system</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>apiGroup</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>taints</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-key1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-value1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>effect</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoSchedule</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>After applying the above <code>MemberCluster</code>, we will apply a <code>ClusterResourcePlacement</code> with the following spec:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1          </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <code>ClusterResourcePlacement</code> CR should not propagate the <code>test-ns</code> namespace to the member cluster because of the taint,
looking at the status of the CR should show the following:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T19:03:17Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all the clusters needed as specified by the scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T19:03:17Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All 0 cluster(s) are synchronized to the latest resources on the hub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>cluster</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SynchronizeSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T19:03:17Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>There are no clusters selected to place the resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>observedResourceIndex</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Looking at the <code>ClusterResourcePlacementSynchronized</code>, <code>ClusterResourcePlacementApplied</code> conditions and reading the message fields
we can see that no clusters were selected to place the resources.</p><h2 id=removing-taint-from-membercluster>Removing taint from MemberCluster</h2><p>In this example, we will remove the taint from the <code>MemberCluster</code> from the last section. This should automatically trigger the Fleet scheduler to propagate the resources to the <code>MemberCluster</code>.</p><p>After removing the taint from the <code>MemberCluster</code>. Let&rsquo;s take a look at the status of the <code>ClusterResourcePlacement</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:00:03Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all the clusters needed as specified by the scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:02:57Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All 1 cluster(s) are synchronized to the latest resources on the hub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>cluster</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SynchronizeSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:02:57Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully applied resources to 1 member clusters</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>observedResourceIndex</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementStatuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:02:52Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in kind-cluster-1 (affinity
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        score: 0, topology spread score: 0): picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ScheduleSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:02:57Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully Synchronized work(s) for placement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronizeSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:02:57Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully applied resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>From the status we can clearly see that the resources were propagated to the member cluster after removing the taint.</p><h2 id=adding-toleration-to-clusterresourceplacement>Adding toleration to ClusterResourcePlacement</h2><p>Adding a toleration to a <code>ClusterResourcePlacement</code> CR allows the Fleet scheduler to tolerate specific taints on the <code>MemberClusters</code>.</p><p>For this section we will start from scratch, we will first create a namespace that we will propagate to the <code>MemberCluster</code></p><pre tabindex=0><code>kubectl create ns test-ns
</code></pre><p>Then apply the <code>MemberCluster</code> with a taint,</p><p>Example <code>MemberCluster</code> with taint:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>heartbeatPeriodSeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>60</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>identity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>apiGroup</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ServiceAccount</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>fleet-member-agent-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>fleet-system</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>taints</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>effect</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoSchedule</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-key1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-value1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <code>ClusterResourcePlacement</code> CR will not propagate the <code>test-ns</code> namespace to the member cluster because of the taint.</p><p>Now we will add a toleration to a <code>ClusterResourcePlacement</code> CR as part of the placement policy, which will use the Exists operator to tolerate the taint.</p><p>Example <code>ClusterResourcePlacement</code> spec with tolerations after adding new toleration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>tolerations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-key1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Exists</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>revisionHistoryLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Let&rsquo;s take a look at the status of the <code>ClusterResourcePlacement</code> CR after adding the toleration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:16:10Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all the clusters needed as specified by the scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:16:15Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All 1 cluster(s) are synchronized to the latest resources on the hub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>cluster</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SynchronizeSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:16:15Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully applied resources to 1 member clusters</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>observedResourceIndex</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementStatuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:16:10Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in kind-cluster-1 (affinity
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        score: 0, topology spread score: 0): picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ScheduleSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:16:15Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully Synchronized work(s) for placement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronizeSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:16:15Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully applied resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>From the status we can see that the resources were propagated to the <code>MemberCluster</code> after adding the toleration.</p><p>Now let&rsquo;s try adding a new taint to the member cluster CR and see if the resources are still propagated to the <code>MemberCluster</code>,</p><p>Example <code>MemberCluster</code> CR with new taint:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>heartbeatPeriodSeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>60</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>identity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>apiGroup</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ServiceAccount</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>fleet-member-agent-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>fleet-system</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>taints</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>effect</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoSchedule</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-key1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-value1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>effect</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoSchedule</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-key2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-value2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Let&rsquo;s take a look at the <code>ClusterResourcePlacement</code> CR status after adding the new taint:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:27:44Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all the clusters needed as specified by the scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:27:49Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All 1 cluster(s) are synchronized to the latest resources on the hub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>cluster</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SynchronizeSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:27:49Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully applied resources to 1 member clusters</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>observedResourceIndex</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementStatuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:27:44Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in kind-cluster-1 (affinity
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        score: 0, topology spread score: 0): picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ScheduleSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:27:49Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully Synchronized work(s) for placement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronizeSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-04-16T20:27:49Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully applied resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Nothing changes in the status because even if the new taint is not tolerated, the exising resources on the <code>MemberCluster</code>
will continue to run because the taint effect is <code>NoSchedule</code> and the cluster was already selected for resource propagation in a
previous scheduling cycle.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-f53861fa149aba83d55219c600a493a6>3.8 - Using the ClusterResourceOverride API</h1><div class=lead>How to use the <code>ClusterResourceOverride</code> API to override cluster-scoped resources</div><p>This guide provides an overview of how to use the Fleet <code>ClusterResourceOverride</code> API to override cluster resources.</p><h2 id=overview>Overview</h2><p><code>ClusterResourceOverride</code> is a feature within Fleet that allows for the modification or override of specific attributes
across cluster-wide resources. With ClusterResourceOverride, you can define rules based on cluster labels or other
criteria, specifying changes to be applied to various cluster-wide resources such as namespaces, roles, role bindings,
or custom resource definitions. These modifications may include updates to permissions, configurations, or other
parameters, ensuring consistent management and enforcement of configurations across your Fleet-managed Kubernetes clusters.</p><h2 id=api-components>API Components</h2><p>The ClusterResourceOverride API consists of the following components:</p><ul><li><strong>Placement</strong>: This specifies which placement the override is applied to.</li><li><strong>Cluster Resource Selectors</strong>: These specify the set of cluster resources selected for overriding.</li><li><strong>Policy</strong>: This specifies the policy to be applied to the selected resources.</li></ul><p>The following sections discuss these components in depth.</p><h2 id=placement>Placement</h2><p>To configure which placement the override is applied to, you can use the name of <code>ClusterResourcePlacement</code>.</p><h2 id=cluster-resource-selectors>Cluster Resource Selectors</h2><p>A <code>ClusterResourceOverride</code> object may feature one or more cluster resource selectors, specifying which resources to select to be overridden.</p><p>The <code>ClusterResourceSelector</code> object supports the following fields:</p><ul><li><code>group</code>: The API group of the resource</li><li><code>version</code>: The API version of the resource</li><li><code>kind</code>: The kind of the resource</li><li><code>name</code>: The name of the resource</li></ul><blockquote><p>Note: The resource can only be selected by name.</p></blockquote><p>To add a resource selector, edit the <code>clusterResourceSelectors</code> field in the <code>ClusterResourceOverride</code> spec:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-cro</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>clusterResourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rbac.authorization.k8s.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterRole</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>secret-reader</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The example in the tutorial will pick the <code>ClusterRole</code> named <code>secret-reader</code>, as shown below, to be overridden.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rbac.authorization.k8s.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterRole</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>secret-reader</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#204a87;font-weight:700>apiGroups</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;secrets&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>verbs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;get&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;watch&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;list&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=policy>Policy</h2><p>The <code>Policy</code> is made up of a set of rules (<code>OverrideRules</code>) that specify the changes to be applied to the selected
resources on selected clusters.</p><p>Each <code>OverrideRule</code> supports the following fields:</p><ul><li><strong>Cluster Selector</strong>: This specifies the set of clusters to which the override applies.</li><li><strong>Override Type</strong>: This specifies the type of override to be applied. The default type is <code>JSONPatch</code>.<ul><li><code>JSONPatch</code>: applies the JSON patch to the selected resources using <a href=https://datatracker.ietf.org/doc/html/rfc6902>RFC 6902</a>.</li><li><code>Delete</code>: deletes the selected resources on the target cluster.</li></ul></li><li><strong>JSON Patch Override</strong>: This specifies the changes to be applied to the selected resources when the override type is <code>JSONPatch</code>.</li></ul><h3 id=cluster-selector>Cluster Selector</h3><p>To specify the clusters to which the override applies, you can use the <code>clusterSelector</code> field in the <code>OverrideRule</code> spec.
The <code>clusterSelector</code> field supports the following fields:</p><ul><li><code>clusterSelectorTerms</code>: A list of terms that are used to select clusters.<ul><li>Each term in the list is used to select clusters based on the label selector.</li></ul></li></ul><blockquote><p>IMPORTANT:
Only <code>labelSelector</code> is supported in the <code>clusterSelectorTerms</code> field.</p></blockquote><h3 id=override-type>Override Type</h3><p>To specify the type of override to be applied, you can use the overrideType field in the OverrideRule spec.
The default value is <code>JSONPatch</code>.</p><ul><li><code>JSONPatch</code>: applies the JSON patch to the selected resources using <a href=https://datatracker.ietf.org/doc/html/rfc6902>RFC 6902</a>.</li><li><code>Delete</code>: deletes the selected resources on the target cluster.</li></ul><h4 id=json-patch-override>JSON Patch Override</h4><p>To specify the changes to be applied to the selected resources, you can use the jsonPatchOverrides field in the OverrideRule spec.
The jsonPatchOverrides field supports the following fields:</p><blockquote><p>JSONPatchOverride applies a JSON patch on the selected resources following <a href=https://datatracker.ietf.org/doc/html/rfc6902>RFC 6902</a>.
All the fields defined follow this RFC.</p></blockquote><ul><li><p><code>op</code>: The operation to be performed. The supported operations are <code>add</code>, <code>remove</code>, and <code>replace</code>.</p><ul><li><code>add</code>: Adds a new value to the specified path.</li><li><code>remove</code>: Removes the value at the specified path.</li><li><code>replace</code>: Replaces the value at the specified path.</li></ul></li><li><p><code>path</code>: The path to the field to be modified.</p><ul><li>Some guidelines for the path are as follows:<ul><li>Must start with a <code>/</code> character.</li><li>Cannot be empty.</li><li>Cannot contain an empty string ("///").</li><li>Cannot be a TypeMeta Field ("/kind", &ldquo;/apiVersion&rdquo;).</li><li>Cannot be a Metadata Field ("/metadata/name", &ldquo;/metadata/namespace&rdquo;), except the fields &ldquo;/metadata/annotations&rdquo; and &ldquo;metadata/labels&rdquo;.</li><li>Cannot be any field in the status of the resource.</li></ul></li><li>Some examples of valid paths are:<ul><li><code>/metadata/labels/new-label</code></li><li><code>/metadata/annotations/new-annotation</code></li><li><code>/spec/template/spec/containers/0/resources/limits/cpu</code></li><li><code>/spec/template/spec/containers/0/resources/requests/memory</code></li></ul></li></ul></li><li><p><code>value</code>: The value to be set.</p><ul><li>If the <code>op</code> is <code>remove</code>, the value cannot be set.</li><li>There is a list of reserved variables that will be replaced by the actual values:<ul><li><code>${MEMBER-CLUSTER-NAME}</code>: this will be replaced by the name of the <code>memberCluster</code> that represents this cluster.</li></ul></li></ul></li></ul><h5 id=example-override-labels>Example: Override Labels</h5><p>To overwrite the existing labels on the <code>ClusterRole</code> named <code>secret-reader</code> on clusters with the label <code>env: prod</code>,
you can use the following configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-cro</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>clusterResourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rbac.authorization.k8s.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterRole</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>secret-reader</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>overrideRules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>clusterSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>prod</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>jsonPatchOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>add</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/metadata/labels</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span>{<span style=color:#4e9a06>&#34;cluster-name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;${MEMBER-CLUSTER-NAME}&#34;</span>}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><blockquote><p>Note: To add a new label to the existing labels, please use the below configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>add</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/metadata/labels/new-label</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;new-value&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div></blockquote><p>The <code>ClusterResourceOverride</code> object above will add a label <code>cluster-name</code> with the value of the <code>memberCluster</code> name to the <code>ClusterRole</code> named <code>secret-reader</code> on clusters with the label <code>env: prod</code>.</p><h5 id=example-remove-verbs>Example: Remove Verbs</h5><p>To remove the verb &ldquo;list&rdquo; in the <code>ClusterRole</code> named <code>secret-reader</code> on clusters with the label <code>env: prod</code>,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-cro</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>clusterResourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rbac.authorization.k8s.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterRole</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>secret-reader</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>overrideRules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>clusterSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>prod</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>jsonPatchOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>remove</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/rules/0/verbs/2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <code>ClusterResourceOverride</code> object above will remove the verb &ldquo;list&rdquo; in the <code>ClusterRole</code> named <code>secret-reader</code> on
clusters with the label <code>env: prod</code> selected by the clusterResourcePlacement <code>crp-example</code>.</p><blockquote><p>The ClusterResourceOverride mentioned above utilizes the cluster role displayed below:</p><pre tabindex=0><code>Name:         secret-reader
Labels:       &lt;none&gt;
Annotations:  &lt;none&gt;
PolicyRule:
Resources  Non-Resource URLs  Resource Names  Verbs
---------  -----------------  --------------  -----
secrets    []                 []              [get watch list]
</code></pre></blockquote><h4 id=delete>Delete</h4><p>The <code>Delete</code> override type can be used to delete the selected resources on the target cluster.</p><h5 id=example-delete-selected-resource>Example: Delete Selected Resource</h5><p>To delete the <code>secret-reader</code> on the clusters with the label <code>env: test</code> selected by the clusterResourcePlacement <code>crp-example</code>, you can use the <code>Delete</code> override type.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-cro</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>clusterResourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rbac.authorization.k8s.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterRole</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>secret-reader</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>overrideRules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>clusterSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>overrideType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Delete</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=multiple-override-patches>Multiple Override Patches</h3><p>You may add multiple <code>JSONPatchOverride</code> to an <code>OverrideRule</code> to apply multiple changes to the selected cluster resources.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-cro</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>clusterResourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rbac.authorization.k8s.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterRole</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>secret-reader</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>overrideRules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>clusterSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>prod</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>jsonPatchOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>remove</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/rules/0/verbs/2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>remove</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/rules/0/verbs/1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <code>ClusterResourceOverride</code> object above will remove the verbs &ldquo;list&rdquo; and &ldquo;watch&rdquo; in the <code>ClusterRole</code> named
<code>secret-reader</code> on clusters with the label <code>env: prod</code>.</p><h4 id=breaking-down-the-paths>Breaking down the paths:</h4><ul><li>First <code>JSONPatchOverride</code>:<ul><li><code>/rules/0</code>: This denotes the first rule in the rules array of the ClusterRole. In the provided ClusterRole definition,
there&rsquo;s only one rule defined (&ldquo;secrets&rdquo;), so this corresponds to the first (and only) rule.</li><li><code>/verbs/2</code>: Within this rule, the third element of the verbs array is targeted (&ldquo;list&rdquo;).</li></ul></li><li>Second <code>JSONPatchOverride</code>:<ul><li><code>/rules/0</code>: This denotes the first rule in the rules array of the ClusterRole. In the provided ClusterRole definition,
there&rsquo;s only one rule defined (&ldquo;secrets&rdquo;), so this corresponds to the first (and only) rule.</li><li><code>/verbs/1</code>: Within this rule, the second element of the verbs array is targeted (&ldquo;watch&rdquo;).</li></ul></li></ul><blockquote><p>The ClusterResourceOverride mentioned above utilizes the cluster role displayed below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>         </span><span style=color:#000>secret-reader</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>&lt;none&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>&lt;none&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>PolicyRule</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>Resources  Non-Resource URLs  Resource Names  Verbs</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>---</span>------ <span style=color:#f8f8f8;text-decoration:underline> </span>----------------- <span style=color:#f8f8f8;text-decoration:underline> </span>-------------- <span style=color:#f8f8f8;text-decoration:underline> </span>-----<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>secrets    []                 []              [get watch list]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div></blockquote><h2 id=applying-the-clusterresourceoverride>Applying the ClusterResourceOverride</h2><p>Create a ClusterResourcePlacement resource to specify the placement rules for distributing the cluster resource overrides across
the cluster infrastructure. Ensure that you select the appropriate resource.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rbac.authorization.k8s.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterRole</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>secret-reader</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>prod</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <code>ClusterResourcePlacement</code> configuration outlined above will disperse resources across all clusters labeled with <code>env: prod</code>.
As the changes are implemented, the corresponding <code>ClusterResourceOverride</code> configurations will be applied to the
designated clusters, triggered by the selection of matching cluster role resource <code>secret-reader</code>.</p><h2 id=verifying-the-cluster-resource-is-overridden>Verifying the Cluster Resource is Overridden</h2><p>To ensure that the <code>ClusterResourceOverride</code> object is applied to the selected clusters, verify the <code>ClusterResourcePlacement</code>
status by running <code>kubectl describe crp crp-example</code> command:</p><pre tabindex=0><code>Status:
  Conditions:
    ...
    Message:                The selected resources are successfully overridden in the 10 clusters
    Observed Generation:    1
    Reason:                 OverriddenSucceeded
    Status:                 True
    Type:                   ClusterResourcePlacementOverridden
    ...
  Observed Resource Index:  0
  Placement Statuses:
    Applicable Cluster Resource Overrides:
      example-cro-0
    Cluster Name:  member-50
    Conditions:
      ...
      Message:               Successfully applied the override rules on the resources
      Observed Generation:   1
      Reason:                OverriddenSucceeded
      Status:                True
      Type:                  Overridden
     ...
</code></pre><p>Each cluster maintains its own <code>Applicable Cluster Resource Overrides</code> which contain the cluster resource override snapshot
if relevant. Additionally, individual status messages for each cluster indicate whether the override rules have been
effectively applied.</p><p>The <code>ClusterResourcePlacementOverridden</code> condition indicates whether the resource override has been successfully applied
to the selected resources in the selected clusters.</p><p>To verify that the <code>ClusterResourceOverride</code> object has been successfully applied to the selected resources,
check resources in the selected clusters:</p><ol><li>Get cluster credentials:
<code>az aks get-credentials --resource-group &lt;resource-group> --name &lt;cluster-name></code></li><li>Get the <code>ClusterRole</code> object in the selected cluster:
<code>kubectl --context=&lt;member-cluster-context> get clusterrole secret-reader -o yaml</code></li></ol><p>Upon inspecting the described <code>ClusterRole</code> object, it becomes apparent that the verbs &ldquo;watch&rdquo; and &ldquo;list&rdquo; have been
removed from the permissions list within the <code>ClusterRole</code> named &ldquo;secret-reader&rdquo; on the prod clusters.</p><pre tabindex=0><code> apiVersion: rbac.authorization.k8s.io/v1
 kind: ClusterRole
 metadata:
  ...
 rules:
 - apiGroups:
   - &#34;&#34;
   resources:
   - secrets
   verbs:
   - get
</code></pre><p>Similarly, you can verify that this cluster role does not exist in the test clusters.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-4f07136e38cf9fb330102a16c2742234>3.9 - Using the ResourceOverride API</h1><div class=lead>How to use the <code>ResourceOverride</code> API to override namespace-scoped resources</div><p>This guide provides an overview of how to use the Fleet <code>ResourceOverride</code> API to override resources.</p><h2 id=overview>Overview</h2><p><code>ResourceOverride</code> is a Fleet API that allows you to modify or override specific attributes of
existing resources within your cluster. With ResourceOverride, you can define rules based on cluster
labels or other criteria, specifying changes to be applied to resources such as Deployments, StatefulSets, ConfigMaps, or Secrets.
These changes can include updates to container images, environment variables, resource limits, or any other configurable parameters.</p><h2 id=api-components>API Components</h2><p>The ResourceOverride API consists of the following components:</p><ul><li><strong>Placement</strong>: This specifies which placement the override is applied to.</li><li><strong>Resource Selectors</strong>: These specify the set of resources selected for overriding.</li><li><strong>Policy</strong>: This specifies the policy to be applied to the selected resources.</li></ul><p>The following sections discuss these components in depth.</p><h2 id=placement>Placement</h2><p>To configure which placement the override is applied to, you can use the name of <code>ClusterResourcePlacement</code>.</p><h2 id=resource-selectors>Resource Selectors</h2><p>A <code>ResourceOverride</code> object may feature one or more resource selectors, specifying which resources to select to be overridden.</p><p>The <code>ResourceSelector</code> object supports the following fields:</p><ul><li><code>group</code>: The API group of the resource</li><li><code>version</code>: The API version of the resource</li><li><code>kind</code>: The kind of the resource</li><li><code>name</code>: The name of the resource</li></ul><blockquote><p>Note: The resource can only be selected by name.</p></blockquote><p>To add a resource selector, edit the <code>resourceSelectors</code> field in the <code>ResourceOverride</code> spec:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-ro</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><blockquote><p>Note: The ResourceOverride needs to be in the same namespace as the resources it is overriding.</p></blockquote><p>The examples in the tutorial will pick a <code>Deployment</code> named <code>my-deployment</code> from the namespace <code>test-namespace</code>, as shown below, to be overridden.</p><pre tabindex=0><code>apiVersion: apps/v1
kind: Deployment
metadata:
  ...
  name: my-deployment
  namespace: test-namespace
  ...
spec:
  progressDeadlineSeconds: 600
  replicas: 2
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: test-nginx
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: test-nginx
    spec:
      containers:
      - image: nginx:1.14.2
        imagePullPolicy: IfNotPresent
        name: nginx
        ports:
        - containerPort: 80
          protocol: TCP
        resources: {}
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: {}
      terminationGracePeriodSeconds: 30
status:
  ...
</code></pre><h2 id=policy>Policy</h2><p>The <code>Policy</code> is made up of a set of rules (<code>OverrideRules</code>) that specify the changes to be applied to the selected
resources on selected clusters.</p><p>Each <code>OverrideRule</code> supports the following fields:</p><ul><li><strong>Cluster Selector</strong>: This specifies the set of clusters to which the override applies.</li><li><strong>Override Type</strong>: This specifies the type of override to be applied. The default type is <code>JSONPatch</code>.<ul><li><code>JSONPatch</code>: applies the JSON patch to the selected resources using <a href=https://datatracker.ietf.org/doc/html/rfc6902>RFC 6902</a>.</li><li><code>Delete</code>: deletes the selected resources on the target cluster.</li></ul></li><li><strong>JSON Patch Override</strong>: This specifies the changes to be applied to the selected resources when the override type is <code>JSONPatch</code>.</li></ul><h3 id=cluster-selector>Cluster Selector</h3><p>To specify the clusters to which the override applies, you can use the <code>clusterSelector</code> field in the <code>OverrideRule</code> spec.
The <code>clusterSelector</code> field supports the following fields:</p><ul><li><code>clusterSelectorTerms</code>: A list of terms that are used to select clusters.<ul><li>Each term in the list is used to select clusters based on the label selector.</li></ul></li></ul><blockquote><p>IMPORTANT:
Only <code>labelSelector</code> is supported in the <code>clusterSelectorTerms</code> field.</p></blockquote><h3 id=override-type>Override Type</h3><p>To specify the type of override to be applied, you can use the overrideType field in the OverrideRule spec.
The default value is <code>JSONPatch</code>.</p><ul><li><code>JSONPatch</code>: applies the JSON patch to the selected resources using <a href=https://datatracker.ietf.org/doc/html/rfc6902>RFC 6902</a>.</li><li><code>Delete</code>: deletes the selected resources on the target cluster.</li></ul><h4 id=json-patch-override>JSON Patch Override</h4><p>To specify the changes to be applied to the selected resources, you can use the jsonPatchOverrides field in the OverrideRule spec.
The jsonPatchOverrides field supports the following fields:</p><blockquote><p>JSONPatchOverride applies a JSON patch on the selected resources following <a href=https://datatracker.ietf.org/doc/html/rfc6902>RFC 6902</a>.
All the fields defined follow this RFC.</p></blockquote><p>The <code>jsonPatchOverrides</code> field supports the following fields:</p><ul><li><p><code>op</code>: The operation to be performed. The supported operations are <code>add</code>, <code>remove</code>, and <code>replace</code>.</p><ul><li><code>add</code>: Adds a new value to the specified path.</li><li><code>remove</code>: Removes the value at the specified path.</li><li><code>replace</code>: Replaces the value at the specified path.</li></ul></li><li><p><code>path</code>: The path to the field to be modified.</p><ul><li>Some guidelines for the path are as follows:<ul><li>Must start with a <code>/</code> character.</li><li>Cannot be empty.</li><li>Cannot contain an empty string ("///").</li><li>Cannot be a TypeMeta Field ("/kind", &ldquo;/apiVersion&rdquo;).</li><li>Cannot be a Metadata Field ("/metadata/name", &ldquo;/metadata/namespace&rdquo;), except the fields &ldquo;/metadata/annotations&rdquo; and &ldquo;metadata/labels&rdquo;.</li><li>Cannot be any field in the status of the resource.</li></ul></li><li>Some examples of valid paths are:<ul><li><code>/metadata/labels/new-label</code></li><li><code>/metadata/annotations/new-annotation</code></li><li><code>/spec/template/spec/containers/0/resources/limits/cpu</code></li><li><code>/spec/template/spec/containers/0/resources/requests/memory</code></li></ul></li></ul></li><li><p><code>value</code>: The value to be set.</p><ul><li>If the <code>op</code> is <code>remove</code>, the value cannot be set.</li><li>There is a list of reserved variables that will be replaced by the actual values:<ul><li><code>${MEMBER-CLUSTER-NAME}</code>: this will be replaced by the name of the <code>memberCluster</code> that represents this cluster.</li></ul></li></ul></li></ul><h5 id=example-override-labels>Example: Override Labels</h5><p>To overwrite the existing labels on the <code>Deployment</code> named <code>my-deployment</code> on clusters with the label <code>env: prod</code>,
you can use the following configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-ro</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>overrideRules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>clusterSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>prod</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>jsonPatchOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>add</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/metadata/labels</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span>{<span style=color:#4e9a06>&#34;cluster-name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;${MEMBER-CLUSTER-NAME}&#34;</span>}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><blockquote><p>Note: To add a new label to the existing labels, please use the below configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>add</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/metadata/labels/new-label</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;new-value&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div></blockquote><p>The <code>ResourceOverride</code> object above will add a label <code>cluster-name</code> with the value of the <code>memberCluster</code> name to the <code>Deployment</code> named <code>example-ro</code> on clusters with the label <code>env: prod</code>.</p><h5 id=example-override-image>Example: Override Image</h5><p>To override the image of the container in the <code>Deployment</code> named <code>my-deployment</code> on all clusters with the label <code>env: prod</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-ro</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>overrideRules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>clusterSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>prod</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>jsonPatchOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>replace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/spec/template/spec/containers/0/image</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;nginx:1.20.0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <code>ResourceOverride</code> object above will replace the image of the container in the <code>Deployment</code> named <code>my-deployment</code>
with the image <code>nginx:1.20.0</code> on all clusters with the label <code>env: prod</code> selected by the clusterResourcePlacement <code>crp-example</code>.</p><blockquote><p>The ResourceOverride mentioned above utilizes the deployment displayed below:</p><pre tabindex=0><code>apiVersion: apps/v1
kind: Deployment
metadata:
  ...
  name: my-deployment
  namespace: test-namespace
  ...
spec:
  ...
  template:
    ...
    spec:
      containers:
      - image: nginx:1.14.2
        imagePullPolicy: IfNotPresent
        name: nginx
        ports:
       ...
      ...
  ...
</code></pre></blockquote><h4 id=delete>Delete</h4><p>The <code>Delete</code> override type can be used to delete the selected resources on the target cluster.</p><h5 id=example-delete-selected-resource>Example: Delete Selected Resource</h5><p>To delete the <code>my-deployment</code> on the clusters with the label <code>env: test</code> selected by the clusterResourcePlacement <code>crp-example</code>,
you can use the <code>Delete</code> override type.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-ro</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>overrideRules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>clusterSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>overrideType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Delete</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=multiple-override-rules>Multiple Override Rules</h3><p>You may add multiple <code>OverrideRules</code> to a <code>Policy</code> to apply multiple changes to the selected resources.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-ro</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>overrideRules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>clusterSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>prod</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>jsonPatchOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>replace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/spec/template/spec/containers/0/image</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;nginx:1.20.0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>clusterSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>jsonPatchOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>replace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/spec/template/spec/containers/0/image</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;nginx:latest&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <code>ResourceOverride</code> object above will replace the image of the container in the <code>Deployment</code> named <code>my-deployment</code>
with the image <code>nginx:1.20.0</code> on all clusters with the label <code>env: prod</code> and the image <code>nginx:latest</code> on all clusters with the label <code>env: test</code>.</p><blockquote><p>The ResourceOverride mentioned above utilizes the deployment displayed below:</p><pre tabindex=0><code>apiVersion: apps/v1
kind: Deployment
metadata:
  ...
  name: my-deployment
  namespace: test-namespace
  ...
spec:
  ...
  template:
    ...
    spec:
      containers:
      - image: nginx:1.14.2
        imagePullPolicy: IfNotPresent
        name: nginx
        ports:
       ...
      ...
  ...
</code></pre></blockquote><h2 id=applying-the-resourceoverride>Applying the ResourceOverride</h2><p>Create a ClusterResourcePlacement resource to specify the placement rules for distributing the resource overrides across
the cluster infrastructure. Ensure that you select the appropriate namespaces containing the matching resources.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>prod</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <code>ClusterResourcePlacement</code> configuration outlined above will disperse resources within <code>test-namespace</code> across all
clusters labeled with <code>env: prod</code> and <code>env: test</code>. As the changes are implemented, the corresponding <code>ResourceOverride</code>
configurations will be applied to the designated clusters, triggered by the selection of matching deployment resource
<code>my-deployment</code>.</p><h2 id=verifying-the-cluster-resource-is-overridden>Verifying the Cluster Resource is Overridden</h2><p>To ensure that the <code>ResourceOverride</code> object is applied to the selected resources, verify the <code>ClusterResourcePlacement</code>
status by running <code>kubectl describe crp crp-example</code> command:</p><pre tabindex=0><code>Status:
  Conditions:
    ...
    Message:                The selected resources are successfully overridden in the 10 clusters
    Observed Generation:    1
    Reason:                 OverriddenSucceeded
    Status:                 True
    Type:                   ClusterResourcePlacementOverridden
    ...
  Observed Resource Index:  0
  Placement Statuses:
    Applicable Resource Overrides:
      Name:        example-ro-0
      Namespace:   test-namespace
    Cluster Name:  member-50
    Conditions:
      ...
      Message:               Successfully applied the override rules on the resources
      Observed Generation:   1
      Reason:                OverriddenSucceeded
      Status:                True
      Type:                  Overridden
     ...
</code></pre><p>Each cluster maintains its own <code>Applicable Resource Overrides</code> which contain the resource override snapshot and
the resource override namespace if relevant. Additionally, individual status messages for each cluster indicates
whether the override rules have been effectively applied.</p><p>The <code>ClusterResourcePlacementOverridden</code> condition indicates whether the resource override has been successfully applied
to the selected resources in the selected clusters.</p><p>To verify that the <code>ResourceOverride</code> object has been successfully applied to the selected resources,
check resources in the selected clusters:</p><ol><li>Get cluster credentials:
<code>az aks get-credentials --resource-group &lt;resource-group> --name &lt;cluster-name></code></li><li>Get the <code>Deployment</code> object in the selected cluster:
<code>kubectl --context=&lt;member-cluster-context> get deployment my-deployment -n test-namespace -o yaml</code></li></ol><p>Upon inspecting the member cluster, it was found that the selected cluster had the label env: prod.
Consequently, the image on deployment <code>my-deployment</code> was modified to be <code>nginx:1.20.0</code> on selected cluster.</p><pre tabindex=0><code>apiVersion: apps/v1
 kind: Deployment
 metadata:
   ...
   name: my-deployment
   namespace: test-namespace
   ...
 spec:
   ...
   template:
     ...
     spec:
       containers:
       - image: nginx:1.20.0
         imagePullPolicy: IfNotPresent
         name: nginx
         ports:
        ...
       ...
 status:
     ...
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-b44fd8dfb69a651370335b35322594c6>3.10 - Using Envelope Objects to Place Resources</h1><div class=lead>How to use envelope objects with the ClusterResourcePlacement API</div><h2 id=propagating-resources-with-envelope-objects>Propagating Resources with Envelope Objects</h2><p>This guide provides instructions on propagating a set of resources from the hub cluster to joined member clusters within an envelope object.</p><h2 id=why-use-envelope-objects>Why Use Envelope Objects?</h2><p>When propagating resources to member clusters using Fleet, it&rsquo;s important to understand that the hub cluster itself is also a Kubernetes cluster. Without envelope objects, any resource you want to propagate would first be applied directly to the hub cluster, which can lead to some potential side effects:</p><ol><li><p><strong>Unintended Side Effects</strong>: Resources like ValidatingWebhookConfigurations, MutatingWebhookConfigurations, or Admission Controllers would become active on the hub cluster, potentially intercepting and affecting hub cluster operations.</p></li><li><p><strong>Security Risks</strong>: RBAC resources (Roles, ClusterRoles, RoleBindings, ClusterRoleBindings) intended for member clusters could grant unintended permissions on the hub cluster.</p></li><li><p><strong>Resource Limitations</strong>: ResourceQuotas, FlowSchema or LimitRanges defined for member clusters would take effect on the hub cluster. While this is generally not a critical issue, there may be cases where you want to avoid these constraints on the hub.</p></li></ol><p>Envelope objects solve these problems by allowing you to define resources that should be propagated without actually deploying their contents on the hub cluster. The envelope object itself is applied to the hub, but the resources it contains are only extracted and applied when they reach the member clusters.</p><h2 id=envelope-objects-with-crds>Envelope Objects with CRDs</h2><p>Fleet now supports two types of envelope Custom Resource Definitions (CRDs) for propagating resources:</p><ol><li><strong>ClusterResourceEnvelope</strong>: Used to wrap cluster-scoped resources for placement.</li><li><strong>ResourceEnvelope</strong>: Used to wrap namespace-scoped resources for placement.</li></ol><p>These CRDs provide a more structured and Kubernetes-native way to package resources for propagation to member clusters without causing unintended side effects on the hub cluster.</p><h3 id=clusterresourceenvelope-example>ClusterResourceEnvelope Example</h3><p>The <code>ClusterResourceEnvelope</code> is a cluster-scoped resource that can only wrap other cluster-scoped resources. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourceEnvelope</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#4e9a06>&#34;webhook.yaml&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>admissionregistration.k8s.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ValidatingWebhookConfiguration</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>guard</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>webhooks</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>guard.example.com</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>operations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;CREATE&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>apiGroups</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;*&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>apiVersions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;*&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;*&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clientConfig</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>service</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>guard</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ops</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>admissionReviewVersions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;v1&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>sideEffects</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>None</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>timeoutSeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#4e9a06>&#34;clusterrole.yaml&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rbac.authorization.k8s.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterRole</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>pod-reader</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>apiGroups</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;pods&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>verbs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;get&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;list&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;watch&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=resourceenvelope-example>ResourceEnvelope Example</h3><p>The <code>ResourceEnvelope</code> is a namespace-scoped resource that can only wrap namespace-scoped resources. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceEnvelope</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#4e9a06>&#34;cm.yaml&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ConfigMap</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>config</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>foo</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>bar</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#4e9a06>&#34;deploy.yaml&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ingress</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>replicas</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>selector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>template</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>containers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>web</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=propagating-envelope-objects-from-hub-cluster-to-member-cluster>Propagating envelope objects from hub cluster to member cluster</h2><p>We apply our envelope objects on the hub cluster and then use a <code>ClusterResourcePlacement</code> object to propagate these resources from the hub to member clusters.</p><h3 id=example-crp-spec-for-propagating-a-resourceenvelope>Example CRP spec for propagating a ResourceEnvelope:</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-with-envelope</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusterNames</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickFixed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>revisionHistoryLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=example-crp-spec-for-propagating-a-clusterresourceenvelope>Example CRP spec for propagating a ClusterResourceEnvelope:</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-with-cluster-envelop</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusterNames</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickFixed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourceEnvelope</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>revisionHistoryLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=crp-status-for-resourceenvelope>CRP status for ResourceEnvelope:</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-11-30T19:54:13Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all the clusters needed as specified by the scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-11-30T19:54:18Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All 1 cluster(s) are synchronized to the latest resources on the hub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>cluster</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SynchronizeSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-11-30T19:54:18Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully applied resources to 1 member clusters</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementStatuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-11-30T19:54:13Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>&#39;Successfully scheduled resources for placement in kind-cluster-1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ScheduleSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-11-30T19:54:18Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully Synchronized work(s) for placement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronizeSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-11-30T19:54:18Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully applied resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceEnvelope</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><blockquote><p><strong>Note:</strong> In the <code>selectedResources</code> section, we specifically display the propagated envelope object. We do not individually list all the resources contained within the envelope object in the status.</p></blockquote><p>Upon inspection of the <code>selectedResources</code>, it indicates that the namespace <code>app</code> and the ResourceEnvelope <code>example</code> have been successfully propagated. Users can further verify the successful propagation of resources contained within the envelope object by ensuring that the <code>failedPlacements</code> section in the <code>placementStatus</code> for the target cluster does not appear in the status.</p><h2 id=example-crp-status-where-resources-within-an-envelope-object-failed-to-apply>Example CRP status where resources within an envelope object failed to apply</h2><h3 id=crp-status-with-failed-resourceenvelope-resource>CRP status with failed ResourceEnvelope resource:</h3><p>In the example below, within the <code>placementStatus</code> section for <code>kind-cluster-1</code>, the <code>failedPlacements</code> section provides details on a resource that failed to apply along with information about the envelope object which contained the resource.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-12-06T00:09:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all the clusters needed as specified by the scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-12-06T00:09:58Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All 1 cluster(s) are synchronized to the latest resources on the hub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>cluster</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SynchronizeSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-12-06T00:09:58Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Failed to apply manifests to 1 clusters, please check the `failedPlacements`</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>status</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplyFailed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementStatuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-12-06T00:09:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>&#39;Successfully scheduled resources for placement in kind-cluster-1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ScheduleSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-12-06T00:09:58Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully Synchronized work(s) for placement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronizeSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-12-06T00:09:58Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Failed to apply manifests, please check the `failedPlacements` status</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplyFailed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>failedPlacements</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>condition</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-12-06T00:09:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message: &#39;Failed to apply manifest</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>namespaces &#34;app&#34; not found&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AppliedManifestFailedReason</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>envelope</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceEnvelope</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ingress</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceEnvelope</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=crp-status-with-failed-clusterresourceenvelope-resource>CRP status with failed ClusterResourceEnvelope resource:</h3><p>Similar to namespace-scoped resources, cluster-scoped resources within a ClusterResourceEnvelope can also fail to apply:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-12-06T00:09:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all the clusters needed as specified by the scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-12-06T00:09:58Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Failed to apply manifests to 1 clusters, please check the `failedPlacements`</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>status</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplyFailed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementStatuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-12-06T00:09:58Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Failed to apply manifests, please check the `failedPlacements` status</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplyFailed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>failedPlacements</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>condition</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-12-06T00:09:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message: &#39;Failed to apply manifest</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>service &#34;guard&#34; not found in namespace &#34;ops&#34;&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AppliedManifestFailedReason</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>envelope</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourceEnvelope</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ValidatingWebhookConfiguration</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>guard</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>admissionregistration.k8s.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourceEnvelope</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-9e6acaf2aaf7ab5737e91dce54ade3d3>3.11 - Controlling How Fleet Handles Pre-Existing Resources</h1><div class=lead>How to fine-tune the way Fleet handles pre-existing resources</div><p>This guide provides an overview on how to set up Fleet&rsquo;s takeover experience, which allows
developers and admins to choose what will happen when Fleet encounters a pre-existing resource.
This occurs most often in the Fleet adoption scenario, where a cluster just joins into a fleet and
the system finds out that the resources to place onto the new member cluster via the CRP API have
already been running there.</p><p>A concern commonly associated with this scenario is that the running (pre-existing) set of
resources might have configuration differences from their equivalents on the hub cluster,
for example: On the hub cluster one might have a namespace <code>work</code> where it hosts a deployment
<code>web-server</code> that runs the image <code>rpd-stars:latest</code>; while on the member cluster in the same
namespace lives a deployment of the same name but with the image <code>umbrella-biolab:latest</code>.
If Fleet applies the resource template from the hub cluster, unexpected service interruptions
might occur.</p><p>To address this concern, Fleet also introduces a new field, <code>whenToTakeOver</code>, in the apply
strategy. Three options are available:</p><ul><li><code>Always</code>: This is the default option ðŸ˜‘. With this setting, Fleet will take over a
pre-existing resource as soon as it encounters it. Fleet will apply the corresponding
resource template from the hub cluster, and any value differences in the managed fields
will be overwritten. This is consistent with the behavior before the new takeover experience is
added.</li><li><code>IfNoDiff</code>: This is the new option âœ¨ provided by the takeover mechanism. With this setting,
Fleet will check for configuration differences when it finds a pre-existing resource and
will only take over the resource (apply the resource template) if no configuration
differences are found. Consider using this option for a safer adoption journey.</li><li><code>Never</code>: This is another new option âœ¨ provided by the takeover mechanism. With this setting,
Fleet will ignore pre-existing resources and no apply op will be performed. This will be considered
as an apply error. Use this option if you would like to check for the presence of pre-existing
resources without taking any action.</li></ul><blockquote><p>Before you begin</p><p>The new takeover experience is currently in preview.</p><p>Note that the APIs for the new experience are only available in the Fleet v1beta1 API, not the v1 API. If you do not see the new APIs in command outputs, verify that you are explicitly requesting the v1beta1 API objects, as opposed to the v1 API objects (the default).</p></blockquote><h2 id=how-fleet-can-be-used-to-safely-take-over-pre-existing-resources>How Fleet can be used to safely take over pre-existing resources</h2><p>The steps below explain how the takeover experience functions. The code assumes that you have
a fleet of two clusters, <code>member-1</code> and <code>member-2</code>:</p><ul><li><p>Switch to the second member cluster, and create a namespace, <code>work-2</code>, with labels:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context member-2-admin
</span></span><span style=display:flex><span>kubectl create ns work-2
</span></span><span style=display:flex><span>kubectl label ns work-2 <span style=color:#000>app</span><span style=color:#ce5c00;font-weight:700>=</span>work-2
</span></span><span style=display:flex><span>kubectl label ns work-2 <span style=color:#000>owner</span><span style=color:#ce5c00;font-weight:700>=</span>wesker
</span></span></code></pre></div></li><li><p>Switch to the hub cluster, and create the same namespace, but with a slightly different set of labels:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context hub-admin
</span></span><span style=display:flex><span>kubectl create ns work-2
</span></span><span style=display:flex><span>kubectl label ns work-2 <span style=color:#000>app</span><span style=color:#ce5c00;font-weight:700>=</span>work-2
</span></span><span style=display:flex><span>kubectl label ns work-2 <span style=color:#000>owner</span><span style=color:#ce5c00;font-weight:700>=</span>redfield
</span></span></code></pre></div></li><li><p>Create a CRP object that places the namespace to all member clusters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat <span style=color:#4e9a06>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#4e9a06># The YAML configuration of the CRP object.
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterResourcePlacement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: work-2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSelectors:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - group: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      kind: Namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      version: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      # Select all namespaces with the label app=work. 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          app: work-2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  policy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    placementType: PickAll
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  strategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # For simplicity reasons, the CRP is configured to roll out changes to
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # all member clusters at once. This is not a setup recommended for production
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # use.      
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: RollingUpdate
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    rollingUpdate:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      maxUnavailable: 100%
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      unavailablePeriodSeconds: 1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    applyStrategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      whenToTakeOver: Never
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div></li><li><p>Give Fleet a few seconds to handle the placement. Check the status of the CRP object; you should see a failure there that complains about an apply error on the cluster <code>member-2</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get clusterresourceplacement.v1beta1.placement.kubernetes-fleet.io work -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.status.placementStatuses}&#39;</span> <span style=color:#000;font-weight:700>|</span> jq
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># The command above uses JSON paths to query the relevant status information</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># directly and uses the jq utility to pretty print the output JSON.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># jq might not be available in your environment. You may have to install it</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># separately, or omit it from the command.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># If the output is empty, the status might have not been populated properly</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># yet. Retry in a few seconds; you may also want to switch the output type</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># from jsonpath to yaml to see the full object.</span>
</span></span></code></pre></div><p>The output should look like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;clusterName&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;member-1&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;conditions&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>        <span style=color:#a40000>...</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#a40000>...</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;status&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Applied&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>,</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;clusterName&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;member-2&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;conditions&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>        <span style=color:#a40000>...</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#a40000>...</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;status&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Applied&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>],</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;failedPlacements&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#a40000>...</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div></li><li><p>You can take a look at the <code>failedPlacements</code> part in the placement status for error details:</p><p>The output should look like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;condition&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;lastTransitionTime&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;message&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Failed to apply the manifest (error: no ownership of the object in the member cluster; takeover is needed)&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;reason&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;NotTakenOver&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;status&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Applied&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;kind&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Namespace&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;work-2&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;version&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;v1&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>]</span>
</span></span></code></pre></div><p>Fleet finds out that the namespace <code>work-2</code> already exists on the member cluster, and
it is not owned by Fleet; since the takeover policy is set to <code>Never</code>, Fleet will not assume
ownership of the namespace; no apply will be performed and an apply error will be raised
instead.</p><p>The following <code>jq</code> query can help you better locate clusters with failed placements and their
failure details:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get clusterresourceplacement.v1beta1.placement.kubernetes-fleet.io work -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.status.placementStatuses}&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;[.[] | select (.failedPlacements != null)] | map({clusterName, failedPlacements})&#39;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># The command above uses JSON paths to retrieve the relevant status information</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># directly and uses the jq utility to query the data.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># jq might not be available in your environment. You may have to install it</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># separately, or omit it from the command.</span>
</span></span></code></pre></div><p>It would filter out all the clusters that do not have failures and report only
the failed clusters with the failure details:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;clusterName&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;member-2&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;failedPlacements&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;condition&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&#34;lastTransitionTime&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&#34;message&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Failed to apply the manifest (error: no ownership of the object in the member cluster; takeover is needed)&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&#34;reason&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;NotTakenOver&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&#34;status&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&#34;type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Applied&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;kind&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Namespace&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;work-2&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;version&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;v1&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div></li><li><p>Next, update the CRP object and set the <code>whenToTakeOver</code> field to <code>IfNoDiff</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat <span style=color:#4e9a06>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#4e9a06># The YAML configuration of the CRP object.
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterResourcePlacement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: work-2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSelectors:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - group: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      kind: Namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      version: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      # Select all namespaces with the label app=work. 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          app: work-2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  policy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    placementType: PickAll
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  strategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # For simplicity reasons, the CRP is configured to roll out changes to
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # all member clusters at once. This is not a setup recommended for production
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # use.      
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: RollingUpdate
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    rollingUpdate:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      maxUnavailable: 100%
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      unavailablePeriodSeconds: 1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    applyStrategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      whenToTakeOver: IfNoDiff
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div></li><li><p>Give Fleet a few seconds to handle the placement. Check the status of the CRP object; you should see the apply op still fails.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get clusterresourceplacement.v1beta1.placement.kubernetes-fleet.io work-2
</span></span></code></pre></div></li><li><p>Verify the error details reported in the <code>failedPlacements</code> field for another time:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get clusterresourceplacement.v1beta1.placement.kubernetes-fleet.io work -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.status.placementStatuses}&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;[.[] | select (.failedPlacements != null)] | map({clusterName, failedPlacements})&#39;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># The command above uses JSON paths to retrieve the relevant status information</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># directly and uses the jq utility to query the data.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># jq might not be available in your environment. You may have to install it</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># separately, or omit it from the command.</span>
</span></span></code></pre></div><p>The output has changed:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;clusterName&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;member-2&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;failedPlacements&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;condition&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&#34;lastTransitionTime&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&#34;message&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Failed to apply the manifest (error: cannot take over object: configuration differences are found between the manifest object and the corresponding object in the member cluster)&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&#34;reason&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;FailedToTakeOver&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&#34;status&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&#34;type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Applied&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;kind&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Namespace&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;work-2&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;version&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;v1&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Now, with the takeover policy set to <code>IfNoDiff</code>, Fleet can assume ownership of pre-existing
resources; however, as a configuration difference has been found between the hub cluster
and the member cluster, takeover is blocked.</p></li><li><p>Similar to the drift detection mechanism, Fleet will report details about the found
configuration differences as well. You can learn about them in the <code>diffedPlacements</code> part
of the status.</p><p>Use the <code>jq</code> query below to list all clusters with the <code>diffedPlacements</code> status information
populated:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get clusterresourceplacement.v1beta1.placement.kubernetes-fleet.io work -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.status.placementStatuses}&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;[.[] | select (.diffedPlacements != null)] | map({clusterName, diffedPlacements})&#39;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># The command above uses JSON paths to retrieve the relevant status information</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># directly and uses the jq utility to query the data.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># jq might not be available in your environment. You may have to install it</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># separately, or omit it from the command.</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;clusterName&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;member-2&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;diffedPlacements&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;firstDiffedObservedTime&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;group&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;version&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;v1&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;kind&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Namespace&#34;</span><span style=color:#000;font-weight:700>,</span>    
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;work-2&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;observationTime&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;observedDiffs&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87;font-weight:700>&#34;path&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;/metadata/labels/owner&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87;font-weight:700>&#34;valueInHub&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;redfield&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87;font-weight:700>&#34;valueInMember&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;wesker&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>],</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;targetClusterObservedGeneration&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>0</span>    
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Fleet will report the following information about a configuration difference:</p><ul><li><code>group</code>, <code>kind</code>, <code>version</code>, <code>namespace</code>, and <code>name</code>: the resource that has configuration differences.</li><li><code>observationTime</code>: the timestamp where the current diff detail is collected.</li><li><code>firstDiffedObservedTime</code>: the timestamp where the current diff is first observed.</li><li><code>observedDiffs</code>: the diff details, specifically:<ul><li><code>path</code>: A JSON path (RFC 6901) that points to the diff&rsquo;d field;</li><li><code>valueInHub</code>: the value at the JSON path as seen from the hub cluster resource template
(the desired state). If this value is absent, the field does not exist in the resource template.</li><li><code>valueInMember</code>: the value at the JSON path as seen from the member cluster resource
(the current state). If this value is absent, the field does not exist in the current state.</li></ul></li><li><code>targetClusterObservedGeneration</code>: the generation of the member cluster resource.</li></ul></li><li><p>To fix the configuration difference, consider one of the following options:</p><ul><li>Switch the <code>whenToTakeOver</code> setting back to <code>Always</code>, which will instruct Fleet to take over the resource right away and overwrite all configuration differences; or</li><li>Edit the diff&rsquo;d field directly on the member cluster side, so that the value is consistent with that on the hub cluster; Fleet will periodically re-evaluate diffs and should take over the resource soon after.</li><li>Delete the resource from the member cluster. Fleet will then re-apply the resource template and re-create the resource.</li></ul><p>Here the guide will take the first option available, setting the <code>whenToTakeOver</code> field to
<code>Always</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat <span style=color:#4e9a06>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#4e9a06># The YAML configuration of the CRP object.
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterResourcePlacement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: work-2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSelectors:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - group: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      kind: Namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      version: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      # Select all namespaces with the label app=work. 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          app: work-2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  policy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    placementType: PickAll
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  strategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # For simplicity reasons, the CRP is configured to roll out changes to
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # all member clusters at once. This is not a setup recommended for production
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # use.      
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: RollingUpdate
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    rollingUpdate:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      maxUnavailable: 100%
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      unavailablePeriodSeconds: 1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    applyStrategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      whenToTakeOver: Always
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div></li><li><p>Check the CRP status; in a few seconds, Fleet will report that all objects have been applied.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get clusterresourceplacement.v1beta1.placement.kubernetes-fleet.io work-2
</span></span></code></pre></div><p>If you switch to the member cluster <code>member-2</code> now, you should see that the object looks
exactly the same as the resource template kept on the hub cluster; the owner label has been
over-written.</p></li></ul><blockquote><p>Important</p><p>When Fleet fails to take over an object, the pre-existing resource will not be put under Fleet&rsquo;s management: any change made on the hub cluster side will have no effect on the pre-existing resource. If you choose to delete the resource template, or remove the CRP object, Fleet will not attempt to delete the pre-existing resource.</p></blockquote><h2 id=takeover-and-comparison-options>Takeover and comparison options</h2><p>Fleet provides a <code>comparisonOptions</code> setting that allows you to fine-tune how Fleet calculates configuration differences between a resource template created on the hub cluster and the corresponding pre-existing resource on a member cluster.</p><blockquote><p>Note</p><p>The <code>comparisonOptions</code> setting also controls how Fleet detects drifts. See the how-to guide on drift detection for more information.</p></blockquote><p>If <code>partialComparison</code> is used, Fleet will only report configuration differences in managed fields, i.e., fields that are explicitly specified in the resource template; the presence of additional fields on the member cluster side will not stop Fleet from taking over the pre-existing resource; on the contrary, with <code>fullComparison</code>, Fleet will only take over a pre-existing resource if it looks exactly the same as its hub cluster counterpart.</p><p>Below is a table that summarizes the combos of different options and their respective effects:</p><table><thead><tr><th><code>whenToTakeOver</code> setting</th><th><code>comparisonOption</code> setting</th><th>Configuration difference scenario</th><th>Outcome</th></tr></thead><tbody><tr><td><code>IfNoDiff</code></td><td><code>partialComparison</code></td><td>There exists a value difference in a managed field between a pre-existing resource on a member cluster and the hub cluster resource template.</td><td>Fleet will report an apply error in the status, plus the diff details.</td></tr><tr><td><code>IfNoDiff</code></td><td><code>partialComparison</code></td><td>The pre-existing resource has a field that is absent on the hub cluster resource template.</td><td>Fleet will take over the resource; the configuration difference in the unmanaged field will be left untouched.</td></tr><tr><td><code>IfNoDiff</code></td><td><code>fullComparison</code></td><td><strong>Difference has been found on a field, managed or not.</strong></td><td>Fleet will report an apply error in the status, plus the diff details.</td></tr><tr><td><code>Always</code></td><td>Any option</td><td>Difference has been found on a field, managed or not.</td><td>Fleet will take over the resource; configuration differences in unmanaged fields will be left untouched.</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-934276b9448b25f33e6f2421e293bbf7>3.12 - Enabling Drift Detection in Fleet</h1><div class=lead>How to enable drift detection in Fleet</div><p>This guide provides an overview on how to enable drift detection in Fleet. This feature can help
developers and admins identify (and act upon) configuration drifts in their KubeFleet system,
which are often brought by temporary fixes, inadvertent changes, and failed automations.</p><blockquote><p>Before you begin</p><p>The new drift detection experience is currently in preview.</p><p>Note that the APIs for the new experience are only available in the Fleet v1beta1 API, not the v1 API. If you do not see the new APIs in command outputs, verify that you are explicitly requesting the v1beta1 API objects, as opposed to the v1 API objects (the default).</p></blockquote><h2 id=what-is-a-drift>What is a drift?</h2><p>A drift occurs when a non-Fleet agent (e.g., a developer or a controller) makes changes to
a field of a Fleet-managed resource directly on the member cluster side without modifying
the corresponding resource template created on the hub cluster.</p><p>See the steps below for an example; the code assumes that you have a Fleet of two clusters,
<code>member-1</code> and <code>member-2</code>.</p><ul><li><p>Switch to the hub cluster in the preview environment:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context hub-admin
</span></span></code></pre></div></li><li><p>Create a namespace, <code>work</code>, on the hub cluster, with some labels:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl create ns work
</span></span><span style=display:flex><span>kubectl label ns work <span style=color:#000>app</span><span style=color:#ce5c00;font-weight:700>=</span>work
</span></span><span style=display:flex><span>kubectl label ns work <span style=color:#000>owner</span><span style=color:#ce5c00;font-weight:700>=</span>redfield
</span></span></code></pre></div></li><li><p>Create a CRP object, which places the namespace on all member clusters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat <span style=color:#4e9a06>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#4e9a06># The YAML configuration of the CRP object.
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterResourcePlacement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: work
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSelectors:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - group: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      kind: Namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      version: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      # Select all namespaces with the label app=work.      
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          app: work
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  policy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    placementType: PickAll
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  strategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # For simplicity reasons, the CRP is configured to roll out changes to
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # all member clusters at once. This is not a setup recommended for production
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # use.         
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: RollingUpdate
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    rollingUpdate:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      maxUnavailable: 100%
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      unavailablePeriodSeconds: 1            
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div></li><li><p>Fleet should be able to finish the placement within seconds. To verify the progress, run the command below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get clusterresourceplacement.v1beta1.placement.kubernetes-fleet.io work
</span></span></code></pre></div><p>Confirm that in the output, Fleet has reported that the placement is of the <code>Available</code> state.</p></li><li><p>Switch to the first member cluster, <code>member-1</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context member-1-admin
</span></span></code></pre></div></li><li><p>You should see the namespace, <code>work</code>, being placed in this member cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get ns work --show-labels
</span></span></code></pre></div><p>The output should look as follows; note that all the labels have been set
(the <code>kubernetes.io/metadata.name</code> label is added by the Kubernetes system automatically):</p><pre tabindex=0><code>NAME     STATUS   AGE   LABELS
work     Active   91m   app=work,owner=redfield,kubernetes.io/metadata.name=work
</code></pre></li><li><p>Anyone with proper access to the member cluster could modify the namespace as they want;
for example, one can set the <code>owner</code> label to a different value:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl label ns work <span style=color:#000>owner</span><span style=color:#ce5c00;font-weight:700>=</span>wesker --overwrite
</span></span><span style=display:flex><span>kubectl label ns work <span style=color:#000>use</span><span style=color:#ce5c00;font-weight:700>=</span>hack --overwrite
</span></span></code></pre></div><p><strong>Now the namespace has drifted from its intended state.</strong></p></li></ul><p>Note that drifts are not necessarily a bad thing: to ensure system availability, often developers
and admins would need to make ad-hoc changes to the system; for example, one might need to set a
Deployment on a member cluster to use a different image from its template (as kept on the hub
cluster) to test a fix. In the current version of Fleet, the system is not drift-aware, which
means that Fleet will simply re-apply the resource template periodically with or without drifts.</p><p>In the case above:</p><ul><li><p>Since the owner label has been set on the resource template, its value would be overwritten by
Fleet, from <code>wesker</code> to <code>redfield</code>, within minutes. This provides a great consistency guarantee
but also blocks out all possibilities of expedient fixes/changes, which can be an inconvenience at times.</p></li><li><p>The <code>use</code> label is not a part of the resource template, so it will not be affected by any
apply op performed by Fleet. Its prolonged presence might pose an issue, depending on the
nature of the setup.</p></li></ul><h2 id=how-fleet-can-be-used-to-handle-drifts-gracefully>How Fleet can be used to handle drifts gracefully</h2><p>Fleet aims to provide an experience that:</p><ul><li>âœ… allows developers and admins to make changes on the member cluster side when necessary; and</li><li>âœ… helps developers and admins to detect drifts, esp. long-living ones, in their systems,
so that they can be handled properly; and</li><li>âœ… grants developers and admins great flexibility on when and how drifts should be handled.</li></ul><p>To enable the new experience, set proper apply strategies in the CRP object, as
illustrated by the steps below:</p><ul><li><p>Switch to the hub cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context hub-admin
</span></span></code></pre></div></li><li><p>Update the existing CRP (<code>work</code>), to use an apply strategy with the <code>whenToApply</code> field set to
<code>IfNotDrifted</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat <span style=color:#4e9a06>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#4e9a06># The YAML configuration of the CRP object.
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterResourcePlacement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: work
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSelectors:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - group: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      kind: Namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      version: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      # Select all namespaces with the label app=work. 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          app: work
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  policy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    placementType: PickAll
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  strategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    applyStrategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      whenToApply: IfNotDrifted
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # For simplicity reasons, the CRP is configured to roll out changes to
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # all member clusters at once. This is not a setup recommended for production
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # use.      
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: RollingUpdate
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    rollingUpdate:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      maxUnavailable: 100%
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      unavailablePeriodSeconds: 1                
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><p>The <code>whenToApply</code> field features two options:</p><ul><li><code>Always</code>: this is the default option ðŸ˜‘. With this setting, Fleet will periodically apply
the resource templates from the hub cluster to member clusters, with or without drifts.
This is consistent with the behavior before the new drift detection and takeover experience.</li><li><code>IfNotDrifted</code>: this is the new option âœ¨ provided by the drift detection mechanism. With
this setting, Fleet will check for drifts periodically; if drifts are found, Fleet will stop
applying the resource templates and report in the CRP status.</li></ul></li><li><p>Switch to the first member cluster and edit the labels for a second time, effectively re-introducing
a drift in the system. After it&rsquo;s done, switch back to the hub cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context member-1-admin
</span></span><span style=display:flex><span>kubectl label ns work <span style=color:#000>owner</span><span style=color:#ce5c00;font-weight:700>=</span>wesker --overwrite
</span></span><span style=display:flex><span>kubectl label ns work <span style=color:#000>use</span><span style=color:#ce5c00;font-weight:700>=</span>hack --overwrite
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span>kubectl config use-context hub-admin
</span></span></code></pre></div></li><li><p>Fleet should be able to find the drifts swiftly (w/in a few seconds). Inspect the placement status Fleet
reports for each cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get clusterresourceplacement.v1beta1.placement.kubernetes-fleet.io work -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.status.placementStatuses}&#39;</span> <span style=color:#000;font-weight:700>|</span> jq
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># The command above uses JSON paths to query the relevant status information</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># directly and uses the jq utility to pretty print the output JSON.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># jq might not be available in your environment. You may have to install it</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># separately, or omit it from the command.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># If the output is empty, the status might have not been populated properly</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># yet. Retry in a few seconds; you may also want to switch the output type</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># from jsonpath to yaml to see the full object.</span>
</span></span></code></pre></div><p>The output should look like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>{<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>&#34;clusterName&#34;: </span><span style=color:#4e9a06>&#34;member-1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>&#34;conditions&#34;: </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>{<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;status&#34;: </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;type&#34;: </span><span style=color:#4e9a06>&#34;Applied&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000;font-weight:700>],</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>&#34;driftedPlacements&#34;: </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>{<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;firstDriftedObservedTime&#34;: </span><span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;kind&#34;: </span><span style=color:#4e9a06>&#34;Namespace&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;name&#34;: </span><span style=color:#4e9a06>&#34;work&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;observationTime&#34;: </span><span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;observedDrifts&#34;: </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span>{<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>&#34;path&#34;: </span><span style=color:#4e9a06>&#34;/metadata/labels/owner&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>&#34;valueInHub&#34;: </span><span style=color:#4e9a06>&#34;redfield&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>&#34;valueInMember&#34;: </span><span style=color:#4e9a06>&#34;wesker&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span>}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#000;font-weight:700>],</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;targetClusterObservedGeneration&#34;: </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;version&#34;: </span><span style=color:#4e9a06>&#34;v1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000;font-weight:700>],</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>&#34;failedPlacements&#34;: </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>{<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;condition&#34;: </span>{<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>&#34;lastTransitionTime&#34;: </span><span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>&#34;message&#34;: </span><span style=color:#4e9a06>&#34;Failed to apply the manifest (error: cannot apply manifest: drifts are found between the manifest and the object from the member cluster)&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>&#34;reason&#34;: </span><span style=color:#4e9a06>&#34;FoundDrifts&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>&#34;status&#34;: </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>&#34;type&#34;: </span><span style=color:#4e9a06>&#34;Applied&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>}<span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;kind&#34;: </span><span style=color:#4e9a06>&#34;Namespace&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;name&#34;: </span><span style=color:#4e9a06>&#34;work&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;version&#34;: </span><span style=color:#4e9a06>&#34;v1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>}<span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>{<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>&#34;clusterName&#34;: </span><span style=color:#4e9a06>&#34;member-2&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>&#34;conditions&#34;: </span><span style=color:#000;font-weight:700>[</span><span style=color:#000>...]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>You should see that cluster <code>member-1</code> has encountered an apply failure. The
<code>failedPlacements</code> part explains exactly which manifests have failed on <code>member-1</code>
and its reason; in this case, the apply op fails as Fleet finds out that the namespace
<code>work</code> has drifted from its intended state. The <code>driftedPlacements</code> part specifies in
detail which fields have drifted and the value differences between the hub
cluster and the member cluster.</p><p>Fleet will report the following information about a drift:</p><ul><li><code>group</code>, <code>kind</code>, <code>version</code>, <code>namespace</code>, and <code>name</code>: the resource that has drifted from its desired state.</li><li><code>observationTime</code>: the timestamp where the current drift detail is collected.</li><li><code>firstDriftedObservedTime</code>: the timestamp where the current drift is first observed.</li><li><code>observedDrifts</code>: the drift details, specifically:<ul><li><code>path</code>: A JSON path (RFC 6901) that points to the drifted field;</li><li><code>valueInHub</code>: the value at the JSON path as seen from the hub cluster resource template
(the desired state). If this value is absent, the field does not exist in the resource template.</li><li><code>valueInMember</code>: the value at the JSON path as seen from the member cluster resource
(the current state). If this value is absent, the field does not exist in the current state.</li></ul></li><li><code>targetClusterObservedGeneration</code>: the generation of the member cluster resource.</li></ul><p>The following <code>jq</code> query can help you better extract the drifted clusters and the drift
details from the CRP status output:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get clusterresourceplacement.v1beta1.placement.kubernetes-fleet.io work -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.status.placementStatuses}&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;[.[] | select (.driftedPlacements != null)] | map({clusterName, driftedPlacements})&#39;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># The command above uses JSON paths to query the relevant status information</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># directly and uses the jq utility to pretty print the output JSON.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># jq might not be available in your environment. You may have to install it</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># separately, or omit it from the command.</span>
</span></span></code></pre></div><p>This query would filter out all the clusters that do not have drifts and report only
the drifted clusters with the drift details:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>{<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>&#34;clusterName&#34;: </span><span style=color:#4e9a06>&#34;member-1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>&#34;driftedPlacements&#34;: </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>{<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;firstDriftedObservedTime&#34;: </span><span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;kind&#34;: </span><span style=color:#4e9a06>&#34;Namespace&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;name&#34;: </span><span style=color:#4e9a06>&#34;work&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;observationTime&#34;: </span><span style=color:#4e9a06>&#34;...&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;observedDrifts&#34;: </span><span style=color:#000;font-weight:700>[</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span>{<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>&#34;path&#34;: </span><span style=color:#4e9a06>&#34;/metadata/labels/owner&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>&#34;valueInHub&#34;: </span><span style=color:#4e9a06>&#34;redfield&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>&#34;valueInMember&#34;: </span><span style=color:#4e9a06>&#34;wesker&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span>}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#000;font-weight:700>],</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;targetClusterObservedGeneration&#34;: </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>&#34;version&#34;: </span><span style=color:#4e9a06>&#34;v1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div></li><li><p>To fix the drift, consider one of the following options:</p><ul><li>Switch the <code>whenToApply</code> setting back to <code>Always</code>, which will instruct Fleet to overwrite
the drifts using values from the hub cluster resource template; or</li><li>Edit the drifted field directly on the member cluster side, so that the value is
consistent with that on the hub cluster; Fleet will periodically re-evaluate drifts
and should report that no drifts are found soon after.</li><li>Delete the resource from the member cluster. Fleet will then re-apply the resource
template and re-create the resource.</li></ul><blockquote><p>Important:</p><p>The presence of drifts will <strong>NOT</strong> stop Fleet from rolling out newer resource versions. If you choose to edit the resource template on the hub cluster, Fleet will always apply the new resource template in the rollout process, which may also resolve the drift.</p></blockquote></li></ul><h2 id=comparison-options>Comparison options</h2><p>One may have found out that the namespace on the member cluster has another drift, the
label <code>use=hack</code>, which is not reported in the CRP status by Fleet. This is because by default
Fleet compares only managed fields, i.e., fields that are explicitly specified in the resource
template. If a field is not populated on the hub cluster side, Fleet will not recognize its
presence on the member cluster side as a drift. This allows controllers on the member cluster
side to manage some fields automatically without Fleet&rsquo;s involvement; for example, one might would
like to use an HPA solution to auto-scale Deployments as appropriate and consequently decide not
to include the <code>.spec.replicas</code> field in the resource template.</p><p>Fleet recognizes that there might be cases where developers and admins would like to have their
resources look exactly the same across their fleet. If this scenario applies, one might set up
the <code>comparisonOptions</code> field in the apply strategy from the <code>partialComparison</code> value
(the default) to <code>fullComparison</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>work</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>work</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>applyStrategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>whenToApply</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>IfNotDrifted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>comparisonOption</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>fullComparison</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>With this setting, Fleet will recognize the presence of any unmanaged fields (i.e., fields that
are present on the member cluster side, but not set on the hub cluster side) as drifts as well.
If anyone adds a field to a Fleet-managed object directly on the member cluster, it would trigger
an apply error, which you can find out about the details the same way as illustrated in the
section above.</p><h2 id=summary>Summary</h2><p>Below is a summary of the synergy between the <code>whenToApply</code> and <code>comparisonOption</code> settings:</p><table><thead><tr><th><code>whenToApply</code> setting</th><th><code>comparisonOption</code> setting</th><th>Drift scenario</th><th>Outcome</th></tr></thead><tbody><tr><td><code>IfNotDrifted</code></td><td><code>partialComparison</code></td><td>A managed field (i.e., a field that has been explicitly set in the hub cluster resource template) is edited.</td><td>Fleet will report an apply error in the status, plus the drift details.</td></tr><tr><td><code>IfNotDrifted</code></td><td><code>partialComparison</code></td><td>An unmanaged field (i.e., a field that has not been explicitly set in the hub cluster resource template) is edited/added.</td><td>N/A; the change is left untouched, and Fleet will ignore it.</td></tr><tr><td><code>IfNotDrifted</code></td><td><code>fullComparison</code></td><td>Any field is edited/added.</td><td>Fleet will report an apply error in the status, plus the drift details.</td></tr><tr><td><code>Always</code></td><td><code>partialComparison</code></td><td>A managed field (i.e., a field that has been explicitly set in the hub cluster resource template) is edited.</td><td>N/A; the change is overwritten shortly.</td></tr><tr><td><code>Always</code></td><td><code>partialComparison</code></td><td>An unmanaged field (i.e., a field that has not been explicitly set in the hub cluster resource template) is edited/added.</td><td>N/A; the change is left untouched, and Fleet will ignore it.</td></tr><tr><td><code>Always</code></td><td><code>fullComparison</code></td><td>Any field is edited/added.</td><td>The change on managed fields will be overwritten shortly; Fleet will report drift details about changes on unmanaged fields, but this is not considered as an apply error.</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-305fa8c74ee8f62995ad9a0d77561184>3.13 - Using the ReportDiff Apply Mode</h1><div class=lead>How to use the ReportDiff apply mode</div><p>This guide provides an overview on how to use the <code>ReportDiff</code> apply mode, which allows one to
easily evaluate how things will change in the system without the risk of incurring unexpected
changes. In this mode, Fleet will check for configuration differences between the hub cluster
resource templates and their corresponding resources on the member clusters, but will not
perform any apply op. This is most helpful in cases of experimentation and drift/diff analysis.</p><h1 id=how-the-reportdiff-mode-can-help>How the <code>ReportDiff</code> mode can help</h1><p>To use this mode, simply set the <code>type</code> field in the apply strategy part of the CRP API
from <code>ClientSideApply</code> (the default) or <code>ServerSideApply</code> to <code>ReportDiff</code>. Configuration
differences are checked per <code>comparisonOption</code> setting, in consistency with the behavior
documented in the drift detection how-to guide; see the document for more information.</p><p>The steps below might help explain the workflow better; it assumes that you have a fleet
of two member clusters, <code>member-1</code> and <code>member-2</code>:</p><ul><li><p>Switch to the hub cluster and create a namespace, <code>work-3</code>, with some labels.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context hub-admin
</span></span><span style=display:flex><span>kubectl create ns work-3
</span></span><span style=display:flex><span>kubectl label ns work-3 <span style=color:#000>app</span><span style=color:#ce5c00;font-weight:700>=</span>work-3
</span></span><span style=display:flex><span>kubectl label ns work-3 <span style=color:#000>owner</span><span style=color:#ce5c00;font-weight:700>=</span>leon
</span></span></code></pre></div></li><li><p>Create a CRP object that places the namespace to all member clusters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat <span style=color:#4e9a06>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#4e9a06># The YAML configuration of the CRP object.
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterResourcePlacement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: work-3
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSelectors:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - group: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      kind: Namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      version: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      # Select all namespaces with the label app=work-3. 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          app: work-3
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  policy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    placementType: PickAll
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  strategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # For simplicity reasons, the CRP is configured to roll out changes to
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # all member clusters at once. This is not a setup recommended for production
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # use.      
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: RollingUpdate
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    rollingUpdate:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      maxUnavailable: 100%
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      unavailablePeriodSeconds: 1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div></li><li><p>In a few seconds, Fleet will complete the placement. Verify that the CRP is available by checking its status.</p></li><li><p>After the CRP becomes available, edit its apply strategy and set it to use the ReportDiff mode:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat <span style=color:#4e9a06>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#4e9a06># The YAML configuration of the CRP object.
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterResourcePlacement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: work-3
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSelectors:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - group: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      kind: Namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      version: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      # Select all namespaces with the label app=work-3. 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          app: work-3
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  policy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    placementType: PickAll
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  strategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # For simplicity reasons, the CRP is configured to roll out changes to
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # all member clusters at once. This is not a setup recommended for production
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    # use.      
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: RollingUpdate
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    rollingUpdate:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      maxUnavailable: 100%
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      unavailablePeriodSeconds: 1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    applyStrategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      type: ReportDiff   
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div></li><li><p>The CRP should remain available, as currently there is no configuration difference at all.
Check the <code>ClusterResourcePlacementDiffReported</code> condition in the status; it should report no error:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get clusterresourceplacement.v1beta1.placement.kubernetes-fleet.io work-3 -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.status.conditions[?(@.type==&#34;ClusterResourcePlacementDiffReported&#34;)]}&#39;</span> <span style=color:#000;font-weight:700>|</span> jq
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># The command above uses JSON paths to query the drift details directly and</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># uses the jq utility to pretty print the output JSON.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># jq might not be available in your environment. You may have to install it</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># separately, or omit it from the command.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># If the output is empty, the status might have not been populated properly</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># yet. You can switch the output type from jsonpath to yaml to see the full</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># object.</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;lastTransitionTime&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;2025-03-19T06:45:58Z&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;message&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Diff reporting in 2 cluster(s) has been completed&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;observedGeneration&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#a40000>...</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;reason&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;DiffReportingCompleted&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;status&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;ClusterResourcePlacementDiffReported&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div></li><li><p>Now, switch to the second member cluster and make a label change on the applied namespace.
After the change is done, switch back to the hub cluster.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl config use-context member-2-admin
</span></span><span style=display:flex><span>kubectl label ns work-3 <span style=color:#000>owner</span><span style=color:#ce5c00;font-weight:700>=</span>krauser --overwrite
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span>kubectl config use-context hub-admin
</span></span></code></pre></div></li><li><p>Fleet will detect this configuration difference shortly (w/in 15 seconds).
Verify that the diff details have been added to the CRP status, specifically reported
in the <code>diffedPlacements</code> part of the status; the <code>jq</code> query below
will list all the clusters with the <code>diffedPlacements</code> status information populated:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get clusterresourceplacement.v1beta1.placement.kubernetes-fleet.io work-3 -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.status.placementStatuses}&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;[.[] | select (.diffedPlacements != null)] | map({clusterName, diffedPlacements})&#39;</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># The command above uses JSON paths to retrieve the relevant status information</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># directly and uses the jq utility to query the data.</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># jq might not be available in your environment. You may have to install it</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># separately, or omit it from the command.</span>
</span></span></code></pre></div><p>The output should be as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;clusterName&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;member-2&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;diffedPlacements&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;firstDiffedObservedTime&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;2025-03-19T06:49:54Z&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;kind&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Namespace&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;work-3&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;observationTime&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;2025-03-19T06:50:25Z&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;observedDiffs&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87;font-weight:700>&#34;path&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;/metadata/labels/owner&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87;font-weight:700>&#34;valueInHub&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;leon&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87;font-weight:700>&#34;valueInMember&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;krauser&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>],</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;targetClusterObservedGeneration&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;version&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;v1&#34;</span> 
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Fleet will report the following information about a configuration difference:</p><ul><li><code>group</code>, <code>kind</code>, <code>version</code>, <code>namespace</code>, and <code>name</code>: the resource that has configuration differences.</li><li><code>observationTime</code>: the timestamp where the current diff detail is collected.</li><li><code>firstDiffedObservedTime</code>: the timestamp where the current diff is first observed.</li><li><code>observedDiffs</code>: the diff details, specifically:<ul><li><code>path</code>: A JSON path (RFC 6901) that points to the diff&rsquo;d field;</li><li><code>valueInHub</code>: the value at the JSON path as seen from the hub cluster resource template
(the desired state). If this value is absent, the field does not exist in the resource template.</li><li><code>valueInMember</code>: the value at the JSON path as seen from the member cluster resource
(the current state). If this value is absent, the field does not exist in the current state.</li></ul></li><li><code>targetClusterObservedGeneration</code>: the generation of the member cluster resource.</li></ul></li></ul><h2 id=more-information-on-the-reportdiff-mode>More information on the ReportDiff mode</h2><ul><li>As mentioned earlier, with this mode no apply op will be run at all; it is up to the user to
decide the best way to handle found configuration differences (if any).</li><li>Diff reporting becomes successful and complete as soon as Fleet finishes checking all the resources;
whether configuration differences are found or not has no effect on the diff reporting success status.<ul><li>When a resource change has been applied on the hub cluster side, for CRPs of the ReportDiff mode,
the change will be immediately rolled out to all member clusters (when the rollout strategy is set to
RollingUpdate, the default type), as soon as they have completed diff reporting earlier.</li></ul></li><li>It is worth noting that Fleet will only report differences on resources that have corresponding manifests
on the hub cluster. If, for example, a namespace-scoped object has been created on the member cluster but
not on the hub cluster, Fleet will ignore the object, even if its owner namespace has been selected for placement.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-dcd05a852eca01d185729a33f973f1ea>3.14 - How to Roll Out and Roll Back Changes in Stage</h1><div class=lead>How to roll out and roll back changes with staged update APIs</div><p>This how-to guide demonstrates how to use staged updates to rollout resources to member clusters in a staged manner and rollback resources to a previous version. We&rsquo;ll cover both cluster-scoped and namespace-scoped approaches to serve different organizational needs.</p><h2 id=overview-of-staged-update-approaches>Overview of Staged Update Approaches</h2><p>Kubefleet provides two staged update approaches:</p><p><strong>Cluster-Scoped</strong>: Use <code>ClusterStagedUpdateRun</code> with <code>ClusterResourcePlacement</code> (CRP) for fleet administrators managing infrastructure-level changes.</p><p><strong>Namespace-Scoped</strong>: Use <code>StagedUpdateRun</code> with <code>ResourcePlacement</code> for application teams managing rollouts within their specific namespaces.</p><h2 id=prerequisite>Prerequisite</h2><p>This tutorial is based on a demo fleet environment with 3 member clusters:</p><table><thead><tr><th>cluster name</th><th>labels</th></tr></thead><tbody><tr><td>member1</td><td>environment=canary, order=2</td></tr><tr><td>member2</td><td>environment=staging</td></tr><tr><td>member3</td><td>environment=canary, order=1</td></tr></tbody></table><p>We&rsquo;ll demonstrate both cluster-scoped and namespace-scoped staged updates using different scenarios.</p><h2 id=cluster-scoped-staged-updates>Cluster-Scoped Staged Updates</h2><h3 id=setup-for-cluster-scoped-updates>Setup for Cluster-Scoped Updates</h3><p>To demonstrate cluster-scoped rollout and rollback behavior, we create a demo namespace and a sample configmap with very simple data on the hub cluster. The namespace with configmap will be deployed to the member clusters.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create ns test-namespace
</span></span><span style=display:flex><span>kubectl create cm test-cm --from-literal<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>key</span><span style=color:#ce5c00;font-weight:700>=</span>value1 -n test-namespace
</span></span></code></pre></div><p>Now we create a <code>ClusterResourcePlacement</code> to deploy the resources:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterResourcePlacement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: example-placement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSelectors:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - group: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      kind: Namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      name: test-namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      version: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  policy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    placementType: PickAll
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  strategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: External
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><p><strong>Note that <code>spec.strategy.type</code> is set to <code>External</code> to allow rollout triggered with a ClusterStagedUpdateRun.</strong>
All clusters should be scheduled since we use the <code>PickAll</code> policy but at the moment no resource should be deployed on the member clusters because we haven&rsquo;t created a <code>ClusterStagedUpdateRun</code> yet. The CRP is not <strong>AVAILABLE</strong> yet.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get crp example-placement
</span></span><span style=display:flex><span>NAME                GEN   SCHEDULED   SCHEDULED-GEN   AVAILABLE   AVAILABLE-GEN   AGE
</span></span><span style=display:flex><span>example-placement   <span style=color:#0000cf;font-weight:700>1</span>     True        <span style=color:#0000cf;font-weight:700>1</span>                                           8s
</span></span></code></pre></div><h3 id=check-cluster-resource-snapshot-versions>Check cluster resource snapshot versions</h3><p>Fleet keeps a list of resource snapshots for version control and audit, (for more details, please refer to <a href=/docs/api-reference/>api-reference</a>).</p><p>To check current resource snapshots:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get clusterresourcesnapshots --show-labels
</span></span><span style=display:flex><span>NAME                           GEN   AGE     LABELS
</span></span><span style=display:flex><span>example-placement-0-snapshot   <span style=color:#0000cf;font-weight:700>1</span>     7m31s   kubernetes-fleet.io/is-latest-snapshot<span style=color:#ce5c00;font-weight:700>=</span>true,kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>=</span>example-placement,kubernetes-fleet.io/resource-index<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>
</span></span></code></pre></div><p>We only have one version of the snapshot. It is the current latest (<code>kubernetes-fleet.io/is-latest-snapshot=true</code>) and has resource-index 0 (<code>kubernetes-fleet.io/resource-index=0</code>).</p><p>Now we modify the our configmap with a new value <code>value2</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl edit cm test-cm -n test-namespace
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl get configmap test-cm -n test-namespace -o yaml
</span></span><span style=display:flex><span>apiVersion: v1
</span></span><span style=display:flex><span>data:
</span></span><span style=display:flex><span>  key: value2     <span style=color:#8f5902;font-style:italic># value updated here, old value: value1</span>
</span></span><span style=display:flex><span>kind: ConfigMap
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  creationTimestamp: ...
</span></span><span style=display:flex><span>  name: test-cm
</span></span><span style=display:flex><span>  namespace: test-namespace
</span></span><span style=display:flex><span>  resourceVersion: ...
</span></span><span style=display:flex><span>  uid: ...
</span></span></code></pre></div><p>It now shows 2 versions of resource snapshots with index 0 and 1 respectively:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get clusterresourcesnapshots --show-labels
</span></span><span style=display:flex><span>NAME                           GEN   AGE    LABELS
</span></span><span style=display:flex><span>example-placement-0-snapshot   <span style=color:#0000cf;font-weight:700>1</span>     17m    kubernetes-fleet.io/is-latest-snapshot<span style=color:#ce5c00;font-weight:700>=</span>false,kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>=</span>example-placement,kubernetes-fleet.io/resource-index<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>example-placement-1-snapshot   <span style=color:#0000cf;font-weight:700>1</span>     2m2s   kubernetes-fleet.io/is-latest-snapshot<span style=color:#ce5c00;font-weight:700>=</span>true,kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>=</span>example-placement,kubernetes-fleet.io/resource-index<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span>
</span></span></code></pre></div><p>The <code>latest</code> label set to <code>example-placement-1-snapshot</code> which contains the latest configmap data:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get clusterresourcesnapshots example-placement-1-snapshot -o yaml
</span></span><span style=display:flex><span>apiVersion: placement.kubernetes-fleet.io/v1
</span></span><span style=display:flex><span>kind: ClusterResourceSnapshot
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  labels:
</span></span><span style=display:flex><span>    kubernetes-fleet.io/is-latest-snapshot: <span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>    kubernetes-fleet.io/parent-CRP: example-placement
</span></span><span style=display:flex><span>    kubernetes-fleet.io/resource-index: <span style=color:#4e9a06>&#34;1&#34;</span>
</span></span><span style=display:flex><span>  name: example-placement-1-snapshot
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>spec:
</span></span><span style=display:flex><span>  selectedResources:
</span></span><span style=display:flex><span>  - apiVersion: v1
</span></span><span style=display:flex><span>    kind: Namespace
</span></span><span style=display:flex><span>    metadata:
</span></span><span style=display:flex><span>      labels:
</span></span><span style=display:flex><span>        kubernetes.io/metadata.name: test-namespace
</span></span><span style=display:flex><span>      name: test-namespace
</span></span><span style=display:flex><span>    spec:
</span></span><span style=display:flex><span>      finalizers:
</span></span><span style=display:flex><span>      - kubernetes
</span></span><span style=display:flex><span>  - apiVersion: v1
</span></span><span style=display:flex><span>    data:
</span></span><span style=display:flex><span>      key: value2 <span style=color:#8f5902;font-style:italic># latest value: value2, old value: value1</span>
</span></span><span style=display:flex><span>    kind: ConfigMap
</span></span><span style=display:flex><span>    metadata:
</span></span><span style=display:flex><span>      name: test-cm
</span></span><span style=display:flex><span>      namespace: test-namespace
</span></span></code></pre></div><h3 id=deploy-a-clusterstagedupdatestrategy>Deploy a ClusterStagedUpdateStrategy</h3><p>A <code>ClusterStagedUpdateStrategy</code> defines the orchestration pattern that groups clusters into stages and specifies the rollout sequence.
It selects member clusters by labels. For our demonstration, we create one with two stages:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterStagedUpdateStrategy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: example-strategy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  stages:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - name: staging
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          environment: staging
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      afterStageTasks:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        - type: TimedWait
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          waitTime: 1m
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - name: canary
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          environment: canary
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      sortingLabelKey: order
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      afterStageTasks:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        - type: Approval
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><h3 id=deploy-a-clusterstagedupdaterun-to-rollout-latest-change>Deploy a ClusterStagedUpdateRun to rollout latest change</h3><p>A <code>ClusterStagedUpdateRun</code> executes the rollout of a <code>ClusterResourcePlacement</code> following a <code>ClusterStagedUpdateStrategy</code>. To trigger the staged update run for our CRP, we create a <code>ClusterStagedUpdateRun</code> specifying the CRP name, updateRun strategy name, and the latest resource snapshot index (&ldquo;1&rdquo;):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterStagedUpdateRun
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: example-run
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  placementName: example-placement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSnapshotIndex: &#34;1&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  stagedRolloutStrategyName: example-strategy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><p>The staged update run is initialized and running:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get csur example-run
</span></span><span style=display:flex><span>NAME          PLACEMENT           RESOURCE-SNAPSHOT   POLICY-SNAPSHOT   INITIALIZED   SUCCEEDED   AGE
</span></span><span style=display:flex><span>example-run   example-placement   <span style=color:#0000cf;font-weight:700>1</span>                   <span style=color:#0000cf;font-weight:700>0</span>                 True                      44s
</span></span></code></pre></div><p>A more detailed look at the status:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterStagedUpdateRun</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-run</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-placement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSnapshotIndex</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>stagedRolloutStrategyName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-strategy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterStagedUpdateRun initialized successfully</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>UpdateRunInitializedSuccessfully</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># the updateRun is initialized successfully</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Initialized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>UpdateRunStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Progressing</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># the updateRun is still running</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>deletionStageStatus</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[]</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># no clusters need to be cleaned up</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>stageName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kubernetes-fleet.io/deleteStage</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policyObservedClusterCount</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># number of clusters to be updated</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policySnapshotIndexUsed</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>stagedUpdateStrategySnapshot</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># snapshot of the strategy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>stages</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>afterStageTasks</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>TimedWait</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>waitTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>1m0s</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>environment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>staging</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>staging</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>afterStageTasks</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Approval</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>environment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>canary</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>canary</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>sortingLabelKey</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>order</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>stagesStatus</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># detailed status for each stage</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>afterStageTaskStatus</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AfterStageTaskWaitTimeElapsed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># the wait after-stage task has completed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WaitTimeElapsed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>TimedWait</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>member2</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># stage staging contains member2 cluster only</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterUpdatingStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Started</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterUpdatingSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># member2 is updated successfully</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Succeeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>StageUpdatingWaiting</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Progressing</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>StageUpdatingSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># stage staging has completed successfully</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Succeeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>endTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>stageName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>staging</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>startTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>afterStageTaskStatus</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>approvalRequestName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-run-canary</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># ClusterApprovalRequest name for this stage</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Approval</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>member3</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># according the labelSelector and sortingLabelKey, member3 is selected first in this stage</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterUpdatingStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Started</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterUpdatingSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># member3 update is completed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Succeeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>member1</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># member1 is selected after member3 because of order=2 label</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterUpdatingStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># member1 update has not finished yet</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Started</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>StageUpdatingStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># stage canary is still executing</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Progressing</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>stageName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>canary</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>startTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Wait a little bit more, and we can see stage <code>canary</code> finishes cluster update and is waiting for the Approval task.
We can check the <code>ClusterApprovalRequest</code> generated and not approved yet:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get clusterapprovalrequest
</span></span><span style=display:flex><span>NAME                 UPDATE-RUN    STAGE    APPROVED   APPROVALACCEPTED   AGE
</span></span><span style=display:flex><span>example-run-canary   example-run   canary                                 2m2s
</span></span></code></pre></div><p>We can approve the <code>ClusterApprovalRequest</code> by patching its status:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl patch clusterapprovalrequests example-run-canary --type<span style=color:#ce5c00;font-weight:700>=</span>merge -p <span style=color:#ce5c00;font-weight:700>{</span><span style=color:#4e9a06>&#34;status&#34;</span>:<span style=color:#ce5c00;font-weight:700>{</span><span style=color:#4e9a06>&#34;conditions&#34;</span>:<span style=color:#ce5c00;font-weight:700>[{</span><span style=color:#4e9a06>&#34;type&#34;</span>:<span style=color:#4e9a06>&#34;Approved&#34;</span>,<span style=color:#4e9a06>&#34;status&#34;</span>:<span style=color:#4e9a06>&#34;True&#34;</span>,<span style=color:#4e9a06>&#34;reason&#34;</span>:<span style=color:#4e9a06>&#34;lgtm&#34;</span>,<span style=color:#4e9a06>&#34;message&#34;</span>:<span style=color:#4e9a06>&#34;lgtm&#34;</span>,<span style=color:#4e9a06>&#34;lastTransitionTime&#34;</span>:<span style=color:#4e9a06>&#34;&#39;</span><span style=color:#204a87;font-weight:700>$(</span>date -u +%Y-%m-%dT%H:%M:%SZ<span style=color:#204a87;font-weight:700>)</span><span style=color:#4e9a06>&#39;&#34;</span>,<span style=color:#4e9a06>&#34;observedGeneration&#34;</span>:1<span style=color:#ce5c00;font-weight:700>}]}}</span> --subresource<span style=color:#ce5c00;font-weight:700>=</span>status
</span></span><span style=display:flex><span>clusterapprovalrequest.placement.kubernetes-fleet.io/example-run-canary patched
</span></span></code></pre></div><p>This can be done equivalently by creating a json patch file and applying it:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat <span style=color:#4e9a06>&lt;&lt; EOF &gt; approval.json
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;status&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    &#34;conditions&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        {
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            &#34;lastTransitionTime&#34;: &#34;$(date -u +%Y-%m-%dT%H:%M:%SZ)&#34;,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            &#34;message&#34;: &#34;lgtm&#34;,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            &#34;observedGeneration&#34;: 1,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            &#34;reason&#34;: &#34;lgtm&#34;,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            &#34;status&#34;: &#34;True&#34;,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            &#34;type&#34;: &#34;Approved&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        }
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    ]
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>}
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span><span style=display:flex><span>kubectl patch clusterapprovalrequests example-run-canary --type<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;merge&#39;</span> --subresource<span style=color:#ce5c00;font-weight:700>=</span>status --patch-file approval.json
</span></span></code></pre></div><p>Then verify it&rsquo;s approved:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get clusterapprovalrequest
</span></span><span style=display:flex><span>NAME                 UPDATE-RUN    STAGE    APPROVED   APPROVALACCEPTED   AGE
</span></span><span style=display:flex><span>example-run-canary   example-run   canary   True       True               2m30s
</span></span></code></pre></div><p>The updateRun now is able to proceed and complete:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get csur example-run
</span></span><span style=display:flex><span>NAME          PLACEMENT           RESOURCE-SNAPSHOT   POLICY-SNAPSHOT   INITIALIZED   SUCCEEDED   AGE
</span></span><span style=display:flex><span>example-run   example-placement   <span style=color:#0000cf;font-weight:700>1</span>                   <span style=color:#0000cf;font-weight:700>0</span>                 True          True        4m22s
</span></span></code></pre></div><p>The CRP also shows rollout has completed and resources are available on all member clusters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get crp example-placement
</span></span><span style=display:flex><span>NAME                GEN   SCHEDULED   SCHEDULED-GEN   AVAILABLE   AVAILABLE-GEN   AGE
</span></span><span style=display:flex><span>example-placement   <span style=color:#0000cf;font-weight:700>1</span>     True        <span style=color:#0000cf;font-weight:700>1</span>               True        <span style=color:#0000cf;font-weight:700>1</span>               134m
</span></span></code></pre></div><p>The configmap <code>test-cm</code> should be deployed on all 3 member clusters, with latest data:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=deploy-a-second-clusterstagedupdaterun-to-rollback-to-a-previous-version>Deploy a second ClusterStagedUpdateRun to rollback to a previous version</h3><p>Now suppose the workload admin wants to rollback the configmap change, reverting the value <code>value2</code> back to <code>value1</code>.
Instead of manually updating the configmap from hub, they can create a new <code>ClusterStagedUpdateRun</code> with a previous resource snapshot index, &ldquo;0&rdquo; in our context and they can reuse the same strategy:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterStagedUpdateRun
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: example-run-2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  placementName: example-placement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSnapshotIndex: &#34;0&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  stagedRolloutStrategyName: example-strategy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><p>Following the same step as <a href=/docs/how-tos/staged-update/#deploy-a-clusterstagedupdaterun-to-rollout-latest-change>deploying the first updateRun</a>, the second updateRun should succeed also. Complete status shown as below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterStagedUpdateRun</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-run-2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-placement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSnapshotIndex</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>stagedRolloutStrategyName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-strategy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterStagedUpdateRun initialized successfully</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>UpdateRunInitializedSuccessfully</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Initialized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>UpdateRunStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Progressing</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>UpdateRunSucceeded</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># updateRun succeeded </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Succeeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>deletionStageStatus</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>StageUpdatingStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Progressing</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>StageUpdatingSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># no clusters in the deletion stage, it completes directly</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Succeeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>endTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>stageName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kubernetes-fleet.io/deleteStage</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>startTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policyObservedClusterCount</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policySnapshotIndexUsed</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>stagedUpdateStrategySnapshot</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>stages</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>afterStageTasks</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>TimedWait</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>waitTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>1m0s</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>environment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>staging</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>staging</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>afterStageTasks</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Approval</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>environment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>canary</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>canary</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>sortingLabelKey</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>order</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>stagesStatus</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>afterStageTaskStatus</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AfterStageTaskWaitTimeElapsed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WaitTimeElapsed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>TimedWait</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>member2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterUpdatingStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Started</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterUpdatingSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Succeeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>StageUpdatingWaiting</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Progressing</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>StageUpdatingSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Succeeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>endTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>stageName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>staging</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>startTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>afterStageTaskStatus</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>approvalRequestName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-run-2-canary</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AfterStageTaskApprovalRequestCreated</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApprovalRequestCreated</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AfterStageTaskApprovalRequestApproved</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApprovalRequestApproved</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Approval</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>member3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterUpdatingStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Started</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterUpdatingSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Succeeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>member1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterUpdatingStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Started</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterUpdatingSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Succeeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>StageUpdatingWaiting</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Progressing</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>StageUpdatingSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Succeeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>endTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>stageName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>canary</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>startTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The configmap <code>test-cm</code> should be updated on all 3 member clusters, with old data:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>value1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=namespace-scoped-staged-updates>Namespace-Scoped Staged Updates</h2><p>Namespace-scoped staged updates allow application teams to manage rollouts independently within their namespaces using <code>StagedUpdateRun</code> and <code>StagedUpdateStrategy</code> resources.</p><h3 id=setup-for-namespace-scoped-updates>Setup for Namespace-Scoped Updates</h3><p>Let&rsquo;s demonstrate namespace-scoped staged updates by deploying an application within a specific namespace. Create a namespace and an application rollout:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create ns my-app-namespace
</span></span><span style=display:flex><span>kubectl create deployment web-app --image<span style=color:#ce5c00;font-weight:700>=</span>nginx:1.20 --port<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>80</span> -n my-app-namespace
</span></span><span style=display:flex><span>kubectl expose deployment web-app --port<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>80</span> --target-port<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>80</span> -n my-app-namespace
</span></span></code></pre></div><p>Create a namespace-scoped <code>ResourcePlacement</code> to deploy the application:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ResourcePlacement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: web-app-placement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  namespace: my-app-namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSelectors:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - group: &#34;apps&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      kind: Deployment
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      name: web-app
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      version: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - group: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      kind: Service
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      name: web-app
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      version: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  policy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    placementType: PickAll
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  strategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: External # enables namespace-scoped staged updates
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><h3 id=check-namespace-scoped-resource-snapshots>Check namespace-scoped resource snapshots</h3><p>Check the resource snapshots for the namespace-scoped placement:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get resourcesnapshots -n my-app-namespace 
</span></span><span style=display:flex><span>NAME                         GEN    AGE    LABELS  
</span></span><span style=display:flex><span>web-app-placement-0-snapshot  <span style=color:#0000cf;font-weight:700>1</span>     63s    kubernetes-fleet.io/is-latest-snapshot<span style=color:#ce5c00;font-weight:700>=</span>true,kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>=</span>web-app-placement,kubernetes-fleet.io/resource-index<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>
</span></span></code></pre></div><p>Update the deployment to a new version:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl <span style=color:#204a87>set</span> image deployment/web-app web-app<span style=color:#ce5c00;font-weight:700>=</span>nginx:1.21 -n my-app-namespace
</span></span></code></pre></div><p>Verify the new snapshot is created:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get resourcesnapshots -n my-app-namespace --show-labels
</span></span><span style=display:flex><span>NAME                         GEN    AGE    LABELS  
</span></span><span style=display:flex><span>web-app-placement-0-snapshot  <span style=color:#0000cf;font-weight:700>1</span>     263s   kubernetes-fleet.io/is-latest-snapshot<span style=color:#ce5c00;font-weight:700>=</span>false,kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>=</span>web-app-placement,kubernetes-fleet.io/resource-index<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>web-app-placement-1-snapshot  <span style=color:#0000cf;font-weight:700>1</span>     23s    kubernetes-fleet.io/is-latest-snapshot<span style=color:#ce5c00;font-weight:700>=</span>true,kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>=</span>web-app-placement,kubernetes-fleet.io/resource-index<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span>
</span></span></code></pre></div><h3 id=deploy-a-stagedupdatestrategy>Deploy a StagedUpdateStrategy</h3><p>Create a namespace-scoped staged update strategy:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: StagedUpdateStrategy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: app-rollout-strategy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  namespace: my-app-namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  stages:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - name: dev-clusters
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          environment: staging
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      afterStageTasks:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        - type: TimedWait
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          waitTime: 30s
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - name: prod-clusters
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          environment: canary
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      sortingLabelKey: order
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      afterStageTasks:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        - type: Approval
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><h3 id=deploy-a-stagedupdaterun>Deploy a StagedUpdateRun</h3><p>Create a namespace-scoped staged update run to rollout the new image version:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: StagedUpdateRun
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: web-app-rollout-v1-21
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  namespace: my-app-namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  placementName: web-app-placement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSnapshotIndex: &#34;1&#34;  # Latest snapshot with nginx:1.21
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  stagedRolloutStrategyName: app-rollout-strategy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><h3 id=monitor-namespace-scoped-staged-rollout>Monitor namespace-scoped staged rollout</h3><p>Check the status of the staged update run:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe sur web-app-rollout-v1-21 -n my-app-namespace
</span></span></code></pre></div><p>Wait for the first stage to complete, then check for approval requests:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get approvalrequests -n my-app-namespace
</span></span></code></pre></div><p>Approve the staging gate to proceed to production clusters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl patch approvalrequests web-app-rollout-v1-21-prod-clusters -n my-app-namespace --type<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;merge&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  -p <span style=color:#4e9a06>&#39;{&#34;status&#34;:{&#34;conditions&#34;:[{&#34;type&#34;:&#34;Approved&#34;,&#34;status&#34;:&#34;True&#34;,&#34;reason&#34;:&#34;approved&#34;,&#34;message&#34;:&#34;approved&#34;}]}}&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  --subresource<span style=color:#ce5c00;font-weight:700>=</span>status
</span></span></code></pre></div><p>Verify the rollout completion:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get sur web-app-rollout-v1-21 -n my-app-namespace
</span></span><span style=display:flex><span>kubectl get resourceplacement web-app-placement -n my-app-namespace
</span></span></code></pre></div><h3 id=rollback-with-namespace-scoped-staged-updates>Rollback with namespace-scoped staged updates</h3><p>To rollback to the previous version (nginx:1.20), create another staged update run referencing the earlier snapshot:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: StagedUpdateRun
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: web-app-rollback-v1-20
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  namespace: my-app-namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  placementName: web-app-placement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSnapshotIndex: &#34;0&#34;  # Previous snapshot with nginx:1.20
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  stagedRolloutStrategyName: app-rollout-strategy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><p>Follow the same monitoring and approval process as above to complete the rollback.</p><h2 id=key-differences-summary>Key Differences Summary</h2><table><thead><tr><th>Aspect</th><th>Cluster-Scoped</th><th>Namespace-Scoped</th></tr></thead><tbody><tr><td><strong>Strategy Resource</strong></td><td><code>ClusterStagedUpdateStrategy</code></td><td><code>StagedUpdateStrategy</code></td></tr><tr><td><strong>UpdateRun Resource</strong></td><td><code>ClusterStagedUpdateRun</code></td><td><code>StagedUpdateRun</code></td></tr><tr><td><strong>Target Placement</strong></td><td><code>ClusterResourcePlacement</code></td><td><code>ResourcePlacement</code></td></tr><tr><td><strong>Approval Resource</strong></td><td><code>ClusterApprovalRequest</code> (short name: <code>careq</code>)</td><td><code>ApprovalRequest</code> (short name: <code>areq</code>)</td></tr><tr><td><strong>Scope</strong></td><td>Cluster-wide</td><td>Namespace-bound</td></tr><tr><td><strong>Use Case</strong></td><td>Infrastructure rollouts</td><td>Application rollouts</td></tr><tr><td><strong>Permissions</strong></td><td>Cluster-admin level</td><td>Namespace-level</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-3d9472b6f83afdc50046a1c5ab64a789>3.15 - Evicting Resources and Setting up Disruption Budgets</h1><div class=lead>How to evict resources from a cluster and set up disruption budgets to protect against untimely evictions</div><p>This how-to guide discusses how to create <code>ClusterResourcePlacementEviction</code> objects and <code>ClusterResourcePlacementDisruptionBudget</code> objects to evict resources from member clusters and protect resources on member clusters from voluntary disruption, respectively.</p><h2 id=evicting-resources-from-member-clusters-using-clusterresourceplacementeviction>Evicting Resources from Member Clusters using ClusterResourcePlacementEviction</h2><p>The <code>ClusterResourcePlacementEviction</code> object is used to remove resources from a member cluster once the resources have already been propagated from the hub cluster.</p><p>To successfully evict resources from a cluster, the user needs to specify:</p><ul><li>The name of the <code>ClusterResourcePlacement</code> object which propagated resources to the target cluster.</li><li>The name of the target cluster from which we need to evict resources.</li></ul><p>In this example, we will create a <code>ClusterResourcePlacement</code> object with PickAll placement policy to propagate resources to an existing <code>MemberCluster</code>, add a taint to the member cluster
resource and then create a <code>ClusterResourcePlacementEviction</code> object to evict resources from the <code>MemberCluster</code>.</p><p>We will first create a namespace that we will propagate to the member cluster.</p><pre tabindex=0><code>kubectl create ns test-ns
</code></pre><p>Then we will apply a <code>ClusterResourcePlacement</code> with the following spec:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <code>CRP</code> status after applying should look something like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>kubectl get crp test-crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>NAME       GEN   SCHEDULED   SCHEDULED-GEN   AVAILABLE   AVAILABLE-GEN   AGE</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>test-crp   2     True        2               True        2               5m49s</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>let&rsquo;s now add a taint to the member cluster to ensure this cluster is not picked again by the scheduler once we evict resources from it.</p><p>Modify the cluster object to add a taint:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>heartbeatPeriodSeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>60</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>identity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ServiceAccount</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>fleet-member-agent-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>fleet-system</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>taints</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>effect</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoSchedule</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-key</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-value</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Now we will create a <code>ClusterResourcePlacementEviction</code> object to evict resources from the member cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementEviction</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-eviction</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>the eviction object should look like this, if the eviction was successful:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>kubectl get crpe test-eviction</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>NAME            VALID   EXECUTED</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>test-eviction   True    True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>since the eviction is successful, the resources should be removed from the cluster, let&rsquo;s take a look at the <code>CRP</code> object status to verify:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>kubectl get crp test-crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>NAME       GEN   SCHEDULED   SCHEDULED-GEN   AVAILABLE   AVAILABLE-GEN   AGE</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>test-crp   2     True        2                                           15m</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>from the object we can clearly tell that the resources were evicted since the <code>AVAILABLE</code> column is empty. If the user needs more information <code>ClusterResourcePlacement</code> object&rsquo;s status can be checked.</p><h2 id=protecting-resources-from-voluntary-disruptions-using-clusterresourceplacementdisruptionbudget>Protecting resources from voluntary disruptions using ClusterResourcePlacementDisruptionBudget</h2><p>In this example, we will create a <code>ClusterResourcePlacement</code> object with PickN placement policy to propagate resources to an existing MemberCluster,
then create a <code>ClusterResourcePlacementDisruptionBudget</code> object to protect resources on the MemberCluster from voluntary disruption and
then try to evict resources from the MemberCluster using <code>ClusterResourcePlacementEviction</code>.</p><p>We will first create a namespace that we will propagate to the member cluster.</p><pre tabindex=0><code>kubectl create ns test-ns
</code></pre><p>Then we will apply a <code>ClusterResourcePlacement</code> with the following spec:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-ns</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <code>CRP</code> object after applying should look something like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>kubectl get crp test-crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>NAME       GEN   SCHEDULED   SCHEDULED-GEN   AVAILABLE   AVAILABLE-GEN   AGE</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>test-crp   2     True        2               True        2               8s</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Now we will create a <code>ClusterResourcePlacementDisruptionBudget</code> object to protect resources on the member cluster from voluntary disruption:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementDisruptionBudget</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>minAvailable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><blockquote><p><strong>Note:</strong> An eviction object is only reconciled once, after which it reaches a terminal state, if the user desires to create/apply the same eviction object again they need to delete the existing eviction object and re-create the object for the eviction to occur again.</p></blockquote><p>Now we will create a <code>ClusterResourcePlacementEviction</code> object to evict resources from the member cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementEviction</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-eviction</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-crp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><blockquote><p><strong>Note:</strong> The eviction controller will try to get the corresponding <code>ClusterResourcePlacementDisruptionBudget</code> object when a <code>ClusterResourcePlacementEviction</code> object is reconciled to check if the specified MaxAvailable or MinAvailable allows the eviction to be executed.</p></blockquote><p>let&rsquo;s take a look at the eviction object to see if the eviction was executed,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>kubectl get crpe test-eviction</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>NAME            VALID   EXECUTED</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>test-eviction   True    False</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>from the eviction object we can see the eviction was not executed.</p><p>let&rsquo;s take a look at the <code>ClusterResourcePlacementEviction</code> object status to verify why the eviction was not executed:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2025-01-21T15:52:29Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Eviction is valid</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementEvictionValid</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Valid</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2025-01-21T15:52:29Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;Eviction is blocked by specified ClusterResourcePlacementDisruptionBudget,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      availablePlacements: 1, totalPlacements: 1&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementEvictionNotExecuted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Executed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>the eviction status clearly mentions that the eviction was blocked by the specified <code>ClusterResourcePlacementDisruptionBudget</code>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-4f4f59d184a40c4dcfcbee8f42acf039>3.16 - Scheduling AI Jobs with Kueue and Fleet</h1><div class=lead>Learn how to schedule AI/ML workloads using Kueue and ClusterResourcePlacement/ResourcePlacement</div><h1 id=scheduling-ai-jobs-with-kueue-and-placement>Scheduling AI Jobs with Kueue and Placement</h1><p>This guide demonstrates how to schedule AI/ML workloads across your fleet using KubeFleet&rsquo;s ClusterResourcePlacement/ResourcePlacement in conjunction with Kueue for efficient job queuing and resource management.</p><h2 id=overview>Overview</h2><p>When scheduling AI/ML jobs across multiple clusters, you need three key components working together:</p><ul><li><strong>ClusterResourcePlacement</strong>: Propagates cluster-scoped resources (ClusterQueues, ResourceFlavors) and namespaces to selected clusters</li><li><strong>ResourcePlacement</strong>: Propagates the AI/ML job and LocalQueue to selected clusters within the namespace</li><li><strong>Kueue</strong>: Manages job queuing and resource quotas within each cluster</li></ul><p>This combination ensures efficient scheduling and resource utilization for your AI workloads across your entire fleet.</p><h2 id=enable-kueue-on-fleet>Enable Kueue on Fleet</h2><p>To enable Kueue in your fleet environment, you&rsquo;ll need to install Kueue on your Member Clusters and the required CustomResourceDefinitions (CRDs) on your Hub Cluster.</p><h3 id=install-kueue-on-individual-member-clusters>Install Kueue on Individual Member Clusters</h3><p>Before proceeding with the installation, keep in mind that you&rsquo;ll need to switch to the context of the member cluster you want to install Kueue on. This is because Kueue needs to be installed and managed individually within each cluster, and you need to ensure that you&rsquo;re interacting with the correct cluster when applying the necessary configurations.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Set the Kueue version you want to install</span>
</span></span><span style=display:flex><span><span style=color:#000>VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>v0.14.4  <span style=color:#8f5902;font-style:italic># Replace with the latest version, or working version you like</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Switch to your member cluster context</span>
</span></span><span style=display:flex><span>kubectl config use-context &lt;member-cluster-context&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Install Kueue on the member cluster</span>
</span></span><span style=display:flex><span>kubectl apply --server-side -f <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  https://github.com/kubernetes-sigs/kueue/releases/download/<span style=color:#000>$VERSION</span>/manifests.yaml
</span></span></code></pre></div><blockquote><p><strong>Note</strong>: Replace <code>VERSION</code> with the latest version of Kueue. For more information about Kueue versions, see <a href=https://github.com/kubernetes-sigs/kueue/releases>Kueue releases</a>.</p></blockquote><p>To ensure Kueue is properly installed:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># On member clusters - check Kueue controller is running</span>
</span></span><span style=display:flex><span>kubectl get pods -n kueue-system
</span></span></code></pre></div><pre tabindex=0><code>NAME                                        READY   STATUS    RESTARTS   AGE
kueue-controller-manager-59f5c6b49c-22g7r   2/2     Running   0          57s
</code></pre><p><strong>Repeat this process for each member cluster</strong> in your fleet where you want to schedule AI/ML workloads.</p><h3 id=install-crds-on-hub-cluster>Install CRDs on Hub Cluster</h3><p>Next, you will need to install the necessary CRDs on the hub cluster. Installing the CRDs here allows the hub cluster to properly handle Kueue-related resources. For this guide, we will install the CRDs for ResourceFlavor, ClusterQueue, and LocalQueue.</p><blockquote><p><strong>Important</strong>: Make sure you have switched to the context of your hub cluster before proceeding with the installation.</p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Switch to your hub cluster context</span>
</span></span><span style=display:flex><span>kubectl config use-context &lt;hub-cluster-context&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Set the Kueue version you want to install</span>
</span></span><span style=display:flex><span><span style=color:#000>VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>v0.9.0  <span style=color:#8f5902;font-style:italic># Replace with the latest version, or working version you like</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Install required Kueue CRDs on hub cluster</span>
</span></span><span style=display:flex><span>kubectl apply -f https://raw.githubusercontent.com/kubernetes-sigs/kueue/<span style=color:#000>$VERSION</span>/config/components/crd/bases/kueue.x-k8s.io_clusterqueues.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl apply -f https://raw.githubusercontent.com/kubernetes-sigs/kueue/<span style=color:#000>$VERSION</span>/config/components/crd/bases/kueue.x-k8s.io_localqueues.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl apply -f https://raw.githubusercontent.com/kubernetes-sigs/kueue/<span style=color:#000>$VERSION</span>/config/components/crd/bases/kueue.x-k8s.io_resourceflavors.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Verify CRDs are installed</span>
</span></span><span style=display:flex><span>kubectl get crds <span style=color:#000;font-weight:700>|</span> grep kueue
</span></span></code></pre></div><p>You should see output similar to:</p><pre tabindex=0><code>clusterqueues.kueue.x-k8s.io                       2025-10-17T17:50:30Z
localqueues.kueue.x-k8s.io                         2025-10-17T17:50:33Z
resourceflavors.kueue.x-k8s.io                     2025-10-17T17:50:35Z
</code></pre><h2 id=step-by-step-guide>Step-by-Step Guide</h2><h3 id=1-create-resource-flavor-on-hub>1. Create Resource Flavor on Hub</h3><p>First, create a ResourceFlavor that defines the available resource types:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kueue.x-k8s.io/v1beta1 </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceFlavor  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>default-flavor</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># This ResourceFlavor will be used for all the resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>A ResourceFlavor is an object that represents the variations in the nodes available in your cluster by associating them with node labels and taints.</p><h3 id=2-configure-clusterqueue-on-hub>2. Configure ClusterQueue on Hub</h3><p>Set up a ClusterQueue for the workloads:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kueue.x-k8s.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterQueue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster-queue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>cohort</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compute-workload</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespaceSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{}<span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># Available to all namespaces  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>queueingStrategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>BestEffortFIFO</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># Default queueing strategy </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceGroups</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>coveredResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;cpu&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;memory&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>flavors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>default-flavor</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cpu</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>nominalQuota</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;32&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>memory</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>nominalQuota</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;128Gi&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><blockquote><p>NOTE: The resources need to be listed in the same order as the coveredResources list.</p></blockquote><p>A ClusterQueue is a cluster-scoped object that oversees a pool of resources, including CPU, memory, and GPU. It manages ResourceFlavors, sets usage limits, and controls the order in which workloads are admitted. This will handle the ResourceFlavor that was previously created.</p><h3 id=3-create-ai-job-namespace-on-hub>3. Create AI job Namespace on Hub</h3><p>Create the namespace where your AI jobs will be scheduled:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compute-jobs</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compute-workload</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The LocalQueue and Job require a namespace to be specified.</p><h3 id=4-use-clusterresourceplacement-to-propagate-cluster-scoped-resources>4. Use ClusterResourcePlacement to Propagate Cluster-Scoped Resources</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>sample-kueue </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kueue.x-k8s.io  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1beta1  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceFlavor  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>default-flavor  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kueue.x-k8s.io  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1beta1  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterQueue  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster-queue  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compute-jobs  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>selectionScope</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NamespaceOnly</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>rollingUpdate</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxUnavailable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxSurge</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>unavailablePeriodSeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>60</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>revisionHistoryLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>15</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The ClusterResourcePlacement (CRP) will select the cluster-scoped resources you created (such as ResourceFlavor and ClusterQueue) and the namespace only. The CRP will propagate these resources to all selected member clusters on the Fleet.</p><h4 id=verify-clusterresourceplacement-completed>Verify ClusterResourcePlacement Completed</h4><p>After creating the ClusterResourcePlacement, you need to verify that it has successfully propagated the resources to the target clusters. A successful completion is indicated by several conditions in the status:</p><ol><li>Check the placement status:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Get detailed status of the ClusterResourcePlacement</span>
</span></span><span style=display:flex><span>kubectl describe crp sample-kueue
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>         </span><span style=color:#000>sample-kueue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>&lt;none&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>&lt;none&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>API Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>         </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Creation Timestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-22T20:19:50Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Finalizers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>kubernetes-fleet.io/crp-cleanup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>kubernetes-fleet.io/scheduler-cleanup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Resource Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#0000cf;font-weight:700>3794694</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>UID</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>e242900c-3552-4289-bf8f-8be2480e63b1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>..</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-10-22T20:19:50Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>found all cluster needed as specified by the scheduling policy, found 3 cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-10-22T20:19:50Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>All 3 cluster(s) start rolling out the latest resource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ClusterResourcePlacementRolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-10-22T20:19:50Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ClusterResourcePlacementOverridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-10-22T20:19:50Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Works(s) are succcesfully created or updated in 3 target cluster(s)&#39; namespaces</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ClusterResourcePlacementWorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-10-22T20:19:50Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>The selected resources are successfully applied to 3 cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-10-22T20:19:50Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>The selected resources in 3 cluster(s) are available now</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>ResourceAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ClusterResourcePlacementAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Observed Resource Index</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Placement Statuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Cluster Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-22T20:19:50Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>Successfully scheduled resources for placement in &#34;cluster-1&#34; (affinity score: 0, topology spread score: 0): picked by scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-22T20:19:50Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-22T20:19:50Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-22T20:19:50Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-22T20:19:50Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-22T20:19:50Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>The availability of work object sample-kueue-work is not trackable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>NotAllWorkAreAvailabilityTrackable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ClusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster-2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ClusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster-3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Selected Resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>     </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>     </span><span style=color:#000>compute-jobs</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>kueue.x-k8s.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>     </span><span style=color:#000>ClusterQueue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>     </span><span style=color:#000>cluster-queue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>kueue.x-k8s.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>     </span><span style=color:#000>ResourceFlavor</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>     </span><span style=color:#000>default-flavor</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Events</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Type    Reason                        Age   From                  Message</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>---- <span style=color:#f8f8f8;text-decoration:underline>   </span>------ <span style=color:#f8f8f8;text-decoration:underline>                       </span>---- <span style=color:#f8f8f8;text-decoration:underline> </span>---- <span style=color:#f8f8f8;text-decoration:underline>                 </span>-------<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementRolloutStarted       13s   placement-controller  Started rolling out the latest resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementOverriddenSucceeded  13s   placement-controller  Placement has been successfully overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementWorkSynchronized     13s   placement-controller  Work(s) have been created or updated successfully for the selected cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementApplied              13s   placement-controller  Resources have been applied to the selected cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementAvailable            13s   placement-controller  Resources are available on the selected cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementRolloutCompleted     13s   placement-controller  Placement has finished the rollout process and reached the desired status</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><ol start=2><li>Verify resources on target clusters:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Switch to member cluster context</span>
</span></span><span style=display:flex><span>kubectl config use-context &lt;member-cluster-context&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check if resources are present</span>
</span></span><span style=display:flex><span>kubectl get resourceflavor default-flavor
</span></span><span style=display:flex><span>kubectl get clusterqueue cluster-queue
</span></span><span style=display:flex><span>kubectl get ns compute-jobs
</span></span></code></pre></div><h3 id=5-create-localqueue-on-hub>5. Create LocalQueue on Hub</h3><p>Create a LocalQueue that will be propagated to member clusters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kueue.x-k8s.io/v1beta1 </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>LocalQueue  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compute-jobs</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>local-queue   </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>clusterQueue</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster-queue</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># Point to the ClusterQueue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>A LocalQueue is a namespaced resource that receives workloads from users within the specified namespace. This resource will point to the ClusterQueue previously created.</p><h3 id=6-define-your-ai-jobs-on-hub>6. Define Your AI Job(s) on Hub</h3><p>Create your compute job(s) with Kueue annotations:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>batch/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Job</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>mock-workload</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compute-jobs</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kueue.x-k8s.io/queue-name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>local-queue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>ttlSecondsAfterFinished</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>60</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># Job will be deleted after 60 seconds  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>parallelism</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>completions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>suspend</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># Set to true to allow Kueue to control the Job</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>template</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>containers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compute</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ubuntu:22.04</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>command</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#4e9a06>&#34;/bin/bash&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#4e9a06>&#34;-c&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          echo &#34;Starting mock compute job...&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          echo &#34;Loading input dataset...&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          sleep 10
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          echo &#34;Epoch 1/3: Processing accuracy: 65%&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          sleep 10
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          echo &#34;Epoch 2/3: Processing accuracy: 85%&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          sleep 10
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          echo &#34;Epoch 3/3: Processing accuracy: 95%&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          echo &#34;Processing completed successfully!&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>requests</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>cpu</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2Gi&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>limits</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>cpu</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2Gi&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>restartPolicy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Never</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>backoffLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>---</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>batch/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Job</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>model-evaluation</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compute-jobs</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kueue.x-k8s.io/queue-name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>local-queue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>ttlSecondsAfterFinished</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>60</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>parallelism</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>completions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>suspend</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># Set to true to allow Kueue to control the Job</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>template</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>containers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>evaluation</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ubuntu:22.04</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>command</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#4e9a06>&#34;/bin/bash&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#4e9a06>&#34;-c&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          echo &#34;Starting model evaluation job...&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          echo &#34;Loading test dataset...&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          sleep 5
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          echo &#34;Running evaluation suite...&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          sleep 10
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          echo &#34;Computing metrics...&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          echo &#34;Accuracy: 94.5%&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          echo &#34;F1 Score: 0.93&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          echo &#34;Evaluation completed successfully!&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>requests</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>cpu</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1Gi&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>limits</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>cpu</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>memory</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1Gi&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>restartPolicy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Never</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>backoffLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>This Job defines the compute workload that will be scheduled by Kueue. The <code>kueue.x-k8s.io/queue-name</code> annotation tells Kueue which LocalQueue should manage this job, ensuring proper resource allocation and queuing behavior.</p><h3 id=7-create-independent-resourceplacements-for-jobs>7. Create Independent ResourcePlacements for Jobs</h3><p>When submitting jobs, each one can be placed independently to allow for dynamic scheduling based on current cluster conditions. Here&rsquo;s how to create separate ResourcePlacements for each job:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># First, create a ResourcePlacement for the LocalQueue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>queue-placement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compute-jobs</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kueue.x-k8s.io</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>LocalQueue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>local-queue </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickAll </span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># Place queue in all available clusters</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>rollingUpdate</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxUnavailable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxSurge</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>unavailablePeriodSeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>60</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>applyStrategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>whenToApply</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>IfNotDrifted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>revisionHistoryLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>15</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>---</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#8f5902;font-style:italic># Then, create an independent ResourcePlacement for each job</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>job1-placement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compute-jobs</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>batch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Job</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>mock-workload</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># Schedule each job to a single cluster</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>preferredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>weight</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>40</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>preference</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>propertySorter</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>resources.kubernetes-fleet.io/available-cpu  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>sortOrder</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Descending  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>weight</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>30</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>preference</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>propertySorter</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>resources.kubernetes-fleet.io/available-memory</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>sortOrder</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Descending</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>rollingUpdate</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxUnavailable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxSurge</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>unavailablePeriodSeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>60</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>applyStrategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>whenToApply</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>IfNotDrifted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>revisionHistoryLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>15</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>---</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#8f5902;font-style:italic># Example of placing another job independently</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>job2-placement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compute-jobs</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>batch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Job</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>model-evaluation</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>preferredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>weight</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>40</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>preference</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>propertySorter</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>resources.kubernetes-fleet.io/available-cpu  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>sortOrder</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Descending  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>weight</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>30</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>preference</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>propertySorter</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>resources.kubernetes-fleet.io/available-memory</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>sortOrder</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Descending</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>rollingUpdate</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxUnavailable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxSurge</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%  </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>unavailablePeriodSeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>60</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>applyStrategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>whenToApply</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>IfNotDrifted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>revisionHistoryLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>15</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>This approach enables dynamic job scheduling for continuous job submissions. Here&rsquo;s how it works:</p><ol><li><p><strong>Initial Setup</strong>:</p><ul><li>The LocalQueue is placed on all clusters through its own ResourcePlacement with <code>placementType: PickAll</code></li><li>This ensures any cluster can potentially receive jobs based on their current capacity</li></ul></li><li><p><strong>Continuous Job Submission Pattern</strong>:</p><p>When submitting jobs continuously, each job needs its own unique identity and ResourcePlacement:</p><p>a. <strong>Job Creation</strong>:</p><ul><li>Generate a unique name for each job (e.g., using timestamp)</li><li>Create the job with the Kueue annotation pointing to the LocalQueue</li><li>Set <code>suspend: true</code> to allow Kueue to manage job execution</li><li>Define resource requirements specific to the job</li></ul><p>b. <strong>ResourcePlacement Creation</strong>:</p><ul><li>Create a new ResourcePlacement for each job</li><li>Name it to match or reference the job (e.g., <code>&lt;jobname>-placement</code>)</li><li>Set <code>placementType: PickN</code> with <code>numberOfClusters: 1</code></li><li>Configure affinity rules based on current requirements:<ul><li>CPU availability</li><li>Memory availability</li><li>Specific node capabilities</li><li>Geographic location</li><li>Cost considerations</li></ul></li></ul><p>c. <strong>Independent Scheduling</strong>:</p><ul><li>Each job&rsquo;s ResourcePlacement operates independently</li><li>Scheduling decisions are made based on real-time cluster conditions</li><li>New jobs can be submitted without affecting existing ones</li><li>Failed placements don&rsquo;t block other job submissions</li></ul><p>d. <strong>Resource Consideration</strong>:</p><ul><li>Check cluster capacity before submission</li><li>Consider job priority and resource requirements</li><li>Account for existing workload distribution</li><li>Allow time for placement and resource allocation</li></ul></li><li><p><strong>Monitoring Job Distribution</strong>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Watch job distribution across clusters</span>
</span></span><span style=display:flex><span>watch <span style=color:#4e9a06>&#39;for ctx in $(kubectl config get-contexts -o name); do
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  echo &#34;=== Cluster: $ctx ===&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  kubectl --context $ctx get jobs -n compute-jobs
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>done&#39;</span>
</span></span></code></pre></div></li></ol><p>This pattern ensures:</p><ul><li>Jobs are distributed based on real-time resource availability</li><li>No single cluster gets overloaded</li><li>System remains responsive as new jobs are continuously submitted</li><li>Each job can use different resource requirements or placement policies</li><li>Failed placements don&rsquo;t block the submission pipeline</li></ul><h4 id=verify-resourceplacements-completed>Verify ResourcePlacements Completed</h4><p>After creating the ResourcePlacements, verify that your jobs and LocalQueue are properly propagated:</p><ol><li>Check ResourcePlacement status for the LocalQueue:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Get detailed status of the queue ResourcePlacement</span>
</span></span><span style=display:flex><span>kubectl describe resourceplacement queue-placement -n compute-jobs
</span></span></code></pre></div><ol start=2><li>Check ResourcePlacement status for individual jobs:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Get detailed status of job placements</span>
</span></span><span style=display:flex><span>kubectl describe resourceplacement job1-placement -n compute-jobs
</span></span><span style=display:flex><span>kubectl describe resourceplacement job2-placement -n compute-jobs
</span></span></code></pre></div><h5 id=example>Example:</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>         </span><span style=color:#000>job1-placement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>compute-jobs</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>&lt;none&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>&lt;none&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>API Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>placement.kubernetes-fleet.io/v1beta1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>         </span><span style=color:#000>ResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Creation Timestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-23T22:41:26Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Finalizers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>kubernetes-fleet.io/crp-cleanup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>kubernetes-fleet.io/scheduler-cleanup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Resource Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#0000cf;font-weight:700>4416159</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>UID</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>91666f24-9b16-43cd-90f3-9a2e715733be</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-10-23T22:41:26Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>found all cluster needed as specified by the scheduling policy, found 1 cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-10-23T22:41:26Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>All 1 cluster(s) start rolling out the latest resource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ResourcePlacementRolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-10-23T22:41:26Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ResourcePlacementOverridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-10-23T22:41:26Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Works(s) are succcesfully created or updated in 1 target cluster(s)&#39; namespaces</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ResourcePlacementWorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-10-23T22:41:32Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Failed to apply resources to 1 cluster(s), please check the `failedPlacements` status</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>ApplyFailed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>False</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Observed Resource Index</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Placement Statuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Cluster Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>cluster-3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-23T22:41:26Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>Successfully scheduled resources for placement in &#34;cluster-3&#34; (affinity score: 70, topology spread score: 0): picked by scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-23T22:41:26Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-23T22:41:26Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-23T22:41:26Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-23T22:41:32Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>Work object training.job1-placement-work has failed to apply</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>NotAllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>False</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Drifted Placements</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>First Drifted Observed Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-23T22:41:32Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                        </span><span style=color:#000>batch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                         </span><span style=color:#000>Job</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                         </span><span style=color:#000>mock-workload</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#000>compute-jobs</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observation Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>             </span><span style=color:#000>2025-10-23T22:41:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Drifts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                              </span><span style=color:#000>/spec/selector/matchLabels/batch.kubernetes.io~1controller-uid</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Value In Member</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>f9e62977-6c5c-48aa-a82b-1421e2647395</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                              </span><span style=color:#000>/spec/suspend</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Value In Hub</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                      </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Value In Member</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                              </span><span style=color:#000>/spec/template/metadata/creationTimestamp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Value In Member</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>&lt;nil&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                              </span><span style=color:#000>/spec/template/metadata/labels/batch.kubernetes.io~1controller-uid</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Value In Member</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>f9e62977-6c5c-48aa-a82b-1421e2647395</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                              </span><span style=color:#000>/spec/template/metadata/labels/controller-uid</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Value In Member</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>f9e62977-6c5c-48aa-a82b-1421e2647395</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Target Cluster Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                             </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Failed Placements</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Condition</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>2025-10-23T22:41:32Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Message:               Failed to apply the manifest (error: cannot apply manifest</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>drifts are found between the manifest and the object from the member cluster in degraded mode (full comparison is performed instead of partial comparison, as the manifest object is considered to be invalid by the member cluster API server))</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>FoundDriftsInDegradedMode</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>False</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>batch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#000>Job</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#000>mock-workload</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>               </span><span style=color:#000>compute-jobs</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Resource Index</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Selected Resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>batch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>Job</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>mock-workload</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>compute-jobs</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Events</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Type    Reason                        Age   From                  Message</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>---- <span style=color:#f8f8f8;text-decoration:underline>   </span>------ <span style=color:#f8f8f8;text-decoration:underline>                       </span>---- <span style=color:#f8f8f8;text-decoration:underline> </span>---- <span style=color:#f8f8f8;text-decoration:underline>                 </span>-------<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementRolloutStarted       23s   placement-controller  Started rolling out the latest resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementOverriddenSucceeded  23s   placement-controller  Placement has been successfully overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementWorkSynchronized     23s   placement-controller  Work(s) have been created or updated successfully for the selected cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementApplied              22s   placement-controller  Resources have been applied to the selected cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementAvailable            22s   placement-controller  Resources are available on the selected cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Normal  PlacementRolloutCompleted     22s   placement-controller  Placement has finished the rollout process and reached the desired status</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><blockquote><p>NOTE: The ResourcePlacement will complete rollout but with detect drifts after initial application as kueue takes over the resources. Completition indication can be found in the events.</p></blockquote><ol start=2><li>Verify resources on target cluster:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Switch to member cluster context</span>
</span></span><span style=display:flex><span>kubectl config use-context &lt;member-cluster-context&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check if job and localqueue exist in the namespace</span>
</span></span><span style=display:flex><span>kubectl get jobs,localqueue -n compute-jobs
</span></span></code></pre></div><h2 id=how-it-works>How It Works</h2><p>The job scheduling process combines ClusterResourcePlacement, ResourcePlacement, and Kueue in the following orchestrated workflow:</p><h3 id=-workflow-overview>ðŸ”„ Workflow Overview</h3><ol><li><p><strong>ClusterResourcePlacement Phase</strong>:</p><ul><li>Propagates cluster-scoped resources (ResourceFlavor, ClusterQueue) to selected member clusters</li><li>Ensures the namespace is created on target clusters</li><li>Sets up the foundational Kueue infrastructure across the fleet</li></ul></li><li><p><strong>ResourcePlacement Phase</strong>:</p><ul><li>Selects appropriate clusters based on resource constraints</li><li>Propagates the AI/ML job and LocalQueue to the selected cluster(s)</li></ul></li><li><p><strong>Kueue Management Phase</strong>:</p><ul><li>Manages job admission based on ClusterQueue quotas</li><li>Controls job execution through suspend/unsuspend mechanism</li><li>Handles resource tracking and quota enforcement</li><li>Maintains job queuing and priority order</li></ul></li></ol><h3 id=-resource-flow>ðŸŽ¯ Resource Flow</h3><pre tabindex=0><code>Hub Cluster                    Member Cluster(s)
â”œâ”€â”€ ResourceFlavor       â”€â”€â”€â”€â”€â”€â–º ResourceFlavor
â”œâ”€â”€ ClusterQueue         â”€â”€â”€â”€â”€â”€â–º ClusterQueue  
â”œâ”€â”€ Namespace           â”€â”€â”€â”€â”€â”€â–º Namespace
â”œâ”€â”€ LocalQueue          â”€â”€â”€â”€â”€â”€â–º LocalQueue
â””â”€â”€ AI Job              â”€â”€â”€â”€â”€â”€â–º AI Job â†’ Kueue â†’ Pod
</code></pre><h2 id=best-practices>Best Practices</h2><ol><li><p><strong>Resource Management</strong></p><ul><li>Always specify both requests and limits for resources</li><li>Set realistic resource requirements based on workload needs</li><li>Consider additional resources needed for data processing</li></ul></li><li><p><strong>Queue Configuration</strong></p><ul><li>Configure quotas based on actual cluster capacity</li><li>Create separate queues for different workload types</li><li>Use cohorts to manage related jobs efficiently</li></ul></li><li><p><strong>Placement Strategy</strong></p><ul><li>Define clear cluster selection criteria</li><li>Consider workload requirements when setting affinities</li><li>Plan for high availability with backup clusters</li></ul></li></ol><h2 id=monitoring-and-troubleshooting>Monitoring and Troubleshooting</h2><h3 id=-monitoring-job-status>ðŸ“Š Monitoring Job Status</h3><h4 id=check-placement-status>Check Placement Status</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># View ResourcePlacement status</span>
</span></span><span style=display:flex><span>kubectl get resourceplacement &lt;rp-name&gt; -n &lt;namespace&gt; -o yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># View ClusterResourcePlacement status</span>
</span></span><span style=display:flex><span>kubectl get clusterresourceplacement &lt;crp-name&gt; -o yaml
</span></span></code></pre></div><h4 id=monitor-queue-status-on-member-cluster>Monitor Queue Status on Member Cluster</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check LocalQueue status</span>
</span></span><span style=display:flex><span>kubectl get localqueue &lt;lq-name&gt; -n &lt;namespace&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check ClusterQueue status</span>
</span></span><span style=display:flex><span>kubectl get clusterqueue &lt;cq-name&gt; -o wide
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Check Job status</span>
</span></span><span style=display:flex><span>kubectl get job &lt;job-name&gt; -n &lt;namespace&gt;
</span></span></code></pre></div><h2 id=related-resources>Related Resources</h2><h3 id=-documentation>ðŸ“š Documentation</h3><ul><li><a href=https://kueue.sigs.k8s.io/docs/>Kueue Documentation</a> - Complete Kueue setup and configuration guide</li><li><a href=/docs/concepts/crp/>ClusterResourcePlacement Concepts</a> - Understanding cluster-scoped resource propagation</li><li><a href=/docs/concepts/rp/>ResourcePlacement Concepts</a> - Namespace-scoped resource scheduling</li><li><a href=/docs/how-tos/property-based-scheduling/>Properties-based Scheduling</a> - Advanced cluster selection strategies</li></ul><h3 id=-related-how-to-guides>ðŸ”— Related How-To Guides</h3><ul><li><a href=/docs/how-tos/clusters/>Managing Cluster Resources</a> - Setting up and configuring member clusters</li><li><a href=/docs/how-tos/resource-override/>Resource Override</a> - Customizing resources per cluster</li><li><a href=/docs/how-tos/affinities/>Affinities</a> - Advanced placement constraints</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-68ec2370d0409cc27325be36693f9368>4 - Tutorials</h1><div class=lead>Guide for integrating KubeFleet with your development and operations workflows</div><div class="pageinfo pageinfo-primary"><p>This guide will help you understand how KubeFleet can seamlessly integrate with your development and operations workflows. Follow the instructions provided to get the most out of KubeFleet&rsquo;s features. Below is a walkthrough of all the tutorials currently available.</p></div></div><div class=td-content><h1 id=pg-f30bed2e013ae9043ec31b7a759aae4e>4.1 - Resource Migration Across Clusters</h1><div class=lead>Migrating Applications to Another Cluster When a Cluster Goes Down</div><p>This tutorial demonstrates how to move applications from clusters have gone down to other operational clusters using Fleet.</p><h2 id=scenario>Scenario</h2><p>Your fleet consists of the following clusters:</p><ol><li>Member Cluster 1 & Member Cluster 2 (WestUS, 1 node each)</li><li>Member Cluster 3 (EastUS2, 2 nodes)</li><li>Member Cluster 4 & Member Cluster 5 (WestEurope, 3 nodes each)</li></ol><p>Due to certain circumstances, Member Cluster 1 and Member Cluster 2 are down, requiring you to migrate your applications from these clusters to other operational ones.</p><h2 id=current-application-resources>Current Application Resources</h2><p>The following resources are currently deployed in Member Cluster 1 and Member Cluster 2 by the ClusterResourcePlacement:</p><h4 id=service>Service</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Service</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx-service</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>ports</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>protocol</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>TCP</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>80</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>targetPort</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>80</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>LoadBalancer</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Summary:</p><ul><li>This defines a Kubernetes Service named <code>nginx-svc</code> in the <code>test-app</code> namespace.</li><li>The service is of type LoadBalancer, meaning it exposes the application to the internet.</li><li>It targets pods with the label app: nginx and forwards traffic to port 80 on the pods.</li></ul><h4 id=deployment>Deployment</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx-deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>replicas</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>template</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>containers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx:1.16.1 </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>ports</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>containerPort</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>80</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Summary:</p><ul><li>This defines a Kubernetes Deployment named <code>nginx-deployment</code> in the <code>test-app</code> namespace.</li><li>It creates 2 replicas of the nginx pod, each running the <code>nginx:1.16.1</code> image.</li><li>The deployment ensures that the specified number of pods (replicas) are running and available.</li><li>The pods are labeled with <code>app: nginx</code> and expose port 80.</li></ul><h4 id=clusterresourceplacement>ClusterResourcePlacement</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubectl.kubernetes.io/last-applied-configuration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      {&#34;apiVersion&#34;:&#34;placement.kubernetes-fleet.io/v1&#34;,&#34;kind&#34;:&#34;ClusterResourcePlacement&#34;,&#34;metadata&#34;:{&#34;annotations&#34;:{},&#34;name&#34;:&#34;crp-migration&#34;},&#34;spec&#34;:{&#34;policy&#34;:{&#34;affinity&#34;:{&#34;clusterAffinity&#34;:{&#34;requiredDuringSchedulingIgnoredDuringExecution&#34;:{&#34;clusterSelectorTerms&#34;:[{&#34;labelSelector&#34;:{&#34;matchLabels&#34;:{&#34;fleet.azure.com/location&#34;:&#34;westus&#34;}}}]}}},&#34;numberOfClusters&#34;:2,&#34;placementType&#34;:&#34;PickN&#34;},&#34;resourceSelectors&#34;:[{&#34;group&#34;:&#34;&#34;,&#34;kind&#34;:&#34;Namespace&#34;,&#34;name&#34;:&#34;test-app&#34;,&#34;version&#34;:&#34;v1&#34;}],&#34;revisionHistoryLimit&#34;:10,&#34;strategy&#34;:{&#34;type&#34;:&#34;RollingUpdate&#34;}}}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>creationTimestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>finalizers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>kubernetes-fleet.io/crp-cleanup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>kubernetes-fleet.io/scheduler-cleanup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-migration</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;22177519&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>0683cfaa-df24-4b2c-8a3d-07031692da8f</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>fleet.azure.com/location</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>westus</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>revisionHistoryLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all cluster needed as specified by the scheduling policy, found</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All 2 cluster(s) start rolling out the latest resource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementRolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementOverridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Works(s) are succcesfully created or updated in 2 target cluster(s)&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>namespaces</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementWorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources are successfully applied to 2 cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:45Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources in 2 cluster(s) are available now</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>observedResourceIndex</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementStatuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>aks-member-2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in &#34;aks-member-2&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        (affinity score: 0, topology spread score: 0): picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:45Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkAreAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>aks-member-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in &#34;aks-member-1&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        (affinity score: 0, topology spread score: 0): picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:35Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:27:45Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkAreAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx-deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Service</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx-service</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Summary:</p><ul><li>This defines a ClusterResourcePlacement named <code>crp-migration</code>.</li><li>The PickN placement policy selects 2 clusters based on the label <code>fleet.azure.com/location: westus</code>. Consequently, it chooses Member Cluster 1 and Member Cluster 2, as they are located in WestUS.</li><li>It targets resources in the <code>test-app</code> namespace.</li></ul><h2 id=migrating-applications-to-a-cluster-to-other-operational-clusters>Migrating Applications to a Cluster to Other Operational Clusters</h2><p>When the clusters in WestUS go down, update the ClusterResourcePlacement (CRP) to migrate the applications to other clusters.
In this tutorial, we will move them to Member Cluster 4 and Member Cluster 5, which are located in WestEurope.</p><h4 id=update-the-crp-for-migration-to-clusters-in-westeurope>Update the CRP for Migration to Clusters in WestEurope</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-migration</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>fleet.azure.com/location</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>westeurope </span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># updated label</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>revisionHistoryLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Update the <code>crp.yaml</code> to reflect the new region and apply it:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f crp.yaml
</span></span></code></pre></div><h3 id=results>Results</h3><p>After applying the updated <code>crp.yaml</code>, the Fleet will schedule the application on the available clusters in WestEurope.
You can check the status of the CRP to ensure that the application has been successfully migrated and is running on the newly selected clusters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get crp crp-migration -o yaml
</span></span></code></pre></div><p>You should see a status indicating that the application is now running in the clusters located in WestEurope, similar to the following:</p><h4 id=crp-status>CRP Status</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:02Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all cluster needed as specified by the scheduling policy, found</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All 2 cluster(s) start rolling out the latest resource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementRolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementOverridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Works(s) are succcesfully created or updated in 2 target cluster(s)&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>namespaces</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementWorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources are successfully applied to 2 cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources in 2 cluster(s) are available now</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>observedResourceIndex</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementStatuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>aks-member-5</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:02Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in &#34;aks-member-5&#34; (affinity
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        score: 0, topology spread score: 0): picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkAreAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>aks-member-4</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:02Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in &#34;aks-member-4&#34; (affinity
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        score: 0, topology spread score: 0): picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T21:36:14Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkAreAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx-deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Service</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx-service</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=conclusion>Conclusion</h2><p>This tutorial demonstrated how to migrate applications using Fleet when clusters in one region go down.
By updating the ClusterResourcePlacement, you can ensure that your applications are moved to available clusters in another region, maintaining availability and resilience.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-beb3175636ed99415e3048a146b6c625>4.2 - Resource Migration With Overrides</h1><div class=lead>Migrating Applications to Another Cluster For Higher Availability With Overrides</div><p>This tutorial shows how to migrate applications from clusters with lower availability to those with higher availability,
while also scaling up the number of replicas, using Fleet.</p><h2 id=scenario>Scenario</h2><p>Your fleet consists of the following clusters:</p><ol><li>Member Cluster 1 & Member Cluster 2 (WestUS, 1 node each)</li><li>Member Cluster 3 (EastUS2, 2 nodes)</li><li>Member Cluster 4 & Member Cluster 5 (WestEurope, 3 nodes each)</li></ol><p>Due to a sudden increase in traffic and resource demands in your WestUS clusters, you need to migrate your applications to clusters in EastUS2 or WestEurope that have higher availability and can better handle the increased load.</p><h2 id=current-application-resources>Current Application Resources</h2><p>The following resources are currently deployed in the WestUS clusters:</p><h4 id=service>Service</h4><blockquote><p>Note: Service test file located <a href=/docs/tutorials/migrationwithoverridedr/testfiles/nginx-service.yaml>here</a>.</p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Service</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx-service</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>ports</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>protocol</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>TCP</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>80</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>targetPort</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>80</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>LoadBalancer</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Summary:</p><ul><li>This defines a Kubernetes Service named <code>nginx-svc</code> in the <code>test-app</code> namespace.</li><li>The service is of type LoadBalancer, meaning it exposes the application to the internet.</li><li>It targets pods with the label app: nginx and forwards traffic to port 80 on the pods.</li></ul><h4 id=deployment>Deployment</h4><blockquote><p>Note: Deployment test file located <a href=/docs/tutorials/migrationwithoverridedr/testfiles/nginx-deployment.yaml>here</a>.</p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx-deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>replicas</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>template</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>containers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx:1.16.1 </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>ports</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>containerPort</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>80</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><blockquote><p>Note: The current deployment has 2 replicas.</p></blockquote><p>Summary:</p><ul><li>This defines a Kubernetes Deployment named <code>nginx-deployment</code> in the <code>test-app</code> namespace.</li><li>It creates 2 replicas of the nginx pod, each running the <code>nginx:1.16.1</code> image.</li><li>The deployment ensures that the specified number of pods (replicas) are running and available.</li><li>The pods are labeled with <code>app: nginx</code> and expose port 80.</li></ul><h4 id=clusterresourceplacement>ClusterResourcePlacement</h4><blockquote><p>Note: CRP Availability test file located <a href=/docs/tutorials/migrationwithoverridedr/testfiles/crp-availability.yaml>here</a></p></blockquote><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kubectl.kubernetes.io/last-applied-configuration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      {&#34;apiVersion&#34;:&#34;placement.kubernetes-fleet.io/v1&#34;,&#34;kind&#34;:&#34;ClusterResourcePlacement&#34;,&#34;metadata&#34;:{&#34;annotations&#34;:{},&#34;name&#34;:&#34;crp-availability&#34;},&#34;spec&#34;:{&#34;policy&#34;:{&#34;affinity&#34;:{&#34;clusterAffinity&#34;:{&#34;requiredDuringSchedulingIgnoredDuringExecution&#34;:{&#34;clusterSelectorTerms&#34;:[{&#34;labelSelector&#34;:{&#34;matchLabels&#34;:{&#34;fleet.azure.com/location&#34;:&#34;westus&#34;}}}]}}},&#34;numberOfClusters&#34;:2,&#34;placementType&#34;:&#34;PickN&#34;},&#34;resourceSelectors&#34;:[{&#34;group&#34;:&#34;&#34;,&#34;kind&#34;:&#34;Namespace&#34;,&#34;name&#34;:&#34;test-app&#34;,&#34;version&#34;:&#34;v1&#34;}],&#34;revisionHistoryLimit&#34;:10,&#34;strategy&#34;:{&#34;type&#34;:&#34;RollingUpdate&#34;}}}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>creationTimestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>finalizers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>kubernetes-fleet.io/crp-cleanup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#000>kubernetes-fleet.io/scheduler-cleanup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-availability</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;22228766&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>uid</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>58dbb5d1-4afa-479f-bf57-413328aa61bd</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>fleet.azure.com/location</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>westus</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>revisionHistoryLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all cluster needed as specified by the scheduling policy, found</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All 2 cluster(s) start rolling out the latest resource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementRolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementOverridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Works(s) are succcesfully created or updated in 2 target cluster(s)&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>namespaces</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementWorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources are successfully applied to 2 cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:01:02Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources in 2 cluster(s) are available now</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>observedResourceIndex</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementStatuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>aks-member-2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in &#34;aks-member-2&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        (affinity score: 0, topology spread score: 0): picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:01:02Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkAreAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>aks-member-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in &#34;aks-member-1&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        (affinity score: 0, topology spread score: 0): picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:00:53Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:01:02Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkAreAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx-deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Service</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx-service</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Summary:</p><ul><li>This defines a ClusterResourcePlacement named <code>crp-availability</code>.</li><li>The placement policy PickN selects 2 clusters. The clusters are selected based on the label <code>fleet.azure.com/location: westus</code>.</li><li>It targets resources in the <code>test-app</code> namespace.</li></ul><h3 id=identify-clusters-with-more-availability>Identify Clusters with More Availability</h3><p>To identify clusters with more availability, you can check the member cluster properties.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get memberclusters -A -o wide
</span></span></code></pre></div><p>The output will show the availability in each cluster, including the number of nodes, available CPU, and memory.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>NAME                                JOINED   AGE   NODE-COUNT   AVAILABLE-CPU   AVAILABLE-MEMORY   ALLOCATABLE-CPU   ALLOCATABLE-MEMORY
</span></span><span style=display:flex><span>aks-member-1                        True     22d   <span style=color:#0000cf;font-weight:700>1</span>            30m             40Ki               1900m             4652296Ki
</span></span><span style=display:flex><span>aks-member-2                        True     22d   <span style=color:#0000cf;font-weight:700>1</span>            30m             40Ki               1900m             4652296Ki
</span></span><span style=display:flex><span>aks-member-3                        True     22d   <span style=color:#0000cf;font-weight:700>2</span>            2820m           8477196Ki          3800m             9304588Ki
</span></span><span style=display:flex><span>aks-member-4                        True     22d   <span style=color:#0000cf;font-weight:700>3</span>            4408m           12896012Ki         5700m             13956876Ki
</span></span><span style=display:flex><span>aks-member-5                        True     22d   <span style=color:#0000cf;font-weight:700>3</span>            4408m           12896024Ki         5700m             13956888Ki
</span></span></code></pre></div><p>Based on the available resources, you can see that Member Cluster 3 in EastUS2 and Member Cluster 4 & 5 in WestEurope have more nodes and available resources compared to the WestUS clusters.</p><h2 id=migrating-applications-to-a-different-cluster-with-more-availability-while-scaling-up>Migrating Applications to a Different Cluster with More Availability While Scaling Up</h2><p>When the clusters in WestUS are nearing capacity limits and risk becoming overloaded, update the ClusterResourcePlacement (CRP) to migrate the applications to clusters in EastUS2 or WestEurope, which have more available resources and can handle increased demand more effectively.
For this tutorial, we will move them to WestEurope.</p><h2 id=create-resource-override>Create Resource Override</h2><blockquote><p>Note: Cluster resource override test file located <a href=/docs/tutorials/migrationwithoverridedr/testfiles/ro-1.yaml>here</a></p></blockquote><p>To scale up during migration, apply this override before updating crp:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceOverride</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ro-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx-deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>overrideRules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>clusterSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>labelSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>fleet.azure.com/location</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>westeurope</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>jsonPatchOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- <span style=color:#204a87;font-weight:700>op</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>replace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/spec/replicas</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>This override updates the <code>nginx-deployment</code> Deployment in the <code>test-app</code> namespace by setting the number of replicas to &ldquo;4&rdquo; for clusters located in the westeurope region.</p><h4 id=update-the-crp-for-migration>Update the CRP for Migration</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>placement.kubernetes-fleet.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacement</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>crp-availability</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>policy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>placementType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PickN</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>numberOfClusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>affinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clusterAffinity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>clusterSelectorTerms</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>propertySelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>matchExpressions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kubernetes-fleet.io/node-count</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Ge</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#204a87;font-weight:700>values</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                      </span>- <span style=color:#4e9a06>&#34;3&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>resourceSelectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>revisionHistoryLimit</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Update the <a href=/docs/tutorials/migrationwithoverridedr/testfiles/crp-availability.yaml><code>crp-availability.yaml</code></a> to reflect selecting clusters with higher node-count and apply it:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f crp-availability.yaml
</span></span></code></pre></div><h3 id=results>Results</h3><p>After applying the updated <a href=/docs/tutorials/migrationwithoverridedr/testfiles/crp-availability.yaml><code>crp-availability.yaml</code></a>, the Fleet will schedule the application on the available clusters in WestEurope as they each have 3 nodes.
You can check the status of the CRP to ensure that the application has been successfully migrated and is running in the new region:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get crp crp-availability -o yaml
</span></span></code></pre></div><p>You should see a status indicating that the application is now running in the WestEurope clusters, similar to the following:</p><h4 id=crp-status>CRP Status</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:08Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>found all cluster needed as specified by the scheduling policy, found</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:20Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All 2 cluster(s) start rolling out the latest resource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementRolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:20Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources are successfully overridden in 2 cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OverriddenSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementOverridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:20Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Works(s) are succcesfully created or updated in 2 target cluster(s)&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>namespaces</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementWorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:21Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources are successfully applied to 2 cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:30Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The selected resources in 2 cluster(s) are available now</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ResourceAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ClusterResourcePlacementAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>observedResourceIndex</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>placementStatuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>applicableResourceOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ro-1-0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>aks-member-5</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:08Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in &#34;aks-member-5&#34; (affinity
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        score: 0, topology spread score: 0): picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:20Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:20Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully applied the override rules on the resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OverriddenSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:20Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:21Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:30Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkAreAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>applicableResourceOverrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ro-1-0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>clusterName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>aks-member-4</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:08Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in &#34;aks-member-4&#34; (affinity
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        score: 0, topology spread score: 0): picked by scheduling policy&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:08Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:08Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Successfully applied the override rules on the resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OverriddenSucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:08Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:09Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2024-07-25T23:10:19Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>All corresponding work objects are available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AllWorkAreAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectedResources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>group</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx-deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Service</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>nginx-service</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>test-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The status indicates that the application has been successfully migrated to the WestEurope clusters and is now running with 4 replicas, as the resource override has been applied.</p><p>To double-check, you can also verify the number of replicas in the <code>nginx-deployment</code>:</p><ol><li>Change context to member cluster 4 or 5:<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context aks-member-4
</span></span></code></pre></div></li><li>Get the deployment:<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get deployment nginx-deployment -n test-app -o wide
</span></span></code></pre></div></li></ol><h2 id=conclusion>Conclusion</h2><p>This tutorial demonstrated how to migrate applications using Fleet from clusters with lower availability to those with higher availability.
By updating the ClusterResourcePlacement and applying a ResourceOverride, you can ensure that your applications are moved to clusters with better availability while also scaling up the number of replicas to enhance performance and resilience.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-1bfc1b59cc6e4f5f6eab261a68e88f97>4.3 - KubeFleet and ArgoCD Integration</h1><div class=lead>See KubeFleet and ArgoCD working together to efficiently manage Gitops promotion</div><p>This hands-on guide of KubeFleet and ArgoCD integration shows how these powerful tools work in concert to revolutionize multi-cluster application management.
Discover how KubeFleet&rsquo;s intelligent orchestration capabilities complement ArgoCD&rsquo;s popular GitOps approach, enabling seamless deployments across diverse environments while maintaining consistency and control.
This tutorial illuminates practical strategies for targeted deployments, environment-specific configurations, and safe, controlled rollouts.
Follow along to transform your multi-cluster challenges into streamlined, automated workflows that enhance both developer productivity and operational reliability.</p><p>Suppose in a multi-cluster, multi-tenant organization, team A wants to deploy the resources ONLY to the clusters they own.
They want to make sure each cluster receives the correct configuration, and they want to ensure safe deployment by rolling out to their staging environment first, then to canary if staging is healthy, and lastly to the production.
Our tutorial will walk you through a hands-on experience of how to achieve this. Below image demonstrates the major components and their interactions.</p><p><img src=/images/en/docs/tutorials/ArgoCD/fleet-argocd-integration.png alt></p><h2 id=prerequisites>Prerequisites</h2><h3 id=kubefleet-environment>KubeFleet environment</h3><p>In this tutorial, we prepare a fleet environment with one hub cluster and four member clusters.
The member clusters are labeled to indicate their environment and team ownership.
From the hub cluster, we can verify the clustermembership and their labels:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl get memberclusters --show-labels
</span></span><span style=display:flex><span>NAME      JOINED   AGE    MEMBER-AGENT-LAST-SEEN   NODE-COUNT   AVAILABLE-CPU   AVAILABLE-MEMORY   LABELS
</span></span><span style=display:flex><span>member1   True     84d    10s                      <span style=color:#0000cf;font-weight:700>3</span>            4036m           13339148Ki         <span style=color:#000>environment</span><span style=color:#ce5c00;font-weight:700>=</span>staging,team<span style=color:#ce5c00;font-weight:700>=</span>A,...
</span></span><span style=display:flex><span>member2   True     84d    14s                      <span style=color:#0000cf;font-weight:700>3</span>            4038m           13354748Ki         <span style=color:#000>environment</span><span style=color:#ce5c00;font-weight:700>=</span>canary,team<span style=color:#ce5c00;font-weight:700>=</span>A,...
</span></span><span style=display:flex><span>member3   True     144m   6s                       <span style=color:#0000cf;font-weight:700>3</span>            3676m           12458504Ki         <span style=color:#000>environment</span><span style=color:#ce5c00;font-weight:700>=</span>production,team<span style=color:#ce5c00;font-weight:700>=</span>A,...
</span></span><span style=display:flex><span>member4   True     6m7s   15s                      <span style=color:#0000cf;font-weight:700>3</span>            4036m           13347336Ki         <span style=color:#000>team</span><span style=color:#ce5c00;font-weight:700>=</span>B,...
</span></span></code></pre></div><p>From above output, we can see that:</p><ul><li><code>member1</code> is in <code>staging</code> environment and owned by team <code>A</code>.</li><li><code>member2</code> is in <code>canary</code> environment and owned by team <code>A</code>.</li><li><code>member3</code> is in <code>production</code> environment and owned by team <code>A</code>.</li><li><code>member4</code> is owned by team <code>B</code>.</li></ul><h3 id=install-argocd>Install ArgoCD</h3><p>In this tutorial, we expect ArgoCD controllers to be installed on each member cluster. Only ArgoCD CRDs need to be installed on the hub cluster so that ArgoCD <code>Applications</code> can be created.</p><ul><li><p><strong>Option 1: Install ArgoCD on each member cluster directly (RECOMMENDED)</strong></p><p>It&rsquo;s straightforward to install ArgoCD on each member cluster. You can follow the instructions in <a href=https://argo-cd.readthedocs.io/en/stable/getting_started/>ArgoCD Getting Started</a>.<br>To install only CRDs on the hub cluster, you can run the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl apply -k https://github.com/argoproj/argo-cd/manifests/crds?ref<span style=color:#ce5c00;font-weight:700>=</span>stable --server-side<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
</span></span></code></pre></div></li><li><p><strong>Option 2: Use KubeFleet ClusterResourcePlacement (CRP) to install ArgoCD on member clusters (Experimental)</strong></p><p>Alternatively, you can first install all the ArgoCD manifests on the hub cluster, and then use KubeFleet <code>ClusterResourcePlacement</code> to populate to the member clusters.
Install the CRDs on the hub cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl apply -k https://github.com/argoproj/argo-cd/manifests/crds?ref<span style=color:#ce5c00;font-weight:700>=</span>stable --server-side<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
</span></span></code></pre></div><p>Then apply the resource manifest we prepared (<a href=/docs/tutorials/argocd/manifests/argocd-install.yaml>argocd-install.yaml</a>) to the hub cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl create ns argocd <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> kubectl apply -f ./manifests/argocd-install.yaml -n argocd --server-side<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
</span></span></code></pre></div><p>We then use a <code>ClusterResourcePlacement</code> (refer to <a href=/docs/tutorials/argocd/manifests/argocd-crp.yaml>argocd-crp.yaml</a>) to populate the manifests to the member clusters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl apply -f ./manifests/argocd-crp.yaml
</span></span></code></pre></div><p>Verify the CRP becomes available:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get crp
</span></span><span style=display:flex><span>NAME                GEN   SCHEDULED   SCHEDULED-GEN   AVAILABLE   AVAILABLE-GEN   AGE
</span></span><span style=display:flex><span>crp-argocd          <span style=color:#0000cf;font-weight:700>1</span>     True        <span style=color:#0000cf;font-weight:700>1</span>               True        <span style=color:#0000cf;font-weight:700>1</span>               79m
</span></span></code></pre></div></li></ul><h3 id=enable-applications-in-any-namespace-in-argocd>Enable &ldquo;Applications in any namespace&rdquo; in ArgoCD</h3><p>In this tutorial, we are going to deploy an ArgoCD <code>Application</code> in the guestbook namespace.
Enabling &ldquo;Applications in any namespace&rdquo; feature, application teams can manage their applications in a more flexible way without the risk of a privilege escalation. In this tutorial, we need to enable <code>Applications</code> to be created in the <code>guestbook</code> namespace.</p><ul><li><p><strong>Option 1: Enable on each member cluster manually</strong></p><p>You can follow the instructions in <a href=https://argo-cd.readthedocs.io/en/latest/operator-manual/app-any-namespace/>ArgoCD Applications-in-any-namespace</a> documentation to enable this feature on each member cluster manually.<br>It generally involves updating the <code>argocd-cmd-params-cm</code> configmap and restarting the <code>argocd-application-controller</code> statefulset and <code>argocd-server</code> deployment.<br>You will also want to create an ArgoCD <code>AppProject</code> in the <code>argocd</code> namespace for <code>Applications</code> to refer to. You can find the manifest at <a href=/docs/tutorials/argocd/manifests/guestbook-appproject.yaml>guestbook-appproject.yaml</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat ./manifests/guestbook-appproject.yaml
</span></span><span style=display:flex><span>apiVersion: argoproj.io/v1alpha1
</span></span><span style=display:flex><span>kind: AppProject
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  name: guestbook-project
</span></span><span style=display:flex><span>  namespace: argocd
</span></span><span style=display:flex><span>spec:
</span></span><span style=display:flex><span>  sourceNamespaces:
</span></span><span style=display:flex><span>  - guestbook
</span></span><span style=display:flex><span>  destinations:
</span></span><span style=display:flex><span>  - namespace: <span style=color:#4e9a06>&#39;*&#39;</span>
</span></span><span style=display:flex><span>    server: https://kubernetes.default.svc
</span></span><span style=display:flex><span>  sourceRepos:
</span></span><span style=display:flex><span>  - <span style=color:#4e9a06>&#39;*&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl config use-context member&lt;*&gt;
</span></span><span style=display:flex><span>kubectl apply -f ./manifests/guestbook-appproject.yaml
</span></span></code></pre></div></li><li><p><strong>Option 2: Populate ArgoCD AppProject to member clusters with CRP (Experimental)</strong></p><p>If you tried above Option 2 to install ArgoCD from hub cluster to member clusters, you gain the flexibility by just updating the <code>argocd-cmd-params-cm</code> configmap, and adding the <a href=/docs/tutorials/argocd/manifests/guestbook-appproject.yaml>guestbook-appproject</a> to the <code>argocd</code> namespace, and <a href=/docs/tutorials/argocd/manifests/argocd-crp.yaml>existing CRP</a> will populate the resources automatically to the member clusters. <em>Note: you probably also want to update the <code>argocd-application-controller</code> and <code>argocd-server</code> a bit to trigger pod restarts.</em></p></li></ul><h2 id=deploy-resources-to-clusters-using-argocd-application-orchestrated-by-kubefleet>Deploy resources to clusters using ArgoCD Application orchestrated by KubeFleet</h2><p>We have prepared one <code>guestbook-ui</code> deployment with corresponding service for each environment.
The deployments are same except for the replica count. This simulates different configurations for different clusters. You may find the manifests <a href=/docs/tutorials/argocd/manifests/guestbook/production/guestbook-ui.yaml>here</a>.</p><pre tabindex=0><code>guestbook  
â”‚
â””â”€â”€â”€staging
â”‚   â”‚   guestbook-ui.yaml
|
â””â”€â”€â”€canary
|   â”‚   guestbook-ui.yaml
|
â””â”€â”€â”€production
    â”‚   guestbook-ui.yaml
</code></pre><h3 id=deploy-an-argocd-application-for-gitops-continuous-delivery>Deploy an ArgoCD Application for gitops continuous delivery</h3><p>Team A want to create an ArgoCD <code>Application</code> to automatically sync the manifests from git repository to the member clusters.
The <code>Application</code> should be created on the hub cluster and placed onto the member clusters team A owns. The <code>Application</code> example can be found at <a href=/docs/tutorials/argocd/manifests/guestbook-app.yaml>guestbook-app.yaml</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl create ns guestbook
</span></span><span style=display:flex><span>kubectl apply of - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: argoproj.io/v1alpha1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: Application
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: guestbook-app
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  namespace: guestbook 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  destination:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    namespace: guestbook
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    server: https://kubernetes.default.svc
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  project: guestbook-project
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  source:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    path: content/en/docs/tutorials/ArgoCD/manifests/guestbook
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    repoURL: https://github.com/kubefleet-dev/website.git
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    targetRevision: main
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  syncPolicy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    automated:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      prune: true
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      selfHeal: true
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    retry:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      backoff:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        duration: 5s
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        factor: 2
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        maxDuration: 3m0s
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      limit: 10
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    syncOptions:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - PruneLast=true
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - PrunePropagationPolicy=foreground
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - CreateNamespace=true
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - ApplyOutOfSyncOnly=true
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><h3 id=place-argocd-application-to-member-clusters-with-crp>Place ArgoCD Application to member clusters with CRP</h3><p>A <code>ClusterResourcePlacement</code> (CRP) is used to place resources on the hub cluster to member clusters.
Team A is able to select their own member clusters by specifying cluster labels.
In <code>spec.resourceSelectors</code>, specifying <code>guestbook</code> namespace includes all resources in it including the <code>Application</code> just deployed.
The <code>spec.strategy.type</code> is set to <code>External</code> so that CRP is not rolled out immediately. Instead, rollout will be triggered separately in next steps.
The CRP resource can be found at <a href=/docs/tutorials/argocd/manifests/guestbook-crp.yaml>guestbook-crp.yaml</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterResourcePlacement
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: guestbook-crp
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  policy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    placementType: PickAll # select all member clusters with label team=A
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    affinity:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      clusterAffinity:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        requiredDuringSchedulingIgnoredDuringExecution:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>          clusterSelectorTerms:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            - labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>                  team: A # label selectors
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSelectors:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  - group: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    kind: Namespace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    name: guestbook # select guestbook namespace with all resources in it
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    version: v1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  revisionHistoryLimit: 10
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  strategy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    type: External # will use an updateRun to trigger the rollout
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><p>Verify the CRP status and it&rsquo;s clear that only <code>member1</code>, <code>member2</code>, and <code>member3</code> are selected with <code>team=A</code> label are selected, and rollout has not started yet.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get crp guestbook-crp -o yaml
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>status:
</span></span><span style=display:flex><span>  conditions:
</span></span><span style=display:flex><span>  - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-23T23:46:56Z&#34;</span>
</span></span><span style=display:flex><span>    message: found all cluster needed as specified by the scheduling policy, found
</span></span><span style=display:flex><span>      <span style=color:#0000cf;font-weight:700>3</span> cluster<span style=color:#ce5c00;font-weight:700>(</span>s<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    reason: SchedulingPolicyFulfilled
</span></span><span style=display:flex><span>    status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>    type: ClusterResourcePlacementScheduled
</span></span><span style=display:flex><span>  - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-23T23:46:56Z&#34;</span>
</span></span><span style=display:flex><span>    message: There are still <span style=color:#0000cf;font-weight:700>3</span> cluster<span style=color:#ce5c00;font-weight:700>(</span>s<span style=color:#ce5c00;font-weight:700>)</span> in the process of deciding whether to roll
</span></span><span style=display:flex><span>      out the latest resources or not
</span></span><span style=display:flex><span>    observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    reason: RolloutStartedUnknown
</span></span><span style=display:flex><span>    status: Unknown
</span></span><span style=display:flex><span>    type: ClusterResourcePlacementRolloutStarted
</span></span><span style=display:flex><span>  observedResourceIndex: <span style=color:#4e9a06>&#34;0&#34;</span>
</span></span><span style=display:flex><span>  placementStatuses:
</span></span><span style=display:flex><span>  - clusterName: member1
</span></span><span style=display:flex><span>    conditions:
</span></span><span style=display:flex><span>    - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T00:22:22Z&#34;</span>
</span></span><span style=display:flex><span>      message: <span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in &#34;member1&#34; (affinity
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        score: 0, topology spread score: 0): picked by scheduling policy&#39;</span>
</span></span><span style=display:flex><span>      observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      reason: Scheduled
</span></span><span style=display:flex><span>      status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>      type: Scheduled
</span></span><span style=display:flex><span>    - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T00:22:22Z&#34;</span>
</span></span><span style=display:flex><span>      message: In the process of deciding whether to roll out the latest resources
</span></span><span style=display:flex><span>        or not
</span></span><span style=display:flex><span>      observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      reason: RolloutStartedUnknown
</span></span><span style=display:flex><span>      status: Unknown
</span></span><span style=display:flex><span>      type: RolloutStarted
</span></span><span style=display:flex><span>  - clusterName: member2
</span></span><span style=display:flex><span>    conditions:
</span></span><span style=display:flex><span>    - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-23T23:46:56Z&#34;</span>
</span></span><span style=display:flex><span>      message: <span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in &#34;member2&#34; (affinity
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        score: 0, topology spread score: 0): picked by scheduling policy&#39;</span>
</span></span><span style=display:flex><span>      observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      reason: Scheduled
</span></span><span style=display:flex><span>      status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>      type: Scheduled
</span></span><span style=display:flex><span>    - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-23T23:46:56Z&#34;</span>
</span></span><span style=display:flex><span>      message: In the process of deciding whether to roll out the latest resources
</span></span><span style=display:flex><span>        or not
</span></span><span style=display:flex><span>      observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      reason: RolloutStartedUnknown
</span></span><span style=display:flex><span>      status: Unknown
</span></span><span style=display:flex><span>      type: RolloutStarted
</span></span><span style=display:flex><span>  - clusterName: member3
</span></span><span style=display:flex><span>    conditions:
</span></span><span style=display:flex><span>    - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-23T23:46:56Z&#34;</span>
</span></span><span style=display:flex><span>      message: <span style=color:#4e9a06>&#39;Successfully scheduled resources for placement in &#34;member3&#34; (affinity
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        score: 0, topology spread score: 0): picked by scheduling policy&#39;</span>
</span></span><span style=display:flex><span>      observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      reason: Scheduled
</span></span><span style=display:flex><span>      status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>      type: Scheduled
</span></span><span style=display:flex><span>    - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-23T23:46:56Z&#34;</span>
</span></span><span style=display:flex><span>      message: In the process of deciding whether to roll out the latest resources
</span></span><span style=display:flex><span>        or not
</span></span><span style=display:flex><span>      observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      reason: RolloutStartedUnknown
</span></span><span style=display:flex><span>      status: Unknown
</span></span><span style=display:flex><span>      type: RolloutStarted
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h3 id=override-path-for-different-member-clusters-with-resourceoverride>Override path for different member clusters with ResourceOverride</h3><p>Above <code>Application</code> specifies <code>spec.source.path</code> as <code>content/en/docs/tutorials/ArgoCD/manifests/guestbook</code>.
By default, every member cluster selected receives the same <code>Application</code> resource.
In this tutorial, member clusters from different environments should receive different manifests, as configured in different folders in the git repo.
To achieve this, a <code>ResourceOverride</code> is used to override the <code>Application</code> resource for each member cluster.
The <code>ResourceOverride</code> resource can be found at <a href=/docs/tutorials/argocd/manifests/guestbook-ro.yaml>guestbook-ro.yaml</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1alpha1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ResourceOverride
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: guestbook-app-ro
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  namespace: guestbook # ro needs to be created in the same namespace as the resource it overrides
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  placement:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    name: guestbook-crp # specify the CRP name
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  policy:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    overrideRules:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - clusterSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        clusterSelectorTerms:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        - labelSelector: 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            matchExpressions:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            - key: environment
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>              operator: Exists
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      jsonPatchOverrides:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      - op: replace
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        path: /spec/source/path # spec.source.path is overridden
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        value: &#34;content/en/docs/tutorials/ArgoCD/manifests/guestbook/${MEMBER-CLUSTER-LABEL-KEY-environment}&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      overrideType: JSONPatch
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSelectors:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  - group: argoproj.io
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    kind: Application
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    name: guestbook-app # name of the Application
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    version: v1alpha1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><h3 id=trigger-crp-progressive-rollout-with-clusterstagedupdaterun>Trigger CRP progressive rollout with clusterStagedUpdateRun</h3><p>A <code>ClusterStagedUpdateRun</code> (or updateRun for short) is used to trigger the rollout of the CRP in a progressive, stage-by-stage manner by following a pre-defined rollout strategy, namely <code>ClusterStagedUpdateStrategy</code>.</p><p>A <code>ClusterStagedUpdateStrategy</code> is provided at <a href=/docs/tutorials/argocd/manifests/teamA-strategy.yaml>teamA-strategy.yaml</a>.
It defines 3 stages: staging, canary, and production. Clusters are grouped by label <code>environment</code> into different stages.
The <code>TimedWait</code> after-stage task in <code>staging</code> stageis used to pause the rollout for 1 minute before moving to <code>canary</code> stage.s
The <code>Approval</code> after-stage task in <code>canary</code> stage waits for manual approval before moving to <code>production</code> stage.
After applying the strategy, a <code>ClusterStagedUpdateRun</code> can then reference it to generate the concrete test plan.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterStagedUpdateStrategy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: team-a-strategy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  stages: # 3 stages: staging, canary, production
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  - afterStageTasks:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - type: TimedWait
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      waitTime: 1m # wait 1 minute before moving to canary stage
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        environment: staging
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    name: staging
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  - afterStageTasks:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    - type: Approval # wait for manual approval before moving to production stage
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        environment: canary
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    name: canary
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  - labelSelector:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      matchLabels:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        environment: production
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    name: production
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><p>Now it&rsquo;s time to trigger the rollout. A sample <code>ClusterStagedUpdateRun</code> can be found at <a href=/docs/tutorials/argocd/manifests/guestbook-updaterun.yaml>guestbook-updaterun.yaml</a>.
It&rsquo;s pretty straightforward, just specifying the CRP resource name, the strategy name, and resource version.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterStagedUpdateRun
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: guestbook-updaterun
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  placementName: guestbook-crp
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSnapshotIndex: &#34;0&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  stagedRolloutStrategyName: team-a-strategy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><p>Checking the updateRun status to see the rollout progress, <code>member1</code> in <code>staging</code> stage has been updated, and it&rsquo;s pausing at the <code>after-stage</code> task before moving to <code>canary</code> stage.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl get crsur gestbook-updaterun -o yaml
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>stagesStatus:
</span></span><span style=display:flex><span>  - afterStageTaskStatus:
</span></span><span style=display:flex><span>    - type: TimedWait
</span></span><span style=display:flex><span>    clusters:
</span></span><span style=display:flex><span>    - clusterName: member1
</span></span><span style=display:flex><span>      conditions:
</span></span><span style=display:flex><span>      - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T00:47:41Z&#34;</span>
</span></span><span style=display:flex><span>        message: <span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>        observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>        reason: ClusterUpdatingStarted
</span></span><span style=display:flex><span>        status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>        type: Started
</span></span><span style=display:flex><span>      - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T00:47:56Z&#34;</span>
</span></span><span style=display:flex><span>        message: <span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>        observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>        reason: ClusterUpdatingSucceeded
</span></span><span style=display:flex><span>        status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>        type: Succeeded
</span></span><span style=display:flex><span>      resourceOverrideSnapshots:
</span></span><span style=display:flex><span>      - name: guestbook-app-ro-0
</span></span><span style=display:flex><span>        namespace: guestbook
</span></span><span style=display:flex><span>    conditions:
</span></span><span style=display:flex><span>    - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T00:47:56Z&#34;</span>
</span></span><span style=display:flex><span>      message: <span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>      observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      reason: StageUpdatingWaiting
</span></span><span style=display:flex><span>      status: <span style=color:#4e9a06>&#34;False&#34;</span>
</span></span><span style=display:flex><span>      type: Progressing
</span></span><span style=display:flex><span>    stageName: staging
</span></span><span style=display:flex><span>    startTime: <span style=color:#4e9a06>&#34;2025-03-24T00:47:41Z&#34;</span>
</span></span><span style=display:flex><span>  - afterStageTaskStatus:
</span></span><span style=display:flex><span>    - approvalRequestName: guestbook-updaterun-canary
</span></span><span style=display:flex><span>      type: Approval
</span></span><span style=display:flex><span>    clusters:
</span></span><span style=display:flex><span>    - clusterName: member2
</span></span><span style=display:flex><span>      resourceOverrideSnapshots:
</span></span><span style=display:flex><span>      - name: guestbook-app-ro-0
</span></span><span style=display:flex><span>        namespace: guestbook
</span></span><span style=display:flex><span>    stageName: canary
</span></span><span style=display:flex><span>  - clusters:
</span></span><span style=display:flex><span>    - clusterName: member3
</span></span><span style=display:flex><span>      resourceOverrideSnapshots:
</span></span><span style=display:flex><span>      - name: guestbook-app-ro-0
</span></span><span style=display:flex><span>        namespace: guestbook
</span></span><span style=display:flex><span>    stageName: production
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>Checking the <code>Application</code> status on each member cluster, and it&rsquo;s synced and healthy:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context member1
</span></span><span style=display:flex><span>kubectl get Applications -n guestbook
</span></span><span style=display:flex><span>NAMESPACE   NAME            SYNC STATUS   HEALTH STATUS
</span></span><span style=display:flex><span>guestbook   guestbook-app   Synced        Healthy
</span></span></code></pre></div><p>At the same time, there&rsquo;s no <code>Application</code> in <code>member2</code> or <code>member3</code> as they are not rolled out yet.</p><p>After 1 minute, the <code>staging</code> stage is completed, and <code>member2</code> in <code>canary</code> stage is updated.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl get crsur guestbook-updaterun -o yaml
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>- afterStageTaskStatus:
</span></span><span style=display:flex><span>    - approvalRequestName: guestbook-updaterun-canary
</span></span><span style=display:flex><span>      conditions:
</span></span><span style=display:flex><span>      - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T00:49:11Z&#34;</span>
</span></span><span style=display:flex><span>        message: <span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>        observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>        reason: AfterStageTaskApprovalRequestCreated
</span></span><span style=display:flex><span>        status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>        type: ApprovalRequestCreated
</span></span><span style=display:flex><span>      type: Approval
</span></span><span style=display:flex><span>    clusters:
</span></span><span style=display:flex><span>    - clusterName: member2
</span></span><span style=display:flex><span>      conditions:
</span></span><span style=display:flex><span>      - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T00:48:56Z&#34;</span>
</span></span><span style=display:flex><span>        message: <span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>        observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>        reason: ClusterUpdatingStarted
</span></span><span style=display:flex><span>        status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>        type: Started
</span></span><span style=display:flex><span>      - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T00:49:11Z&#34;</span>
</span></span><span style=display:flex><span>        message: <span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>        observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>        reason: ClusterUpdatingSucceeded
</span></span><span style=display:flex><span>        status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>        type: Succeeded
</span></span><span style=display:flex><span>      resourceOverrideSnapshots:
</span></span><span style=display:flex><span>      - name: guestbook-app-ro-0
</span></span><span style=display:flex><span>        namespace: guestbook
</span></span><span style=display:flex><span>    conditions:
</span></span><span style=display:flex><span>    - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T00:49:11Z&#34;</span>
</span></span><span style=display:flex><span>      message: <span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>      observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      reason: StageUpdatingWaiting
</span></span><span style=display:flex><span>      status: <span style=color:#4e9a06>&#34;False&#34;</span>
</span></span><span style=display:flex><span>      type: Progressing
</span></span><span style=display:flex><span>    stageName: canary
</span></span><span style=display:flex><span>    startTime: <span style=color:#4e9a06>&#34;2025-03-24T00:48:56Z&#34;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p><code>canary</code> stage requires manual approval to complete. The controller generates a <code>ClusterApprovalRequest</code> object for user to approve.
The name is included in the updateRun status, as shown above, <code>approvalRequestName: guestbook-updaterun-canary</code>.
Team A can verify everything works properly and then approve the request to proceed to <code>production</code> stage:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl get clusterapprovalrequests
</span></span><span style=display:flex><span>NAME                         UPDATE-RUN            STAGE    APPROVED   APPROVALACCEPTED   AGE
</span></span><span style=display:flex><span>guestbook-updaterun-canary   guestbook-updaterun   canary                                 21m
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl patch clusterapprovalrequests guestbook-updaterun-canary --type<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;merge&#39;</span> -p <span style=color:#4e9a06>&#39;{&#34;status&#34;:{&#34;conditions&#34;:[{&#34;type&#34;:&#34;Approved&#34;,&#34;status&#34;:&#34;True&#34;,&#34;reason&#34;:&#34;lgtm&#34;,&#34;message&#34;:&#34;lgtm&#34;,&#34;lastTransitionTime&#34;:&#34;&#39;</span><span style=color:#204a87;font-weight:700>$(</span>date -u +%Y-%m-%dT%H:%M:%SZ<span style=color:#204a87;font-weight:700>)</span><span style=color:#4e9a06>&#39;&#34;,&#34;observedGeneration&#34;:1}]}}&#39;</span> --subresource<span style=color:#ce5c00;font-weight:700>=</span>status
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl get clusterapprovalrequests
</span></span><span style=display:flex><span>NAME                         UPDATE-RUN            STAGE    APPROVED   APPROVALACCEPTED   AGE
</span></span><span style=display:flex><span>guestbook-updaterun-canary   guestbook-updaterun   canary   True       True               22m
</span></span></code></pre></div><p>Not the updateRun moves on to <code>production</code> stage, and <code>member3</code> is updated. The whole updateRun is completed:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl get crsur guestbook-updaterun -o yaml
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>status:
</span></span><span style=display:flex><span>  conditions:
</span></span><span style=display:flex><span>  - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T00:47:41Z&#34;</span>
</span></span><span style=display:flex><span>    message: ClusterStagedUpdateRun initialized successfully
</span></span><span style=display:flex><span>    observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    reason: UpdateRunInitializedSuccessfully
</span></span><span style=display:flex><span>    status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>    type: Initialized
</span></span><span style=display:flex><span>  - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T00:47:41Z&#34;</span>
</span></span><span style=display:flex><span>    message: <span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>    observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    reason: UpdateRunStarted
</span></span><span style=display:flex><span>    status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>    type: Progressing
</span></span><span style=display:flex><span>  - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T01:11:45Z&#34;</span>
</span></span><span style=display:flex><span>    message: <span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>    observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    reason: UpdateRunSucceeded
</span></span><span style=display:flex><span>    status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>    type: Succeeded
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>  stagesStatus:
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  - clusters:
</span></span><span style=display:flex><span>    - clusterName: member3
</span></span><span style=display:flex><span>      conditions:
</span></span><span style=display:flex><span>      - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T01:11:30Z&#34;</span>
</span></span><span style=display:flex><span>        message: <span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>        observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>        reason: ClusterUpdatingStarted
</span></span><span style=display:flex><span>        status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>        type: Started
</span></span><span style=display:flex><span>      - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T01:11:45Z&#34;</span>
</span></span><span style=display:flex><span>        message: <span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>        observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>        reason: ClusterUpdatingSucceeded
</span></span><span style=display:flex><span>        status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>        type: Succeeded
</span></span><span style=display:flex><span>      resourceOverrideSnapshots:
</span></span><span style=display:flex><span>      - name: guestbook-app-ro-0
</span></span><span style=display:flex><span>        namespace: guestbook
</span></span><span style=display:flex><span>    conditions:
</span></span><span style=display:flex><span>    - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T01:11:45Z&#34;</span>
</span></span><span style=display:flex><span>      message: <span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>      observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      reason: StageUpdatingWaiting
</span></span><span style=display:flex><span>      status: <span style=color:#4e9a06>&#34;False&#34;</span>
</span></span><span style=display:flex><span>      type: Progressing
</span></span><span style=display:flex><span>    - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-03-24T01:11:45Z&#34;</span>
</span></span><span style=display:flex><span>      message: <span style=color:#4e9a06>&#34;&#34;</span>
</span></span><span style=display:flex><span>      observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      reason: StageUpdatingSucceeded
</span></span><span style=display:flex><span>      status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>      type: Succeeded
</span></span><span style=display:flex><span>    endTime: <span style=color:#4e9a06>&#34;2025-03-24T01:11:45Z&#34;</span>
</span></span><span style=display:flex><span>    stageName: production
</span></span><span style=display:flex><span>    startTime: <span style=color:#4e9a06>&#34;2025-03-24T01:11:30Z&#34;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h3 id=verify-the-application-on-member-clusters>Verify the Application on member clusters</h3><p>Now we are able to see the <code>Application</code> is created, synced, and healthy on all member clusters except <code>member4</code> as it does not belong to team A.
We can also verify that the configMaps synced from git repo are different for each member cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context member1
</span></span><span style=display:flex><span>kubectl get app -n guestbook
</span></span><span style=display:flex><span>NAMESPACE   NAME            SYNC STATUS   HEALTH STATUS
</span></span><span style=display:flex><span>guestbook   guestbook-app   Synced        Healthy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl get deploy,svc -n guestbook
</span></span><span style=display:flex><span>NAME                           READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style=display:flex><span>deployment.apps/guestbook-ui   1/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>1</span>           80s <span style=color:#8f5902;font-style:italic># 1 replica in staging env</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NAME                   TYPE        CLUSTER-IP    EXTERNAL-IP   PORT<span style=color:#ce5c00;font-weight:700>(</span>S<span style=color:#ce5c00;font-weight:700>)</span>   AGE
</span></span><span style=display:flex><span>service/guestbook-ui   ClusterIP   10.0.20.139   &lt;none&gt;        80/TCP    79s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># verify member2</span>
</span></span><span style=display:flex><span>kubectl config use-context member2
</span></span><span style=display:flex><span>kubectl get app -n guestbook
</span></span><span style=display:flex><span>NAMESPACE   NAME            SYNC STATUS   HEALTH STATUS
</span></span><span style=display:flex><span>guestbook   guestbook-app   Synced        Healthy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl get deploy,svc -n guestbook
</span></span><span style=display:flex><span>NAME                           READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style=display:flex><span>deployment.apps/guestbook-ui   2/2     <span style=color:#0000cf;font-weight:700>2</span>            <span style=color:#0000cf;font-weight:700>2</span>           54s <span style=color:#8f5902;font-style:italic># 2 replicas in canary env</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NAME                   TYPE        CLUSTER-IP    EXTERNAL-IP   PORT<span style=color:#ce5c00;font-weight:700>(</span>S<span style=color:#ce5c00;font-weight:700>)</span>   AGE
</span></span><span style=display:flex><span>service/guestbook-ui   ClusterIP   10.0.20.139   &lt;none&gt;        80/TCP    54s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># verify member3</span>
</span></span><span style=display:flex><span>kubectl config use-context member3
</span></span><span style=display:flex><span>kubectl get app -n guestbook
</span></span><span style=display:flex><span>NAMESPACE   NAME            SYNC STATUS   HEALTH STATUS
</span></span><span style=display:flex><span>guestbook   guestbook-app   Synced        Healthy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl get deploy,svc -n guestbook
</span></span><span style=display:flex><span>NAME                           READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style=display:flex><span>deployment.apps/guestbook-ui   4/4     <span style=color:#0000cf;font-weight:700>4</span>            <span style=color:#0000cf;font-weight:700>4</span>           18s <span style=color:#8f5902;font-style:italic># 4 replicas in production env</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NAME                   TYPE        CLUSTER-IP    EXTERNAL-IP   PORT<span style=color:#ce5c00;font-weight:700>(</span>S<span style=color:#ce5c00;font-weight:700>)</span>   AGE
</span></span><span style=display:flex><span>service/guestbook-ui   ClusterIP   10.0.20.139   &lt;none&gt;        80/TCP    17s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># verify member4</span>
</span></span><span style=display:flex><span>kubectl config use-context member4
</span></span><span style=display:flex><span>kubectl get app -A
</span></span><span style=display:flex><span>No resources found
</span></span></code></pre></div><h2 id=release-a-new-version>Release a new version</h2><p>When team A makes some changes and decides to release a new version, they can cut a new branch or tag in the git repo.
To rollout this new version progressively, they can simply:</p><ol><li>Update the <code>targetRevision</code> in the <code>Application</code> resource to the new branch or tag on the hub cluster.</li><li>Create a new <code>ClusterStagedUpdateRun</code> with the new resource snapshot index.</li></ol><p>Suppose now we cut a new release on branch <code>v0.0.1</code>.
Updating the <code>spec.source.targetRevision</code> in the <code>Application</code> resource to <code>v0.0.1</code> will not trigger rollout instantly.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl edit app guestbook-app -n guestbook
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>spec:
</span></span><span style=display:flex><span>  source:
</span></span><span style=display:flex><span>    targetRevision: v0.0.1 <span style=color:#8f5902;font-style:italic># &lt;- replace with your release branch</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>Checking the crp, and it&rsquo;s clear that the new <code>Application</code> is not available yet:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl get crp
</span></span><span style=display:flex><span>NAME            GEN   SCHEDULED   SCHEDULED-GEN   AVAILABLE   AVAILABLE-GEN   AGE
</span></span><span style=display:flex><span>guestbook-crp   <span style=color:#0000cf;font-weight:700>1</span>     True        <span style=color:#0000cf;font-weight:700>1</span>                                           130m
</span></span></code></pre></div><p>Check a new version of <code>ClusterResourceSnapshot</code> is generated:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl get clusterresourcesnapshots --show-labels
</span></span><span style=display:flex><span>NAME                       GEN   AGE     LABELS
</span></span><span style=display:flex><span>guestbook-crp-0-snapshot   <span style=color:#0000cf;font-weight:700>1</span>     133m    kubernetes-fleet.io/is-latest-snapshot<span style=color:#ce5c00;font-weight:700>=</span>false,kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>=</span>guestbook-crp,kubernetes-fleet.io/resource-index<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>guestbook-crp-1-snapshot   <span style=color:#0000cf;font-weight:700>1</span>     3m46s   kubernetes-fleet.io/is-latest-snapshot<span style=color:#ce5c00;font-weight:700>=</span>true,kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>=</span>guestbook-crp,kubernetes-fleet.io/resource-index<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span>
</span></span></code></pre></div><p>Notice that <code>guestbook-crp-1-snapshot</code> is latest with <code>resource-index</code> set to <code>1</code>.</p><p>Create a new <code>ClusterStagedUpdateRun</code> with the new resource snapshot index:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context hub
</span></span><span style=display:flex><span>kubectl apply -f - <span style=color:#4e9a06>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>apiVersion: placement.kubernetes-fleet.io/v1beta1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>kind: ClusterStagedUpdateRun
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>metadata:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  name: guestbook-updaterun
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>spec:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  placementName: guestbook-crp
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  resourceSnapshotIndex: &#34;1&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>  stagedRolloutStrategyName: team-a-strategy
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div><p>Following the same steps as before, we can see the new version is rolled out progressively to all member clusters.</p><h2 id=summary>Summary</h2><p>KubeFleet and ArgoCD integration offers a powerful solution for multi-cluster application management, combining KubeFleet&rsquo;s intelligent orchestration with ArgoCD&rsquo;s popular GitOps approach. This tutorial showcased how teams can deploy applications across diverse environments with cluster-specific configurations while maintaining complete control over the rollout process. Through practical examples, we demonstrated targeted deployments using cluster labels, environment-specific configurations via overrides, and safe, controlled rollouts with staged update runs. This integration enables teams to transform multi-cluster challenges into streamlined, automated workflows that enhance both developer productivity and operational reliability.</p><h2 id=next-steps>Next steps</h2><ul><li>Learn more about <a href=/docs/concepts/crp/>ClusterResourcePlacements</a>.</li><li>Learn more about <a href=/docs/concepts/override/>ClusterResourceOverrides and ResourceOverrides</a>.</li><li>Learn more about <a href=/docs/concepts/staged-update/>ClusterStagedUpdateRun</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-cec98a3a5ff74162065d32be41bf560a>5 - Troubleshooting Guides</h1><div class=lead>Guides for identifying and fixing common KubeFleet issues</div><div class="pageinfo pageinfo-primary"><p>KubeFleet documentation features a number of troubleshooting guides to help you identify and fix
KubeFleet issues you encounter. Pick one below to proceed.</p></div></div><div class=td-content><h1 id=pg-894ce2920918d9ff68e739cf22ea5092>5.1 - ClusterResourcePlacement TSG</h1><div class=lead>Identify and fix KubeFleet issues associated with the ClusterResourcePlacement API</div><p>This TSG is meant to help you troubleshoot issues with the ClusterResourcePlacement API in Fleet.</p><h2 id=cluster-resource-placement>Cluster Resource Placement</h2><p>Internal Objects to keep in mind when troubleshooting CRP related errors on the hub cluster:</p><ul><li><code>ClusterResourceSnapshot</code></li><li><code>ClusterSchedulingPolicySnapshot</code></li><li><code>ClusterResourceBinding</code></li><li><code>Work</code></li></ul><p>Please read the <a href=/docs/api-reference/>Fleet API reference</a> for more details about each object.</p><h2 id=complete-progress-of-the-clusterresourceplacement>Complete Progress of the ClusterResourcePlacement</h2><p>Understanding the progression and the status of the <code>ClusterResourcePlacement</code> custom resource is crucial for diagnosing and identifying failures.
You can view the status of the <code>ClusterResourcePlacement</code> custom resource by using the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe clusterresourceplacement &lt;name&gt;
</span></span></code></pre></div><p>The complete progression of <code>ClusterResourcePlacement</code> is as follows:</p><ol><li><code>ClusterResourcePlacementScheduled</code>: Indicates a resource has been scheduled for placement..<ul><li>If this condition is false, refer to <a href=/docs/troubleshooting/clusterresourceplacementscheduled/>CRP Schedule Failure TSG</a>.</li></ul></li><li><code>ClusterResourcePlacementRolloutStarted</code>: Indicates the rollout process has begun.<ul><li>If this condition is false refer to <a href=/docs/troubleshooting/clusterresourceplacementrolloutstarted/>CRP Rollout Failure TSG</a></li><li>If you are triggering a rollout with a staged update run, refer to <a href=ClusterStagedUpdateRun>ClusterStagedUpdateRun TSG</a>.</li></ul></li><li><code>ClusterResourcePlacementOverridden</code>: Indicates the resource has been overridden.<ul><li>If this condition is false, refer to <a href=/docs/troubleshooting/clusterresourceplacementoverridden/>CRP Override Failure TSG</a></li></ul></li><li><code>ClusterResourcePlacementWorkSynchronized</code>: Indicates the work objects have been synchronized.<ul><li>If this condition is false, refer to <a href=/docs/troubleshooting/clusterresourceplacementworksynchronized/>CRP Work-Synchronization Failure TSG</a></li></ul></li><li><code>ClusterResourcePlacementApplied</code>: Indicates the resource has been applied. This condition will only be populated if the
apply strategy in use is of the type <code>ClientSideApply</code> (default) or <code>ServerSideApply</code>.<ul><li>If this condition is false, refer to <a href=/docs/troubleshooting/placementapplied/>Work-Application Failure TSG</a></li></ul></li><li><code>ClusterResourcePlacementAvailable</code>: Indicates the resource is available. This condition will only be populated if the
apply strategy in use is of the type <code>ClientSideApply</code> (default) or <code>ServerSideApply</code>.<ul><li>If this condition is false, refer to <a href=/docs/troubleshooting/placementavailable/>Availability Failure TSG</a></li></ul></li><li><code>ClusterResourcePlacementDiffreported</code>: Indicates whether diff reporting has completed on all resources. This condition
will only be populated if the apply strategy in use is of the type <code>ReportDiff</code>.<ul><li>If this condition is false, refer to the <a href=/docs/troubleshooting/clusterresourceplacementdiffreported/>CRP Diff Reporting Failure TSG</a> for more information.</li></ul></li></ol><h2 id=how-can-i-debug-if-some-clusters-are-not-selected-as-expected>How can I debug if some clusters are not selected as expected?</h2><p>Check the status of the <code>ClusterSchedulingPolicySnapshot</code> to determine which clusters were selected along with the reason.</p><h2 id=how-can-i-debug-if-a-selected-cluster-does-not-have-the-expected-resources-on-it-or-if-crp-doesnt-pick-up-the-latest-changes>How can I debug if a selected cluster does not have the expected resources on it or if CRP doesn&rsquo;t pick up the latest changes?</h2><p>Please check the following cases,</p><ul><li>Check whether the <code>ClusterResourcePlacementRolloutStarted</code> condition in <code>ClusterResourcePlacement</code> status is set to <strong>true</strong> or <strong>false</strong>.</li><li>If <code>false</code>, see <a href=/docs/troubleshooting/clusterresourceplacementscheduled/>CRP Schedule Failure TSG</a>.</li><li>If <code>true</code>,<ul><li>Check to see if <code>ClusterResourcePlacementApplied</code> condition is set to <strong>unknown</strong>, <strong>false</strong> or <strong>true</strong>.</li><li>If <code>unknown</code>, wait for the process to finish, as the resources are still being applied to the member cluster. If the state remains unknown for a while, create a <a href=https://github.com/kubefleet-dev/kubefleet/issues>issue</a>, as this is an unusual behavior.</li><li>If <code>false</code>, refer to <a href=/docs/troubleshooting/placementapplied/>Work-Application Failure TSG</a>.</li><li>If <code>true</code>, verify that the resource exists on the hub cluster.</li></ul></li></ul><p>We can also take a look at the <code>placementStatuses</code> section in <code>ClusterResourcePlacement</code> status for that particular cluster. In <code>placementStatuses</code> we would find <code>failedPlacements</code> section which should have the reasons as to why resources failed to apply.</p><h2 id=how-can-i-debug-if-the-drift-detection-result-or-the-configuration-difference-check-result-are-different-from-my-expectations>How can I debug if the drift detection result or the configuration difference check result are different from my expectations?</h2><p>See the <a href=/docs/troubleshooting/driftanddiffdetection/>Drift Detection and Configuration Difference Check Unexpected Result TSG</a> for more information.</p><h2 id=how-can-i-find-and-verify-the-latest-clusterschedulingpolicysnapshot-for-a-clusterresourceplacement>How can I find and verify the latest ClusterSchedulingPolicySnapshot for a ClusterResourcePlacement?</h2><p>To find the latest <code>ClusterSchedulingPolicySnapshot</code> for a <code>ClusterResourcePlacement</code> resource, run the following command:</p><pre tabindex=0><code>kubectl get clusterschedulingpolicysnapshot -l kubernetes-fleet.io/is-latest-snapshot=true,kubernetes-fleet.io/parent-CRP={CRPName}
</code></pre><blockquote><p>NOTE: In this command, replace <code>{CRPName}</code> with your <code>ClusterResourcePlacement</code> name.</p></blockquote><p>Then, compare the <code>ClusterSchedulingPolicySnapshot</code> with the <code>ClusterResourcePlacement</code> policy to make sure that they match, excluding the <code>numberOfClusters</code> field from the <code>ClusterResourcePlacement</code> spec.</p><p>If the placement type is <code>PickN</code>, check whether the number of clusters that&rsquo;s requested in the <code>ClusterResourcePlacement</code> policy matches the value of the number-of-clusters label.</p><h2 id=how-can-i-find-the-latest-clusterresourcebinding-resource>How can I find the latest ClusterResourceBinding resource?</h2><p>The following command lists all <code>ClusterResourceBindings</code> instances that are associated with <code>ClusterResourcePlacement</code>:</p><pre tabindex=0><code>kubectl get clusterresourcebinding -l kubernetes-fleet.io/parent-CRP={CRPName}
</code></pre><blockquote><p>NOTE: In this command, replace <code>{CRPName}</code> with your <code>ClusterResourcePlacement</code> name.</p></blockquote><h3 id=example>Example</h3><p>In this case we have <code>ClusterResourcePlacement</code> called test-crp.</p><ol><li>List the <code>ClusterResourcePlacement</code> to get the name of the CRP,</li></ol><pre tabindex=0><code>kubectl get crp test-crp
NAME       GEN   SCHEDULED   SCHEDULEDGEN   APPLIED   APPLIEDGEN   AGE
test-crp   1     True        1              True      1            15s
</code></pre><ol start=2><li>The following command is run to view the status of the <code>ClusterResourcePlacement</code> deployment.</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe clusterresourceplacement test-crp
</span></span></code></pre></div><ol start=3><li>Here&rsquo;s an example output. From the <code>placementStatuses</code> section of the <code>test-crp</code> status, notice that it has distributed
resources to two member clusters and, therefore, has two <code>ClusterResourceBindings</code> instances:</li></ol><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2023-11-23T00:49:29Z&#34;
    ...
  placementStatuses:
  - clusterName: kind-cluster-1
    conditions:
      ...
      type: ResourceApplied
  - clusterName: kind-cluster-2
    conditions:
      ...
      reason: ApplySucceeded
      status: &#34;True&#34;
      type: ResourceApplied
</code></pre><ol start=3><li>To get the <code>ClusterResourceBindings</code> value, run the following command:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    kubectl get clusterresourcebinding -l kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>=</span>test-crp 
</span></span></code></pre></div><ol start=4><li>The output lists all <code>ClusterResourceBindings</code> instances that are associated with <code>test-crp</code>.</li></ol><pre tabindex=0><code>kubectl get clusterresourcebinding -l kubernetes-fleet.io/parent-CRP=test-crp 
NAME                               WORKCREATED   RESOURCESAPPLIED   AGE
test-crp-kind-cluster-1-be990c3e   True          True               33s
test-crp-kind-cluster-2-ec4d953c   True          True               33s
</code></pre><p>The <code>ClusterResourceBinding</code> resource name uses the following format: <code>{CRPName}-{clusterName}-{suffix}</code>.
Find the <code>ClusterResourceBinding</code> for the target cluster you are looking for based on the <code>clusterName</code>.</p><h2 id=how-can-i-find-the-latest-clusterresourcesnapshot-resource>How can I find the latest ClusterResourceSnapshot resource?</h2><p>To find the latest ClusterResourceSnapshot resource, run the following command:</p><pre tabindex=0><code>kubectl get clusterresourcesnapshot -l kubernetes-fleet.io/is-latest-snapshot=true,kubernetes-fleet.io/parent-CRP={CRPName}
</code></pre><blockquote><p>NOTE: In this command, replace <code>{CRPName}</code> with your <code>ClusterResourcePlacement</code> name.</p></blockquote><h2 id=how-can-i-find-the-correct-work-resource-thats-associated-with-clusterresourceplacement>How can I find the correct work resource that&rsquo;s associated with ClusterResourcePlacement?</h2><p>To find the correct work resource, follow these steps:</p><ol><li>Identify the member cluster namespace and the <code>ClusterResourcePlacement</code> name. The format for the namespace is <code>fleet-member-{clusterName}</code>.</li><li>To get the work resource, run the following command:</li></ol><pre tabindex=0><code>kubectl get work -n fleet-member-{clusterName} -l kubernetes-fleet.io/parent-CRP={CRPName}
</code></pre><blockquote><p>NOTE: In this command, replace <code>{clusterName}</code> and <code>{CRPName}</code> with the names that you identified in the first step.</p></blockquote></div><div class=td-content style=page-break-before:always><h1 id=pg-93d68ffad9a5f65589e402107316e989>5.2 - CRP Schedule Failure TSG</h1><div class=lead>Troubleshooting guide for CRP status &ldquo;ClusterResourcePlacementScheduled&rdquo; condition set to false</div><p>The <code>ClusterResourcePlacementScheduled</code> condition is set to <code>false</code> when the scheduler cannot find all the clusters needed as specified by the scheduling policy.</p><blockquote><p>Note: To get more information about why the scheduling fails, you can check the <a href=https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/scheduler/scheduler.go>scheduler</a> logs.</p></blockquote><h2 id=common-scenarios>Common scenarios</h2><p>Instances where this condition may arise:</p><ul><li>When the placement policy is set to <code>PickFixed</code>, but the specified cluster names do not match any joined member cluster name in the fleet, or the specified cluster is no longer connected to the fleet.</li><li>When the placement policy is set to <code>PickN</code>, and N clusters are specified, but there are fewer than N clusters that have joined the fleet or satisfy the placement policy.</li><li>When the <code>ClusterResourcePlacement</code> resource selector selects a reserved namespace.</li></ul><blockquote><p>Note: When the placement policy is set to <code>PickAll</code>, the <code>ClusterResourcePlacementScheduled</code> condition is always set to <code>true</code>.</p></blockquote><h2 id=case-study>Case Study</h2><p>In the following example, the <code>ClusterResourcePlacement</code> with a <code>PickN</code> placement policy is trying to propagate resources to two clusters labeled <code>env:prod</code>.
The two clusters, named <code>kind-cluster-1</code> and <code>kind-cluster-2</code>, have joined the fleet. However, only one member cluster, <code>kind-cluster-1</code>, has the label <code>env:prod</code>.</p><h3 id=crp-spec>CRP spec:</h3><pre tabindex=0><code>spec:
  policy:
    affinity:
      clusterAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          clusterSelectorTerms:
          - labelSelector:
              matchLabels:
                env: prod
    numberOfClusters: 2
    placementType: PickN
  resourceSelectors:
  ...
  revisionHistoryLimit: 10
  strategy:
    type: RollingUpdate
</code></pre><h3 id=clusterresourceplacement-status>ClusterResourcePlacement status</h3><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
    message: could not find all the clusters needed as specified by the scheduling
      policy
    observedGeneration: 1
    reason: SchedulingPolicyUnfulfilled
    status: &#34;False&#34;
    type: ClusterResourcePlacementScheduled
  - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
    message: All 1 cluster(s) start rolling out the latest resource
    observedGeneration: 1
    reason: RolloutStarted
    status: &#34;True&#34;
    type: ClusterResourcePlacementRolloutStarted
  - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
    message: No override rules are configured for the selected resources
    observedGeneration: 1
    reason: NoOverrideSpecified
    status: &#34;True&#34;
    type: ClusterResourcePlacementOverridden
  - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
    message: Works(s) are succcesfully created or updated in the 1 target clusters&#39;
      namespaces
    observedGeneration: 1
    reason: WorkSynchronized
    status: &#34;True&#34;
    type: ClusterResourcePlacementWorkSynchronized
  - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
    message: The selected resources are successfully applied to 1 clusters
    observedGeneration: 1
    reason: ApplySucceeded
    status: &#34;True&#34;
    type: ClusterResourcePlacementApplied
  - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
    message: The selected resources in 1 cluster are available now
    observedGeneration: 1
    reason: ResourceAvailable
    status: &#34;True&#34;
    type: ClusterResourcePlacementAvailable
  observedResourceIndex: &#34;0&#34;
  placementStatuses:
  - clusterName: kind-cluster-1
    conditions:
    - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
      message: &#39;Successfully scheduled resources for placement in kind-cluster-1 (affinity
        score: 0, topology spread score: 0): picked by scheduling policy&#39;
      observedGeneration: 1
      reason: Scheduled
      status: &#34;True&#34;
      type: Scheduled
    - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
      message: Detected the new changes on the resources and started the rollout process
      observedGeneration: 1
      reason: RolloutStarted
      status: &#34;True&#34;
      type: RolloutStarted
    - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
      message: No override rules are configured for the selected resources
      observedGeneration: 1
      reason: NoOverrideSpecified
      status: &#34;True&#34;
      type: Overridden
    - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
      message: All of the works are synchronized to the latest
      observedGeneration: 1
      reason: AllWorkSynced
      status: &#34;True&#34;
      type: WorkSynchronized
    - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
      message: All corresponding work objects are applied
      observedGeneration: 1
      reason: AllWorkHaveBeenApplied
      status: &#34;True&#34;
      type: Applied
    - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
      message: All corresponding work objects are available
      observedGeneration: 1
      reason: AllWorkAreAvailable
      status: &#34;True&#34;
      type: Available
  - conditions:
    - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
      message: &#39;kind-cluster-2 is not selected: ClusterUnschedulable, cluster does not
        match with any of the required cluster affinity terms&#39;
      observedGeneration: 1
      reason: ScheduleFailed
      status: &#34;False&#34;
      type: Scheduled
  selectedResources:
  ...
</code></pre><p>The <code>ClusterResourcePlacementScheduled</code> condition is set to <code>false</code>, the goal is to select two clusters with the label <code>env:prod</code>, but only one member cluster possesses the correct label as specified in <code>clusterAffinity</code>.</p><p>We can also take a look at the <code>ClusterSchedulingPolicySnapshot</code> status to figure out why the scheduler could not schedule the resource for the placement policy specified.
To learn how to get the latest <code>ClusterSchedulingPolicySnapshot</code>, see <a href=/docs/troubleshooting/clusterresourceplacement/#how-can-i-find-and-verify-the-latest-clusterschedulingpolicysnapshot-for-a-clusterresourceplacement>How can I find and verify the latest ClusterSchedulingPolicySnapshot for a ClusterResourcePlacement deployment?</a> to learn how to get the latest <code>ClusterSchedulingPolicySnapshot</code>.</p><p>The corresponding <code>ClusterSchedulingPolicySnapshot</code> spec and status gives us even more information on why scheduling failed.</p><h3 id=latest-clusterschedulingpolicysnapshot>Latest ClusterSchedulingPolicySnapshot</h3><pre tabindex=0><code>apiVersion: placement.kubernetes-fleet.io/v1
kind: ClusterSchedulingPolicySnapshot
metadata:
  annotations:
    kubernetes-fleet.io/CRP-generation: &#34;1&#34;
    kubernetes-fleet.io/number-of-clusters: &#34;2&#34;
  creationTimestamp: &#34;2024-05-07T22:36:33Z&#34;
  generation: 1
  labels:
    kubernetes-fleet.io/is-latest-snapshot: &#34;true&#34;
    kubernetes-fleet.io/parent-CRP: crp-2
    kubernetes-fleet.io/policy-index: &#34;0&#34;
  name: crp-2-0
  ownerReferences:
  - apiVersion: placement.kubernetes-fleet.io/v1beta1
    blockOwnerDeletion: true
    controller: true
    kind: ClusterResourcePlacement
    name: crp-2
    uid: 48bc1e92-a8b9-4450-a2d5-c6905df2cbf0
  resourceVersion: &#34;10090&#34;
  uid: 2137887e-45fd-4f52-bbb7-b96f39854625
spec:
  policy:
    affinity:
      clusterAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          clusterSelectorTerms:
          - labelSelector:
              matchLabels:
                env: prod
    placementType: PickN
  policyHash: ZjE0Yjk4YjYyMTVjY2U3NzQ1MTZkNWRhZjRiNjQ1NzQ4NjllNTUyMzZkODBkYzkyYmRkMGU3OTI3MWEwOTkyNQ==
status:
  conditions:
  - lastTransitionTime: &#34;2024-05-07T22:36:33Z&#34;
    message: could not find all the clusters needed as specified by the scheduling
      policy
    observedGeneration: 1
    reason: SchedulingPolicyUnfulfilled
    status: &#34;False&#34;
    type: Scheduled
  observedCRPGeneration: 1
  targetClusters:
  - clusterName: kind-cluster-1
    clusterScore:
      affinityScore: 0
      priorityScore: 0
    reason: picked by scheduling policy
    selected: true
  - clusterName: kind-cluster-2
    reason: ClusterUnschedulable, cluster does not match with any of the required
      cluster affinity terms
    selected: false
</code></pre><h3 id=resolution>Resolution:</h3><p>The solution here is to add the <code>env:prod</code> label to the member cluster resource for <code>kind-cluster-2</code> as well, so that the scheduler can select the cluster to propagate resources.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-23b95c381312caebb1798baf3bea7f4f>5.3 - ResourcePlacement TSG</h1><div class=lead>Identify and fix KubeFleet issues associated with the ResourcePlacement API</div><p>This TSG is meant to help you troubleshoot issues with the ResourcePlacement API in Fleet.</p><h2 id=resource-placement>Resource Placement</h2><p>Internal Objects to keep in mind when troubleshooting RP related errors on the hub cluster:</p><ul><li><code>ResourceSnapshot</code></li><li><code>SchedulingPolicySnapshot</code></li><li><code>ResourceBinding</code></li><li><code>Work</code></li></ul><p>Please read the <a href=/docs/api-reference/>Fleet API reference</a> for more details about each object.</p><h2 id=important-considerations-for-resourceplacement>Important Considerations for ResourcePlacement</h2><h3 id=namespace-prerequisites>Namespace Prerequisites</h3><p><strong>Important</strong>: ResourcePlacement can only place namespace-scoped resources to clusters that already have the target namespace.
Before creating a ResourcePlacement:</p><ul><li><p>Ensure the target namespace exists on the member clusters, either:</p><ul><li>Created by a <code>ClusterResourcePlacement</code> (CRP) using namespace-only mode</li><li>Pre-existing on the member clusters</li></ul></li><li><p>If the namespace doesn&rsquo;t exist on a member cluster, the <code>ResourcePlacement</code> will fail to apply resources to that cluster.</p></li></ul><h3 id=coordination-with-clusterresourceplacement>Coordination with ClusterResourcePlacement</h3><p>When using both ResourcePlacement (RP) and ClusterResourcePlacement (CRP) together:</p><ul><li><strong>CRP in namespace-only mode</strong>: Use CRP to create and manage the namespace itself across clusters</li><li><strong>RP for resources</strong>: Use RP to manage specific resources within that namespace</li><li><strong>Avoid conflicts</strong>: Ensure that CRP and RP don&rsquo;t select the same resources to prevent conflicts</li></ul><h3 id=resource-scope-limitations>Resource Scope Limitations</h3><p>ResourcePlacement can only select and manage namespace-scoped resources within the same namespace where the RP object resides:</p><ul><li>âœ… <strong>Supported</strong>: ConfigMaps, Secrets, Services, Deployments, StatefulSets, Jobs, etc. within the RP&rsquo;s namespace</li><li>âŒ <strong>Not Supported</strong>: Cluster-scoped resources (use ClusterResourcePlacement instead)</li><li>âŒ <strong>Not Supported</strong>: Resources in other namespaces</li></ul><h2 id=complete-progress-of-the-resourceplacement>Complete Progress of the ResourcePlacement</h2><p>Understanding the progression and the status of the <code>ResourcePlacement</code> custom resource is crucial for diagnosing and identifying failures.
You can view the status of the <code>ResourcePlacement</code> custom resource by using the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe resourceplacement &lt;name&gt; -n &lt;namespace&gt;
</span></span></code></pre></div><p>The complete progression of <code>ResourcePlacement</code> is as follows:</p><ol><li><code>ResourcePlacementScheduled</code>: Indicates a resource has been scheduled for placement.<ul><li>If this condition is false, refer to <a href=/docs/troubleshooting/clusterresourceplacementscheduled/>CRP Schedule Failure TSG</a>.</li></ul></li><li><code>ResourcePlacementRolloutStarted</code>: Indicates the rollout process has begun.<ul><li>If this condition is false, refer to <a href=/docs/troubleshooting/clusterresourceplacementrolloutstarted/>CRP Rollout Failure TSG</a>.</li><li>If you are triggering a rollout with a staged update run, refer to <a href=ClusterStagedUpdateRun.md>ClusterStagedUpdateRun TSG</a>.</li></ul></li><li><code>ResourcePlacementOverridden</code>: Indicates the resource has been overridden.<ul><li>If this condition is false, refer to <a href=/docs/troubleshooting/clusterresourceplacementoverridden/>CRP Override Failure TSG</a>.</li></ul></li><li><code>ResourcePlacementWorkSynchronized</code>: Indicates the work objects have been synchronized.<ul><li>If this condition is false, refer to <a href=/docs/troubleshooting/clusterresourceplacementworksynchronized/>CRP Work-Synchronization Failure TSG</a>.</li></ul></li><li><code>ResourcePlacementApplied</code>: Indicates the resource has been applied. This condition will only be populated if the
apply strategy in use is of the type <code>ClientSideApply</code> (default) or <code>ServerSideApply</code>.<ul><li>If this condition is false, refer to <a href=/docs/troubleshooting/placementapplied/>Work-Application Failure TSG</a>.</li></ul></li><li><code>ResourcePlacementAvailable</code>: Indicates the resource is available. This condition will only be populated if the
apply strategy in use is of the type <code>ClientSideApply</code> (default) or <code>ServerSideApply</code>.<ul><li>If this condition is false, refer to <a href=/docs/troubleshooting/placementavailable/>Availability Failure TSG</a>.</li></ul></li><li><code>ResourcePlacementDiffreported</code>: Indicates whether diff reporting has completed on all resources. This condition
will only be populated if the apply strategy in use is of the type <code>ReportDiff</code>.<ul><li>If this condition is false, refer to the <a href=/docs/troubleshooting/clusterresourceplacementdiffreported/>CRP Diff Reporting Failure TSG</a> for more information.</li></ul></li></ol><blockquote><p><strong>Note</strong>: ResourcePlacement and ClusterResourcePlacement share the same underlying architecture with a 1-to-1 mapping of condition types.
The condition types follow a naming convention where RP conditions use the <code>ResourcePlacement</code> prefix while CRP conditions use the
<code>ClusterResourcePlacement</code> prefix. For example:</p><ul><li><code>ResourcePlacementScheduled</code> â†” <code>ClusterResourcePlacementScheduled</code></li><li><code>ResourcePlacementApplied</code> â†” <code>ClusterResourcePlacementApplied</code></li><li><code>ResourcePlacementAvailable</code> â†” <code>ClusterResourcePlacementAvailable</code></li></ul><p>The troubleshooting approaches documented in the CRP TSG files are applicable to ResourcePlacement as well. The main difference is that
ResourcePlacement is namespace-scoped and works with namespace-scoped resources, while ClusterResourcePlacement is cluster-scoped.
When following CRP TSG guidance, substitute the appropriate RP condition names and commands (e.g., use
<code>kubectl get resourceplacement -n &lt;namespace></code> instead of <code>kubectl get clusterresourceplacement</code>).</p></blockquote><h2 id=how-can-i-debug-if-some-clusters-are-not-selected-as-expected>How can I debug if some clusters are not selected as expected?</h2><p>Check the status of the <code>SchedulingPolicySnapshot</code> to determine which clusters were selected along with the reason.</p><p>To find the latest <code>SchedulingPolicySnapshot</code> for a <code>ResourcePlacement</code> resource, run the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get schedulingpolicysnapshot -n &lt;namespace&gt; -l kubernetes-fleet.io/is-latest-snapshot<span style=color:#ce5c00;font-weight:700>=</span>true,kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>={</span>RPName<span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><blockquote><p>NOTE: In this command, replace <code>{RPName}</code> with your <code>ResourcePlacement</code> name and <code>&lt;namespace></code> with the namespace where the ResourcePlacement exists.</p></blockquote><p>Then, compare the <code>SchedulingPolicySnapshot</code> with the <code>ResourcePlacement</code> policy to make sure that they match.</p><h2 id=how-can-i-debug-if-a-selected-cluster-does-not-have-the-expected-resources-on-it-or-if-rp-doesnt-pick-up-the-latest-changes>How can I debug if a selected cluster does not have the expected resources on it or if RP doesn&rsquo;t pick up the latest changes?</h2><p>Please check the following cases,</p><ul><li>Check whether the <code>ResourcePlacementRolloutStarted</code> condition in <code>ResourcePlacement</code> status is set to <strong>true</strong> or <strong>false</strong>.</li><li>If <code>false</code>, the resource placement has not started rolling out yet.</li><li>If <code>true</code>,<ul><li>Check to see if the overall <code>ResourcePlacementApplied</code> condition is set to <strong>unknown</strong>, <strong>false</strong> or <strong>true</strong>.</li><li>If <code>unknown</code>, wait for the process to finish, as the resources are still being applied to the member clusters. If the state remains unknown for a while, create an <a href=https://github.com/kubefleet-dev/kubefleet/issues>issue</a>, as this is an unusual behavior.</li><li>If <code>false</code>, the resources failed to apply on one or more clusters. Check the <code>Placement Statuses</code> section in the status for cluster-specific details.</li><li>If <code>true</code>, verify that the resource exists on the hub cluster in the same namespace as the ResourcePlacement.</li></ul></li></ul><p>To pinpoint issues on specific clusters, examine the <code>Placement Statuses</code> section in <code>ResourcePlacement</code> status. For each cluster, you can find:</p><ul><li>The cluster name</li><li>Conditions specific to that cluster (e.g., <code>Applied</code>, <code>Available</code>)</li><li><code>Failed Placements</code> section which lists the resources that failed to apply along with the reasons</li></ul><h2 id=how-can-i-debug-if-the-drift-detection-result-or-the-configuration-difference-check-result-are-different-from-my-expectations>How can I debug if the drift detection result or the configuration difference check result are different from my expectations?</h2><p>See the <a href=/docs/troubleshooting/driftanddiffdetection/>Drift Detection and Configuration Difference Check Unexpected Result TSG</a> for more information.</p><h2 id=how-can-i-find-the-latest-resourcebinding-resource>How can I find the latest ResourceBinding resource?</h2><p>The following command lists all <code>ResourceBindings</code> instances that are associated with <code>ResourcePlacement</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get resourcebinding -n &lt;namespace&gt; -l kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>={</span>RPName<span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><blockquote><p>NOTE: In this command, replace <code>{RPName}</code> with your <code>ResourcePlacement</code> name and <code>&lt;namespace></code> with the namespace where the ResourcePlacement exists.</p></blockquote><h3 id=example>Example</h3><p>In this case we have <code>ResourcePlacement</code> called test-rp in namespace <code>test-ns</code>.</p><ol><li>Get the <code>ResourcePlacement</code> to get a basic overview of the RP,</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get rp test-rp -n test-ns
</span></span><span style=display:flex><span>NAME       GEN   SCHEDULED   SCHEDULEDGEN   AVAILABLE   AVAILABLE-GEN   AGE
</span></span><span style=display:flex><span>test-rp    <span style=color:#0000cf;font-weight:700>1</span>     True        <span style=color:#0000cf;font-weight:700>1</span>              True        <span style=color:#0000cf;font-weight:700>1</span>               15s
</span></span></code></pre></div><ol start=2><li>The following command is run to view the status of the <code>ResourcePlacement</code>.</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe resourceplacement test-rp -n test-ns
</span></span></code></pre></div><p><strong>Here&rsquo;s an example output:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>found all cluster needed as specified by the scheduling policy, found 2 cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>SchedulingPolicyFulfilled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ResourcePlacementScheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>All 2 cluster(s) start rolling out the latest resource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ResourcePlacementRolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ResourcePlacementOverridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Works(s) are succcesfully created or updated in 2 target cluster(s)&#39; namespaces</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ResourcePlacementWorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>The selected resources are successfully applied to 2 cluster(s)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>ApplySucceeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ResourcePlacementApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>The selected resources in 2 cluster(s) are available now</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>ResourceAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>ResourcePlacementAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Observed Resource Index</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Placement Statuses</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Cluster Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>kind-cluster-1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Successfully scheduled resources for placement in &#34;kind-cluster-1&#34;: picked by scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>All corresponding work objects are available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>AllWorkAreAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Resource Index</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Cluster Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>             </span><span style=color:#000>kind-cluster-2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Successfully scheduled resources for placement in &#34;kind-cluster-2&#34;: picked by scheduling policy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>Scheduled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>Detected the new changes on the resources and started the rollout process</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>RolloutStarted</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>No</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>override rules are configured for the selected resources</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>NoOverrideSpecified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>Overridden</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>All of the works are synchronized to the latest</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>AllWorkSynced</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>WorkSynchronized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>All corresponding work objects are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>AllWorkHaveBeenApplied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>Applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Last Transition Time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#000>2025-11-13T22:25:45Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>All corresponding work objects are available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Observed Generation</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#000>AllWorkAreAvailable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                 </span><span style=color:#204a87;font-weight:700>True</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>                   </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Observed Resource Index</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Selected Resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>ConfigMap</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>app-config</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>my-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>ConfigMap</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>feature-flags</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>my-app</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>From the status output, you can see:</p><ul><li><strong>Overall Conditions</strong>: Show the aggregated state across all clusters (e.g., <code>ResourcePlacementApplied</code>, <code>ResourcePlacementAvailable</code>)</li><li><strong>Placement Statuses</strong>: Contains per-cluster details for <code>kind-cluster-1</code> and <code>kind-cluster-2</code>, each with their own conditions (<code>Scheduled</code>, <code>Applied</code>, <code>Available</code>, etc.)</li><li><strong>Selected Resources</strong>: Lists the ConfigMaps (<code>app-config</code> and <code>feature-flags</code>) that were selected for placement</li></ul><ol start=2><li>To get the <code>ResourceBindings</code>, run the following command:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    kubectl get resourcebinding -n test-ns -l kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>=</span>test-rp 
</span></span></code></pre></div><p>This lists all <code>ResourceBindings</code> instances that are associated with <code>test-rp</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get resourcebinding -n test-ns -l kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>=</span>test-rp 
</span></span><span style=display:flex><span>NAME                              WORKSYNCHRONIZED   RESOURCESAPPLIED   AGE
</span></span><span style=display:flex><span>test-rp-kind-cluster-1-be990c3e   True               True               33s
</span></span><span style=display:flex><span>test-rp-kind-cluster-2-ec4d953c   True               True               33s
</span></span></code></pre></div><p>The <code>ResourceBinding</code> resource name uses the following format: <code>{RPName}-{clusterName}-{suffix}</code>.
Find the <code>ResourceBinding</code> for the target cluster you are looking for based on the <code>clusterName</code>.</p><h2 id=how-can-i-find-the-latest-resourcesnapshot-resource>How can I find the latest ResourceSnapshot resource?</h2><p>To find the latest ResourceSnapshot resource, run the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get resourcesnapshot -n &lt;namespace&gt; -l kubernetes-fleet.io/is-latest-snapshot<span style=color:#ce5c00;font-weight:700>=</span>true,kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>={</span>RPName<span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><blockquote><p>NOTE: In this command, replace <code>{RPName}</code> with your <code>ResourcePlacement</code> name and <code>&lt;namespace></code> with the namespace where the ResourcePlacement exists.</p></blockquote><h2 id=how-can-i-find-the-correct-work-resource-thats-associated-with-resourceplacement>How can I find the correct work resource that&rsquo;s associated with ResourcePlacement?</h2><p>To find the correct work resource, follow these steps:</p><ol><li>Identify the member cluster namespace and the <code>ResourcePlacement</code> name. The format for the namespace is <code>fleet-member-{clusterName}</code>.</li><li>To get the work resource, run the following command:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get work -n fleet-member-<span style=color:#ce5c00;font-weight:700>{</span>clusterName<span style=color:#ce5c00;font-weight:700>}</span> -l kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>={</span>RPName<span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><blockquote><p>NOTE: In this command, replace <code>{clusterName}</code> and <code>{RPName}</code> with the names that you identified in the first step.</p></blockquote></div><div class=td-content style=page-break-before:always><h1 id=pg-2ebda7b0ab75a3e1b8f7d1d152615e0c>5.4 - CRP Rollout Failure TSG</h1><div class=lead>Troubleshooting guide for CRP status &ldquo;ClusterResourcePlacementRolloutStarted&rdquo; condition set to false</div><p>When using the <code>ClusterResourcePlacement</code> API object in Azure Kubernetes Fleet Manager to propagate resources, the selected resources aren&rsquo;t rolled out in all scheduled clusters and the <code>ClusterResourcePlacementRolloutStarted</code> condition status shows as <code>False</code>.</p><p><em>This TSG only applies to the <code>RollingUpdate</code> rollout strategy, which is the default strategy if you don&rsquo;t specify in the <code>ClusterResourcePlacement</code>.</em>
<em>To troubleshoot the update run strategy as you specify <code>External</code> in the <code>ClusterResourcePlacement</code>, please refer to the <a href=ClusterStagedUpdateRun>Staged Update Run Troubleshooting Guide</a>.</em></p><blockquote><p>Note: To get more information about why the rollout doesn&rsquo;t start, you can check the <a href=https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/controllers/rollout/controller.go>rollout controller</a> to get more information on why the rollout did not start.</p></blockquote><h2 id=common-scenarios>Common scenarios</h2><p>Instances where this condition may arise:</p><ul><li>The Cluster Resource Placement rollout strategy is blocked because the <code>RollingUpdate</code> configuration is too strict.</li></ul><h2 id=troubleshooting-steps>Troubleshooting Steps</h2><ol><li>In the <code>ClusterResourcePlacement</code> status section, check the <code>placementStatuses</code> to identify clusters with the <code>RolloutStarted</code> status set to <code>False</code>.</li><li>Locate the corresponding <code>ClusterResourceBinding</code> for the identified cluster. For more information, see <a href=README.md#how-can-i-find-the-latest-clusterresourcebinding-resource>How can I find the latest ClusterResourceBinding resource?</a>.
This resource should indicate the status of the <code>Work</code> whether it was created or updated.</li><li>Verify the values of <code>maxUnavailable</code> and <code>maxSurge</code> to ensure they align with your expectations.</li></ol><h2 id=case-study>Case Study</h2><p>In the following example, the <code>ClusterResourcePlacement</code> is trying to propagate a namespace to three member clusters.
However, during the initial creation of the <code>ClusterResourcePlacement</code>, the namespace didn&rsquo;t exist on the hub cluster,
and the fleet currently comprises two member clusters named <code>kind-cluster-1</code> and <code>kind-cluster-2</code>.</p><h3 id=clusterresourceplacement-spec>ClusterResourcePlacement spec</h3><pre tabindex=0><code>spec:
  policy:
    numberOfClusters: 3
    placementType: PickN
  resourceSelectors:
  - group: &#34;&#34;
    kind: Namespace
    name: test-ns
    version: v1
  revisionHistoryLimit: 10
  strategy:
    type: RollingUpdate
</code></pre><h3 id=clusterresourceplacement-status>ClusterResourcePlacement status</h3><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
    message: could not find all the clusters needed as specified by the scheduling
      policy
    observedGeneration: 1
    reason: SchedulingPolicyUnfulfilled
    status: &#34;False&#34;
    type: ClusterResourcePlacementScheduled
  - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
    message: All 2 cluster(s) start rolling out the latest resource
    observedGeneration: 1
    reason: RolloutStarted
    status: &#34;True&#34;
    type: ClusterResourcePlacementRolloutStarted
  - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
    message: No override rules are configured for the selected resources
    observedGeneration: 1
    reason: NoOverrideSpecified
    status: &#34;True&#34;
    type: ClusterResourcePlacementOverridden
  - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
    message: Works(s) are succcesfully created or updated in the 2 target clusters&#39;
      namespaces
    observedGeneration: 1
    reason: WorkSynchronized
    status: &#34;True&#34;
    type: ClusterResourcePlacementWorkSynchronized
  - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
    message: The selected resources are successfully applied to 2 clusters
    observedGeneration: 1
    reason: ApplySucceeded
    status: &#34;True&#34;
    type: ClusterResourcePlacementApplied
  - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
    message: The selected resources in 2 cluster are available now
    observedGeneration: 1
    reason: ResourceAvailable
    status: &#34;True&#34;
    type: ClusterResourcePlacementAvailable
  observedResourceIndex: &#34;0&#34;
  placementStatuses:
  - clusterName: kind-cluster-2
    conditions:
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: &#39;Successfully scheduled resources for placement in kind-cluster-2 (affinity
        score: 0, topology spread score: 0): picked by scheduling policy&#39;
      observedGeneration: 1
      reason: Scheduled
      status: &#34;True&#34;
      type: Scheduled
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: Detected the new changes on the resources and started the rollout process
      observedGeneration: 1
      reason: RolloutStarted
      status: &#34;True&#34;
      type: RolloutStarted
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: No override rules are configured for the selected resources
      observedGeneration: 1
      reason: NoOverrideSpecified
      status: &#34;True&#34;
      type: Overridden
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: All of the works are synchronized to the latest
      observedGeneration: 1
      reason: AllWorkSynced
      status: &#34;True&#34;
      type: WorkSynchronized
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: All corresponding work objects are applied
      observedGeneration: 1
      reason: AllWorkHaveBeenApplied
      status: &#34;True&#34;
      type: Applied
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: All corresponding work objects are available
      observedGeneration: 1
      reason: AllWorkAreAvailable
      status: &#34;True&#34;
      type: Available
  - clusterName: kind-cluster-1
    conditions:
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: &#39;Successfully scheduled resources for placement in kind-cluster-1 (affinity
        score: 0, topology spread score: 0): picked by scheduling policy&#39;
      observedGeneration: 1
      reason: Scheduled
      status: &#34;True&#34;
      type: Scheduled
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: Detected the new changes on the resources and started the rollout process
      observedGeneration: 1
      reason: RolloutStarted
      status: &#34;True&#34;
      type: RolloutStarted
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: No override rules are configured for the selected resources
      observedGeneration: 1
      reason: NoOverrideSpecified
      status: &#34;True&#34;
      type: Overridden
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: All of the works are synchronized to the latest
      observedGeneration: 1
      reason: AllWorkSynced
      status: &#34;True&#34;
      type: WorkSynchronized
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: All corresponding work objects are applied
      observedGeneration: 1
      reason: AllWorkHaveBeenApplied
      status: &#34;True&#34;
      type: Applied
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: All corresponding work objects are available
      observedGeneration: 1
      reason: AllWorkAreAvailable
      status: &#34;True&#34;
      type: Available
</code></pre><p>The previous output indicates that the resource <code>test-ns</code> namespace never exists on the hub cluster and shows the following <code>ClusterResourcePlacement</code> condition statuses:</p><ul><li><code>ClusterResourcePlacementScheduled</code> is set to <code>False</code>, as the specified policy aims to pick three clusters, but the scheduler can only accommodate placement in two currently available and joined clusters.</li><li><code>ClusterResourcePlacementRolloutStarted</code> is set to <code>True</code>, as the rollout process has commenced with 2 clusters being selected.</li><li><code>ClusterResourcePlacementOverridden</code> is set to <code>True</code>, as no override rules are configured for the selected resources.</li><li><code>ClusterResourcePlacementWorkSynchronized</code> is set to <code>True</code>.</li><li><code>ClusterResourcePlacementApplied</code> is set to <code>True</code>.</li><li><code>ClusterResourcePlacementAvailable</code> is set to <code>True</code>.</li></ul><p>To ensure seamless propagation of the namespace across the relevant clusters, proceed to create the <code>test-ns</code> namespace on the hub cluster.</p><h3 id=clusterresourceplacement-status-after-namespace-test-ns-is-created-on-the-hub-cluster>ClusterResourcePlacement status after namespace test-ns is created on the hub cluster</h3><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
    message: could not find all the clusters needed as specified by the scheduling
      policy
    observedGeneration: 1
    reason: SchedulingPolicyUnfulfilled
    status: &#34;False&#34;
    type: ClusterResourcePlacementScheduled
  - lastTransitionTime: &#34;2024-05-07T23:13:51Z&#34;
    message: The rollout is being blocked by the rollout strategy in 2 cluster(s)
    observedGeneration: 1
    reason: RolloutNotStartedYet
    status: &#34;False&#34;
    type: ClusterResourcePlacementRolloutStarted
  observedResourceIndex: &#34;1&#34;
  placementStatuses:
  - clusterName: kind-cluster-2
    conditions:
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: &#39;Successfully scheduled resources for placement in kind-cluster-2 (affinity
        score: 0, topology spread score: 0): picked by scheduling policy&#39;
      observedGeneration: 1
      reason: Scheduled
      status: &#34;True&#34;
      type: Scheduled
    - lastTransitionTime: &#34;2024-05-07T23:13:51Z&#34;
      message: The rollout is being blocked by the rollout strategy
      observedGeneration: 1
      reason: RolloutNotStartedYet
      status: &#34;False&#34;
      type: RolloutStarted
  - clusterName: kind-cluster-1
    conditions:
    - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
      message: &#39;Successfully scheduled resources for placement in kind-cluster-1 (affinity
        score: 0, topology spread score: 0): picked by scheduling policy&#39;
      observedGeneration: 1
      reason: Scheduled
      status: &#34;True&#34;
      type: Scheduled
    - lastTransitionTime: &#34;2024-05-07T23:13:51Z&#34;
      message: The rollout is being blocked by the rollout strategy
      observedGeneration: 1
      reason: RolloutNotStartedYet
      status: &#34;False&#34;
      type: RolloutStarted
  selectedResources:
  - kind: Namespace
    name: test-ns
    version: v1
</code></pre><p>Upon examination, the <code>ClusterResourcePlacementScheduled</code> condition status is shown as <code>False</code>.
The <code>ClusterResourcePlacementRolloutStarted</code> status is also shown as <code>False</code> with the message <code>The rollout is being blocked by the rollout strategy in 2 cluster(s)</code>.</p><p>Let&rsquo;s check the latest <code>ClusterResourceSnapshot</code>.</p><p>Check the latest <code>ClusterResourceSnapshot</code> by running the command in <a href=README.md#how-can-I-find-the-latest-ClusterResourceSnapshot-resource>How can I find the latest ClusterResourceSnapshot resource?</a>.</p><h3 id=latest-clusterresourcesnapshot>Latest ClusterResourceSnapshot</h3><pre tabindex=0><code>apiVersion: placement.kubernetes-fleet.io/v1
kind: ClusterResourceSnapshot
metadata:
  annotations:
    kubernetes-fleet.io/number-of-enveloped-object: &#34;0&#34;
    kubernetes-fleet.io/number-of-resource-snapshots: &#34;1&#34;
    kubernetes-fleet.io/resource-hash: 72344be6e268bc7af29d75b7f0aad588d341c228801aab50d6f9f5fc33dd9c7c
  creationTimestamp: &#34;2024-05-07T23:13:51Z&#34;
  generation: 1
  labels:
    kubernetes-fleet.io/is-latest-snapshot: &#34;true&#34;
    kubernetes-fleet.io/parent-CRP: crp-3
    kubernetes-fleet.io/resource-index: &#34;1&#34;
  name: crp-3-1-snapshot
  ownerReferences:
  - apiVersion: placement.kubernetes-fleet.io/v1beta1
    blockOwnerDeletion: true
    controller: true
    kind: ClusterResourcePlacement
    name: crp-3
    uid: b4f31b9a-971a-480d-93ac-93f093ee661f
  resourceVersion: &#34;14434&#34;
  uid: 85ee0e81-92c9-4362-932b-b0bf57d78e3f
spec:
  selectedResources:
  - apiVersion: v1
    kind: Namespace
    metadata:
      labels:
        kubernetes.io/metadata.name: test-ns
      name: test-ns
    spec:
      finalizers:
      - kubernetes
</code></pre><p>Upon inspecting <code>ClusterResourceSnapshot</code> spec, the <code>selectedResources</code> section now shows the namespace <code>test-ns</code>.</p><p>Let&rsquo;s check the <code>ClusterResourceBinding</code> for <code>kind-cluster-1</code> to see if it was updated after the namespace <code>test-ns</code> was created.
Check the <code>ClusterResourceBinding</code> for <code>kind-cluster-1</code> by running the command in <a href=README.md#how-can-i-find-the-latest-clusterresourcebinding-resource>How can I find the latest ClusterResourceBinding resource?</a>.</p><h3 id=clusterresourcebinding-for-kind-cluster-1>ClusterResourceBinding for kind-cluster-1</h3><pre tabindex=0><code>apiVersion: placement.kubernetes-fleet.io/v1
kind: ClusterResourceBinding
metadata:
  creationTimestamp: &#34;2024-05-07T23:08:53Z&#34;
  finalizers:
  - kubernetes-fleet.io/work-cleanup
  generation: 2
  labels:
    kubernetes-fleet.io/parent-CRP: crp-3
  name: crp-3-kind-cluster-1-7114c253
  resourceVersion: &#34;14438&#34;
  uid: 0db4e480-8599-4b40-a1cc-f33bcb24b1a7
spec:
  applyStrategy:
    type: ClientSideApply
  clusterDecision:
    clusterName: kind-cluster-1
    clusterScore:
      affinityScore: 0
      priorityScore: 0
    reason: picked by scheduling policy
    selected: true
  resourceSnapshotName: crp-3-0-snapshot
  schedulingPolicySnapshotName: crp-3-0
  state: Bound
  targetCluster: kind-cluster-1
status:
  conditions:
  - lastTransitionTime: &#34;2024-05-07T23:13:51Z&#34;
    message: The resources cannot be updated to the latest because of the rollout
      strategy
    observedGeneration: 2
    reason: RolloutNotStartedYet
    status: &#34;False&#34;
    type: RolloutStarted
  - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
    message: No override rules are configured for the selected resources
    observedGeneration: 2
    reason: NoOverrideSpecified
    status: &#34;True&#34;
    type: Overridden
  - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
    message: All of the works are synchronized to the latest
    observedGeneration: 2
    reason: AllWorkSynced
    status: &#34;True&#34;
    type: WorkSynchronized
  - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
    message: All corresponding work objects are applied
    observedGeneration: 2
    reason: AllWorkHaveBeenApplied
    status: &#34;True&#34;
    type: Applied
  - lastTransitionTime: &#34;2024-05-07T23:08:53Z&#34;
    message: All corresponding work objects are available
    observedGeneration: 2
    reason: AllWorkAreAvailable
    status: &#34;True&#34;
    type: Available
</code></pre><p>Upon inspection, it is observed that the <code>ClusterResourceBinding</code> remains unchanged. Notably, in the spec, the <code>resourceSnapshotName</code> still references the old <code>ClusterResourceSnapshot</code> name.</p><p>This issue arises due to the absence of explicit <code>rollingUpdate</code> input from the user. Consequently, the default values are applied:</p><ul><li>The <code>maxUnavailable</code> value is configured to 25% x 3 (desired number), rounded to <code>1</code></li><li>The <code>maxSurge</code> value is configured to 25% x 3 (desired number), rounded to <code>1</code></li></ul><h3 id=why-clusterresourcebinding-isnt-updated>Why ClusterResourceBinding isn&rsquo;t updated?</h3><p>Initially, when the <code>ClusterResourcePlacement</code> was created, two <code>ClusterResourceBindings</code> were generated.
However, since the rollout didn&rsquo;t apply to the initial phase, the <code>ClusterResourcePlacementRolloutStarted</code> condition was set to <code>True</code>.</p><p>Upon creating the <code>test-ns</code> namespace on the hub cluster, the rollout controller attempted to update the two existing <code>ClusterResourceBindings</code>.
However, <code>maxUnavailable</code> was set to <code>1</code> due to the lack of member clusters, which caused the <code>RollingUpdate</code> configuration to be too strict.</p><blockquote><p>NOTE: During the update, if one of the bindings fails to apply, it will also violate the <code>RollingUpdate</code> configuration, which causes <code>maxUnavailable</code> to be set to <code>1</code>.</p></blockquote><h3 id=resolution>Resolution</h3><p>In this situation, to address this issue, consider manually setting <code>maxUnavailable</code> to a value greater than <code>1</code> to relax the <code>RollingUpdate</code> configuration.
Alternatively, you can join a third member cluster.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a7815b1d1edbdbce187363a1b343e478>5.5 - CRP Override Failure TSG</h1><div class=lead>Troubleshooting guide for CRP status &ldquo;ClusterResourcePlacementOverridden&rdquo; condition set to false</div><p>The status of the <code>ClusterResourcePlacementOverridden</code> condition is set to <code>false</code> when there is an Override API related issue.</p><blockquote><p>Note: To get more information, look into the logs for the overrider controller (includes
controller for <a href=https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/controllers/overrider/clusterresource_controller.go>ClusterResourceOverride</a> and
<a href=https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/controllers/overrider/resource_controller.go>ResourceOverride</a>).</p></blockquote><h2 id=common-scenarios>Common scenarios</h2><p>Instances where this condition may arise:</p><ul><li>The <code>ClusterResourceOverride</code> or <code>ResourceOverride</code> is created with an invalid field path for the resource.</li></ul><h2 id=case-study>Case Study</h2><p>In the following example, an attempt is made to override the cluster role <code>secret-reader</code> that is being propagated by the <code>ClusterResourcePlacement</code> to the selected clusters.
However, the <code>ClusterResourceOverride</code> is created with an invalid path for the field within resource.</p><h3 id=clusterrole>ClusterRole</h3><pre tabindex=0><code>apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
    creationTimestamp: &#34;2024-05-14T15:36:48Z&#34;
    name: secret-reader
    resourceVersion: &#34;81334&#34;
    uid: 108e6312-3416-49be-aa3d-a665c5df58b4
rules:
- apiGroups:
  - &#34;&#34;
    resources:
  - secrets
    verbs:
  - get
  - watch
  - list
</code></pre><p>The <code>ClusterRole</code> <code>secret-reader</code> that is being propagated to the member clusters by the <code>ClusterResourcePlacement</code>.</p><h3 id=clusterresourceoverride-spec>ClusterResourceOverride spec</h3><pre tabindex=0><code>spec:
  clusterResourceSelectors:
  - group: rbac.authorization.k8s.io
    kind: ClusterRole
    name: secret-reader
    version: v1
  policy:
    overrideRules:
    - clusterSelector:
        clusterSelectorTerms:
        - labelSelector:
            matchLabels:
              env: canary
      jsonPatchOverrides:
      - op: add
        path: /metadata/labels/new-label
        value: new-value
</code></pre><p>The <code>ClusterResourceOverride</code> is created to override the <code>ClusterRole</code> <code>secret-reader</code> by adding a new label (<code>new-label</code>)
that has the value <code>new-value</code> for the clusters with the label <code>env: canary</code>.</p><h3 id=clusterresourceplacement-spec>ClusterResourcePlacement Spec</h3><pre tabindex=0><code>spec:
  resourceSelectors:
    - group: rbac.authorization.k8s.io
      kind: ClusterRole
      name: secret-reader
      version: v1
  policy:
    placementType: PickN
    numberOfClusters: 1
    affinity:
      clusterAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          clusterSelectorTerms:
            - labelSelector:
                matchLabels:
                  env: canary
  strategy:
    type: RollingUpdate
    applyStrategy:
      allowCoOwnership: true
</code></pre><h3 id=clusterresourceplacement-status>ClusterResourcePlacement Status</h3><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2024-05-14T16:16:18Z&#34;
    message: found all cluster needed as specified by the scheduling policy, found
      1 cluster(s)
    observedGeneration: 1
    reason: SchedulingPolicyFulfilled
    status: &#34;True&#34;
    type: ClusterResourcePlacementScheduled
  - lastTransitionTime: &#34;2024-05-14T16:16:18Z&#34;
    message: All 1 cluster(s) start rolling out the latest resource
    observedGeneration: 1
    reason: RolloutStarted
    status: &#34;True&#34;
    type: ClusterResourcePlacementRolloutStarted
  - lastTransitionTime: &#34;2024-05-14T16:16:18Z&#34;
    message: Failed to override resources in 1 cluster(s)
    observedGeneration: 1
    reason: OverriddenFailed
    status: &#34;False&#34;
    type: ClusterResourcePlacementOverridden
  observedResourceIndex: &#34;0&#34;
  placementStatuses:
  - applicableClusterResourceOverrides:
    - cro-1-0
    clusterName: kind-cluster-1
    conditions:
    - lastTransitionTime: &#34;2024-05-14T16:16:18Z&#34;
      message: &#39;Successfully scheduled resources for placement in kind-cluster-1 (affinity
        score: 0, topology spread score: 0): picked by scheduling policy&#39;
      observedGeneration: 1
      reason: Scheduled
      status: &#34;True&#34;
      type: Scheduled
    - lastTransitionTime: &#34;2024-05-14T16:16:18Z&#34;
      message: Detected the new changes on the resources and started the rollout process
      observedGeneration: 1
      reason: RolloutStarted
      status: &#34;True&#34;
      type: RolloutStarted
    - lastTransitionTime: &#34;2024-05-14T16:16:18Z&#34;
      message: &#39;Failed to apply the override rules on the resources: add operation
        does not apply: doc is missing path: &#34;/metadata/labels/new-label&#34;: missing
        value&#39;
      observedGeneration: 1
      reason: OverriddenFailed
      status: &#34;False&#34;
      type: Overridden
  selectedResources:
  - group: rbac.authorization.k8s.io
    kind: ClusterRole
    name: secret-reader
    version: v1
</code></pre><p>The CRP attempted to override a propagated resource utilizing an applicable <code>ClusterResourceOverrideSnapshot</code>.
However, as the <code>ClusterResourcePlacementOverridden</code> condition remains false, looking at the placement status for the cluster
where the condition <code>Overridden</code> failed will offer insights into the exact cause of the failure.</p><p>In this situation, the message indicates that the override failed because the path <code>/metadata/labels/new-label</code> and its corresponding value are missing.
Based on the previous example of the cluster role <code>secret-reader</code>, you can see that the path <code>/metadata/labels/</code> doesn&rsquo;t exist. This means that <code>labels</code> doesn&rsquo;t exist.
Therefore, a new label can&rsquo;t be added.</p><h3 id=resolution>Resolution</h3><p>To successfully override the cluster role <code>secret-reader</code>, correct the path and value in <code>ClusterResourceOverride</code>, as shown in the following code:</p><pre tabindex=0><code>jsonPatchOverrides:
  - op: add
    path: /metadata/labels
    value: 
      newlabel: new-value
</code></pre><p>This will successfully add the new label <code>newlabel</code> with the value <code>new-value</code> to the <code>ClusterRole</code> <code>secret-reader</code>, as we are creating the <code>labels</code> field and adding a new value <code>newlabel: new-value</code> to it.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-ac0342e775af869b5b77d564fc4c06f6>5.6 - CRP Work-Synchronization Failure TSG</h1><div class=lead>Troubleshooting guide for CRP status &ldquo;ClusterResourcePlacementWorkSynchronized&rdquo; condition set to false</div><p>The <code>ClusterResourcePlacementWorkSynchronized</code> condition is false when the CRP has been recently updated but the associated work objects have not yet been synchronized with the changes.</p><blockquote><p>Note: In addition, it may be helpful to look into the logs for the <a href=https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/controllers/workgenerator/controller.go>work generator controller</a> to get more information on why the work synchronization failed.</p></blockquote><h2 id=common-scenarios>Common Scenarios</h2><p>Instances where this condition may arise:</p><ul><li>The controller encounters an error while trying to generate the corresponding <code>work</code> object.</li><li>The enveloped object is not well formatted.</li></ul><h3 id=case-study>Case Study</h3><p>The CRP is attempting to propagate a resource to a selected cluster, but the work object has not been updated to reflect the latest changes due to the selected cluster has been terminated.</p><h3 id=clusterresourceplacement-spec>ClusterResourcePlacement Spec</h3><pre tabindex=0><code>spec:
  resourceSelectors:
    - group: rbac.authorization.k8s.io
      kind: ClusterRole
      name: secret-reader
      version: v1
  policy:
    placementType: PickN
    numberOfClusters: 1
  strategy:
    type: RollingUpdate
</code></pre><h3 id=clusterresourceplacement-status>ClusterResourcePlacement Status</h3><pre tabindex=0><code>spec:
  policy:
    numberOfClusters: 1
    placementType: PickN
  resourceSelectors:
  - group: &#34;&#34;
    kind: Namespace
    name: test-ns
    version: v1
  revisionHistoryLimit: 10
  strategy:
    type: RollingUpdate
status:
  conditions:
  - lastTransitionTime: &#34;2024-05-14T18:05:04Z&#34;
    message: found all cluster needed as specified by the scheduling policy, found
      1 cluster(s)
    observedGeneration: 1
    reason: SchedulingPolicyFulfilled
    status: &#34;True&#34;
    type: ClusterResourcePlacementScheduled
  - lastTransitionTime: &#34;2024-05-14T18:05:05Z&#34;
    message: All 1 cluster(s) start rolling out the latest resource
    observedGeneration: 1
    reason: RolloutStarted
    status: &#34;True&#34;
    type: ClusterResourcePlacementRolloutStarted
  - lastTransitionTime: &#34;2024-05-14T18:05:05Z&#34;
    message: No override rules are configured for the selected resources
    observedGeneration: 1
    reason: NoOverrideSpecified
    status: &#34;True&#34;
    type: ClusterResourcePlacementOverridden
  - lastTransitionTime: &#34;2024-05-14T18:05:05Z&#34;
    message: There are 1 cluster(s) which have not finished creating or updating work(s)
      yet
    observedGeneration: 1
    reason: WorkNotSynchronizedYet
    status: &#34;False&#34;
    type: ClusterResourcePlacementWorkSynchronized
  observedResourceIndex: &#34;0&#34;
  placementStatuses:
  - clusterName: kind-cluster-1
    conditions:
    - lastTransitionTime: &#34;2024-05-14T18:05:04Z&#34;
      message: &#39;Successfully scheduled resources for placement in kind-cluster-1 (affinity
        score: 0, topology spread score: 0): picked by scheduling policy&#39;
      observedGeneration: 1
      reason: Scheduled
      status: &#34;True&#34;
      type: Scheduled
    - lastTransitionTime: &#34;2024-05-14T18:05:05Z&#34;
      message: Detected the new changes on the resources and started the rollout process
      observedGeneration: 1
      reason: RolloutStarted
      status: &#34;True&#34;
      type: RolloutStarted
    - lastTransitionTime: &#34;2024-05-14T18:05:05Z&#34;
      message: No override rules are configured for the selected resources
      observedGeneration: 1
      reason: NoOverrideSpecified
      status: &#34;True&#34;
      type: Overridden
    - lastTransitionTime: &#34;2024-05-14T18:05:05Z&#34;
      message: &#39;Failed to synchronize the work to the latest: works.placement.kubernetes-fleet.io
        &#34;crp1-work&#34; is forbidden: unable to create new content in namespace fleet-member-kind-cluster-1
        because it is being terminated&#39;
      observedGeneration: 1
      reason: SyncWorkFailed
      status: &#34;False&#34;
      type: WorkSynchronized
  selectedResources:
  - kind: Namespace
    name: test-ns
    version: v1
</code></pre><p>In the <code>ClusterResourcePlacement</code> status, the <code>ClusterResourcePlacementWorkSynchronized</code> condition status shows as <code>False</code>.
The message for it indicates that the work object <code>crp1-work</code> is prohibited from generating new content within the namespace <code>fleet-member-kind-cluster-1</code> because it&rsquo;s currently terminating.</p><h3 id=resolution>Resolution</h3><p>To address the issue at hand, there are several potential solutions:</p><ul><li>Modify the <code>ClusterResourcePlacement</code> with a newly selected cluster.</li><li>Delete the <code>ClusterResourcePlacement</code> to remove work through garbage collection.</li><li>Rejoin the member cluster. The namespace can only be regenerated after rejoining the cluster.</li></ul><p>In other situations, you might opt to wait for the work to finish propagating.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-ad9e0d02d959cb98d7558d179b1eff6f>5.7 - Work-Application Failure TSG</h1><div class=lead>Troubleshooting guide for &ldquo;Applied&rdquo; condition set to false</div><p>The <code>ClusterResourcePlacementApplied</code> (for ClusterResourcePlacement) or <code>ResourcePlacementApplied</code> (for ResourcePlacement) condition is set to <code>false</code> when the deployment fails to apply.</p><blockquote><p>Note: To get more information about why the resources are not applied, you can check the <a href=https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/controllers/workapplier>work applier</a> logs.</p></blockquote><h2 id=common-scenarios>Common scenarios</h2><p>Instances where this condition may arise:</p><ul><li>The resource already exists on the cluster and isn&rsquo;t managed by the fleet controller.</li><li>Another placement (ClusterResourcePlacement or ResourcePlacement) is already managing the resource for the selected cluster by using a different apply strategy.</li><li>The placement doesn&rsquo;t apply the manifest because of syntax errors or invalid resource configurations. This might also occur if a resource is propagated through an envelope object.</li></ul><h2 id=investigation-steps>Investigation steps</h2><ol><li><strong>Check <code>placementStatuses</code></strong>: In the placement status section, inspect the <code>placementStatuses</code> to identify which clusters have the <code>Applied</code> condition set to <code>false</code> and note down their <code>clusterName</code>.</li><li><strong>Locate the <code>Work</code> Object in Hub Cluster</strong>: Use the identified <code>clusterName</code> to locate the <code>Work</code> object associated with the member cluster.<ul><li>For ClusterResourcePlacement, refer to <a href=/docs/troubleshooting/clusterresourceplacement/#how-can-i-find-the-correct-work-resource-thats-associated-with-clusterresourceplacement>this section</a></li><li>For ResourcePlacement, refer to <a href=/docs/troubleshooting/resourceplacement/#how-can-i-find-the-correct-work-resource-thats-associated-with-resourceplacement>this section</a></li></ul></li><li><strong>Check <code>Work</code> object status</strong>: Inspect the status of the <code>Work</code> object to understand the specific issues preventing successful resource application.</li></ol><h2 id=case-study-clusterresourceplacement>Case Study: ClusterResourcePlacement</h2><p>In the following example, a <code>ClusterResourcePlacement</code> is trying to propagate a namespace that contains a deployment to two member clusters. However, the namespace already exists on one member cluster, specifically <code>kind-cluster-1</code>.</p><h3 id=clusterresourceplacement-spec>ClusterResourcePlacement spec</h3><pre tabindex=0><code>  policy:
    clusterNames:
    - kind-cluster-1
    - kind-cluster-2
    placementType: PickFixed
  resourceSelectors:
  - group: &#34;&#34;
    kind: Namespace
    name: test-ns
    version: v1
  revisionHistoryLimit: 10
  strategy:
    type: RollingUpdate
</code></pre><h3 id=clusterresourceplacement-status>ClusterResourcePlacement status</h3><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
    message: could not find all the clusters needed as specified by the scheduling
      policy
    observedGeneration: 1
    reason: SchedulingPolicyUnfulfilled
    status: &#34;False&#34;
    type: ClusterResourcePlacementScheduled
  - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
    message: All 2 cluster(s) start rolling out the latest resource
    observedGeneration: 1
    reason: RolloutStarted
    status: &#34;True&#34;
    type: ClusterResourcePlacementRolloutStarted
  - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
    message: No override rules are configured for the selected resources
    observedGeneration: 1
    reason: NoOverrideSpecified
    status: &#34;True&#34;
    type: ClusterResourcePlacementOverridden
  - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
    message: Works(s) are succcesfully created or updated in the 2 target clusters&#39;
      namespaces
    observedGeneration: 1
    reason: WorkSynchronized
    status: &#34;True&#34;
    type: ClusterResourcePlacementWorkSynchronized
  - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
    message: Failed to apply resources to 1 clusters, please check the `failedPlacements`
      status
    observedGeneration: 1
    reason: ApplyFailed
    status: &#34;False&#34;
    type: ClusterResourcePlacementApplied
  observedResourceIndex: &#34;0&#34;
  placementStatuses:
  - clusterName: kind-cluster-2
    conditions:
    - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
      message: &#39;Successfully scheduled resources for placement in kind-cluster-2 (affinity
        score: 0, topology spread score: 0): picked by scheduling policy&#39;
      observedGeneration: 1
      reason: Scheduled
      status: &#34;True&#34;
      type: Scheduled
    - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
      message: Detected the new changes on the resources and started the rollout process
      observedGeneration: 1
      reason: RolloutStarted
      status: &#34;True&#34;
      type: RolloutStarted
    - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
      message: No override rules are configured for the selected resources
      observedGeneration: 1
      reason: NoOverrideSpecified
      status: &#34;True&#34;
      type: Overridden
    - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
      message: All of the works are synchronized to the latest
      observedGeneration: 1
      reason: AllWorkSynced
      status: &#34;True&#34;
      type: WorkSynchronized
    - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
      message: All corresponding work objects are applied
      observedGeneration: 1
      reason: AllWorkHaveBeenApplied
      status: &#34;True&#34;
      type: Applied
    - lastTransitionTime: &#34;2024-05-07T23:32:49Z&#34;
      message: The availability of work object crp-4-work is not trackable
      observedGeneration: 1
      reason: WorkNotTrackable
      status: &#34;True&#34;
      type: Available
  - clusterName: kind-cluster-1
    conditions:
    - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
      message: &#39;Successfully scheduled resources for placement in kind-cluster-1 (affinity
        score: 0, topology spread score: 0): picked by scheduling policy&#39;
      observedGeneration: 1
      reason: Scheduled
      status: &#34;True&#34;
      type: Scheduled
    - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
      message: Detected the new changes on the resources and started the rollout process
      observedGeneration: 1
      reason: RolloutStarted
      status: &#34;True&#34;
      type: RolloutStarted
    - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
      message: No override rules are configured for the selected resources
      observedGeneration: 1
      reason: NoOverrideSpecified
      status: &#34;True&#34;
      type: Overridden
    - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
      message: All of the works are synchronized to the latest
      observedGeneration: 1
      reason: AllWorkSynced
      status: &#34;True&#34;
      type: WorkSynchronized
    - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
      message: Work object crp-4-work is not applied
      observedGeneration: 1
      reason: NotAllWorkHaveBeenApplied
      status: &#34;False&#34;
      type: Applied
    failedPlacements:
    - condition:
        lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
        message: &#39;Failed to apply manifest: failed to process the request due to a
          client error: resource exists and is not managed by the fleet controller
          and co-ownernship is disallowed&#39;
        reason: ManifestsAlreadyOwnedByOthers
        status: &#34;False&#34;
        type: Applied
      kind: Namespace
      name: test-ns
      version: v1
  selectedResources:
  - kind: Namespace
    name: test-ns
    version: v1
  - group: apps
    kind: Deployment
    name: test-nginx
    namespace: test-ns
    version: v1
</code></pre><p>In the ClusterResourcePlacement status, within the <code>failedPlacements</code> section for <code>kind-cluster-1</code>, we get a clear message
as to why the resource failed to apply on the member cluster. In the preceding <code>conditions</code> section,
the <code>Applied</code> condition for <code>kind-cluster-1</code> is flagged as false and shows the <code>NotAllWorkHaveBeenApplied</code> reason.
This indicates that the Work object intended for the member cluster <code>kind-cluster-1</code> has not been applied.</p><p>To inspect the Work object for more details, follow the steps in the <a href=/docs/troubleshooting/placementapplied/#investigation-steps>Investigation steps</a> section above.</p><h3 id=work-status-of-kind-cluster-1>Work status of kind-cluster-1</h3><pre tabindex=0><code> status:
  conditions:
  - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
    message: &#39;Apply manifest {Ordinal:0 Group: Version:v1 Kind:Namespace Resource:namespaces
      Namespace: Name:test-ns} failed&#39;
    observedGeneration: 1
    reason: WorkAppliedFailed
    status: &#34;False&#34;
    type: Applied
  - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
    message: &#34;&#34;
    observedGeneration: 1
    reason: WorkAppliedFailed
    status: Unknown
    type: Available
  manifestConditions:
  - conditions:
    - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
      message: &#39;Failed to apply manifest: failed to process the request due to a client
        error: resource exists and is not managed by the fleet controller and co-ownernship
        is disallowed&#39;
      reason: ManifestsAlreadyOwnedByOthers
      status: &#34;False&#34;
      type: Applied
    - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
      message: Manifest is not applied yet
      reason: ManifestApplyFailed
      status: Unknown
      type: Available
    identifier:
      kind: Namespace
      name: test-ns
      ordinal: 0
      resource: namespaces
      version: v1
  - conditions:
    - lastTransitionTime: &#34;2024-05-07T23:32:40Z&#34;
      message: Manifest is already up to date
      observedGeneration: 1
      reason: ManifestAlreadyUpToDate
      status: &#34;True&#34;
      type: Applied
    - lastTransitionTime: &#34;2024-05-07T23:32:51Z&#34;
      message: Manifest is trackable and available now
      observedGeneration: 1
      reason: ManifestAvailable
      status: &#34;True&#34;
      type: Available
    identifier:
      group: apps
      kind: Deployment
      name: test-nginx
      namespace: test-ns
      ordinal: 1
      resource: deployments
      version: v1
</code></pre><p>From looking at the <code>Work</code> status, specifically the <code>manifestConditions</code> section, you can see that the namespace could not be applied but the deployment within the namespace got propagated from the hub to the member cluster.</p><h3 id=resolution>Resolution</h3><p>In this situation, a potential solution is to set the <code>AllowCoOwnership</code> to <code>true</code> in the ApplyStrategy policy. However, it&rsquo;s important to notice that this decision should be made by the user because the resources might not be shared.</p><h2 id=general-troubleshooting-notes>General Troubleshooting Notes</h2><p>The troubleshooting process and Work object inspection are identical for both ClusterResourcePlacement and ResourcePlacement:</p><ul><li>Both use the same underlying Work API to apply resources to member clusters</li><li>The Work object status and manifestConditions have the same structure regardless of whether they were created by a ClusterResourcePlacement or ResourcePlacement</li><li>The main difference is the scope: ClusterResourcePlacement is cluster-scoped and can select both cluster-scoped and namespace-scoped resources, while ResourcePlacement is namespace-scoped and can only select namespace-scoped resources within its own namespace</li></ul><p>For ResourcePlacement-specific considerations:</p><ul><li>Ensure the target namespace exists on member clusters before the ResourcePlacement tries to apply resources to it</li><li>ResourcePlacement can only select resources within the same namespace where the ResourcePlacement object itself resides</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-347b6a1d4f9443a8fb0b7d48994c2b21>5.8 - Availability Failure TSG</h1><div class=lead>Troubleshooting guide for &ldquo;Available&rdquo; condition set to false</div><p>The <code>ClusterResourcePlacementAvailable</code> (for ClusterResourcePlacement) or <code>ResourcePlacementAvailable</code> (for ResourcePlacement) condition is <code>false</code> when some of the resources are not available yet. Detailed failures are placed in the <code>failedPlacements</code> section of the placement status.</p><blockquote><p>Note: To get more information about why resources are unavailable check <a href=https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/controllers/workapplier>work applier</a> logs.</p></blockquote><h2 id=common-scenarios>Common scenarios</h2><p>Instances where this condition may arise:</p><ul><li>The member cluster doesn&rsquo;t have enough resource availability.</li><li>The deployment contains an invalid image name.</li><li>Required resources (such as persistent volumes, config maps, or secrets) are missing.</li><li>Resource quotas or limit ranges are preventing the resource from becoming available.</li></ul><h2 id=case-study-clusterresourceplacement>Case Study: ClusterResourcePlacement</h2><p>The example output below demonstrates a scenario where a ClusterResourcePlacement is unable to propagate a deployment to a member cluster due to the deployment having a bad image name.</p><h3 id=clusterresourceplacement-spec>ClusterResourcePlacement spec</h3><pre tabindex=0><code>spec:
  resourceSelectors:
    - group: &#34;&#34;
      kind: Namespace
      name: test-ns
      version: v1
  policy:
    placementType: PickN
    numberOfClusters: 1
  strategy:
    type: RollingUpdate
</code></pre><h3 id=clusterresourceplacement-status>ClusterResourcePlacement status</h3><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2024-05-14T18:52:30Z&#34;
    message: found all cluster needed as specified by the scheduling policy, found
      1 cluster(s)
    observedGeneration: 1
    reason: SchedulingPolicyFulfilled
    status: &#34;True&#34;
    type: ClusterResourcePlacementScheduled
  - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
    message: All 1 cluster(s) start rolling out the latest resource
    observedGeneration: 1
    reason: RolloutStarted
    status: &#34;True&#34;
    type: ClusterResourcePlacementRolloutStarted
  - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
    message: No override rules are configured for the selected resources
    observedGeneration: 1
    reason: NoOverrideSpecified
    status: &#34;True&#34;
    type: ClusterResourcePlacementOverridden
  - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
    message: Works(s) are succcesfully created or updated in 1 target cluster(s)&#39;
      namespaces
    observedGeneration: 1
    reason: WorkSynchronized
    status: &#34;True&#34;
    type: ClusterResourcePlacementWorkSynchronized
  - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
    message: The selected resources are successfully applied to 1 cluster(s)
    observedGeneration: 1
    reason: ApplySucceeded
    status: &#34;True&#34;
    type: ClusterResourcePlacementApplied
  - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
    message: The selected resources in 1 cluster(s) are still not available yet
    observedGeneration: 1
    reason: ResourceNotAvailableYet
    status: &#34;False&#34;
    type: ClusterResourcePlacementAvailable
  observedResourceIndex: &#34;0&#34;
  placementStatuses:
  - clusterName: kind-cluster-1
    conditions:
    - lastTransitionTime: &#34;2024-05-14T18:52:30Z&#34;
      message: &#39;Successfully scheduled resources for placement in kind-cluster-1 (affinity
        score: 0, topology spread score: 0): picked by scheduling policy&#39;
      observedGeneration: 1
      reason: Scheduled
      status: &#34;True&#34;
      type: Scheduled
    - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
      message: Detected the new changes on the resources and started the rollout process
      observedGeneration: 1
      reason: RolloutStarted
      status: &#34;True&#34;
      type: RolloutStarted
    - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
      message: No override rules are configured for the selected resources
      observedGeneration: 1
      reason: NoOverrideSpecified
      status: &#34;True&#34;
      type: Overridden
    - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
      message: All of the works are synchronized to the latest
      observedGeneration: 1
      reason: AllWorkSynced
      status: &#34;True&#34;
      type: WorkSynchronized
    - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
      message: All corresponding work objects are applied
      observedGeneration: 1
      reason: AllWorkHaveBeenApplied
      status: &#34;True&#34;
      type: Applied
    - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
      message: Work object crp1-work is not available
      observedGeneration: 1
      reason: NotAllWorkAreAvailable
      status: &#34;False&#34;
      type: Available
    failedPlacements:
    - condition:
        lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
        message: Manifest is trackable but not available yet
        observedGeneration: 1
        reason: ManifestNotAvailableYet
        status: &#34;False&#34;
        type: Available
      group: apps
      kind: Deployment
      name: my-deployment
      namespace: test-ns
      version: v1
  selectedResources:
  - kind: Namespace
    name: test-ns
    version: v1
  - group: apps
    kind: Deployment
    name: my-deployment
    namespace: test-ns
    version: v1
</code></pre><p>In the ClusterResourcePlacement status, within the <code>failedPlacements</code> section for <code>kind-cluster-1</code>, we get a clear message
as to why the resource is not available on the member cluster. In the preceding <code>conditions</code> section,
the <code>Available</code> condition for <code>kind-cluster-1</code> is flagged as <code>false</code> and shows <code>NotAllWorkAreAvailable</code> reason.
This signifies that the Work object intended for the member cluster <code>kind-cluster-1</code> is not yet available.</p><p>For more information on finding the correct Work resource:</p><ul><li>For ClusterResourcePlacement, see <a href=/docs/troubleshooting/clusterresourceplacement/#how-can-i-find-the-correct-work-resource-thats-associated-with-clusterresourceplacement>this section</a></li><li>For ResourcePlacement, see <a href=/docs/troubleshooting/resourceplacement/#how-can-i-find-the-correct-work-resource-thats-associated-with-resourceplacement>this section</a></li></ul><h3 id=work-status-of-kind-cluster-1>Work status of kind-cluster-1</h3><pre tabindex=0><code>status:
conditions:
- lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
  message: Work is applied successfully
  observedGeneration: 1
  reason: WorkAppliedCompleted
  status: &#34;True&#34;
  type: Applied
- lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
  message: Manifest {Ordinal:1 Group:apps Version:v1 Kind:Deployment Resource:deployments
  Namespace:test-ns Name:my-deployment} is not available yet
  observedGeneration: 1
  reason: WorkNotAvailableYet
  status: &#34;False&#34;
  type: Available
  manifestConditions:
- conditions:
  - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
    message: Manifest is already up to date
    reason: ManifestAlreadyUpToDate
    status: &#34;True&#34;
    type: Applied
  - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
    message: Manifest is trackable and available now
    reason: ManifestAvailable
    status: &#34;True&#34;
    type: Available
    identifier:
    kind: Namespace
    name: test-ns
    ordinal: 0
    resource: namespaces
    version: v1
- conditions:
  - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
    message: Manifest is already up to date
    observedGeneration: 1
    reason: ManifestAlreadyUpToDate
    status: &#34;True&#34;
    type: Applied
  - lastTransitionTime: &#34;2024-05-14T18:52:31Z&#34;
    message: Manifest is trackable but not available yet
    observedGeneration: 1
    reason: ManifestNotAvailableYet
    status: &#34;False&#34;
    type: Available
    identifier:
    group: apps
    kind: Deployment
    name: my-deployment
    namespace: test-ns
    ordinal: 1
    resource: deployments
    version: v1
</code></pre><p>Check the <code>Available</code> status for <code>kind-cluster-1</code>. You can see that the <code>my-deployment</code> deployment isn&rsquo;t yet available on the member cluster.
This suggests that an issue might be affecting the deployment manifest.</p><h3 id=resolution>Resolution</h3><p>In this situation, a potential solution is to check the deployment in the member cluster because the message indicates that the root cause of the issue is a bad image name.
After this image name is identified, you can correct the deployment manifest and update it.
After you fix and update the resource manifest, the placement object (ClusterResourcePlacement or ResourcePlacement) automatically propagates the corrected resource to the member cluster.</p><p>For all other situations, make sure that the propagated resource is configured correctly.
Additionally, verify that the selected cluster has sufficient available capacity to accommodate the new resources.</p><h2 id=general-troubleshooting-notes>General Troubleshooting Notes</h2><p>The troubleshooting process and Work object inspection are identical for both ClusterResourcePlacement and ResourcePlacement:</p><ul><li>Both use the same underlying Work API to apply resources to member clusters</li><li>The Work object status and manifestConditions have the same structure regardless of whether they were created by a ClusterResourcePlacement or ResourcePlacement</li><li>The <code>Available</code> condition in the Work status indicates whether the applied resources have become available on the member cluster</li><li>The main difference is the scope: ClusterResourcePlacement is cluster-scoped and can select both cluster-scoped and namespace-scoped resources, while ResourcePlacement is namespace-scoped and can only select namespace-scoped resources within its own namespace</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-866228f003ec1d19d9d3cd253f5a1bae>5.9 - CRP Drift Detection and Configuration Difference Check Unexpected Result TSG</h1><div class=lead>Troubleshoot situations where CRP drift detection and configuration difference check features are returning unexpected results</div><p>This document helps you troubleshoot unexpected drift and configuration difference
detection results when using the KubeFleet CRP API.</p><blockquote><p>Note</p><p>If you are looking for troubleshooting steps on diff reporting failures, i.e., when
the <code>ClusterResourcePlacementDiffReported</code> condition on your CRP object is set to
<code>False</code>, see the <a href=/docs/troubleshooting/clusterresourceplacementdiffreported/>CRP Diff Reporting Failure TSG</a>
instead.</p></blockquote><blockquote><p>Note</p><p>This document focuses on unexpected drift and configuration difference detection
results. If you have encountered drift and configuration difference detection
failures (e.g., no detection results at all with the <code>ClusterResourcePlacementApplied</code>
condition being set to <code>False</code> with a detection related error), see the
<a href=/docs/troubleshooting/placementapplied/>Work-Application Failure TSG</a> instead.</p></blockquote><h2 id=common-scenarios>Common scenarios</h2><p>A drift occurs when a non-KubeFleet agent modifies a KubeFleet-managed resource (i.e.,
a resource that has been applied by KubeFleet). Drift details are reported in the CRP status
on a per-cluster basis (<code>.status.placementStatuses[*].driftedPlacements</code> field).
Drift detection is always on when your CRP uses a <code>ClientSideApply</code> (default) or
<code>ServerSideApply</code> typed apply strategy, however, note the following limitations:</p><ul><li>When you set the <code>comparisonOption</code> setting (<code>.spec.strategy.applyStrategy.comparisonOption</code> field)
to <code>partialComparison</code>, KubeFleet will only detect drifts in managed fields, i.e., fields
that have been explicitly specified on the hub cluster side. A non-KubeFleet agent can then
add a field (e.g., a label or an annotation) to the resource without KubeFleet complaining about it.
To check for such changes (field additions), use the <code>fullComparison</code> option for the <code>comparisonOption</code> field.</li><li>Depending on your cluster setup, there might exist Kubernetes webhooks/controllers (built-in or from a
third party) that will process KubeFleet-managed resources and add/modify fields as they see fit.
The API server on the member cluster side might also add/modify fields (e.g., enforcing default values)
on resources. If your comparison option allows, KubeFleet will report these as drifts. For
any unexpected drift reportings, verify first if you have installed a source that triggers the changes.</li><li>When you set the <code>whenToApply</code> setting (<code>.spec.strategy.applyStrategy.whenToApply</code> field)
to <code>Always</code> and the <code>comparisonOption</code> setting (<code>.spec.strategy.applyStrategy.comparisonOption</code> field)
to <code>partialComparison</code>, no drifts will ever be found, as apply ops from KubeFleet will
overwrite any drift in managed fields, and drifts in unmanaged fields are always ignored.</li><li>Drift detection does not apply to resources that are not yet managed by KubeFleet. If a resource has
not been created on the hub cluster or has not been selected by the CRP API, there will not be any drift
reportings about it, even if the resource live within a KubeFleet managed namespace. Similarly, if KubeFleet
has been blocked from taking over a pre-existing resource due to your takeover setting
(<code>.spec.strategy.applyStrategy.whenToTakeOver</code> field), no drift detection will run on the resource.</li><li>Resource deletion is not considered as a drift; if a KubeFleet-managed resource has been deleted
by a non-KubeFleet agent, KubeFleet will attempt to re-create it as soon as it finds out about the
deletion.</li><li>Drift detection will not block resource rollouts. If you have just updated the resources on
the hub cluster side and triggered a rollout, drifts on the member cluster side might have been
overwritten.</li><li>When a rollout is in progress, drifts will not be reported on the CRP status for a member cluster if
the cluster has not received the latest round of updates.</li></ul><p>KubeFleet will check for configuration differences under the following two conditions:</p><ul><li>When KubeFleet encounters a pre-existing resource, and the <code>whenToTakeOver</code> setting
(<code>.spec.strategy.applyStrategy.whenToTakeOver</code> field) is set to <code>IfNoDiff</code>.</li><li>When the CRP uses an apply strategy of the <code>ReportDiff</code> type.</li></ul><p>Configuration difference details are reported in the CRP status
on a per-cluster basis (<code>.status.placementStatuses[*].diffedPlacements</code> field). Note that the
following limitations apply:</p><ul><li>When you set the <code>comparisonOption</code> setting (<code>.spec.strategy.applyStrategy.comparisonOption</code> field)
to <code>partialComparison</code>, KubeFleet will only check for configuration differences in managed fields,
i.e., fields that have been explicitly specified on the hub cluster side. Unmanaged fields, such
as additional labels and annotations, will not be considered as configuration differences.
To check for such changes (field additions), use the <code>fullComparison</code> option for the <code>comparisonOption</code> field.</li><li>Depending on your cluster setup, there might exist Kubernetes webhooks/controllers (built-in or from a
third party) that will process resources and add/modify fields as they see fit.
The API server on the member cluster side might also add/modify fields (e.g., enforcing default values)
on resources. If your comparison option allows, KubeFleet will report these as configuration differences.
For any unexpected configuration difference reportings, verify first if you have installed a source that
triggers the changes.</li><li>KubeFleet checks for configuration differences regardless of resource ownerships; resources not
managed by KubeFleet will also be checked.</li><li>The absence of a resource will be considered as a configuration difference.</li><li>Configuration differences will not block resource rollouts. If you have just updated the resources on
the hub cluster side and triggered a rollout, configuration difference check will be re-run based on the
newer versions of resources.</li><li>When a rollout is in progress, configuration differences will not be reported on the CRP status
for a member cluster if the cluster has not received the latest round of updates.</li></ul><p>Note also that drift detection and configuration difference check in KubeFleet run periodically.
The reportings in the CRP status might not be up-to-date.</p><h2 id=investigation-steps>Investigation steps</h2><p>If you find an unexpected drift detection or configuration difference check result on a member cluster,
follow the steps below for investigation:</p><ul><li>Double-check the apply strategy of your CRP; confirm that your settings allows proper drift detection
and/or configuration difference check reportings.</li><li>Verify that rollout has completed on all member clusters; see the <a href=/docs/troubleshooting/clusterresourceplacementrolloutstarted/>CRP Rollout Failure TSG</a>
for more information.</li><li>Log onto your member cluster and retrieve the resources with unexpected reportings.<ul><li>Check if its generation (<code>.metadata.generation</code> field) matches with the <code>observedInMemberClusterGeneration</code> value
in the drift detection and/or configuration difference check reportings. A mismatch might signal that the
reportings are not yet up-to-date; they should get refreshed soon.</li><li>The <code>kubectl.kubernetes.io/last-applied-configuration</code> annotation and/or the <code>.metadata.managedFields</code> field might
have some relevant information on which agents have attempted to update/patch the resource. KubeFleet changes
are executed under the name <code>work-api-agent</code>; if you see other manager names, check if it comes from a known source
(e.g., Kubernetes controller) in your cluster.</li></ul></li></ul><p><a href=https://github.com/kubefleet-dev/kubefleet/issues>File an issue to the KubeFleet team</a> if you believe that
the unexpected reportings come from a bug in KubeFleet.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-5b06c835fb960814634cfe57373e74dd>5.10 - CRP Diff Reporting Failure TSG</h1><div class=lead>Troubleshoot failures in the CRP diff reporting process</div><p>This document helps you troubleshoot diff reporting failures when using the KubeFleet CRP API,
specifically when you find that the <code>ClusterResourcePlacementDiffReported</code> status condition has been
set to <code>False</code> in the CRP status.</p><blockquote><p>Note</p><p>If you are looking for troubleshooting steps on unexpected drift detection and/or configuration
difference detection results, see the <a href=/docs/troubleshooting/driftanddiffdetection/>Drift Detection and Configuration Difference Detection Failure TSG</a>
instead.</p></blockquote><blockquote><p>Note</p><p>The <code>ClusterResourcePlacementDiffReported</code> status condition will only be set if the CRP has
an apply strategy of the <code>ReportDiff</code> type. If your CRP uses <code>ClientSideApply</code> (default) or
<code>ServerSideApply</code> typed apply strategies, it is perfectly normal if the <code>ClusterResourcePlacementDiffReported</code>
status condition is absent in the CRP status.</p></blockquote><h2 id=common-scenarios>Common scenarios</h2><p><code>ClusterResourcePlacementDiffReported</code> status condition will be set to <code>False</code> if KubeFleet cannot complete
the configuration difference checking process for one or more of the selected resources.</p><p>Depending on your CRP configuration, KubeFleet might use one of the three approaches for configuration
difference checking:</p><ul><li>If the resource cannot be found on a member cluster, KubeFleet will simply report a full object
difference.</li><li>If you ask KubeFleet to perform partial comparisons, i.e., the <code>comparisonOption</code> field in the
CRP apply strategy (<code>.spec.strategy.applyStrategy.comparisonOption</code> field) is set to <code>partialComparison</code>,
KubeFleet will perform a dry-run apply op (server-side apply with conflict overriding enabled) and
compare the returned apply result against the current state of the resource on the member cluster
side for configuration differences.</li><li>If you ask KubeFleet to perform full comparisons, i.e., the <code>comparisonOption</code> field in the
CRP apply strategy (<code>.spec.strategy.applyStrategy.comparisonOption</code> field) is set to <code>fullComparison</code>,
KubeFleet will directly compare the given manifest (the resource created on the hub cluster side) against
the current state of the resource on the member cluster side for configuration differences.</li></ul><p>Failures might arise if:</p><ul><li>The dry-run apply op does not complete successfully; or</li><li>An unexpected error occurs during the comparison process, such as a JSON path parsing/evaluation error.<ul><li>In this case, please consider <a href=https://github.com/kubefleet-dev/kubefleet/issues>filing a bug to the KubeFleet team</a>.</li></ul></li></ul><h2 id=investigation-steps>Investigation steps</h2><p>If you encounter such a failure, follow the steps below for investigation:</p><ul><li><p>Identify the specific resources that have failed in the diff reporting process first. In the CRP status,
find out the individual member clusters that have diff reporting failures: inspect the
<code>.status.placementStatuses</code> field of the CRP object; each entry corresponds to a member cluster, and
for each entry, check if it has a status condition, <code>ClusterResourcePlacementDiffReported</code>, in
the <code>.status.placementStatuses[*].conditions</code> field, which has been set to <code>False</code>. Write down the name
of the member cluster.</p></li><li><p>For each cluster name that has been written down, list all the work objects that have been created
for the cluster in correspondence with the CRP object:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Replace [YOUR-CLUSTER-NAME] and [YOUR-CRP-NAME] with values of your own.</span>
</span></span><span style=display:flex><span>kubectl get work -n fleet-member-<span style=color:#ce5c00;font-weight:700>[</span>YOUR-CLUSTER-NAME<span style=color:#ce5c00;font-weight:700>]</span> -l kubernetes-fleet.io/parent-CRP<span style=color:#ce5c00;font-weight:700>=[</span>YOUR-CRP-NAME<span style=color:#ce5c00;font-weight:700>]</span>
</span></span></code></pre></div></li><li><p>For each found work object, inspect its status. The <code>.status.manifestConditions</code> field features an array of which
each item explains about the processing result of a resource on the given member cluster. Find out all items with
a <code>DiffReported</code> condition in the <code>.status.manifestConditions[*].conditions</code> field that has been set to <code>False</code>.
The <code>.status.manifestConditions[*].identifier</code> field tells the GVK, namespace, and name of the failing resource.</p></li><li><p>Read the <code>message</code> field of the <code>DiffReported</code> condition (<code>.status.manifestConditions[*].conditions[*].message</code>);
KubeFleet will include the details about the diff reporting failures in the field.</p></li><li><p>If you are familiar with the cause of the error (for example, dry-run apply ops fails due to API server traffic control
measures), fixing the cause (tweaking traffic control limits) should resolve the failure. KubeFleet will periodically
retry diff reporting in face of failures. Otherwise, <a href=https://github.com/kubefleet-dev/kubefleet/issues>file an issue to the KubeFleet team</a>.</p></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-7fd979ab5fd3ad74cbe20240c7d112a7>5.11 - Staged Update Run TSG</h1><div class=lead>Identify and fix KubeFleet issues associated with both ClusterStagedUpdateRun and StagedUpdateRun APIs</div><p>This guide provides troubleshooting steps for common issues related to both cluster-scoped and namespace-scoped Staged Update Runs.</p><blockquote><p>Note: To get more information about failures, you can check the <a href=https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/controllers/updaterun/controller.go>updateRun controller</a> logs.</p></blockquote><h2 id=cluster-scoped-troubleshooting>Cluster-Scoped Troubleshooting</h2><h3 id=crp-status-without-staged-update-run>CRP status without Staged Update Run</h3><p>When a <code>ClusterResourcePlacement</code> is created with <code>spec.strategy.type</code> set to <code>External</code>, the rollout does not start immediately.</p><p>A sample status of such <code>ClusterResourcePlacement</code> is as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl describe crp example-placement
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Status:
</span></span><span style=display:flex><span>  Conditions:
</span></span><span style=display:flex><span>    Last Transition Time:   2025-03-12T23:01:32Z
</span></span><span style=display:flex><span>    Message:                found all cluster needed as specified by the scheduling policy, found <span style=color:#0000cf;font-weight:700>2</span> cluster<span style=color:#ce5c00;font-weight:700>(</span>s<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    Observed Generation:    <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    Reason:                 SchedulingPolicyFulfilled
</span></span><span style=display:flex><span>    Status:                 True
</span></span><span style=display:flex><span>    Type:                   ClusterResourcePlacementScheduled
</span></span><span style=display:flex><span>    Last Transition Time:   2025-03-12T23:01:32Z
</span></span><span style=display:flex><span>    Message:                There are still <span style=color:#0000cf;font-weight:700>2</span> cluster<span style=color:#ce5c00;font-weight:700>(</span>s<span style=color:#ce5c00;font-weight:700>)</span> in the process of deciding whether to roll out the latest resources or not
</span></span><span style=display:flex><span>    Observed Generation:    <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    Reason:                 RolloutStartedUnknown
</span></span><span style=display:flex><span>    Status:                 Unknown
</span></span><span style=display:flex><span>    Type:                   ClusterResourcePlacementRolloutStarted
</span></span><span style=display:flex><span>  Observed Resource Index:  <span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>  Placement Statuses:
</span></span><span style=display:flex><span>    Cluster Name:  member1
</span></span><span style=display:flex><span>    Conditions:
</span></span><span style=display:flex><span>      Last Transition Time:  2025-03-12T23:01:32Z
</span></span><span style=display:flex><span>      Message:               Successfully scheduled resources <span style=color:#204a87;font-weight:700>for</span> placement in <span style=color:#4e9a06>&#34;member1&#34;</span> <span style=color:#ce5c00;font-weight:700>(</span>affinity score: 0, topology spread score: 0<span style=color:#ce5c00;font-weight:700>)</span>: picked by scheduling policy
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                Scheduled
</span></span><span style=display:flex><span>      Status:                True
</span></span><span style=display:flex><span>      Type:                  Scheduled
</span></span><span style=display:flex><span>      Last Transition Time:  2025-03-12T23:01:32Z
</span></span><span style=display:flex><span>      Message:               In the process of deciding whether to roll out the latest resources or not
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                RolloutStartedUnknown
</span></span><span style=display:flex><span>      Status:                Unknown
</span></span><span style=display:flex><span>      Type:                  RolloutStarted
</span></span><span style=display:flex><span>    Cluster Name:            member2
</span></span><span style=display:flex><span>    Conditions:
</span></span><span style=display:flex><span>      Last Transition Time:  2025-03-12T23:01:32Z
</span></span><span style=display:flex><span>      Message:               Successfully scheduled resources <span style=color:#204a87;font-weight:700>for</span> placement in <span style=color:#4e9a06>&#34;member2&#34;</span> <span style=color:#ce5c00;font-weight:700>(</span>affinity score: 0, topology spread score: 0<span style=color:#ce5c00;font-weight:700>)</span>: picked by scheduling policy
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                Scheduled
</span></span><span style=display:flex><span>      Status:                True
</span></span><span style=display:flex><span>      Type:                  Scheduled
</span></span><span style=display:flex><span>      Last Transition Time:  2025-03-12T23:01:32Z
</span></span><span style=display:flex><span>      Message:               In the process of deciding whether to roll out the latest resources or not
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                RolloutStartedUnknown
</span></span><span style=display:flex><span>      Status:                Unknown
</span></span><span style=display:flex><span>      Type:                  RolloutStarted
</span></span><span style=display:flex><span>  Selected Resources:
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>Events:         &lt;none&gt;
</span></span></code></pre></div><p><code>SchedulingPolicyFulfilled</code> condition indicates the CRP has been fully scheduled, while <code>RolloutStartedUnknown</code> condition shows that the rollout has not started.</p><p>In the <code>Placement Statuses</code> section, it displays the detailed status of each cluster. Both selected clusters are in the <code>Scheduled</code> state, but the <code>RolloutStarted</code> condition is still <code>Unknown</code> because the rollout has not kicked off yet.</p><h3 id=investigate-clusterstagedupdaterun-initialization-failure>Investigate ClusterStagedUpdateRun initialization failure</h3><p>An updateRun initialization failure can be easily detected by getting the resource:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get csur example-run 
</span></span><span style=display:flex><span>NAME          PLACEMENT           RESOURCE-SNAPSHOT-INDEX   POLICY-SNAPSHOT-INDEX   INITIALIZED   SUCCEEDED   AGE
</span></span><span style=display:flex><span>example-run   example-placement   <span style=color:#0000cf;font-weight:700>1</span>                         <span style=color:#0000cf;font-weight:700>0</span>                       False                     2s
</span></span></code></pre></div><p>The <code>INITIALIZED</code> field is <code>False</code>, indicating the initialization failed.</p><p>Describe the updateRun to get more details:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl describe csur example-run
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Status:
</span></span><span style=display:flex><span>  Conditions:
</span></span><span style=display:flex><span>    Last Transition Time:  2025-03-13T07:28:29Z
</span></span><span style=display:flex><span>    Message:               cannot <span style=color:#204a87;font-weight:700>continue</span> the ClusterStagedUpdateRun: failed to initialize the clusterStagedUpdateRun: failed to process the request due to a client error: no clusterResourceSnapshots with index <span style=color:#4e9a06>`</span>1<span style=color:#4e9a06>`</span> found <span style=color:#204a87;font-weight:700>for</span> clusterResourcePlacement <span style=color:#4e9a06>`</span>example-placement<span style=color:#4e9a06>`</span>
</span></span><span style=display:flex><span>    Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    Reason:                UpdateRunInitializedFailed
</span></span><span style=display:flex><span>    Status:                False
</span></span><span style=display:flex><span>    Type:                  Initialized
</span></span><span style=display:flex><span>  Deletion Stage Status:
</span></span><span style=display:flex><span>    Clusters:
</span></span><span style=display:flex><span>    Stage Name:                   kubernetes-fleet.io/deleteStage
</span></span><span style=display:flex><span>  Policy Observed Cluster Count:  <span style=color:#0000cf;font-weight:700>2</span>
</span></span><span style=display:flex><span>  Policy Snapshot Index Used:     <span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>The condition clearly indicates the initialization failed. The condition message gives more details about the failure.
In this case, a non-existing resource snapshot index <code>1</code> was used for the updateRun.</p><h3 id=investigate-clusterstagedupdaterun-execution-failure>Investigate ClusterStagedUpdateRun execution failure</h3><p>An updateRun execution failure can be easily detected by getting the resource:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get csur example-run
</span></span><span style=display:flex><span>NAME          PLACEMENT           RESOURCE-SNAPSHOT-INDEX   POLICY-SNAPSHOT-INDEX   INITIALIZED   SUCCEEDED   AGE
</span></span><span style=display:flex><span>example-run   example-placement   <span style=color:#0000cf;font-weight:700>0</span>                         <span style=color:#0000cf;font-weight:700>0</span>                       True          False       24m
</span></span></code></pre></div><p>The <code>SUCCEEDED</code> field is <code>False</code>, indicating the execution failure.</p><p>An updateRun execution failure can be caused by mainly 2 scenarios:</p><ol><li>When the updateRun controller is triggered to reconcile an in-progress updateRun, it starts by doing a bunch of validations
including retrieving the CRP and checking its rollout strategy, gathering all the bindings and regenerating the execution plan.
If any failure happens during validation, the updateRun execution fails with the corresponding validation error.<pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2025-05-13T21:11:06Z&#34;
    message: ClusterStagedUpdateRun initialized successfully
    observedGeneration: 1
    reason: UpdateRunInitializedSuccessfully
    status: &#34;True&#34;
    type: Initialized
  - lastTransitionTime: &#34;2025-05-13T21:11:21Z&#34;
    message: The stages are aborted due to a non-recoverable error
    observedGeneration: 1
    reason: UpdateRunFailed
    status: &#34;False&#34;
    type: Progressing
  - lastTransitionTime: &#34;2025-05-13T22:15:23Z&#34;
    message: &#39;cannot continue the ClusterStagedUpdateRun: failed to execute the
      clusterStagedUpdateRun: failed to process the request due to a client error:
      parent clusterResourcePlacement not found&#39;
    observedGeneration: 1
    reason: UpdateRunFailed
    status: &#34;False&#34;
    type: Succeeded
</code></pre>In above case, the CRP referenced by the updateRun is deleted during the execution. The updateRun controller detects and aborts the release.</li><li>The updateRun controller triggers update to a member cluster by updating the corresponding binding spec and setting its
status to <code>RolloutStarted</code>. It then waits for default 15 seconds and check whether the resources have been successfully applied
by checking the binding again. In case that there are multiple concurrent updateRuns, and during the 15-second wait, some other
updateRun preempts and updates the binding with new configuration, current updateRun detects and fails with clear error message.<pre tabindex=0><code>status:
 conditions:
 - lastTransitionTime: &#34;2025-05-13T21:10:58Z&#34;
   message: ClusterStagedUpdateRun initialized successfully
   observedGeneration: 1
   reason: UpdateRunInitializedSuccessfully
   status: &#34;True&#34;
   type: Initialized
 - lastTransitionTime: &#34;2025-05-13T21:11:13Z&#34;
   message: The stages are aborted due to a non-recoverable error
   observedGeneration: 1
   reason: UpdateRunFailed
   status: &#34;False&#34;
   type: Progressing
 - lastTransitionTime: &#34;2025-05-13T21:11:13Z&#34;
   message: &#39;cannot continue the ClusterStagedUpdateRun: unexpected behavior which
     cannot be handled by the controller: the clusterResourceBinding of the updating
     cluster `member1` in the stage `staging` does not have expected status: binding
     spec diff: binding has different resourceSnapshotName, want: example-placement-0-snapshot,
     got: example-placement-1-snapshot; binding state (want Bound): Bound; binding
     RolloutStarted (want true): true, please check if there is concurrent clusterStagedUpdateRun&#39;
   observedGeneration: 1
   reason: UpdateRunFailed
   status: &#34;False&#34;
   type: Succeeded
</code></pre>The <code>Succeeded</code> condition is set to <code>False</code> with reason <code>UpdateRunFailed</code>. In the <code>message</code>, we show <code>member1</code> cluster in <code>staging</code> stage gets preempted, and the <code>resourceSnapshotName</code> field is changed from <code>example-placement-0-snapshot</code> to <code>example-placement-1-snapshot</code> which means probably some other updateRun is rolling out a newer resource version. The message also prints current binding state and if <code>RolloutStarted</code> condition is set to true. The message gives a hint about whether these is a concurrent clusterStagedUpdateRun running. Upon such failure, the user can list updateRuns or check the binding state:<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get clusterresourcebindings
</span></span><span style=display:flex><span>NAME                                 WORKSYNCHRONIZED   RESOURCESAPPLIED   AGE
</span></span><span style=display:flex><span>example-placement-member1-2afc7d7f   True               True               51m
</span></span><span style=display:flex><span>example-placement-member2-fc081413                                         51m
</span></span></code></pre></div>The binding is named as <code>&lt;crp-name>-&lt;cluster-name>-&lt;suffix></code>. Since the error message says <code>member1</code> cluster fails the updateRun, we can check its binding:<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get clusterresourcebindings example-placement-member1-2afc7d7f -o yaml
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>spec:
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  resourceSnapshotName: example-placement-1-snapshot
</span></span><span style=display:flex><span>  schedulingPolicySnapshotName: example-placement-0
</span></span><span style=display:flex><span>  state: Bound
</span></span><span style=display:flex><span>  targetCluster: member1
</span></span><span style=display:flex><span>status:
</span></span><span style=display:flex><span>  conditions:
</span></span><span style=display:flex><span>  - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-05-13T21:11:06Z&#34;</span>
</span></span><span style=display:flex><span>    message: <span style=color:#4e9a06>&#39;Detected the new changes on the resources and started the rollout process,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>      resourceSnapshotIndex: 1, clusterStagedUpdateRun: example-run-1&#39;</span>
</span></span><span style=display:flex><span>    observedGeneration: <span style=color:#0000cf;font-weight:700>3</span>
</span></span><span style=display:flex><span>    reason: RolloutStarted
</span></span><span style=display:flex><span>    status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>    type: RolloutStarted
</span></span><span style=display:flex><span>  ...
</span></span></code></pre></div>As the binding <code>RolloutStarted</code> condition shows, it&rsquo;s updated by another updateRun <code>example-run-1</code>.</li></ol><p>The updateRun abortion due to execution failures is not recoverable at the moment. If failure happens due to validation error,
one can fix the issue and create a new updateRun. If preemption happens, in most cases the user is releasing a new resource
version, and they can just let the new updateRun run to complete.</p><h3 id=investigate-clusterstagedupdaterun-rollout-stuck>Investigate ClusterStagedUpdateRun rollout stuck</h3><p>A <code>ClusterStagedUpdateRun</code> can get stuck when resource placement fails on some clusters. Getting the updateRun will show the cluster name and stage that is in stuck state:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get csur example-run -o yaml
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>status:
</span></span><span style=display:flex><span>  conditions:
</span></span><span style=display:flex><span>  - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-05-13T23:15:35Z&#34;</span>
</span></span><span style=display:flex><span>    message: ClusterStagedUpdateRun initialized successfully
</span></span><span style=display:flex><span>    observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    reason: UpdateRunInitializedSuccessfully
</span></span><span style=display:flex><span>    status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>    type: Initialized
</span></span><span style=display:flex><span>  - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-05-13T23:21:18Z&#34;</span>
</span></span><span style=display:flex><span>    message: The updateRun is stuck waiting <span style=color:#204a87;font-weight:700>for</span> cluster member1 in stage staging to
</span></span><span style=display:flex><span>      finish updating, please check crp status <span style=color:#204a87;font-weight:700>for</span> potential errors
</span></span><span style=display:flex><span>    observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    reason: UpdateRunStuck
</span></span><span style=display:flex><span>    status: <span style=color:#4e9a06>&#34;False&#34;</span>
</span></span><span style=display:flex><span>    type: Progressing
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>The message shows that the updateRun is stuck waiting for the cluster <code>member1</code> in stage <code>staging</code> to finish releasing.
The updateRun controller rolls resources to a member cluster by updating its corresponding binding. It then checks periodically
whether the update has completed or not. If the binding is still not available after current default 5 minutes, updateRun
controller decides the rollout has stuck and reports the condition.</p><p>This usually indicates something wrong happened on the cluster or the resources have some issue. To further investigate, you can check the <code>ClusterResourcePlacement</code> status:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl describe crp example-placement
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span> Placement Statuses:
</span></span><span style=display:flex><span>    Cluster Name:  member1
</span></span><span style=display:flex><span>    Conditions:
</span></span><span style=display:flex><span>      Last Transition Time:  2025-05-13T23:11:14Z
</span></span><span style=display:flex><span>      Message:               Successfully scheduled resources <span style=color:#204a87;font-weight:700>for</span> placement in <span style=color:#4e9a06>&#34;member1&#34;</span> <span style=color:#ce5c00;font-weight:700>(</span>affinity score: 0, topology spread score: 0<span style=color:#ce5c00;font-weight:700>)</span>: picked by scheduling policy
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                Scheduled
</span></span><span style=display:flex><span>      Status:                True
</span></span><span style=display:flex><span>      Type:                  Scheduled
</span></span><span style=display:flex><span>      Last Transition Time:  2025-05-13T23:15:35Z
</span></span><span style=display:flex><span>      Message:               Detected the new changes on the resources and started the rollout process, resourceSnapshotIndex: 0, clusterStagedUpdateRun: example-run
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                RolloutStarted
</span></span><span style=display:flex><span>      Status:                True
</span></span><span style=display:flex><span>      Type:                  RolloutStarted
</span></span><span style=display:flex><span>      Last Transition Time:  2025-05-13T23:15:35Z
</span></span><span style=display:flex><span>      Message:               No override rules are configured <span style=color:#204a87;font-weight:700>for</span> the selected resources
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                NoOverrideSpecified
</span></span><span style=display:flex><span>      Status:                True
</span></span><span style=display:flex><span>      Type:                  Overridden
</span></span><span style=display:flex><span>      Last Transition Time:  2025-05-13T23:15:35Z
</span></span><span style=display:flex><span>      Message:               All of the works are synchronized to the latest
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                AllWorkSynced
</span></span><span style=display:flex><span>      Status:                True
</span></span><span style=display:flex><span>      Type:                  WorkSynchronized
</span></span><span style=display:flex><span>      Last Transition Time:  2025-05-13T23:15:35Z
</span></span><span style=display:flex><span>      Message:               All corresponding work objects are applied
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                AllWorkHaveBeenApplied
</span></span><span style=display:flex><span>      Status:                True
</span></span><span style=display:flex><span>      Type:                  Applied
</span></span><span style=display:flex><span>      Last Transition Time:  2025-05-13T23:15:35Z
</span></span><span style=display:flex><span>      Message:               Work object example-placement-work-configmap-c5971133-2779-4f6f-8681-3e05c4458c82 is not yet available
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                NotAllWorkAreAvailable
</span></span><span style=display:flex><span>      Status:                False
</span></span><span style=display:flex><span>      Type:                  Available
</span></span><span style=display:flex><span>    Failed Placements:
</span></span><span style=display:flex><span>      Condition:
</span></span><span style=display:flex><span>        Last Transition Time:  2025-05-13T23:15:35Z
</span></span><span style=display:flex><span>        Message:               Manifest is trackable but not available yet
</span></span><span style=display:flex><span>        Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>        Reason:                ManifestNotAvailableYet
</span></span><span style=display:flex><span>        Status:                False
</span></span><span style=display:flex><span>        Type:                  Available
</span></span><span style=display:flex><span>      Envelope:
</span></span><span style=display:flex><span>        Name:       envelope-nginx-deploy
</span></span><span style=display:flex><span>        Namespace:  test-namespace
</span></span><span style=display:flex><span>        Type:       ConfigMap
</span></span><span style=display:flex><span>      Group:        apps
</span></span><span style=display:flex><span>      Kind:         Deployment
</span></span><span style=display:flex><span>      Name:         nginx
</span></span><span style=display:flex><span>      Namespace:    test-namespace
</span></span><span style=display:flex><span>      Version:      v1
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>The <code>Applied</code> condition is <code>False</code> and says not all work have been applied. And in the &ldquo;failed placements&rdquo; section, it shows
the <code>nginx</code> deployment wrapped by <code>envelope-nginx-deploy</code> configMap is not ready. Check from <code>member1</code> cluster and we can see
there&rsquo;s image pull failure:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context member1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl get deploy -n test-namespace
</span></span><span style=display:flex><span>NAME    READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style=display:flex><span>nginx   0/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>0</span>           16m
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl get pods -n test-namespace
</span></span><span style=display:flex><span>NAME                     READY   STATUS         RESTARTS   AGE
</span></span><span style=display:flex><span>nginx-69b9cb5485-sw24b   0/1     ErrImagePull   <span style=color:#0000cf;font-weight:700>0</span>          16m
</span></span></code></pre></div><p>For more debugging instructions, you can refer to <a href=/docs/troubleshooting/clusterresourceplacement/>ClusterResourcePlacement TSG</a>.</p><p>After resolving the issue, you can create always create a new updateRun to restart the rollout. Stuck updateRuns can be deleted.</p><h2 id=namespace-scoped-troubleshooting>Namespace-Scoped Troubleshooting</h2><p>Namespace-scoped <code>StagedUpdateRun</code> troubleshooting is a mirror image of cluster-scoped <code>ClusterStagedUpdateRun</code> troubleshooting. The concepts, failure patterns, and diagnostic approaches are exactly the same - only the resource names, scopes, and kubectl commands differ.</p><p>Both follow identical troubleshooting patterns:</p><ul><li><strong>Initialization failures</strong>: Missing resource snapshots, invalid configurations</li><li><strong>Execution failures</strong>: Validation errors, concurrent updateRun conflicts</li><li><strong>Rollout stuck scenarios</strong>: Resource placement failures, cluster connectivity issues</li><li><strong>Status investigation</strong>: Using <code>kubectl get</code>, <code>kubectl describe</code>, and checking placement status</li><li><strong>Recovery approaches</strong>: Creating new updateRuns, cleaning up stuck resources</li></ul><p>The key differences are:</p><ul><li><strong>Resource scope</strong>: Namespace-scoped vs cluster-scoped resources</li><li><strong>Commands</strong>: Use <code>sur</code> (StagedUpdateRun) instead of <code>csur</code> (ClusterStagedUpdateRun)</li><li><strong>Target resources</strong>: <code>ResourcePlacement</code> instead of <code>ClusterResourcePlacement</code></li><li><strong>Bindings</strong>: <code>resourcebindings</code> instead of <code>clusterresourcebindings</code></li><li><strong>Approvals</strong>: <code>approvalrequests</code> instead of <code>clusterapprovalrequests</code></li></ul><h3 id=resourceplacement-status-without-staged-update-run>ResourcePlacement status without Staged Update Run</h3><p>When a namespace-scoped <code>ResourcePlacement</code> is created with <code>spec.strategy.type</code> set to <code>External</code>, the rollout does not start immediately.</p><p>A sample status of such <code>ResourcePlacement</code> is as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl describe rp web-app-placement -n my-app-namespace
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Status:
</span></span><span style=display:flex><span>  Conditions:
</span></span><span style=display:flex><span>    Last Transition Time:   2025-03-12T23:01:32Z
</span></span><span style=display:flex><span>    Message:                found all cluster needed as specified by the scheduling policy, found <span style=color:#0000cf;font-weight:700>2</span> cluster<span style=color:#ce5c00;font-weight:700>(</span>s<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    Observed Generation:    <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    Reason:                 SchedulingPolicyFulfilled
</span></span><span style=display:flex><span>    Status:                 True
</span></span><span style=display:flex><span>    Type:                   ResourcePlacementScheduled
</span></span><span style=display:flex><span>    Last Transition Time:   2025-03-12T23:01:32Z
</span></span><span style=display:flex><span>    Message:                There are still <span style=color:#0000cf;font-weight:700>2</span> cluster<span style=color:#ce5c00;font-weight:700>(</span>s<span style=color:#ce5c00;font-weight:700>)</span> in the process of deciding whether to roll out the latest resources or not
</span></span><span style=display:flex><span>    Observed Generation:    <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    Reason:                 RolloutStartedUnknown
</span></span><span style=display:flex><span>    Status:                 Unknown
</span></span><span style=display:flex><span>    Type:                   ResourcePlacementRolloutStarted
</span></span><span style=display:flex><span>  Observed Resource Index:  <span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>  Placement Statuses:
</span></span><span style=display:flex><span>    Cluster Name:  member1
</span></span><span style=display:flex><span>    Conditions:
</span></span><span style=display:flex><span>      Last Transition Time:  2025-03-12T23:01:32Z
</span></span><span style=display:flex><span>      Message:               Successfully scheduled resources <span style=color:#204a87;font-weight:700>for</span> placement in <span style=color:#4e9a06>&#34;member1&#34;</span> <span style=color:#ce5c00;font-weight:700>(</span>affinity score: 0, topology spread score: 0<span style=color:#ce5c00;font-weight:700>)</span>: picked by scheduling policy
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                Scheduled
</span></span><span style=display:flex><span>      Status:                True
</span></span><span style=display:flex><span>      Type:                  Scheduled
</span></span><span style=display:flex><span>      Last Transition Time:  2025-03-12T23:01:32Z
</span></span><span style=display:flex><span>      Message:               In the process of deciding whether to roll out the latest resources or not
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                RolloutStartedUnknown
</span></span><span style=display:flex><span>      Status:                Unknown
</span></span><span style=display:flex><span>      Type:                  RolloutStarted
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Events:         &lt;none&gt;
</span></span></code></pre></div><p><code>SchedulingPolicyFulfilled</code> condition indicates the ResourcePlacement has been fully scheduled, while <code>RolloutStartedUnknown</code> condition shows that the rollout has not started.</p><h3 id=investigate-stagedupdaterun-initialization-failure>Investigate StagedUpdateRun initialization failure</h3><p>A namespace-scoped updateRun initialization failure can be easily detected by getting the resource:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get sur web-app-rollout -n my-app-namespace
</span></span><span style=display:flex><span>NAME              PLACEMENT           RESOURCE-SNAPSHOT-INDEX   POLICY-SNAPSHOT-INDEX   INITIALIZED   SUCCEEDED   AGE
</span></span><span style=display:flex><span>web-app-rollout   web-app-placement   <span style=color:#0000cf;font-weight:700>1</span>                         <span style=color:#0000cf;font-weight:700>0</span>                       False                     2s
</span></span></code></pre></div><p>The <code>INITIALIZED</code> field is <code>False</code>, indicating the initialization failed.</p><p>Describe the updateRun to get more details:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl describe sur web-app-rollout -n my-app-namespace
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Status:
</span></span><span style=display:flex><span>  Conditions:
</span></span><span style=display:flex><span>    Last Transition Time:  2025-03-13T07:28:29Z
</span></span><span style=display:flex><span>    Message:               cannot <span style=color:#204a87;font-weight:700>continue</span> the StagedUpdateRun: failed to initialize the stagedUpdateRun: failed to process the request due to a client error: no resourceSnapshots with index <span style=color:#4e9a06>`</span>1<span style=color:#4e9a06>`</span> found <span style=color:#204a87;font-weight:700>for</span> resourcePlacement <span style=color:#4e9a06>`</span>web-app-placement<span style=color:#4e9a06>`</span> in namespace <span style=color:#4e9a06>`</span>my-app-namespace<span style=color:#4e9a06>`</span>
</span></span><span style=display:flex><span>    Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    Reason:                UpdateRunInitializedFailed
</span></span><span style=display:flex><span>    Status:                False
</span></span><span style=display:flex><span>    Type:                  Initialized
</span></span><span style=display:flex><span>  Deletion Stage Status:
</span></span><span style=display:flex><span>    Clusters:
</span></span><span style=display:flex><span>    Stage Name:                   kubernetes-fleet.io/deleteStage
</span></span><span style=display:flex><span>  Policy Observed Cluster Count:  <span style=color:#0000cf;font-weight:700>2</span>
</span></span><span style=display:flex><span>  Policy Snapshot Index Used:     <span style=color:#0000cf;font-weight:700>0</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>The condition clearly indicates the initialization failed. The condition message gives more details about the failure.
In this case, a non-existing resource snapshot index <code>1</code> was used for the updateRun.</p><h3 id=investigate-stagedupdaterun-execution-failure>Investigate StagedUpdateRun execution failure</h3><p>A namespace-scoped updateRun execution failure can be easily detected by getting the resource:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get sur web-app-rollout -n my-app-namespace
</span></span><span style=display:flex><span>NAME              PLACEMENT           RESOURCE-SNAPSHOT-INDEX   POLICY-SNAPSHOT-INDEX   INITIALIZED   SUCCEEDED   AGE
</span></span><span style=display:flex><span>web-app-rollout   web-app-placement   <span style=color:#0000cf;font-weight:700>0</span>                         <span style=color:#0000cf;font-weight:700>0</span>                       True          False       24m
</span></span></code></pre></div><p>The <code>SUCCEEDED</code> field is <code>False</code>, indicating the execution failure.</p><p>The execution failure scenarios are similar to cluster-scoped updateRuns:</p><ol><li><p><strong>Validation errors during reconciliation</strong>: The updateRun controller validates the ResourcePlacement, gathers bindings, and regenerates the execution plan. If any failure occurs, the updateRun execution fails:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2025-05-13T21:11:06Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>StagedUpdateRun initialized successfully</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>UpdateRunInitializedSuccessfully</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Initialized</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2025-05-13T21:11:21Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The stages are aborted due to a non-recoverable error</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>UpdateRunFailed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Progressing</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2025-05-13T22:15:23Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message: &#39;cannot continue the StagedUpdateRun</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>failed to initialize the</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>stagedUpdateRun</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>failed to process the request due to a client error</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#000>parent resourcePlacement not found&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>UpdateRunFailed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Succeeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div></li><li><p><strong>Concurrent updateRun preemption</strong>: When multiple updateRuns target the same ResourcePlacement, they may conflict:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2025-05-13T21:11:13Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#204a87;font-weight:700>message: &#39;cannot continue the StagedUpdateRun</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>unexpected behavior which</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>     </span><span style=color:#204a87;font-weight:700>cannot be handled by the controller</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>the resourceBinding of the updating</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>     </span><span style=color:#204a87;font-weight:700>cluster `member1` in the stage `staging` does not have expected status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>binding</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>     </span><span style=color:#204a87;font-weight:700>spec diff: binding has different resourceSnapshotName, want</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>web-app-placement-0-snapshot,</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>     </span><span style=color:#204a87;font-weight:700>got</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>web-app-placement-1-snapshot; please check if there is concurrent stagedUpdateRun&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>UpdateRunFailed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;False&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>   </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Succeeded</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>To investigate concurrent updateRuns, check the namespace-scoped resource bindings:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get resourcebindings -n my-app-namespace
</span></span><span style=display:flex><span>NAME                                 WORKSYNCHRONIZED   RESOURCESAPPLIED   AGE
</span></span><span style=display:flex><span>web-app-placement-member1-2afc7d7f   True               True               51m
</span></span><span style=display:flex><span>web-app-placement-member2-fc081413                                         51m
</span></span></code></pre></div></li></ol><h3 id=investigate-stagedupdaterun-rollout-stuck>Investigate StagedUpdateRun rollout stuck</h3><p>A <code>StagedUpdateRun</code> can get stuck when resource placement fails on some clusters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl get sur web-app-rollout -n my-app-namespace -o yaml
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>status:
</span></span><span style=display:flex><span>  conditions:
</span></span><span style=display:flex><span>  - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-05-13T23:15:35Z&#34;</span>
</span></span><span style=display:flex><span>    message: StagedUpdateRun initialized successfully
</span></span><span style=display:flex><span>    observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    reason: UpdateRunInitializedSuccessfully
</span></span><span style=display:flex><span>    status: <span style=color:#4e9a06>&#34;True&#34;</span>
</span></span><span style=display:flex><span>    type: Initialized
</span></span><span style=display:flex><span>  - lastTransitionTime: <span style=color:#4e9a06>&#34;2025-05-13T23:21:18Z&#34;</span>
</span></span><span style=display:flex><span>    message: The updateRun is stuck waiting <span style=color:#204a87;font-weight:700>for</span> cluster member1 in stage staging to
</span></span><span style=display:flex><span>      finish updating, please check resourceplacement status <span style=color:#204a87;font-weight:700>for</span> potential errors
</span></span><span style=display:flex><span>    observedGeneration: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    reason: UpdateRunStuck
</span></span><span style=display:flex><span>    status: <span style=color:#4e9a06>&#34;False&#34;</span>
</span></span><span style=display:flex><span>    type: Progressing
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>To investigate further, check the <code>ResourcePlacement</code> status:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ kubectl describe rp web-app-placement -n my-app-namespace
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span> Placement Statuses:
</span></span><span style=display:flex><span>    Cluster Name:  member1
</span></span><span style=display:flex><span>    Conditions:
</span></span><span style=display:flex><span>      Last Transition Time:  2025-05-13T23:11:14Z
</span></span><span style=display:flex><span>      Message:               Successfully scheduled resources <span style=color:#204a87;font-weight:700>for</span> placement in <span style=color:#4e9a06>&#34;member1&#34;</span> <span style=color:#ce5c00;font-weight:700>(</span>affinity score: 0, topology spread score: 0<span style=color:#ce5c00;font-weight:700>)</span>: picked by scheduling policy
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                Scheduled
</span></span><span style=display:flex><span>      Status:                True
</span></span><span style=display:flex><span>      Type:                  Scheduled
</span></span><span style=display:flex><span>      Last Transition Time:  2025-05-13T23:15:35Z
</span></span><span style=display:flex><span>      Message:               Detected the new changes on the resources and started the rollout process, resourceSnapshotIndex: 0, stagedUpdateRun: web-app-rollout
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                RolloutStarted
</span></span><span style=display:flex><span>      Status:                True
</span></span><span style=display:flex><span>      Type:                  RolloutStarted
</span></span><span style=display:flex><span>      Last Transition Time:  2025-05-13T23:15:35Z
</span></span><span style=display:flex><span>      Message:               Work object web-app-placement-work-deployment-1234 is not yet available
</span></span><span style=display:flex><span>      Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>      Reason:                NotAllWorkAreAvailable
</span></span><span style=display:flex><span>      Status:                False
</span></span><span style=display:flex><span>      Type:                  Available
</span></span><span style=display:flex><span>    Failed Placements:
</span></span><span style=display:flex><span>      Condition:
</span></span><span style=display:flex><span>        Last Transition Time:  2025-05-13T23:15:35Z
</span></span><span style=display:flex><span>        Message:               Manifest is trackable but not available yet
</span></span><span style=display:flex><span>        Observed Generation:   <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>        Reason:                ManifestNotAvailableYet
</span></span><span style=display:flex><span>        Status:                False
</span></span><span style=display:flex><span>        Type:                  Available
</span></span><span style=display:flex><span>      Envelope:
</span></span><span style=display:flex><span>        Name:       envelope-web-app-deploy
</span></span><span style=display:flex><span>        Namespace:  my-app-namespace
</span></span><span style=display:flex><span>        Type:       ConfigMap
</span></span><span style=display:flex><span>      Group:        apps
</span></span><span style=display:flex><span>      Kind:         Deployment
</span></span><span style=display:flex><span>      Name:         web-app
</span></span><span style=display:flex><span>      Namespace:    my-app-namespace
</span></span><span style=display:flex><span>      Version:      v1
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>Check the target cluster to diagnose the specific issue:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config use-context member1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl get deploy web-app -n my-app-namespace
</span></span><span style=display:flex><span>NAME      READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style=display:flex><span>web-app   0/1     <span style=color:#0000cf;font-weight:700>1</span>            <span style=color:#0000cf;font-weight:700>0</span>           16m
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl get pods -n my-app-namespace
</span></span><span style=display:flex><span>NAME                       READY   STATUS         RESTARTS   AGE
</span></span><span style=display:flex><span>web-app-69b9cb5485-sw24b   0/1     ErrImagePull   <span style=color:#0000cf;font-weight:700>0</span>          16m
</span></span></code></pre></div><h3 id=namespace-scoped-approval-troubleshooting>Namespace-Scoped Approval Troubleshooting</h3><p>For namespace-scoped staged updates with approval gates, check for <code>ApprovalRequest</code> objects:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># List approval requests in the namespace</span>
</span></span><span style=display:flex><span>$ kubectl get approvalrequests -n my-app-namespace
</span></span><span style=display:flex><span>NAME                           UPDATE-RUN        STAGE      APPROVED   APPROVALACCEPTED   AGE
</span></span><span style=display:flex><span>web-app-rollout-prod-clusters  web-app-rollout   prod       False                         2m
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Approve the request</span>
</span></span><span style=display:flex><span>$ kubectl patch approvalrequests web-app-rollout-prod-clusters -n my-app-namespace --type<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;merge&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  -p <span style=color:#4e9a06>&#39;{&#34;status&#34;:{&#34;conditions&#34;:[{&#34;type&#34;:&#34;Approved&#34;,&#34;status&#34;:&#34;True&#34;,&#34;reason&#34;:&#34;approved&#34;,&#34;message&#34;:&#34;approved&#34;}]}}&#39;</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  --subresource<span style=color:#ce5c00;font-weight:700>=</span>status
</span></span></code></pre></div><p>After resolving issues, create a new updateRun to restart the rollout. Stuck updateRuns can be deleted safely.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d9ce62896f60f2efcc2db9da011ba5cf>5.12 - ClusterResourcePlacementEviction TSG</h1><div class=lead>Identify and fix KubeFleet issues associated with the ClusterResourcePlacementEviction API</div><p>This guide provides troubleshooting steps for issues related to placement eviction.</p><p>An eviction object when created is ideally only reconciled once and reaches a terminal state. List of terminal states
for eviction are:</p><ul><li>Eviction is Invalid</li><li>Eviction is Valid, Eviction failed to Execute</li><li>Eviction is Valid, Eviction executed successfully</li></ul><blockquote><p><strong>Note:</strong> If an eviction object doesn&rsquo;t reach a terminal state i.e. neither valid condition nor executed condition is
set it is likely due to a failure in the reconciliation process where the controller is unable to reach the api server.</p></blockquote><p>The first step in troubleshooting is to check the status of the eviction object to understand if the eviction reached
a terminal state or not.</p><h2 id=invalid-eviction>Invalid eviction</h2><h3 id=missingdeleting-crp-object>Missing/Deleting CRP object</h3><p>Example status with missing <code>CRP</code> object:</p><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2025-04-17T22:16:59Z&#34;
    message: Failed to find ClusterResourcePlacement targeted by eviction
    observedGeneration: 1
    reason: ClusterResourcePlacementEvictionInvalid
    status: &#34;False&#34;
    type: Valid
</code></pre><p>Example status with deleting <code>CRP</code> object:</p><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2025-04-21T19:53:42Z&#34;
    message: Found deleting ClusterResourcePlacement targeted by eviction
    observedGeneration: 1
    reason: ClusterResourcePlacementEvictionInvalid
    status: &#34;False&#34;
    type: Valid
</code></pre><p>In both cases the Eviction object reached a terminal state, its status has <code>Valid</code> condition set to <code>False</code>.
The user should verify if the <code>ClusterResourcePlacement</code> object is missing or if it is being deleted and recreate the
<code>ClusterResourcePlacement</code> object if needed and retry eviction.</p><h3 id=missing-crb-object>Missing CRB object</h3><p>Example status with missing <code>CRB</code> object:</p><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2025-04-17T22:21:51Z&#34;
    message: Failed to find scheduler decision for placement in cluster targeted by
      eviction
    observedGeneration: 1
    reason: ClusterResourcePlacementEvictionInvalid
    status: &#34;False&#34;
    type: Valid
</code></pre><blockquote><p><strong>Note:</strong> The user can find the corresponding <code>ClusterResourceBinding</code> object by listing all <code>ClusterResourceBinding</code>
objects for the <code>ClusterResourcePlacement</code> object</p><pre tabindex=0><code>kubectl get rb -l kubernetes-fleet.io/parent-CRP=&lt;CRPName&gt;
</code></pre><p>The <code>ClusterResourceBinding</code> object name is formatted as <code>&lt;CRPName>-&lt;ClusterName>-randomsuffix</code></p></blockquote><p>In this case the Eviction object reached a terminal state, its status has <code>Valid</code> condition set to <code>False</code>, because the
<code>ClusterResourceBinding</code> object or Placement for target cluster is not found. The user should verify to see if the
<code>ClusterResourcePlacement</code> object is propagating resources to the target cluster,</p><ul><li>If yes, the next step is to check if the <code>ClusterResourceBinding</code> object is present for the target cluster or why it
was not created and try to create an eviction object once <code>ClusterResourceBinding</code> is created.</li><li>If no, the cluster is not picked by the scheduler and hence no need to retry eviction.</li></ul><h3 id=multiple-crb-is-present>Multiple CRB is present</h3><p>Example status with multiple <code>CRB</code> objects:</p><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2025-04-17T23:48:08Z&#34;
    message: Found more than one scheduler decision for placement in cluster targeted
      by eviction
    observedGeneration: 1
    reason: ClusterResourcePlacementEvictionInvalid
    status: &#34;False&#34;
    type: Valid
</code></pre><p>In this case the Eviction object reached a terminal state, its status has <code>Valid</code> condition set to <code>False</code>, because
there is more than one <code>ClusterResourceBinding</code> object or Placement present for the <code>ClusterResourcePlacement</code> object
targeting the member cluster. This is a rare scenario, it&rsquo;s an in-between state where bindings are being-recreated due
to the member cluster being selected again, and it will normally resolve quickly.</p><h3 id=pickfixed-crp-is-targeted-by-crp-eviction>PickFixed CRP is targeted by CRP Eviction</h3><p>Example status for <code>ClusterResourcePlacementEviction</code> object targeting a PickFixed <code>ClusterResourcePlacement</code> object:</p><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2025-04-21T23:19:06Z&#34;
    message: Found ClusterResourcePlacement with PickFixed placement type targeted
      by eviction
    observedGeneration: 1
    reason: ClusterResourcePlacementEvictionInvalid
    status: &#34;False&#34;
    type: Valid
</code></pre><p>In this case the Eviction object reached a terminal state, its status has <code>Valid</code> condition set to <code>False</code>, because
the <code>ClusterResourcePlacement</code> object is of type <code>PickFixed</code>. Users cannot use <code>ClusterResourcePlacementEviction</code>
objects to evict resources propagated by <code>ClusterResourcePlacement</code> objects of type <code>PickFixed</code>. The user can instead
remove the member cluster name from the <code>clusterNames</code> field in the policy of the <code>ClusterResourcePlacement</code> object.</p><h2 id=failed-to-execute-eviction>Failed to execute eviction</h2><h3 id=eviction-blocked-because-placement-is-missing>Eviction blocked because placement is missing</h3><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2025-04-23T23:54:03Z&#34;
    message: Eviction is valid
    observedGeneration: 1
    reason: ClusterResourcePlacementEvictionValid
    status: &#34;True&#34;
    type: Valid
  - lastTransitionTime: &#34;2025-04-23T23:54:03Z&#34;
    message: Eviction is blocked, placement has not propagated resources to target
      cluster yet
    observedGeneration: 1
    reason: ClusterResourcePlacementEvictionNotExecuted
    status: &#34;False&#34;
    type: Executed
</code></pre><p>In this case the Eviction object reached a terminal state, its status has <code>Executed</code> condition set to <code>False</code>, because
for the targeted <code>ClusterResourcePlacement</code> the corresponding <code>ClusterResourceBinding</code> object&rsquo;s spec is set to
<code>Scheduled</code> meaning the rollout of resources is not started yet.</p><blockquote><p><strong>Note:</strong> The user can find the corresponding <code>ClusterResourceBinding</code> object by listing all <code>ClusterResourceBinding</code>
objects for the <code>ClusterResourcePlacement</code> object</p><pre tabindex=0><code>kubectl get rb -l kubernetes-fleet.io/parent-CRP=&lt;CRPName&gt;
</code></pre><p>The <code>ClusterResourceBinding</code> object name is formatted as <code>&lt;CRPName>-&lt;ClusterName>-randomsuffix</code>.</p></blockquote><pre tabindex=0><code>spec:
  applyStrategy:
    type: ClientSideApply
  clusterDecision:
    clusterName: kind-cluster-3
    clusterScore:
      affinityScore: 0
      priorityScore: 0
    reason: &#39;Successfully scheduled resources for placement in &#34;kind-cluster-3&#34; (affinity
      score: 0, topology spread score: 0): picked by scheduling policy&#39;
    selected: true
  resourceSnapshotName: &#34;&#34;
  schedulingPolicySnapshotName: test-crp-1
  state: Scheduled
  targetCluster: kind-cluster-3
</code></pre><p>Here the user can wait for the <code>ClusterResourceBinding</code> object to be updated to <code>Bound</code> state which means that
resources have been propagated to the target cluster and then retry eviction. In some cases this can take a while or not
happen at all, in that case the user should verify if rollout is stuck for <code>ClusterResourcePlacement</code> object.</p><h3 id=eviction-blocked-by-invalid-crpdb>Eviction blocked by Invalid CRPDB</h3><p>Example status for <code>ClusterResourcePlacementEviction</code> object with invalid <code>ClusterResourcePlacementDisruptionBudget</code>,</p><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2025-04-21T23:39:42Z&#34;
    message: Eviction is valid
    observedGeneration: 1
    reason: ClusterResourcePlacementEvictionValid
    status: &#34;True&#34;
    type: Valid
  - lastTransitionTime: &#34;2025-04-21T23:39:42Z&#34;
    message: Eviction is blocked by misconfigured ClusterResourcePlacementDisruptionBudget,
      either MaxUnavailable is specified or MinAvailable is specified as a percentage
      for PickAll ClusterResourcePlacement
    observedGeneration: 1
    reason: ClusterResourcePlacementEvictionNotExecuted
    status: &#34;False&#34;
    type: Executed
</code></pre><p>In this cae the Eviction object reached a terminal state, its status has <code>Executed</code> condition set to <code>False</code>, because
the <code>ClusterResourcePlacementDisruptionBudget</code> object is invalid. For <code>ClusterResourcePlacement</code> objects of type
<code>PickAll</code>, when specifying a <code>ClusterResourcePlacementDisruptionBudget</code> the <code>minAvailable</code> field should be set to an
absolute number and not a percentage and the <code>maxUnavailable</code> field should not be set since the total number of
placements is non-deterministic.</p><h3 id=eviction-blocked-by-specified-crpdb>Eviction blocked by specified CRPDB</h3><p>Example status for <code>ClusterResourcePlacementEviction</code> object blocked by a <code>ClusterResourcePlacementDisruptionBudget</code>
object,</p><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2025-04-24T18:54:30Z&#34;
    message: Eviction is valid
    observedGeneration: 1
    reason: ClusterResourcePlacementEvictionValid
    status: &#34;True&#34;
    type: Valid
  - lastTransitionTime: &#34;2025-04-24T18:54:30Z&#34;
    message: &#39;Eviction is blocked by specified ClusterResourcePlacementDisruptionBudget,
      availablePlacements: 2, totalPlacements: 2&#39;
    observedGeneration: 1
    reason: ClusterResourcePlacementEvictionNotExecuted
    status: &#34;False&#34;
    type: Executed
</code></pre><p>In this cae the Eviction object reached a terminal state, its status has <code>Executed</code> condition set to <code>False</code>, because
the <code>ClusterResourcePlacementDisruptionBudget</code> object is blocking the eviction. The message from <code>Executed</code> condition
reads available placements is 2 and total placements is 2, which means that the <code>ClusterResourcePlacementDisruptionBudget</code>
is protecting all placements propagated by the <code>ClusterResourcePlacement</code> object.</p><p>Taking a look at the <code>ClusterResourcePlacementDisruptionBudget</code> object,</p><pre tabindex=0><code>apiVersion: placement.kubernetes-fleet.io/v1beta1
kind: ClusterResourcePlacementDisruptionBudget
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {&#34;apiVersion&#34;:&#34;placement.kubernetes-fleet.io/v1beta1&#34;,&#34;kind&#34;:&#34;ClusterResourcePlacementDisruptionBudget&#34;,&#34;metadata&#34;:{&#34;annotations&#34;:{},&#34;name&#34;:&#34;pick-all-crp&#34;},&#34;spec&#34;:{&#34;minAvailable&#34;:2}}
  creationTimestamp: &#34;2025-04-24T18:47:22Z&#34;
  generation: 1
  name: pick-all-crp
  resourceVersion: &#34;1749&#34;
  uid: 7d3a0ac5-0225-4fb6-b5e9-fc28d58cefdc
spec:
  minAvailable: 2
</code></pre><p>We can see that the <code>minAvailable</code> is set to <code>2</code>, which means that at least 2 placements should be available for the
<code>ClusterResourcePlacement</code> object.</p><p>Let&rsquo;s take a look at the <code>ClusterResourcePlacement</code> object&rsquo;s status to verify the list of available placements,</p><pre tabindex=0><code>status:
  conditions:
  - lastTransitionTime: &#34;2025-04-24T18:46:38Z&#34;
    message: found all cluster needed as specified by the scheduling policy, found
      2 cluster(s)
    observedGeneration: 1
    reason: SchedulingPolicyFulfilled
    status: &#34;True&#34;
    type: ClusterResourcePlacementScheduled
  - lastTransitionTime: &#34;2025-04-24T18:50:19Z&#34;
    message: All 2 cluster(s) start rolling out the latest resource
    observedGeneration: 1
    reason: RolloutStarted
    status: &#34;True&#34;
    type: ClusterResourcePlacementRolloutStarted
  - lastTransitionTime: &#34;2025-04-24T18:50:19Z&#34;
    message: No override rules are configured for the selected resources
    observedGeneration: 1
    reason: NoOverrideSpecified
    status: &#34;True&#34;
    type: ClusterResourcePlacementOverridden
  - lastTransitionTime: &#34;2025-04-24T18:50:19Z&#34;
    message: Works(s) are succcesfully created or updated in 2 target cluster(s)&#39;
      namespaces
    observedGeneration: 1
    reason: WorkSynchronized
    status: &#34;True&#34;
    type: ClusterResourcePlacementWorkSynchronized
  - lastTransitionTime: &#34;2025-04-24T18:50:19Z&#34;
    message: The selected resources are successfully applied to 2 cluster(s)
    observedGeneration: 1
    reason: ApplySucceeded
    status: &#34;True&#34;
    type: ClusterResourcePlacementApplied
  - lastTransitionTime: &#34;2025-04-24T18:50:19Z&#34;
    message: The selected resources in 2 cluster(s) are available now
    observedGeneration: 1
    reason: ResourceAvailable
    status: &#34;True&#34;
    type: ClusterResourcePlacementAvailable
  observedResourceIndex: &#34;0&#34;
  placementStatuses:
  - clusterName: kind-cluster-1
    conditions:
    - lastTransitionTime: &#34;2025-04-24T18:50:19Z&#34;
      message: &#39;Successfully scheduled resources for placement in &#34;kind-cluster-1&#34;
        (affinity score: 0, topology spread score: 0): picked by scheduling policy&#39;
      observedGeneration: 1
      reason: Scheduled
      status: &#34;True&#34;
      type: Scheduled
    - lastTransitionTime: &#34;2025-04-24T18:50:19Z&#34;
      message: Detected the new changes on the resources and started the rollout process
      observedGeneration: 1
      reason: RolloutStarted
      status: &#34;True&#34;
      type: RolloutStarted
    - lastTransitionTime: &#34;2025-04-24T18:50:19Z&#34;
      message: No override rules are configured for the selected resources
      observedGeneration: 1
      reason: NoOverrideSpecified
      status: &#34;True&#34;
      type: Overridden
    - lastTransitionTime: &#34;2025-04-24T18:50:19Z&#34;
      message: All of the works are synchronized to the latest
      observedGeneration: 1
      reason: AllWorkSynced
      status: &#34;True&#34;
      type: WorkSynchronized
    - lastTransitionTime: &#34;2025-04-24T18:50:19Z&#34;
      message: All corresponding work objects are applied
      observedGeneration: 1
      reason: AllWorkHaveBeenApplied
      status: &#34;True&#34;
      type: Applied
    - lastTransitionTime: &#34;2025-04-24T18:50:19Z&#34;
      message: All corresponding work objects are available
      observedGeneration: 1
      reason: AllWorkAreAvailable
      status: &#34;True&#34;
      type: Available
  - clusterName: kind-cluster-2
    conditions:
    - lastTransitionTime: &#34;2025-04-24T18:46:38Z&#34;
      message: &#39;Successfully scheduled resources for placement in &#34;kind-cluster-2&#34;
        (affinity score: 0, topology spread score: 0): picked by scheduling policy&#39;
      observedGeneration: 1
      reason: Scheduled
      status: &#34;True&#34;
      type: Scheduled
    - lastTransitionTime: &#34;2025-04-24T18:46:38Z&#34;
      message: Detected the new changes on the resources and started the rollout process
      observedGeneration: 1
      reason: RolloutStarted
      status: &#34;True&#34;
      type: RolloutStarted
    - lastTransitionTime: &#34;2025-04-24T18:46:38Z&#34;
      message: No override rules are configured for the selected resources
      observedGeneration: 1
      reason: NoOverrideSpecified
      status: &#34;True&#34;
      type: Overridden
    - lastTransitionTime: &#34;2025-04-24T18:46:38Z&#34;
      message: All of the works are synchronized to the latest
      observedGeneration: 1
      reason: AllWorkSynced
      status: &#34;True&#34;
      type: WorkSynchronized
    - lastTransitionTime: &#34;2025-04-24T18:46:38Z&#34;
      message: All corresponding work objects are applied
      observedGeneration: 1
      reason: AllWorkHaveBeenApplied
      status: &#34;True&#34;
      type: Applied
    - lastTransitionTime: &#34;2025-04-24T18:46:38Z&#34;
      message: All corresponding work objects are available
      observedGeneration: 1
      reason: AllWorkAreAvailable
      status: &#34;True&#34;
      type: Available
  selectedResources:
  - kind: Namespace
    name: test-ns
    version: v1
</code></pre><p>from the status we can see that the <code>ClusterResourcePlacement</code> object has 2 placements available, where resources have
been successfully applied and are available in kind-cluster-1 and kind-cluster-2. The users can check the individual
member clusters to verify the resources are available but the users are recommended to check the<code>ClusterResourcePlacement</code>
object status to verify placement availability since the status is aggregated and updated by the controller.</p><p>Here the user can either remove the <code>ClusterResourcePlacementDisruptionBudget</code> object or update the <code>minAvailable</code> to
<code>1</code> to allow <code>ClusterResourcePlacementEviction</code> object to execute successfully. In general the user should carefully
check the availability of placements and act accordingly when changing the <code>ClusterResourcePlacementDisruptionBudget</code>
object.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-4588103fb9a692533044ee756a5f863f>6 - Frequently Asked Questions</h1><div class=lead>Frequently Asked Questions about KubeFleet</div><h2 id=what-are-the-kubefleet-owned-resources-on-the-hub-and-member-clusters-can-these-kubefleet-owned-resources-be-modified-by-the-user>What are the KubeFleet-owned resources on the hub and member clusters? Can these KubeFleet-owned resources be modified by the user?</h2><p>KubeFleet reserves all namespaces with the prefix <code>fleet-</code>, such as <code>fleet-system</code> and <code>fleet-member-YOUR-CLUSTER-NAME</code> where
<code>YOUR-CLUSTER-NAME</code> are names of member clusters that have joined the fleet. Additionally, KubeFleet will skip resources
under namespaces with the prefix <code>kube-</code>.</p><p>KubeFleet-owned <strong>internal</strong> resources on the hub cluster side include:</p><table><thead><tr><th>Resource</th></tr></thead><tbody><tr><td><code>InternalMemberCluster</code></td></tr><tr><td><code>Work</code></td></tr><tr><td><code>ClusterResourceSnapshot</code></td></tr><tr><td><code>ClusterSchedulingPolicySnapshot</code></td></tr><tr><td><code>ClusterResourceBinding</code></td></tr><tr><td><code>ResourceOverrideSnapshots</code></td></tr><tr><td><code>ClusterResourceOverrideSnapshots</code></td></tr><tr><td><code>ResourceSnapshot</code></td></tr><tr><td><code>SchedulingPolicySnapshot</code></td></tr><tr><td><code>ResourceBinding</code></td></tr></tbody></table><p>And the public APIs exposed by KubeFleet are:</p><table><thead><tr><th>Resource</th></tr></thead><tbody><tr><td><code>ClusterResourcePlacement</code></td></tr><tr><td><code>ClusterResourceEnvelope</code></td></tr><tr><td><code>ResourceEnvelope</code></td></tr><tr><td><code>ClusterStagedUpdateRun</code></td></tr><tr><td><code>ClusterStagedUpdateRunStrategy</code></td></tr><tr><td><code>ClusterApprovalRequests</code></td></tr><tr><td><code>ClusterResourceOverrides</code></td></tr><tr><td><code>ResourceOverrides</code></td></tr><tr><td><code>ClusterResourcePlacementDisruptionBudgets</code></td></tr><tr><td><code>ClusterResourcePlacementEvictions</code></td></tr><tr><td><code>ResourcePlacement</code></td></tr></tbody></table><p>The following resources are the KubeFleet-owned <strong>internal</strong> resources on the member cluster side:</p><table><thead><tr><th>Resource</th></tr></thead><tbody><tr><td><code>AppliedWork</code></td></tr></tbody></table><p>See the <a href=https://github.com/kubefleet-dev/kubefleet/tree/main/apis>KubeFleet source code</a> for the definitions of these APIs.</p><p>Depending on your setup, your environment might feature a few KubeFleet provided webhooks that help safeguard
the KubeFleet internal resources and the KubeFleet reserved namespaces.</p><h2 id=which-kinds-of-resources-can-be-propagated-from-the-hub-cluster-to-the-member-clusters-how-can-i-control-the-list>Which kinds of resources can be propagated from the hub cluster to the member clusters? How can I control the list?</h2><p>When you use the <code>ClusterResourcePlacement</code> or <code>ResourcePlacement</code> API to select resources for placement, KubeFleet will automatically ignore
certain Kubernetes resource groups and/or GVKs. The resources exempted from placement include:</p><ul><li>Pods and Nodes</li><li>All resources in the <code>events.k8s.io</code> resource group.</li><li>All resources in the <code>coordination.k8s.io</code> resource group.</li><li>All resources in the <code>metrics.k8s.io</code> resource group.</li><li>All KubeFleet internal resources.</li></ul><p>Refer to the <a href=https://github.com/kubefleet-dev/kubefleet/blob/main/pkg/utils/apiresources.go>KubeFleet source code</a> for more
information. In addition, KubeFleet will refuse to place the <code>default</code> namespace on the hub cluster to member clusters.</p><p>If you would like to enforce additional restrictions, set up the <code>skipped-propagating-apis</code> and/or the <code>skipped-propagating-namespaces</code> flag on the KubeFleet hub agent, which blocks a specific resource type or a specific
namespace for placement respectively.</p><p>You may also specify the <code>allowed-propagating-apis</code> flag on the KubeFleet hub agent to explicitly dictate
a number of resource types that can be placed via KubeFleet; all resource types not on the whitelist will not be
selected by KubeFleet for placement. Note that this flag is mutually exclusive with the <code>skipped-propagating-apis</code> flag.</p><h2 id=what-happens-to-existing-resources-in-member-clusters-when-their-configuration-is-in-conflict-from-their-hub-cluster-counterparts>What happens to existing resources in member clusters when their configuration is in conflict from their hub cluster counterparts?</h2><p>By default, when KubeFleet encounters a pre-existing resource on the member cluster side, it will attempt to assume
ownership of the resource and overwrite its configuration with values from the hub cluster. You may use apply strategies
to fine-tune this behavior: for example, you may choose to let KubeFleet ignore all pre-existing resources, or let
KubeFleet check if the configuration is consistent between the hub cluster end and the member cluster end before KubeFleet
applies a manifest. For more information, see the KubeFleet documentation on takeover policies.</p><h2 id=what-happens-if-i-modify-a-resource-on-the-hub-cluster-that-has-been-placed-to-member-clusters-what-happens-if-i-modify-a-resource-on-the-member-cluster-that-is-managed-by-kubefleet>What happens if I modify a resource on the hub cluster that has been placed to member clusters? What happens if I modify a resource on the member cluster that is managed by KubeFleet?</h2><p>If you write a resource on the hub cluster end, KubeFleet will synchronize your changes to all selected member clusters automatically.
Specifically, when you update a resource, your changes will be applied to all member clusters; should you choose to delete a
resource, it will be removed from all member clusters as well.</p><p>By default, KubeFleet will attempt to overwrite changes made on the member cluster side if the modified fields are managed by KubeFleet. If you choose to delete a KubeFleet-managed resource, KubeFleet will re-create it shortly. You can fine-tune this
behavior via KubeFleet apply strategies: KubeFleet can help you detect such changes (often known as configuration drifts),
preserve them as necessary, or overwrite them to keep the resources in sync. For more information, see the KubeFleet documentation
on drift detection capabilities.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b5568d681972077a2a3f45e40a59d61a>7 - API Reference</h1><div class=lead>Reference for KubeFleet APIs</div><h2 id=packages>Packages</h2><ul><li><a href=/content/en/docs/api-reference/cluster.kubernetes-fleet.io/v1>cluster.kubernetes-fleet.io/v1</a></li><li><a href=/content/en/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1>cluster.kubernetes-fleet.io/v1beta1</a></li><li><a href=/content/en/docs/api-reference/placement.kubernetes-fleet.io/v1>placement.kubernetes-fleet.io/v1</a></li><li><a href=/content/en/docs/api-reference/placement.kubernetes-fleet.io/v1beta1>placement.kubernetes-fleet.io/v1beta1</a></li></ul></div><div class=td-content><h1 id=pg-b90e365793750eb7a6d0971588638d2f>7.1 - cluster.kubernetes-fleet.io/v1</h1><h1 id=api-reference>API Reference</h1><h2 id=packages>Packages</h2><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#clusterkubernetes-fleetiov1>cluster.kubernetes-fleet.io/v1</a></li></ul><h2 id=clusterkubernetes-fleetiov1>cluster.kubernetes-fleet.io/v1</h2><h3 id=resource-types>Resource Types</h3><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#internalmembercluster>InternalMemberCluster</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#internalmemberclusterlist>InternalMemberClusterList</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#membercluster>MemberCluster</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#memberclusterlist>MemberClusterList</a></li></ul><h4 id=agentstatus>AgentStatus</h4><p>AgentStatus defines the observed status of the member agent of the given type.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#internalmemberclusterstatus>InternalMemberClusterStatus</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#memberclusterstatus>MemberClusterStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>type</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#agenttype>AgentType</a></em></td><td>Type of the member agent.</td><td></td><td></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for the member agent.</td><td></td><td></td></tr><tr><td><code>lastReceivedHeartbeat</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>Last time we received a heartbeat from the member agent.</td><td></td><td></td></tr></tbody></table><h4 id=agenttype>AgentType</h4><p><em>Underlying type:</em> <em>string</em></p><p>AgentType defines a type of agent/binary running in a member cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#agentstatus>AgentStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>MemberAgent</code></td><td>MemberAgent (core) handles member cluster joining/leaving as well as k8s object placement from hub to member clusters.<br></td></tr><tr><td><code>MultiClusterServiceAgent</code></td><td>MultiClusterServiceAgent (networking) is responsible for exposing multi-cluster services via L4 load<br>balancer.<br></td></tr><tr><td><code>ServiceExportImportAgent</code></td><td>ServiceExportImportAgent (networking) is responsible for export or import services across multi-clusters.<br></td></tr></tbody></table><h4 id=clusterstate>ClusterState</h4><p><em>Underlying type:</em> <em>string</em></p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#internalmemberclusterspec>InternalMemberClusterSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Join</code></td><td></td></tr><tr><td><code>Leave</code></td><td></td></tr></tbody></table><h4 id=internalmembercluster>InternalMemberCluster</h4><p>InternalMemberCluster is used by hub agent to notify the member agents about the member cluster state changes, and is used by the member agents to report their status.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#internalmemberclusterlist>InternalMemberClusterList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>cluster.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>InternalMemberCluster</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#internalmemberclusterspec>InternalMemberClusterSpec</a></em></td><td>The desired state of InternalMemberCluster.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#internalmemberclusterstatus>InternalMemberClusterStatus</a></em></td><td>The observed status of InternalMemberCluster.</td><td></td><td></td></tr></tbody></table><h4 id=internalmemberclusterlist>InternalMemberClusterList</h4><p>InternalMemberClusterList contains a list of InternalMemberCluster.</p><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>cluster.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>InternalMemberClusterList</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#listmeta-v1-meta>ListMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>items</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#internalmembercluster>InternalMemberCluster</a> array</em></td><td></td><td></td><td></td></tr></tbody></table><h4 id=internalmemberclusterspec>InternalMemberClusterSpec</h4><p>InternalMemberClusterSpec defines the desired state of InternalMemberCluster. Set by the hub agent.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#internalmembercluster>InternalMemberCluster</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>state</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#clusterstate>ClusterState</a></em></td><td>The desired state of the member cluster. Possible values: Join, Leave.</td><td></td><td></td></tr><tr><td><code>heartbeatPeriodSeconds</code> <em>integer</em></td><td>How often (in seconds) for the member cluster to send a heartbeat to the hub cluster. Default: 60 seconds. Min: 1 second. Max: 10 minutes.</td><td>60</td><td>Maximum: 600<br>Minimum: 1<br></td></tr></tbody></table><h4 id=internalmemberclusterstatus>InternalMemberClusterStatus</h4><p>InternalMemberClusterStatus defines the observed state of InternalMemberCluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#internalmembercluster>InternalMemberCluster</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for the member cluster.</td><td></td><td></td></tr><tr><td><code>properties</code> <em>object (keys:<a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#propertyname>PropertyName</a>, values:<a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#propertyvalue>PropertyValue</a>)</em></td><td>Properties is an array of properties observed for the member cluster.<br>This field is beta-level; it is for the property-based scheduling feature and is only<br>populated when a property provider is enabled in the deployment.</td><td></td><td></td></tr><tr><td><code>resourceUsage</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#resourceusage>ResourceUsage</a></em></td><td>The current observed resource usage of the member cluster. It is populated by the member agent.</td><td></td><td></td></tr><tr><td><code>agentStatus</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#agentstatus>AgentStatus</a> array</em></td><td>AgentStatus is an array of current observed status, each corresponding to one member agent running in the member cluster.</td><td></td><td></td></tr></tbody></table><h4 id=membercluster>MemberCluster</h4><p>MemberCluster is a resource created in the hub cluster to represent a member cluster within a fleet.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#memberclusterlist>MemberClusterList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>cluster.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>MemberCluster</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#memberclusterspec>MemberClusterSpec</a></em></td><td>The desired state of MemberCluster.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#memberclusterstatus>MemberClusterStatus</a></em></td><td>The observed status of MemberCluster.</td><td></td><td></td></tr></tbody></table><h4 id=memberclusterlist>MemberClusterList</h4><p>MemberClusterList contains a list of MemberCluster.</p><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>cluster.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>MemberClusterList</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#listmeta-v1-meta>ListMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>items</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#membercluster>MemberCluster</a> array</em></td><td></td><td></td><td></td></tr></tbody></table><h4 id=memberclusterspec>MemberClusterSpec</h4><p>MemberClusterSpec defines the desired state of MemberCluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#membercluster>MemberCluster</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>identity</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#subject-v1-rbac>Subject</a></em></td><td>The identity used by the member cluster to access the hub cluster.<br>The hub agents deployed on the hub cluster will automatically grant the minimal required permissions to this identity for the member agents deployed on the member cluster to access the hub cluster.</td><td></td><td></td></tr><tr><td><code>heartbeatPeriodSeconds</code> <em>integer</em></td><td>How often (in seconds) for the member cluster to send a heartbeat to the hub cluster. Default: 60 seconds. Min: 1 second. Max: 10 minutes.</td><td>60</td><td>Maximum: 600<br>Minimum: 1<br></td></tr><tr><td><code>taints</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#taint>Taint</a> array</em></td><td>If specified, the MemberCluster&rsquo;s taints.<br>This field is beta-level and is for the taints and tolerations feature.</td><td></td><td>MaxItems: 100<br></td></tr></tbody></table><h4 id=memberclusterstatus>MemberClusterStatus</h4><p>MemberClusterStatus defines the observed status of MemberCluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#membercluster>MemberCluster</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for the member cluster.</td><td></td><td></td></tr><tr><td><code>properties</code> <em>object (keys:<a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#propertyname>PropertyName</a>, values:<a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#propertyvalue>PropertyValue</a>)</em></td><td>Properties is an array of properties observed for the member cluster.<br>This field is beta-level; it is for the property-based scheduling feature and is only<br>populated when a property provider is enabled in the deployment.</td><td></td><td></td></tr><tr><td><code>resourceUsage</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#resourceusage>ResourceUsage</a></em></td><td>The current observed resource usage of the member cluster. It is copied from the corresponding InternalMemberCluster object.</td><td></td><td></td></tr><tr><td><code>agentStatus</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#agentstatus>AgentStatus</a> array</em></td><td>AgentStatus is an array of current observed status, each corresponding to one member agent running in the member cluster.</td><td></td><td></td></tr></tbody></table><h4 id=propertyname>PropertyName</h4><p><em>Underlying type:</em> <em>string</em></p><p>PropertyName is the name of a cluster property.</p><p>A valid name should be a string of one or more segments, separated by slashes (/) if applicable.</p><p>Each segment must be 63 characters or less, start and end with an alphanumeric character,
and can include dashes (-), underscores (_), dots (.), and alphanumerics in between.</p><p>Optionally, the property name can have a prefix, which must be a DNS subdomain up to 253 characters,
followed by a slash (/).</p><p>Examples include:</p><ul><li>&ldquo;avg-resource-pressure&rdquo;</li><li>&ldquo;kubernetes-fleet.io/node-count&rdquo;</li><li>&ldquo;kubernetes.azure.com/vm-sizes/Standard_D2s_v3/count&rdquo;</li></ul><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#internalmemberclusterstatus>InternalMemberClusterStatus</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#memberclusterstatus>MemberClusterStatus</a></li></ul><h4 id=propertyvalue>PropertyValue</h4><p>PropertyValue is the value of a cluster property.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#internalmemberclusterstatus>InternalMemberClusterStatus</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#memberclusterstatus>MemberClusterStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>value</code> <em>string</em></td><td>Value is the value of the cluster property.<br>Currently, it should be a valid Kubernetes quantity.<br>For more information, see<br><a href=https://pkg.go.dev/k8s.io/apimachinery/pkg/api/resource#Quantity>https://pkg.go.dev/k8s.io/apimachinery/pkg/api/resource#Quantity</a>.</td><td></td><td></td></tr><tr><td><code>observationTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>ObservationTime is when the cluster property is observed.</td><td></td><td></td></tr></tbody></table><h4 id=resourceusage>ResourceUsage</h4><p>ResourceUsage contains the observed resource usage of a member cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#internalmemberclusterstatus>InternalMemberClusterStatus</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#memberclusterstatus>MemberClusterStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>capacity</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#resourcelist-v1-core>ResourceList</a></em></td><td>Capacity represents the total resource capacity of all the nodes on a member cluster.<br>A node&rsquo;s total capacity is the amount of resource installed on the node.</td><td></td><td></td></tr><tr><td><code>allocatable</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#resourcelist-v1-core>ResourceList</a></em></td><td>Allocatable represents the total allocatable resources of all the nodes on a member cluster.<br>A node&rsquo;s allocatable capacity is the amount of resource that can actually be used<br>for user workloads, i.e.,<br>allocatable capacity = total capacity - capacities reserved for the OS, kubelet, etc.<br>For more information, see<br><a href=https://kubernetes.io/docs/tasks/administer-cluster/reserve-compute-resources/>https://kubernetes.io/docs/tasks/administer-cluster/reserve-compute-resources/</a>.</td><td></td><td></td></tr><tr><td><code>available</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#resourcelist-v1-core>ResourceList</a></em></td><td>Available represents the total available resources of all the nodes on a member cluster.<br>A node&rsquo;s available capacity is the amount of resource that has not been used yet, i.e.,<br>available capacity = allocatable capacity - capacity that has been requested by workloads.<br>This field is beta-level; it is for the property-based scheduling feature and is only<br>populated when a property provider is enabled in the deployment.</td><td></td><td></td></tr><tr><td><code>observationTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>When the resource usage is observed.</td><td></td><td></td></tr></tbody></table><h4 id=taint>Taint</h4><p>Taint attached to MemberCluster has the &ldquo;effect&rdquo; on
any ClusterResourcePlacement that does not tolerate the Taint.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1/#memberclusterspec>MemberClusterSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>key</code> <em>string</em></td><td>The taint key to be applied to a MemberCluster.</td><td></td><td></td></tr><tr><td><code>value</code> <em>string</em></td><td>The taint value corresponding to the taint key.</td><td></td><td></td></tr><tr><td><code>effect</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#tainteffect-v1-core>TaintEffect</a></em></td><td>The effect of the taint on ClusterResourcePlacements that do not tolerate the taint.<br>Only NoSchedule is supported.</td><td></td><td>Enum: [NoSchedule]<br></td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-7f4c4e511a589ffe2f62357ed3ffc0b8>7.2 - cluster.kubernetes-fleet.io/v1beta1</h1><h1 id=api-reference>API Reference</h1><h2 id=packages>Packages</h2><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#clusterkubernetes-fleetiov1beta1>cluster.kubernetes-fleet.io/v1beta1</a></li></ul><h2 id=clusterkubernetes-fleetiov1beta1>cluster.kubernetes-fleet.io/v1beta1</h2><h3 id=resource-types>Resource Types</h3><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#internalmembercluster>InternalMemberCluster</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#internalmemberclusterlist>InternalMemberClusterList</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#membercluster>MemberCluster</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#memberclusterlist>MemberClusterList</a></li></ul><h4 id=agentstatus>AgentStatus</h4><p>AgentStatus defines the observed status of the member agent of the given type.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#internalmemberclusterstatus>InternalMemberClusterStatus</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#memberclusterstatus>MemberClusterStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>type</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#agenttype>AgentType</a></em></td><td>Type of the member agent.</td><td></td><td></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for the member agent.</td><td></td><td></td></tr><tr><td><code>lastReceivedHeartbeat</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>Last time we received a heartbeat from the member agent.</td><td></td><td></td></tr></tbody></table><h4 id=agenttype>AgentType</h4><p><em>Underlying type:</em> <em>string</em></p><p>AgentType defines a type of agent/binary running in a member cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#agentstatus>AgentStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>MemberAgent</code></td><td>MemberAgent (core) handles member cluster joining/leaving as well as k8s object placement from hub to member clusters.<br></td></tr><tr><td><code>MultiClusterServiceAgent</code></td><td>MultiClusterServiceAgent (networking) is responsible for exposing multi-cluster services via L4 load<br>balancer.<br></td></tr><tr><td><code>ServiceExportImportAgent</code></td><td>ServiceExportImportAgent (networking) is responsible for export or import services across multi-clusters.<br></td></tr></tbody></table><h4 id=clusterstate>ClusterState</h4><p><em>Underlying type:</em> <em>string</em></p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#internalmemberclusterspec>InternalMemberClusterSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Join</code></td><td></td></tr><tr><td><code>Leave</code></td><td></td></tr></tbody></table><h4 id=deleteoptions>DeleteOptions</h4><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#memberclusterspec>MemberClusterSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>validationMode</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#deletevalidationmode>DeleteValidationMode</a></em></td><td>Mode of validation. Can be &ldquo;Skip&rdquo;, or &ldquo;Strict&rdquo;. Default is Strict.</td><td>Strict</td><td>Enum: [Skip Strict]<br>Optional: {}<br></td></tr></tbody></table><h4 id=deletevalidationmode>DeleteValidationMode</h4><p><em>Underlying type:</em> <em>string</em></p><p>DeleteValidationMode identifies the type of validation when deleting a MemberCluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#deleteoptions>DeleteOptions</a></li></ul><h4 id=internalmembercluster>InternalMemberCluster</h4><p>InternalMemberCluster is used by hub agent to notify the member agents about the member cluster state changes, and is used by the member agents to report their status.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#internalmemberclusterlist>InternalMemberClusterList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>cluster.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>InternalMemberCluster</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#internalmemberclusterspec>InternalMemberClusterSpec</a></em></td><td>The desired state of InternalMemberCluster.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#internalmemberclusterstatus>InternalMemberClusterStatus</a></em></td><td>The observed status of InternalMemberCluster.</td><td></td><td></td></tr></tbody></table><h4 id=internalmemberclusterlist>InternalMemberClusterList</h4><p>InternalMemberClusterList contains a list of InternalMemberCluster.</p><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>cluster.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>InternalMemberClusterList</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#listmeta-v1-meta>ListMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>items</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#internalmembercluster>InternalMemberCluster</a> array</em></td><td></td><td></td><td></td></tr></tbody></table><h4 id=internalmemberclusterspec>InternalMemberClusterSpec</h4><p>InternalMemberClusterSpec defines the desired state of InternalMemberCluster. Set by the hub agent.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#internalmembercluster>InternalMemberCluster</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>state</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#clusterstate>ClusterState</a></em></td><td>The desired state of the member cluster. Possible values: Join, Leave.</td><td></td><td></td></tr><tr><td><code>heartbeatPeriodSeconds</code> <em>integer</em></td><td>How often (in seconds) for the member cluster to send a heartbeat to the hub cluster. Default: 60 seconds. Min: 1 second. Max: 10 minutes.</td><td>60</td><td>Maximum: 600<br>Minimum: 1<br></td></tr></tbody></table><h4 id=internalmemberclusterstatus>InternalMemberClusterStatus</h4><p>InternalMemberClusterStatus defines the observed state of InternalMemberCluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#internalmembercluster>InternalMemberCluster</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for the member cluster.</td><td></td><td></td></tr><tr><td><code>properties</code> <em>object (keys:<a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#propertyname>PropertyName</a>, values:<a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#propertyvalue>PropertyValue</a>)</em></td><td>Properties is an array of properties observed for the member cluster.<br>This field is beta-level; it is for the property-based scheduling feature and is only<br>populated when a property provider is enabled in the deployment.</td><td></td><td></td></tr><tr><td><code>resourceUsage</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#resourceusage>ResourceUsage</a></em></td><td>The current observed resource usage of the member cluster. It is populated by the member agent.</td><td></td><td></td></tr><tr><td><code>agentStatus</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#agentstatus>AgentStatus</a> array</em></td><td>AgentStatus is an array of current observed status, each corresponding to one member agent running in the member cluster.</td><td></td><td></td></tr></tbody></table><h4 id=membercluster>MemberCluster</h4><p>MemberCluster is a resource created in the hub cluster to represent a member cluster within a fleet.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#memberclusterlist>MemberClusterList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>cluster.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>MemberCluster</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#memberclusterspec>MemberClusterSpec</a></em></td><td>The desired state of MemberCluster.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#memberclusterstatus>MemberClusterStatus</a></em></td><td>The observed status of MemberCluster.</td><td></td><td></td></tr></tbody></table><h4 id=memberclusterlist>MemberClusterList</h4><p>MemberClusterList contains a list of MemberCluster.</p><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>cluster.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>MemberClusterList</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#listmeta-v1-meta>ListMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>items</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#membercluster>MemberCluster</a> array</em></td><td></td><td></td><td></td></tr></tbody></table><h4 id=memberclusterspec>MemberClusterSpec</h4><p>MemberClusterSpec defines the desired state of MemberCluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#membercluster>MemberCluster</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>identity</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#subject-v1-rbac>Subject</a></em></td><td>The identity used by the member cluster to access the hub cluster.<br>The hub agents deployed on the hub cluster will automatically grant the minimal required permissions to this identity for the member agents deployed on the member cluster to access the hub cluster.</td><td></td><td></td></tr><tr><td><code>heartbeatPeriodSeconds</code> <em>integer</em></td><td>How often (in seconds) for the member cluster to send a heartbeat to the hub cluster. Default: 60 seconds. Min: 1 second. Max: 10 minutes.</td><td>60</td><td>Maximum: 600<br>Minimum: 1<br></td></tr><tr><td><code>taints</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#taint>Taint</a> array</em></td><td>If specified, the MemberCluster&rsquo;s taints.<br>This field is beta-level and is for the taints and tolerations feature.</td><td></td><td>MaxItems: 100<br></td></tr><tr><td><code>deleteOptions</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#deleteoptions>DeleteOptions</a></em></td><td>DeleteOptions for deleting the MemberCluster.</td><td></td><td></td></tr></tbody></table><h4 id=memberclusterstatus>MemberClusterStatus</h4><p>MemberClusterStatus defines the observed status of MemberCluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#membercluster>MemberCluster</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for the member cluster.</td><td></td><td></td></tr><tr><td><code>properties</code> <em>object (keys:<a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#propertyname>PropertyName</a>, values:<a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#propertyvalue>PropertyValue</a>)</em></td><td>Properties is an array of properties observed for the member cluster.<br>This field is beta-level; it is for the property-based scheduling feature and is only<br>populated when a property provider is enabled in the deployment.</td><td></td><td></td></tr><tr><td><code>resourceUsage</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#resourceusage>ResourceUsage</a></em></td><td>The current observed resource usage of the member cluster. It is copied from the corresponding InternalMemberCluster object.</td><td></td><td></td></tr><tr><td><code>agentStatus</code> <em><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#agentstatus>AgentStatus</a> array</em></td><td>AgentStatus is an array of current observed status, each corresponding to one member agent running in the member cluster.</td><td></td><td></td></tr></tbody></table><h4 id=propertyname>PropertyName</h4><p><em>Underlying type:</em> <em>string</em></p><p>PropertyName is the name of a cluster property; it should be a Kubernetes label name.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#internalmemberclusterstatus>InternalMemberClusterStatus</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#memberclusterstatus>MemberClusterStatus</a></li></ul><h4 id=propertyvalue>PropertyValue</h4><p>PropertyValue is the value of a cluster property.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#internalmemberclusterstatus>InternalMemberClusterStatus</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#memberclusterstatus>MemberClusterStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>value</code> <em>string</em></td><td>Value is the value of the cluster property.<br>Currently, it should be a valid Kubernetes quantity.<br>For more information, see<br><a href=https://pkg.go.dev/k8s.io/apimachinery/pkg/api/resource#Quantity>https://pkg.go.dev/k8s.io/apimachinery/pkg/api/resource#Quantity</a>.</td><td></td><td></td></tr><tr><td><code>observationTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>ObservationTime is when the cluster property is observed.</td><td></td><td></td></tr></tbody></table><h4 id=resourceusage>ResourceUsage</h4><p>ResourceUsage contains the observed resource usage of a member cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#internalmemberclusterstatus>InternalMemberClusterStatus</a></li><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#memberclusterstatus>MemberClusterStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>capacity</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#resourcelist-v1-core>ResourceList</a></em></td><td>Capacity represents the total resource capacity of all the nodes on a member cluster.<br>A node&rsquo;s total capacity is the amount of resource installed on the node.</td><td></td><td></td></tr><tr><td><code>allocatable</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#resourcelist-v1-core>ResourceList</a></em></td><td>Allocatable represents the total allocatable resources of all the nodes on a member cluster.<br>A node&rsquo;s allocatable capacity is the amount of resource that can actually be used<br>for user workloads, i.e.,<br>allocatable capacity = total capacity - capacities reserved for the OS, kubelet, etc.<br>For more information, see<br><a href=https://kubernetes.io/docs/tasks/administer-cluster/reserve-compute-resources/>https://kubernetes.io/docs/tasks/administer-cluster/reserve-compute-resources/</a>.</td><td></td><td></td></tr><tr><td><code>available</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#resourcelist-v1-core>ResourceList</a></em></td><td>Available represents the total available resources of all the nodes on a member cluster.<br>A node&rsquo;s available capacity is the amount of resource that has not been used yet, i.e.,<br>available capacity = allocatable capacity - capacity that has been requested by workloads.<br>This field is beta-level; it is for the property-based scheduling feature and is only<br>populated when a property provider is enabled in the deployment.</td><td></td><td></td></tr><tr><td><code>observationTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>When the resource usage is observed.</td><td></td><td></td></tr></tbody></table><h4 id=taint>Taint</h4><p>Taint attached to MemberCluster has the &ldquo;effect&rdquo; on
any ClusterResourcePlacement that does not tolerate the Taint.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/cluster.kubernetes-fleet.io/v1beta1/#memberclusterspec>MemberClusterSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>key</code> <em>string</em></td><td>The taint key to be applied to a MemberCluster.</td><td></td><td></td></tr><tr><td><code>value</code> <em>string</em></td><td>The taint value corresponding to the taint key.</td><td></td><td></td></tr><tr><td><code>effect</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#tainteffect-v1-core>TaintEffect</a></em></td><td>The effect of the taint on ClusterResourcePlacements that do not tolerate the taint.<br>Only NoSchedule is supported.</td><td></td><td>Enum: [NoSchedule]<br></td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-3a56fed116dbc1a8db44faabe552e290>7.3 - placement.kubernetes-fleet.io/v1</h1><h1 id=api-reference>API Reference</h1><h2 id=packages>Packages</h2><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#placementkubernetes-fleetiov1>placement.kubernetes-fleet.io/v1</a></li></ul><h2 id=placementkubernetes-fleetiov1>placement.kubernetes-fleet.io/v1</h2><h3 id=resource-types>Resource Types</h3><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#appliedwork>AppliedWork</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#appliedworklist>AppliedWorkList</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourcebinding>ClusterResourceBinding</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceoverride>ClusterResourceOverride</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceoverridesnapshot>ClusterResourceOverrideSnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceplacement>ClusterResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourcesnapshot>ClusterResourceSnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterschedulingpolicysnapshot>ClusterSchedulingPolicySnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceoverride>ResourceOverride</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceoverridesnapshot>ResourceOverrideSnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#work>Work</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#worklist>WorkList</a></li></ul><h4 id=affinity>Affinity</h4><p>Affinity is a group of cluster affinity scheduling rules. More to be added.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#placementpolicy>PlacementPolicy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>clusterAffinity</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusteraffinity>ClusterAffinity</a></em></td><td>ClusterAffinity contains cluster affinity scheduling rules for the selected resources.</td><td></td><td></td></tr></tbody></table><h4 id=appliedresourcemeta>AppliedResourceMeta</h4><p>AppliedResourceMeta represents the group, version, resource, name and namespace of a resource.
Since these resources have been created, they must have valid group, version, resource, namespace, and name.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#appliedworkstatus>AppliedWorkStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>ordinal</code> <em>integer</em></td><td>Ordinal represents an index in manifests list, so the condition can still be linked<br>to a manifest even though manifest cannot be parsed successfully.</td><td></td><td></td></tr><tr><td><code>group</code> <em>string</em></td><td>Group is the group of the resource.</td><td></td><td></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version is the version of the resource.</td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind is the kind of the resource.</td><td></td><td></td></tr><tr><td><code>resource</code> <em>string</em></td><td>Resource is the resource type of the resource</td><td></td><td></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the resource, the resource is cluster scoped if the value<br>is empty</td><td></td><td></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name is the name of the resource</td><td></td><td></td></tr><tr><td><code>uid</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#uid-types-pkg>UID</a></em></td><td>UID is set on successful deletion of the Kubernetes resource by controller. The<br>resource might be still visible on the managed cluster after this field is set.<br>It is not directly settable by a client.</td><td></td><td></td></tr></tbody></table><h4 id=appliedwork>AppliedWork</h4><p>AppliedWork represents an applied work on managed cluster that is placed
on a managed cluster. An appliedwork links to a work on a hub recording resources
deployed in the managed cluster.
When the agent is removed from managed cluster, cluster-admin on managed cluster
can delete appliedwork to remove resources deployed by the agent.
The name of the appliedwork must be the same as {work name}
The namespace of the appliedwork should be the same as the resource applied on
the managed cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#appliedworklist>AppliedWorkList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>AppliedWork</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#appliedworkspec>AppliedWorkSpec</a></em></td><td>Spec represents the desired configuration of AppliedWork.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#appliedworkstatus>AppliedWorkStatus</a></em></td><td>Status represents the current status of AppliedWork.</td><td></td><td></td></tr></tbody></table><h4 id=appliedworklist>AppliedWorkList</h4><p>AppliedWorkList contains a list of AppliedWork.</p><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>AppliedWorkList</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#listmeta-v1-meta>ListMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>items</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#appliedwork>AppliedWork</a> array</em></td><td>List of works.</td><td></td><td></td></tr></tbody></table><h4 id=appliedworkspec>AppliedWorkSpec</h4><p>AppliedWorkSpec represents the desired configuration of AppliedWork.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#appliedwork>AppliedWork</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>workName</code> <em>string</em></td><td>WorkName represents the name of the related work on the hub.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>workNamespace</code> <em>string</em></td><td>WorkNamespace represents the namespace of the related work on the hub.</td><td></td><td>Required: {}<br></td></tr></tbody></table><h4 id=appliedworkstatus>AppliedWorkStatus</h4><p>AppliedWorkStatus represents the current status of AppliedWork.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#appliedwork>AppliedWork</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>appliedResources</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#appliedresourcemeta>AppliedResourceMeta</a> array</em></td><td>AppliedResources represents a list of resources defined within the Work that are applied.<br>Only resources with valid GroupVersionResource, namespace, and name are suitable.<br>An item in this slice is deleted when there is no mapped manifest in Work.Spec or by finalizer.<br>The resource relating to the item will also be removed from managed cluster.<br>The deleted resource may still be present until the finalizers for that resource are finished.<br>However, the resource will not be undeleted, so it can be removed from this list and eventual consistency is preserved.</td><td></td><td></td></tr></tbody></table><h4 id=applystrategy>ApplyStrategy</h4><p>ApplyStrategy describes how to resolve the conflict if the resource to be placed already exists in the target cluster
and whether it&rsquo;s allowed to be co-owned by other non-fleet appliers.
Note: If multiple CRPs try to place the same resource with different apply strategy, the later ones will fail with the
reason ApplyConflictBetweenPlacements.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcebindingspec>ResourceBindingSpec</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#rolloutstrategy>RolloutStrategy</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#workspec>WorkSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>comparisonOption</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#comparisonoptiontype>ComparisonOptionType</a></em></td><td>ComparisonOption controls how Fleet compares the desired state of a resource, as kept in<br>a hub cluster manifest, with the current state of the resource (if applicable) in the<br>member cluster.<br>Available options are:<br>* PartialComparison: with this option, Fleet will compare only fields that are managed by<br>Fleet, i.e., the fields that are specified explicitly in the hub cluster manifest.<br>Unmanaged fields are ignored. This is the default option.<br>* FullComparison: with this option, Fleet will compare all fields of the resource,<br>even if the fields are absent from the hub cluster manifest.<br>Consider using the PartialComparison option if you would like to:<br>* use the default values for certain fields; or<br>* let another agent, e.g., HPAs, VPAs, etc., on the member cluster side manage some fields; or<br>* allow ad-hoc or cluster-specific settings on the member cluster side.<br>To use the FullComparison option, it is recommended that you:<br>* specify all fields as appropriate in the hub cluster, even if you are OK with using default<br>values;<br>* make sure that no fields are managed by agents other than Fleet on the member cluster<br>side, such as HPAs, VPAs, or other controllers.<br>See the Fleet documentation for further explanations and usage examples.</td><td>PartialComparison</td><td>Enum: [PartialComparison FullComparison]<br>Optional: {}<br></td></tr><tr><td><code>whenToApply</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#whentoapplytype>WhenToApplyType</a></em></td><td>WhenToApply controls when Fleet would apply the manifests on the hub cluster to the member<br>clusters.<br>Available options are:<br>* Always: with this option, Fleet will periodically apply hub cluster manifests<br>on the member cluster side; this will effectively overwrite any change in the fields<br>managed by Fleet (i.e., specified in the hub cluster manifest). This is the default<br>option.<br>Note that this option would revert any ad-hoc changes made on the member cluster side in the<br>managed fields; if you would like to make temporary edits on the member cluster side<br>in the managed fields, switch to IfNotDrifted option. Note that changes in unmanaged<br>fields will be left alone; if you use the FullDiff compare option, such changes will<br>be reported as drifts.<br>* IfNotDrifted: with this option, Fleet will stop applying hub cluster manifests on<br>clusters that have drifted from the desired state; apply ops would still continue on<br>the rest of the clusters. Drifts are calculated using the ComparisonOption,<br>as explained in the corresponding field.<br>Use this option if you would like Fleet to detect drifts in your multi-cluster setup.<br>A drift occurs when an agent makes an ad-hoc change on the member cluster side that<br>makes affected resources deviate from its desired state as kept in the hub cluster;<br>and this option grants you an opportunity to view the drift details and take actions<br>accordingly. The drift details will be reported in the CRP status.<br>To fix a drift, you may:<br>* revert the changes manually on the member cluster side<br>* update the hub cluster manifest; this will trigger Fleet to apply the latest revision<br>of the manifests, which will overwrite the drifted fields<br>(if they are managed by Fleet)<br>* switch to the Always option; this will trigger Fleet to apply the current revision<br>of the manifests, which will overwrite the drifted fields (if they are managed by Fleet).<br>* if applicable and necessary, delete the drifted resources on the member cluster side; Fleet<br>will attempt to re-create them using the hub cluster manifests</td><td>Always</td><td>Enum: [Always IfNotDrifted]<br>Optional: {}<br></td></tr><tr><td><code>type</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#applystrategytype>ApplyStrategyType</a></em></td><td>Type is the apply strategy to use; it determines how Fleet applies manifests from the<br>hub cluster to a member cluster.<br>Available options are:<br>* ClientSideApply: Fleet uses three-way merge to apply manifests, similar to how kubectl<br>performs a client-side apply. This is the default option.<br>Note that this strategy requires that Fleet keep the last applied configuration in the<br>annotation of an applied resource. If the object gets so large that apply ops can no longer<br>be executed, Fleet will switch to server-side apply.<br>Use ComparisonOption and WhenToApply settings to control when an apply op can be executed.<br>* ServerSideApply: Fleet uses server-side apply to apply manifests; Fleet itself will<br>become the field manager for specified fields in the manifests. Specify<br>ServerSideApplyConfig as appropriate if you would like Fleet to take over field<br>ownership upon conflicts. This is the recommended option for most scenarios; it might<br>help reduce object size and safely resolve conflicts between field values. For more<br>information, please refer to the Kubernetes documentation<br>(<a href=https://kubernetes.io/docs/reference/using-api/server-side-apply/#comparison-with-client-side-apply%29>https://kubernetes.io/docs/reference/using-api/server-side-apply/#comparison-with-client-side-apply)</a>.<br>Use ComparisonOption and WhenToApply settings to control when an apply op can be executed.<br>* ReportDiff: Fleet will compare the desired state of a resource as kept in the hub cluster<br>with its current state (if applicable) on the member cluster side, and report any<br>differences. No actual apply ops would be executed, and resources will be left alone as they<br>are on the member clusters.<br>If configuration differences are found on a resource, Fleet will consider this as an apply<br>error, which might block rollout depending on the specified rollout strategy.<br>Use ComparisonOption setting to control how the difference is calculated.<br>ClientSideApply and ServerSideApply apply strategies only work when Fleet can assume<br>ownership of a resource (e.g., the resource is created by Fleet, or Fleet has taken over<br>the resource). See the comments on the WhenToTakeOver field for more information.<br>ReportDiff apply strategy, however, will function regardless of Fleet&rsquo;s ownership<br>status. One may set up a CRP with the ReportDiff strategy and the Never takeover option,<br>and this will turn Fleet into a detection tool that reports only configuration differences<br>but do not touch any resources on the member cluster side.<br>For a comparison between the different strategies and usage examples, refer to the<br>Fleet documentation.</td><td>ClientSideApply</td><td>Enum: [ClientSideApply ServerSideApply ReportDiff]<br>Optional: {}<br></td></tr><tr><td><code>allowCoOwnership</code> <em>boolean</em></td><td>AllowCoOwnership controls whether co-ownership between Fleet and other agents are allowed<br>on a Fleet-managed resource. If set to false, Fleet will refuse to apply manifests to<br>a resource that has been owned by one or more non-Fleet agents.<br>Note that Fleet does not support the case where one resource is being placed multiple<br>times by different CRPs on the same member cluster. An apply error will be returned if<br>Fleet finds that a resource has been owned by another placement attempt by Fleet, even<br>with the AllowCoOwnership setting set to true.</td><td></td><td></td></tr><tr><td><code>serverSideApplyConfig</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#serversideapplyconfig>ServerSideApplyConfig</a></em></td><td>ServerSideApplyConfig defines the configuration for server side apply. It is honored only when type is ServerSideApply.</td><td></td><td></td></tr><tr><td><code>whenToTakeOver</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#whentotakeovertype>WhenToTakeOverType</a></em></td><td>WhenToTakeOver determines the action to take when Fleet applies resources to a member<br>cluster for the first time and finds out that the resource already exists in the cluster.<br>This setting is most relevant in cases where you would like Fleet to manage pre-existing<br>resources on a member cluster.<br>Available options include:<br>* Always: with this action, Fleet will apply the hub cluster manifests to the member<br>clusters even if the affected resources already exist. This is the default action.<br>Note that this might lead to fields being overwritten on the member clusters, if they<br>are specified in the hub cluster manifests.<br>* IfNoDiff: with this action, Fleet will apply the hub cluster manifests to the member<br>clusters if (and only if) pre-existing resources look the same as the hub cluster manifests.<br>This is a safer option as pre-existing resources that are inconsistent with the hub cluster<br>manifests will not be overwritten; Fleet will ignore them until the inconsistencies<br>are resolved properly: any change you make to the hub cluster manifests would not be<br>applied, and if you delete the manifests or even the ClusterResourcePlacement itself<br>from the hub cluster, these pre-existing resources would not be taken away.<br>Fleet will check for inconsistencies in accordance with the ComparisonOption setting. See also<br>the comments on the ComparisonOption field for more information.<br>If a diff has been found in a field that is <strong>managed</strong> by Fleet (i.e., the field<br>*<em>is specified ** in the hub cluster manifest), consider one of the following actions:<br>* set the field in the member cluster to be of the same value as that in the hub cluster<br>manifest.<br>* update the hub cluster manifest so that its field value matches with that in the member<br>cluster.<br>* switch to the Always action, which will allow Fleet to overwrite the field with the<br>value in the hub cluster manifest.<br>If a diff has been found in a field that is <strong>not managed</strong> by Fleet (i.e., the field<br><strong>is not specified</strong> in the hub cluster manifest), consider one of the following actions:<br>* remove the field from the member cluster.<br>* update the hub cluster manifest so that the field is included in the hub cluster manifest.<br>If appropriate, you may also delete the object from the member cluster; Fleet will recreate<br>it using the hub cluster manifest.<br></em>Never: with this action, Fleet will not apply a hub cluster manifest to the member<br>clusters if there is a corresponding pre-existing resource. However, if a manifest<br>has never been applied yet; or it has a corresponding resource which Fleet has assumed<br>ownership, apply op will still be executed.<br>This is the safest option; one will have to remove the pre-existing resources (so that<br>Fleet can re-create them) or switch to a different<br>WhenToTakeOver option before Fleet starts processing the corresponding hub cluster<br>manifests.<br>If you prefer Fleet stop processing all manifests, use this option along with the<br>ReportDiff apply strategy type. This setup would instruct Fleet to touch nothing<br>on the member cluster side but still report configuration differences between the<br>hub cluster and member clusters. Fleet will not give up ownership<br>that it has already assumed though.</td><td>Always</td><td>Enum: [Always IfNoDiff Never]<br>Optional: {}<br></td></tr></tbody></table><h4 id=applystrategytype>ApplyStrategyType</h4><p><em>Underlying type:</em> <em>string</em></p><p>ApplyStrategyType describes the type of the strategy used to apply the resource to the target cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#applystrategy>ApplyStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>ClientSideApply</code></td><td>ApplyStrategyTypeClientSideApply will use three-way merge patch similar to how <code>kubectl apply</code> does by storing<br>last applied state in the <code>last-applied-configuration</code> annotation.<br>When the <code>last-applied-configuration</code> annotation size is greater than 256kB, it falls back to the server-side apply.<br></td></tr><tr><td><code>ServerSideApply</code></td><td>ApplyStrategyTypeServerSideApply will use server-side apply to resolve conflicts between the resource to be placed<br>and the existing resource in the target cluster.<br>Details: <a href=https://kubernetes.io/docs/reference/using-api/server-side-apply>https://kubernetes.io/docs/reference/using-api/server-side-apply</a><br></td></tr><tr><td><code>ReportDiff</code></td><td>ApplyStrategyTypeReportDiff will report differences between the desired state of a<br>resource as kept in the hub cluster and its current state (if applicable) on the member<br>cluster side. No actual apply ops would be executed.<br></td></tr></tbody></table><h4 id=bindingstate>BindingState</h4><p><em>Underlying type:</em> <em>string</em></p><p>BindingState is the state of the binding.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcebindingspec>ResourceBindingSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Scheduled</code></td><td>BindingStateScheduled means the binding is scheduled but need to be bound to the target cluster.<br></td></tr><tr><td><code>Bound</code></td><td>BindingStateBound means the binding is bound to the target cluster.<br></td></tr><tr><td><code>Unscheduled</code></td><td>BindingStateUnscheduled means the binding is not scheduled on to the target cluster anymore.<br>This is a state that rollout controller cares about.<br>The work generator still treat this as bound until rollout controller deletes the binding.<br></td></tr></tbody></table><h4 id=clusteraffinity>ClusterAffinity</h4><p>ClusterAffinity contains cluster affinity scheduling rules for the selected resources.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#affinity>Affinity</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>requiredDuringSchedulingIgnoredDuringExecution</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterselector>ClusterSelector</a></em></td><td>If the affinity requirements specified by this field are not met at<br>scheduling time, the resource will not be scheduled onto the cluster.<br>If the affinity requirements specified by this field cease to be met<br>at some point after the placement (e.g. due to an update), the system<br>may or may not try to eventually remove the resource from the cluster.</td><td></td><td></td></tr><tr><td><code>preferredDuringSchedulingIgnoredDuringExecution</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#preferredclusterselector>PreferredClusterSelector</a> array</em></td><td>The scheduler computes a score for each cluster at schedule time by iterating<br>through the elements of this field and adding &ldquo;weight&rdquo; to the sum if the cluster<br>matches the corresponding matchExpression. The scheduler then chooses the first<br><code>N</code> clusters with the highest sum to satisfy the placement.<br>This field is ignored if the placement type is &ldquo;PickAll&rdquo;.<br>If the cluster score changes at some point after the placement (e.g. due to an update),<br>the system may or may not try to eventually move the resource from a cluster with a lower score<br>to a cluster with higher score.</td><td></td><td></td></tr></tbody></table><h4 id=clusterdecision>ClusterDecision</h4><p>ClusterDecision represents a decision from a placement
An empty ClusterDecision indicates it is not scheduled yet.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcebindingspec>ResourceBindingSpec</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#schedulingpolicysnapshotstatus>SchedulingPolicySnapshotStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>clusterName</code> <em>string</em></td><td>ClusterName is the name of the ManagedCluster. If it is not empty, its value should be unique cross all<br>placement decisions for the Placement.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>selected</code> <em>boolean</em></td><td>Selected indicates if this cluster is selected by the scheduler.</td><td></td><td></td></tr><tr><td><code>clusterScore</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterscore>ClusterScore</a></em></td><td>ClusterScore represents the score of the cluster calculated by the scheduler.</td><td></td><td></td></tr><tr><td><code>reason</code> <em>string</em></td><td>Reason represents the reason why the cluster is selected or not.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourcebinding>ClusterResourceBinding</h4><p>ClusterResourceBinding represents a scheduling decision that binds a group of resources to a cluster.
It MUST have a label named <code>CRPTrackingLabel</code> that points to the cluster resource policy that creates it.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourcebindinglist>ClusterResourceBindingList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourceBinding</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcebindingspec>ResourceBindingSpec</a></em></td><td>The desired state of ClusterResourceBinding.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcebindingstatus>ResourceBindingStatus</a></em></td><td>The observed status of ClusterResourceBinding.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceoverride>ClusterResourceOverride</h4><p>ClusterResourceOverride defines a group of override policies about how to override the selected cluster scope resources
to target clusters.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceoverridelist>ClusterResourceOverrideList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourceOverride</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceoverridespec>ClusterResourceOverrideSpec</a></em></td><td>The desired state of ClusterResourceOverrideSpec.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceoverridesnapshot>ClusterResourceOverrideSnapshot</h4><p>ClusterResourceOverrideSnapshot is used to store a snapshot of ClusterResourceOverride.
Its spec is immutable.
We assign an ever-increasing index for snapshots.
The naming convention of a ClusterResourceOverrideSnapshot is {ClusterResourceOverride}-{resourceIndex}.
resourceIndex will begin with 0.
Each snapshot MUST have the following labels:</p><ul><li><code>OverrideTrackingLabel</code> which points to its owner ClusterResourceOverride.</li><li><code>IsLatestSnapshotLabel</code> which indicates whether the snapshot is the latest one.</li></ul><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceoverridesnapshotlist>ClusterResourceOverrideSnapshotList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourceOverrideSnapshot</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceoverridesnapshotspec>ClusterResourceOverrideSnapshotSpec</a></em></td><td>The desired state of ClusterResourceOverrideSnapshotSpec.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceoverridesnapshotspec>ClusterResourceOverrideSnapshotSpec</h4><p>ClusterResourceOverrideSnapshotSpec defines the desired state of ClusterResourceOverride.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceoverridesnapshot>ClusterResourceOverrideSnapshot</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>overrideSpec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceoverridespec>ClusterResourceOverrideSpec</a></em></td><td>OverrideSpec stores the spec of ClusterResourceOverride.</td><td></td><td></td></tr><tr><td><code>overrideHash</code> <em>integer array</em></td><td>OverrideHash is the sha-256 hash value of the OverrideSpec field.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceoverridespec>ClusterResourceOverrideSpec</h4><p>ClusterResourceOverrideSpec defines the desired state of the Override.
The ClusterResourceOverride create or update will fail when the resource has been selected by the existing ClusterResourceOverride.
If the resource is selected by both ClusterResourceOverride and ResourceOverride, ResourceOverride will win when resolving
conflicts.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceoverride>ClusterResourceOverride</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceoverridesnapshotspec>ClusterResourceOverrideSnapshotSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>placement</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#placementref>PlacementRef</a></em></td><td>Placement defines whether the override is applied to a specific placement or not.<br>If set, the override will trigger the placement rollout immediately when the rollout strategy type is RollingUpdate.<br>Otherwise, it will be applied to the next rollout.<br>The recommended way is to set the placement so that the override can be rolled out immediately.</td><td></td><td></td></tr><tr><td><code>clusterResourceSelectors</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceselector>ClusterResourceSelector</a> array</em></td><td>ClusterResourceSelectors is an array of selectors used to select cluster scoped resources. The selectors are <code>ORed</code>.<br>If a namespace is selected, ALL the resources under the namespace are selected automatically.<br>LabelSelector is not supported.<br>You can have 1-20 selectors.<br>We only support Name selector for now.</td><td></td><td>MaxItems: 20<br>MinItems: 1<br>Required: {}<br></td></tr><tr><td><code>policy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#overridepolicy>OverridePolicy</a></em></td><td>Policy defines how to override the selected resources on the target clusters.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceplacement>ClusterResourcePlacement</h4><p>ClusterResourcePlacement is used to select cluster scoped resources, including built-in resources and custom resources,
and placement them onto selected member clusters in a fleet.</p><p>If a namespace is selected, ALL the resources under the namespace are placed to the target clusters.
Note that you can&rsquo;t select the following resources:</p><ul><li>reserved namespaces including: default, kube-* (reserved for Kubernetes system namespaces),
fleet-* (reserved for fleet system namespaces).</li><li>reserved fleet resource types including: MemberCluster, InternalMemberCluster, ClusterResourcePlacement,
ClusterSchedulingPolicySnapshot, ClusterResourceSnapshot, ClusterResourceBinding, etc.</li></ul><p><code>ClusterSchedulingPolicySnapshot</code> and <code>ClusterResourceSnapshot</code> objects are created when there are changes in the
system to keep the history of the changes affecting a <code>ClusterResourcePlacement</code>.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceplacementlist>ClusterResourcePlacementList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourcePlacement</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceplacementspec>ClusterResourcePlacementSpec</a></em></td><td>The desired state of ClusterResourcePlacement.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceplacementstatus>ClusterResourcePlacementStatus</a></em></td><td>The observed status of ClusterResourcePlacement.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceplacementspec>ClusterResourcePlacementSpec</h4><p>ClusterResourcePlacementSpec defines the desired state of ClusterResourcePlacement.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceplacement>ClusterResourcePlacement</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>resourceSelectors</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceselector>ClusterResourceSelector</a> array</em></td><td>ResourceSelectors is an array of selectors used to select cluster scoped resources. The selectors are <code>ORed</code>.<br>You can have 1-100 selectors.</td><td></td><td>MaxItems: 100<br>MinItems: 1<br></td></tr><tr><td><code>policy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#placementpolicy>PlacementPolicy</a></em></td><td>Policy defines how to select member clusters to place the selected resources.<br>If unspecified, all the joined member clusters are selected.</td><td></td><td></td></tr><tr><td><code>strategy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#rolloutstrategy>RolloutStrategy</a></em></td><td>The rollout strategy to use to replace existing placement with new ones.</td><td></td><td></td></tr><tr><td><code>revisionHistoryLimit</code> <em>integer</em></td><td>The number of old ClusterSchedulingPolicySnapshot or ClusterResourceSnapshot resources to retain to allow rollback.<br>This is a pointer to distinguish between explicit zero and not specified.<br>Defaults to 10.</td><td>10</td><td>Maximum: 1000<br>Minimum: 1<br></td></tr></tbody></table><h4 id=clusterresourceplacementstatus>ClusterResourcePlacementStatus</h4><p>ClusterResourcePlacementStatus defines the observed state of the ClusterResourcePlacement object.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceplacement>ClusterResourcePlacement</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>selectedResources</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceidentifier>ResourceIdentifier</a> array</em></td><td>SelectedResources contains a list of resources selected by ResourceSelectors.</td><td></td><td></td></tr><tr><td><code>observedResourceIndex</code> <em>string</em></td><td>Resource index logically represents the generation of the selected resources.<br>We take a new snapshot of the selected resources whenever the selection or their content change.<br>Each snapshot has a different resource index.<br>One resource snapshot can contain multiple clusterResourceSnapshots CRs in order to store large amount of resources.<br>To get clusterResourceSnapshot of a given resource index, use the following command:<br><code>kubectl get ClusterResourceSnapshot --selector=kubernetes-fleet.io/resource-index=$ObservedResourceIndex</code><br>ObservedResourceIndex is the resource index that the conditions in the ClusterResourcePlacementStatus observe.<br>For example, a condition of <code>ClusterResourcePlacementWorkSynchronized</code> type<br>is observing the synchronization status of the resource snapshot with the resource index $ObservedResourceIndex.</td><td></td><td></td></tr><tr><td><code>placementStatuses</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceplacementstatus>ResourcePlacementStatus</a> array</em></td><td>PlacementStatuses contains a list of placement status on the clusters that are selected by PlacementPolicy.<br>Each selected cluster according to the latest resource placement is guaranteed to have a corresponding placementStatuses.<br>In the pickN case, there are N placement statuses where N = NumberOfClusters; Or in the pickFixed case, there are<br>N placement statuses where N = ClusterNames.<br>In these cases, some of them may not have assigned clusters when we cannot fill the required number of clusters.</td><td></td><td></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for ClusterResourcePlacement.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceselector>ClusterResourceSelector</h4><p>ClusterResourceSelector is used to select cluster scoped resources as the target resources to be placed.
If a namespace is selected, ALL the resources under the namespace are selected automatically.
All the fields are <code>ANDed</code>. In other words, a resource must match all the fields to be selected.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceoverridespec>ClusterResourceOverrideSpec</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceplacementspec>ClusterResourcePlacementSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>group</code> <em>string</em></td><td>Group name of the cluster-scoped resource.<br>Use an empty string to select resources under the core API group (e.g., namespaces).</td><td></td><td></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version of the cluster-scoped resource.</td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind of the cluster-scoped resource.<br>Note: When <code>Kind</code> is <code>namespace</code>, ALL the resources under the selected namespaces are selected.</td><td></td><td></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name of the cluster-scoped resource.</td><td></td><td></td></tr><tr><td><code>labelSelector</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#labelselector-v1-meta>LabelSelector</a></em></td><td>A label query over all the cluster-scoped resources. Resources matching the query are selected.<br>Note that namespace-scoped resources can&rsquo;t be selected even if they match the query.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourcesnapshot>ClusterResourceSnapshot</h4><p>ClusterResourceSnapshot is used to store a snapshot of selected resources by a resource placement policy.
Its spec is immutable.
We may need to produce more than one resourceSnapshot for all the resources a ResourcePlacement selected to get around the 1MB size limit of k8s objects.
We assign an ever-increasing index for each such group of resourceSnapshots.
The naming convention of a clusterResourceSnapshot is {CRPName}-{resourceIndex}-{subindex}
where the name of the first snapshot of a group has no subindex part so its name is {CRPName}-{resourceIndex}-snapshot.
resourceIndex will begin with 0.
Each snapshot MUST have the following labels:</p><ul><li><code>CRPTrackingLabel</code> which points to its owner CRP.</li><li><code>ResourceIndexLabel</code> which is the index of the snapshot group.</li></ul><p>The first snapshot of the index group MAY have the following labels:</p><ul><li><code>IsLatestSnapshotLabel</code> which indicates whether the snapshot is the latest one.</li></ul><p>All the snapshots within the same index group must have the same ResourceIndexLabel.</p><p>The first snapshot of the index group MUST have the following annotations:</p><ul><li><code>NumberOfResourceSnapshotsAnnotation</code> to store the total number of resource snapshots in the index group.</li><li><code>ResourceGroupHashAnnotation</code> whose value is the sha-256 hash of all the snapshots belong to the same snapshot index.</li></ul><p>Each snapshot (excluding the first snapshot) MUST have the following annotations:</p><ul><li><code>SubindexOfResourceSnapshotAnnotation</code> to store the subindex of resource snapshot in the group.</li></ul><p>Snapshot may have the following annotations to indicate the time of next resourceSnapshot candidate detected by the controller:</p><ul><li><code>NextResourceSnapshotCandidateDetectionTimeAnnotation</code> to store the time of next resourceSnapshot candidate detected by the controller.</li></ul><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourcesnapshotlist>ClusterResourceSnapshotList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourceSnapshot</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcesnapshotspec>ResourceSnapshotSpec</a></em></td><td>The desired state of ResourceSnapshot.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcesnapshotstatus>ResourceSnapshotStatus</a></em></td><td>The observed status of ResourceSnapshot.</td><td></td><td></td></tr></tbody></table><h4 id=clusterschedulingpolicysnapshot>ClusterSchedulingPolicySnapshot</h4><p>ClusterSchedulingPolicySnapshot is used to store a snapshot of cluster placement policy.
Its spec is immutable.
The naming convention of a ClusterSchedulingPolicySnapshot is {CRPName}-{PolicySnapshotIndex}.
PolicySnapshotIndex will begin with 0.
Each snapshot must have the following labels:</p><ul><li><code>CRPTrackingLabel</code> which points to its owner CRP.</li><li><code>PolicyIndexLabel</code> which is the index of the policy snapshot.</li><li><code>IsLatestSnapshotLabel</code> which indicates whether the snapshot is the latest one.</li></ul><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterschedulingpolicysnapshotlist>ClusterSchedulingPolicySnapshotList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterSchedulingPolicySnapshot</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#schedulingpolicysnapshotspec>SchedulingPolicySnapshotSpec</a></em></td><td>The desired state of SchedulingPolicySnapshot.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#schedulingpolicysnapshotstatus>SchedulingPolicySnapshotStatus</a></em></td><td>The observed status of SchedulingPolicySnapshot.</td><td></td><td></td></tr></tbody></table><h4 id=clusterscore>ClusterScore</h4><p>ClusterScore represents the score of the cluster calculated by the scheduler.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterdecision>ClusterDecision</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>affinityScore</code> <em>integer</em></td><td>AffinityScore represents the affinity score of the cluster calculated by the last<br>scheduling decision based on the preferred affinity selector.<br>An affinity score may not present if the cluster does not meet the required affinity.</td><td></td><td></td></tr><tr><td><code>priorityScore</code> <em>integer</em></td><td>TopologySpreadScore represents the priority score of the cluster calculated by the last<br>scheduling decision based on the topology spread applied to the cluster.<br>A priority score may not present if the cluster does not meet the topology spread.</td><td></td><td></td></tr></tbody></table><h4 id=clusterselector>ClusterSelector</h4><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusteraffinity>ClusterAffinity</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#overriderule>OverrideRule</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>clusterSelectorTerms</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterselectorterm>ClusterSelectorTerm</a> array</em></td><td>ClusterSelectorTerms is a list of cluster selector terms. The terms are <code>ORed</code>.</td><td></td><td>MaxItems: 10<br></td></tr></tbody></table><h4 id=clusterselectorterm>ClusterSelectorTerm</h4><p><em>Underlying type:</em> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#struct%7blabelselector-*k8sioapimachinerypkgapismetav1labelselector-%22json:%5c%22labelselector,omitempty%5c%22%22;-propertyselector-*propertyselector-%22json:%5c%22propertyselector,omitempty%5c%22%22;-propertysorter-*propertysorter-%22json:%5c%22propertysorter,omitempty%5c%22%22%7d>struct{LabelSelector *k8s.io/apimachinery/pkg/apis/meta/v1.LabelSelector &ldquo;json:"labelSelector,omitempty"&rdquo;; PropertySelector *PropertySelector &ldquo;json:"propertySelector,omitempty"&rdquo;; PropertySorter *PropertySorter &ldquo;json:"propertySorter,omitempty"&rdquo;}</a></em></p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#preferredclusterselector>PreferredClusterSelector</a></li></ul><h4 id=comparisonoptiontype>ComparisonOptionType</h4><p><em>Underlying type:</em> <em>string</em></p><p>ComparisonOptionType describes the compare option that Fleet uses to detect drifts and/or
calculate differences.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#applystrategy>ApplyStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>PartialComparison</code></td><td>ComparisonOptionTypePartialComparison will compare only fields that are managed by Fleet, i.e.,<br>fields that are specified explicitly in the hub cluster manifest. Unmanaged fields<br>are ignored.<br></td></tr><tr><td><code>FullComparison</code></td><td>ComparisonOptionTypeFullDiff will compare all fields of the resource, even if the fields<br>are absent from the hub cluster manifest.<br></td></tr></tbody></table><h4 id=diffdetails>DiffDetails</h4><p>DiffDetails describes the observed configuration differences.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#manifestcondition>ManifestCondition</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>observationTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>ObservationTime is the timestamp when the configuration difference was last detected.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>observedInMemberClusterGeneration</code> <em>integer</em></td><td>ObservedInMemberClusterGeneration is the generation of the applied manifest on the member<br>cluster side.<br>This might be nil if the resource has not been created yet in the member cluster.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>firstDiffedObservedTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>FirstDiffedObservedTime is the timestamp when the configuration difference<br>was first detected.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>observedDiffs</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#patchdetail>PatchDetail</a> array</em></td><td>ObservedDiffs describes each field with configuration difference as found from the<br>member cluster side.<br>Fleet might truncate the details as appropriate to control object size.<br>Each entry specifies how the live state (the state on the member cluster side) compares<br>against the desired state (the state kept in the hub cluster manifest).</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=diffedresourceplacement>DiffedResourcePlacement</h4><p>DiffedResourcePlacement contains the details of a resource with configuration differences.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcebindingstatus>ResourceBindingStatus</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceplacementstatus>ResourcePlacementStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>group</code> <em>string</em></td><td>Group is the group name of the selected resource.</td><td></td><td></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version is the version of the selected resource.</td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind represents the Kind of the selected resources.</td><td></td><td></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name of the target resource.</td><td></td><td></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the resource. Empty if the resource is cluster scoped.</td><td></td><td></td></tr><tr><td><code>envelope</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#envelopeidentifier>EnvelopeIdentifier</a></em></td><td>Envelope identifies the envelope object that contains this resource.</td><td></td><td></td></tr><tr><td><code>observationTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>ObservationTime is the time when we observe the configuration differences for the resource.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>targetClusterObservedGeneration</code> <em>integer</em></td><td>TargetClusterObservedGeneration is the generation of the resource on the target cluster<br>that contains the configuration differences.<br>This might be nil if the resource has not been created yet on the target cluster.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>firstDiffedObservedTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>FirstDiffedObservedTime is the first time the resource on the target cluster is<br>observed to have configuration differences.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>observedDiffs</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#patchdetail>PatchDetail</a> array</em></td><td>ObservedDiffs are the details about the found configuration differences. Note that<br>Fleet might truncate the details as appropriate to control the object size.<br>Each detail entry specifies how the live state (the state on the member<br>cluster side) compares against the desired state (the state kept in the hub cluster manifest).<br>An event about the details will be emitted as well.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=driftdetails>DriftDetails</h4><p>DriftDetails describes the observed configuration drifts.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#manifestcondition>ManifestCondition</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>observationTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>ObservationTime is the timestamp when the drift was last detected.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>observedInMemberClusterGeneration</code> <em>integer</em></td><td>ObservedInMemberClusterGeneration is the generation of the applied manifest on the member<br>cluster side.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>firstDriftedObservedTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>FirstDriftedObservedTime is the timestamp when the drift was first detected.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>observedDrifts</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#patchdetail>PatchDetail</a> array</em></td><td>ObservedDrifts describes each drifted field found from the applied manifest.<br>Fleet might truncate the details as appropriate to control object size.<br>Each entry specifies how the live state (the state on the member cluster side) compares<br>against the desired state (the state kept in the hub cluster manifest).</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=driftedresourceplacement>DriftedResourcePlacement</h4><p>DriftedResourcePlacement contains the details of a resource with configuration drifts.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcebindingstatus>ResourceBindingStatus</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceplacementstatus>ResourcePlacementStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>group</code> <em>string</em></td><td>Group is the group name of the selected resource.</td><td></td><td></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version is the version of the selected resource.</td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind represents the Kind of the selected resources.</td><td></td><td></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name of the target resource.</td><td></td><td></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the resource. Empty if the resource is cluster scoped.</td><td></td><td></td></tr><tr><td><code>envelope</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#envelopeidentifier>EnvelopeIdentifier</a></em></td><td>Envelope identifies the envelope object that contains this resource.</td><td></td><td></td></tr><tr><td><code>observationTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>ObservationTime is the time when we observe the configuration drifts for the resource.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>targetClusterObservedGeneration</code> <em>integer</em></td><td>TargetClusterObservedGeneration is the generation of the resource on the target cluster<br>that contains the configuration drifts.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>firstDriftedObservedTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>FirstDriftedObservedTime is the first time the resource on the target cluster is<br>observed to have configuration drifts.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>observedDrifts</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#patchdetail>PatchDetail</a> array</em></td><td>ObservedDrifts are the details about the found configuration drifts. Note that<br>Fleet might truncate the details as appropriate to control the object size.<br>Each detail entry specifies how the live state (the state on the member<br>cluster side) compares against the desired state (the state kept in the hub cluster manifest).<br>An event about the details will be emitted as well.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=envelopeidentifier>EnvelopeIdentifier</h4><p>EnvelopeIdentifier identifies the envelope object that contains the selected resource.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#diffedresourceplacement>DiffedResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#driftedresourceplacement>DriftedResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#failedresourceplacement>FailedResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceidentifier>ResourceIdentifier</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>name</code> <em>string</em></td><td>Name of the envelope object.</td><td></td><td></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the envelope object. Empty if the envelope object is cluster scoped.</td><td></td><td></td></tr><tr><td><code>type</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#envelopetype>EnvelopeType</a></em></td><td>Type of the envelope object.</td><td>ConfigMap</td><td>Enum: [ConfigMap]<br></td></tr></tbody></table><h4 id=envelopetype>EnvelopeType</h4><p><em>Underlying type:</em> <em>string</em></p><p>EnvelopeType defines the type of the envelope object.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#envelopeidentifier>EnvelopeIdentifier</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>ConfigMap</code></td><td>ConfigMapEnvelopeType means the envelope object is of type <code>ConfigMap</code>.<br></td></tr></tbody></table><h4 id=failedresourceplacement>FailedResourcePlacement</h4><p>FailedResourcePlacement contains the failure details of a failed resource placement.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcebindingstatus>ResourceBindingStatus</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceplacementstatus>ResourcePlacementStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>group</code> <em>string</em></td><td>Group is the group name of the selected resource.</td><td></td><td></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version is the version of the selected resource.</td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind represents the Kind of the selected resources.</td><td></td><td></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name of the target resource.</td><td></td><td></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the resource. Empty if the resource is cluster scoped.</td><td></td><td></td></tr><tr><td><code>envelope</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#envelopeidentifier>EnvelopeIdentifier</a></em></td><td>Envelope identifies the envelope object that contains this resource.</td><td></td><td></td></tr><tr><td><code>condition</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a></em></td><td>The failed condition status.</td><td></td><td></td></tr></tbody></table><h4 id=jsonpatchoverride>JSONPatchOverride</h4><p>JSONPatchOverride applies a JSON patch on the selected resources following <a href=https://datatracker.ietf.org/doc/html/rfc6902>RFC 6902</a>.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#overriderule>OverrideRule</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>op</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#jsonpatchoverrideoperator>JSONPatchOverrideOperator</a></em></td><td>Operator defines the operation on the target field.</td><td></td><td>Enum: [add remove replace]<br></td></tr><tr><td><code>path</code> <em>string</em></td><td>Path defines the target location.<br>Note: override will fail if the resource path does not exist.</td><td></td><td></td></tr><tr><td><code>value</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#json-v1-apiextensions-k8s-io>JSON</a></em></td><td>Value defines the content to be applied on the target location.<br>Value should be empty when operator is <code>remove</code>.<br>We have reserved a few variables in this field that will be replaced by the actual values.<br>Those variables all start with <code>$</code> and are case sensitive.<br>Here is the list of currently supported variables:<br><code>$\{MEMBER-CLUSTER-NAME\}</code>: this will be replaced by the name of the memberCluster CR that represents this cluster.</td><td></td><td></td></tr></tbody></table><h4 id=jsonpatchoverrideoperator>JSONPatchOverrideOperator</h4><p><em>Underlying type:</em> <em>string</em></p><p>JSONPatchOverrideOperator defines the supported JSON patch operator.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#jsonpatchoverride>JSONPatchOverride</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>add</code></td><td>JSONPatchOverrideOpAdd adds the value to the target location.<br>An example target JSON document:<br>{ &ldquo;foo&rdquo;: [ &ldquo;bar&rdquo;, &ldquo;baz&rdquo; ] }<br>A JSON Patch override:<br>[<br>{ &ldquo;op&rdquo;: &ldquo;add&rdquo;, &ldquo;path&rdquo;: &ldquo;/foo/1&rdquo;, &ldquo;value&rdquo;: &ldquo;qux&rdquo; }<br>]<br>The resulting JSON document:<br>{ &ldquo;foo&rdquo;: [ &ldquo;bar&rdquo;, &ldquo;qux&rdquo;, &ldquo;baz&rdquo; ] }<br></td></tr><tr><td><code>remove</code></td><td>JSONPatchOverrideOpRemove removes the value from the target location.<br>An example target JSON document:<br>{<br>&ldquo;baz&rdquo;: &ldquo;qux&rdquo;,<br>&ldquo;foo&rdquo;: &ldquo;bar&rdquo;<br>}<br>A JSON Patch override:<br>[<br>{ &ldquo;op&rdquo;: &ldquo;remove&rdquo;, &ldquo;path&rdquo;: &ldquo;/baz&rdquo; }<br>]<br>The resulting JSON document:<br>{ &ldquo;foo&rdquo;: &ldquo;bar&rdquo; }<br></td></tr><tr><td><code>replace</code></td><td>JSONPatchOverrideOpReplace replaces the value at the target location with a new value.<br>An example target JSON document:<br>{<br>&ldquo;baz&rdquo;: &ldquo;qux&rdquo;,<br>&ldquo;foo&rdquo;: &ldquo;bar&rdquo;<br>}<br>A JSON Patch override:<br>[<br>{ &ldquo;op&rdquo;: &ldquo;replace&rdquo;, &ldquo;path&rdquo;: &ldquo;/baz&rdquo;, &ldquo;value&rdquo;: &ldquo;boo&rdquo; }<br>]<br>The resulting JSON document:<br>{<br>&ldquo;baz&rdquo;: &ldquo;boo&rdquo;,<br>&ldquo;foo&rdquo;: &ldquo;bar&rdquo;<br>}<br></td></tr></tbody></table><h4 id=manifest>Manifest</h4><p>Manifest represents a resource to be deployed on spoke cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#workloadtemplate>WorkloadTemplate</a></li></ul><h4 id=manifestcondition>ManifestCondition</h4><p>ManifestCondition represents the conditions of the resources deployed on
spoke cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#workstatus>WorkStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>identifier</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#workresourceidentifier>WorkResourceIdentifier</a></em></td><td>resourceId represents a identity of a resource linking to manifests in spec.</td><td></td><td></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions represents the conditions of this resource on spoke cluster</td><td></td><td></td></tr><tr><td><code>driftDetails</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#driftdetails>DriftDetails</a></em></td><td>DriftDetails explains about the observed configuration drifts.<br>Fleet might truncate the details as appropriate to control object size.<br>Note that configuration drifts can only occur on a resource if it is currently owned by<br>Fleet and its corresponding placement is set to use the ClientSideApply or ServerSideApply<br>apply strategy. In other words, DriftDetails and DiffDetails will not be populated<br>at the same time.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>diffDetails</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#diffdetails>DiffDetails</a></em></td><td>DiffDetails explains the details about the observed configuration differences.<br>Fleet might truncate the details as appropriate to control object size.<br>Note that configuration differences can only occur on a resource if it is not currently owned<br>by Fleet (i.e., it is a pre-existing resource that needs to be taken over), or if its<br>corresponding placement is set to use the ReportDiff apply strategy. In other words,<br>DiffDetails and DriftDetails will not be populated at the same time.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=namespacedname>NamespacedName</h4><p>NamespacedName comprises a resource name, with a mandatory namespace.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcebindingspec>ResourceBindingSpec</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceplacementstatus>ResourcePlacementStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>name</code> <em>string</em></td><td>Name is the name of the namespaced scope resource.</td><td></td><td></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is namespace of the namespaced scope resource.</td><td></td><td></td></tr></tbody></table><h4 id=overridepolicy>OverridePolicy</h4><p>OverridePolicy defines how to override the selected resources on the target clusters.
More is to be added.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceoverridespec>ClusterResourceOverrideSpec</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceoverridespec>ResourceOverrideSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>overrideRules</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#overriderule>OverrideRule</a> array</em></td><td>OverrideRules defines an array of override rules to be applied on the selected resources.<br>The order of the rules determines the override order.<br>When there are two rules selecting the same fields on the target cluster, the last one will win.<br>You can have 1-20 rules.</td><td></td><td>MaxItems: 20<br>MinItems: 1<br>Required: {}<br></td></tr></tbody></table><h4 id=overriderule>OverrideRule</h4><p>OverrideRule defines how to override the selected resources on the target clusters.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#overridepolicy>OverridePolicy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>clusterSelector</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterselector>ClusterSelector</a></em></td><td>ClusterSelectors selects the target clusters.<br>The resources will be overridden before applying to the matching clusters.<br>An empty clusterSelector selects ALL the member clusters.<br>A nil clusterSelector selects NO member clusters.<br>For now, only labelSelector is supported.</td><td></td><td></td></tr><tr><td><code>overrideType</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#overridetype>OverrideType</a></em></td><td>OverrideType defines the type of the override rules.</td><td>JSONPatch</td><td>Enum: [JSONPatch Delete]<br></td></tr><tr><td><code>jsonPatchOverrides</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#jsonpatchoverride>JSONPatchOverride</a> array</em></td><td>JSONPatchOverrides defines a list of JSON patch override rules.<br>This field is only allowed when OverrideType is JSONPatch.</td><td></td><td>MaxItems: 20<br>MinItems: 1<br></td></tr></tbody></table><h4 id=overridetype>OverrideType</h4><p><em>Underlying type:</em> <em>string</em></p><p>OverrideType defines the type of Override</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#overriderule>OverrideRule</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>JSONPatch</code></td><td>JSONPatchOverrideType applies a JSON patch on the selected resources following <a href=https://datatracker.ietf.org/doc/html/rfc6902>RFC 6902</a>.<br></td></tr><tr><td><code>Delete</code></td><td>DeleteOverrideType deletes the selected resources on the target clusters.<br></td></tr></tbody></table><h4 id=patchdetail>PatchDetail</h4><p>PatchDetail describes a patch that explains an observed configuration drift or
difference.</p><p>A patch detail can be transcribed as a JSON patch operation, as specified in RFC 6902.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#diffdetails>DiffDetails</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#diffedresourceplacement>DiffedResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#driftdetails>DriftDetails</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#driftedresourceplacement>DriftedResourcePlacement</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>path</code> <em>string</em></td><td>The JSON path that points to a field that has drifted or has configuration differences.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>valueInMember</code> <em>string</em></td><td>The value at the JSON path from the member cluster side.<br>This field can be empty if the JSON path does not exist on the member cluster side; i.e.,<br>applying the manifest from the hub cluster side would add a new field.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>valueInHub</code> <em>string</em></td><td>The value at the JSON path from the hub cluster side.<br>This field can be empty if the JSON path does not exist on the hub cluster side; i.e.,<br>applying the manifest from the hub cluster side would remove the field.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=placementpolicy>PlacementPolicy</h4><p>PlacementPolicy contains the rules to select target member clusters to place the selected resources.
Note that only clusters that are both joined and satisfying the rules will be selected.</p><p>You can only specify at most one of the two fields: ClusterNames and Affinity.
If none is specified, all the joined clusters are selected.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceplacementspec>ClusterResourcePlacementSpec</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#schedulingpolicysnapshotspec>SchedulingPolicySnapshotSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>placementType</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#placementtype>PlacementType</a></em></td><td>Type of placement. Can be &ldquo;PickAll&rdquo;, &ldquo;PickN&rdquo; or &ldquo;PickFixed&rdquo;. Default is PickAll.</td><td>PickAll</td><td>Enum: [PickAll PickN PickFixed]<br></td></tr><tr><td><code>clusterNames</code> <em>string array</em></td><td>ClusterNames contains a list of names of MemberCluster to place the selected resources.<br>Only valid if the placement type is &ldquo;PickFixed&rdquo;</td><td></td><td>MaxItems: 100<br></td></tr><tr><td><code>numberOfClusters</code> <em>integer</em></td><td>NumberOfClusters of placement. Only valid if the placement type is &ldquo;PickN&rdquo;.</td><td></td><td>Minimum: 0<br></td></tr><tr><td><code>affinity</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#affinity>Affinity</a></em></td><td>Affinity contains cluster affinity scheduling rules. Defines which member clusters to place the selected resources.<br>Only valid if the placement type is &ldquo;PickAll&rdquo; or &ldquo;PickN&rdquo;.</td><td></td><td></td></tr><tr><td><code>topologySpreadConstraints</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#topologyspreadconstraint>TopologySpreadConstraint</a> array</em></td><td>TopologySpreadConstraints describes how a group of resources ought to spread across multiple topology<br>domains. Scheduler will schedule resources in a way which abides by the constraints.<br>All topologySpreadConstraints are ANDed.<br>Only valid if the placement type is &ldquo;PickN&rdquo;.</td><td></td><td></td></tr><tr><td><code>tolerations</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#toleration>Toleration</a> array</em></td><td>If specified, the ClusterResourcePlacement&rsquo;s Tolerations.<br>Tolerations cannot be updated or deleted.<br>This field is beta-level and is for the taints and tolerations feature.</td><td></td><td>MaxItems: 100<br></td></tr></tbody></table><h4 id=placementref>PlacementRef</h4><p>PlacementRef is the reference to a placement.
For now, we only support ClusterResourcePlacement.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceoverridespec>ClusterResourceOverrideSpec</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceoverridespec>ResourceOverrideSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>name</code> <em>string</em></td><td></td><td></td><td></td></tr><tr><td><code>scope</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcescope>ResourceScope</a></em></td><td>Scope defines the scope of the placement.<br>A clusterResourceOverride can only reference a clusterResourcePlacement (cluster-scoped),<br>and a resourceOverride can reference either a clusterResourcePlacement or resourcePlacement (namespaced).<br>The referenced resourcePlacement must be in the same namespace as the resourceOverride.</td><td>Cluster</td><td>Enum: [Cluster Namespaced]<br></td></tr></tbody></table><h4 id=placementtype>PlacementType</h4><p><em>Underlying type:</em> <em>string</em></p><p>PlacementType identifies the type of placement.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#placementpolicy>PlacementPolicy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>PickAll</code></td><td>PickAllPlacementType picks all clusters that satisfy the rules.<br></td></tr><tr><td><code>PickN</code></td><td>PickNPlacementType picks N clusters that satisfy the rules.<br></td></tr><tr><td><code>PickFixed</code></td><td>PickFixedPlacementType picks a fixed set of clusters.<br></td></tr></tbody></table><h4 id=preferredclusterselector>PreferredClusterSelector</h4><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusteraffinity>ClusterAffinity</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>weight</code> <em>integer</em></td><td>Weight associated with matching the corresponding clusterSelectorTerm, in the range [-100, 100].</td><td></td><td>Maximum: 100<br>Minimum: -100<br></td></tr><tr><td><code>preference</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterselectorterm>ClusterSelectorTerm</a></em></td><td>A cluster selector term, associated with the corresponding weight.</td><td></td><td></td></tr></tbody></table><h4 id=propertyselectoroperator>PropertySelectorOperator</h4><p><em>Underlying type:</em> <em>string</em></p><p>PropertySelectorOperator is the operator that can be used with PropertySelectorRequirements.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#propertyselectorrequirement>PropertySelectorRequirement</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Gt</code></td><td>PropertySelectorGreaterThan dictates Fleet to select cluster if its observed value of a given<br>property is greater than the value specified in the requirement.<br></td></tr><tr><td><code>Ge</code></td><td>PropertySelectorGreaterThanOrEqualTo dictates Fleet to select cluster if its observed value<br>of a given property is greater than or equal to the value specified in the requirement.<br></td></tr><tr><td><code>Eq</code></td><td>PropertySelectorEqualTo dictates Fleet to select cluster if its observed value of a given<br>property is equal to the values specified in the requirement.<br></td></tr><tr><td><code>Ne</code></td><td>PropertySelectorNotEqualTo dictates Fleet to select cluster if its observed value of a given<br>property is not equal to the values specified in the requirement.<br></td></tr><tr><td><code>Lt</code></td><td>PropertySelectorLessThan dictates Fleet to select cluster if its observed value of a given<br>property is less than the value specified in the requirement.<br></td></tr><tr><td><code>Le</code></td><td>PropertySelectorLessThanOrEqualTo dictates Fleet to select cluster if its observed value of a<br>given property is less than or equal to the value specified in the requirement.<br></td></tr></tbody></table><h4 id=propertyselectorrequirement>PropertySelectorRequirement</h4><p>PropertySelectorRequirement is a specific property requirement when picking clusters for
resource placement.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#propertyselector>PropertySelector</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>name</code> <em>string</em></td><td>Name is the name of the property; it should be a Kubernetes label name.</td><td></td><td></td></tr><tr><td><code>operator</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#propertyselectoroperator>PropertySelectorOperator</a></em></td><td>Operator specifies the relationship between a cluster&rsquo;s observed value of the specified<br>property and the values given in the requirement.</td><td></td><td></td></tr><tr><td><code>values</code> <em>string array</em></td><td>Values are a list of values of the specified property which Fleet will compare against<br>the observed values of individual member clusters in accordance with the given<br>operator.<br>At this moment, each value should be a Kubernetes quantity. For more information, see<br><a href=https://pkg.go.dev/k8s.io/apimachinery/pkg/api/resource#Quantity>https://pkg.go.dev/k8s.io/apimachinery/pkg/api/resource#Quantity</a>.<br>If the operator is Gt (greater than), Ge (greater than or equal to), Lt (less than),<br>or <code>Le</code> (less than or equal to), Eq (equal to), or Ne (ne), exactly one value must be<br>specified in the list.</td><td></td><td>MaxItems: 1<br></td></tr></tbody></table><h4 id=propertysortorder>PropertySortOrder</h4><p><em>Underlying type:</em> <em>string</em></p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#propertysorter>PropertySorter</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Descending</code></td><td>Descending instructs Fleet to sort in descending order, that is, the clusters with higher<br>observed values of a property are most preferred and should have higher weights. We will<br>use linear scaling to calculate the weight for each cluster based on the observed values.<br>For example, with this order, if Fleet sorts all clusters by a specific property where the<br>observed values are in the range [10, 100], and a weight of 100 is specified;<br>Fleet will assign:<br>* a weight of 100 to the cluster with the maximum observed value (100); and<br>* a weight of 0 to the cluster with the minimum observed value (10); and<br>* a weight of 11 to the cluster with an observed value of 20.<br>It is calculated using the formula below:<br>((20 - 10)) / (100 - 10)) * 100 = 11<br></td></tr><tr><td><code>Ascending</code></td><td>Ascending instructs Fleet to sort in ascending order, that is, the clusters with lower<br>observed values are most preferred and should have higher weights. We will use linear scaling<br>to calculate the weight for each cluster based on the observed values.<br>For example, with this order, if Fleet sorts all clusters by a specific property where<br>the observed values are in the range [10, 100], and a weight of 100 is specified;<br>Fleet will assign:<br>* a weight of 0 to the cluster with the maximum observed value (100); and<br>* a weight of 100 to the cluster with the minimum observed value (10); and<br>* a weight of 89 to the cluster with an observed value of 20.<br>It is calculated using the formula below:<br>(1 - ((20 - 10) / (100 - 10))) * 100 = 89<br></td></tr></tbody></table><h4 id=resourcebindingspec>ResourceBindingSpec</h4><p>ResourceBindingSpec defines the desired state of ClusterResourceBinding.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourcebinding>ClusterResourceBinding</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>state</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#bindingstate>BindingState</a></em></td><td>The desired state of the binding. Possible values: Scheduled, Bound, Unscheduled.</td><td></td><td></td></tr><tr><td><code>resourceSnapshotName</code> <em>string</em></td><td>ResourceSnapshotName is the name of the resource snapshot that this resource binding points to.<br>If the resources are divided into multiple snapshots because of the resource size limit,<br>it points to the name of the leading snapshot of the index group.</td><td></td><td></td></tr><tr><td><code>resourceOverrideSnapshots</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#namespacedname>NamespacedName</a> array</em></td><td>ResourceOverrideSnapshots is a list of ResourceOverride snapshots associated with the selected resources.</td><td></td><td></td></tr><tr><td><code>clusterResourceOverrideSnapshots</code> <em>string array</em></td><td>ClusterResourceOverrides contains a list of applicable ClusterResourceOverride snapshot names associated with the<br>selected resources.</td><td></td><td></td></tr><tr><td><code>schedulingPolicySnapshotName</code> <em>string</em></td><td>SchedulingPolicySnapshotName is the name of the scheduling policy snapshot that this resource binding<br>points to; more specifically, the scheduler creates this bindings in accordance with this<br>scheduling policy snapshot.</td><td></td><td></td></tr><tr><td><code>targetCluster</code> <em>string</em></td><td>TargetCluster is the name of the cluster that the scheduler assigns the resources to.</td><td></td><td></td></tr><tr><td><code>clusterDecision</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterdecision>ClusterDecision</a></em></td><td>ClusterDecision explains why the scheduler selected this cluster.</td><td></td><td></td></tr><tr><td><code>applyStrategy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#applystrategy>ApplyStrategy</a></em></td><td>ApplyStrategy describes how to resolve the conflict if the resource to be placed already exists in the target cluster<br>and is owned by other appliers.<br>This field is a beta-level feature.</td><td></td><td></td></tr></tbody></table><h4 id=resourcebindingstatus>ResourceBindingStatus</h4><p>ResourceBindingStatus represents the current status of a ClusterResourceBinding.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourcebinding>ClusterResourceBinding</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>failedPlacements</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#failedresourceplacement>FailedResourcePlacement</a> array</em></td><td>FailedPlacements is a list of all the resources failed to be placed to the given cluster or the resource is unavailable.<br>Note that we only include 100 failed resource placements even if there are more than 100.</td><td></td><td>MaxItems: 100<br></td></tr><tr><td><code>driftedPlacements</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#driftedresourceplacement>DriftedResourcePlacement</a> array</em></td><td>DriftedPlacements is a list of resources that have drifted from their desired states<br>kept in the hub cluster, as found by Fleet using the drift detection mechanism.<br>To control the object size, only the first 100 drifted resources will be included.<br>This field is only meaningful if the <code>ClusterName</code> is not empty.</td><td></td><td>MaxItems: 100<br>Optional: {}<br></td></tr><tr><td><code>diffedPlacements</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#diffedresourceplacement>DiffedResourcePlacement</a> array</em></td><td>DiffedPlacements is a list of resources that have configuration differences from their<br>corresponding hub cluster manifests. Fleet will report such differences when:<br>* The CRP uses the ReportDiff apply strategy, which instructs Fleet to compare the hub<br>cluster manifests against the live resources without actually performing any apply op; or<br>* Fleet finds a pre-existing resource on the member cluster side that does not match its<br>hub cluster counterpart, and the CRP has been configured to only take over a resource if<br>no configuration differences are found.<br>To control the object size, only the first 100 diffed resources will be included.<br>This field is only meaningful if the <code>ClusterName</code> is not empty.</td><td></td><td>MaxItems: 100<br>Optional: {}<br></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for ClusterResourceBinding.</td><td></td><td></td></tr></tbody></table><h4 id=resourcecontent>ResourceContent</h4><p>ResourceContent contains the content of a resource</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcesnapshotspec>ResourceSnapshotSpec</a></li></ul><h4 id=resourceidentifier>ResourceIdentifier</h4><p>ResourceIdentifier identifies one Kubernetes resource.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceplacementstatus>ClusterResourcePlacementStatus</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#diffedresourceplacement>DiffedResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#driftedresourceplacement>DriftedResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#failedresourceplacement>FailedResourcePlacement</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>group</code> <em>string</em></td><td>Group is the group name of the selected resource.</td><td></td><td></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version is the version of the selected resource.</td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind represents the Kind of the selected resources.</td><td></td><td></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name of the target resource.</td><td></td><td></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the resource. Empty if the resource is cluster scoped.</td><td></td><td></td></tr><tr><td><code>envelope</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#envelopeidentifier>EnvelopeIdentifier</a></em></td><td>Envelope identifies the envelope object that contains this resource.</td><td></td><td></td></tr></tbody></table><h4 id=resourceoverride>ResourceOverride</h4><p>ResourceOverride defines a group of override policies about how to override the selected namespaced scope resources
to target clusters.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceoverridelist>ResourceOverrideList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ResourceOverride</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceoverridespec>ResourceOverrideSpec</a></em></td><td>The desired state of ResourceOverrideSpec.</td><td></td><td></td></tr></tbody></table><h4 id=resourceoverridesnapshot>ResourceOverrideSnapshot</h4><p>ResourceOverrideSnapshot is used to store a snapshot of ResourceOverride.
Its spec is immutable.
We assign an ever-increasing index for snapshots.
The naming convention of a ResourceOverrideSnapshot is {ResourceOverride}-{resourceIndex}.
resourceIndex will begin with 0.
Each snapshot MUST have the following labels:</p><ul><li><code>OverrideTrackingLabel</code> which points to its owner ResourceOverride.</li><li><code>IsLatestSnapshotLabel</code> which indicates whether the snapshot is the latest one.</li></ul><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceoverridesnapshotlist>ResourceOverrideSnapshotList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ResourceOverrideSnapshot</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceoverridesnapshotspec>ResourceOverrideSnapshotSpec</a></em></td><td>The desired state of ResourceOverrideSnapshot.</td><td></td><td></td></tr></tbody></table><h4 id=resourceoverridesnapshotspec>ResourceOverrideSnapshotSpec</h4><p>ResourceOverrideSnapshotSpec defines the desired state of ResourceOverride.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceoverridesnapshot>ResourceOverrideSnapshot</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>overrideSpec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceoverridespec>ResourceOverrideSpec</a></em></td><td>OverrideSpec stores the spec of ResourceOverride.</td><td></td><td></td></tr><tr><td><code>overrideHash</code> <em>integer array</em></td><td>OverrideHash is the sha-256 hash value of the OverrideSpec field.</td><td></td><td></td></tr></tbody></table><h4 id=resourceoverridespec>ResourceOverrideSpec</h4><p>ResourceOverrideSpec defines the desired state of the Override.
The ResourceOverride create or update will fail when the resource has been selected by the existing ResourceOverride.
If the resource is selected by both ClusterResourceOverride and ResourceOverride, ResourceOverride will win when resolving
conflicts.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceoverride>ResourceOverride</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceoverridesnapshotspec>ResourceOverrideSnapshotSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>placement</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#placementref>PlacementRef</a></em></td><td>Placement defines whether the override is applied to a specific placement or not.<br>If set, the override will trigger the placement rollout immediately when the rollout strategy type is RollingUpdate.<br>Otherwise, it will be applied to the next rollout.<br>The recommended way is to set the placement so that the override can be rolled out immediately.</td><td></td><td></td></tr><tr><td><code>resourceSelectors</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceselector>ResourceSelector</a> array</em></td><td>ResourceSelectors is an array of selectors used to select namespace scoped resources. The selectors are <code>ORed</code>.<br>You can have 1-20 selectors.</td><td></td><td>MaxItems: 20<br>MinItems: 1<br>Required: {}<br></td></tr><tr><td><code>policy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#overridepolicy>OverridePolicy</a></em></td><td>Policy defines how to override the selected resources on the target clusters.</td><td></td><td></td></tr></tbody></table><h4 id=resourceplacementstatus>ResourcePlacementStatus</h4><p>ResourcePlacementStatus represents the placement status of selected resources for one target cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceplacementstatus>ClusterResourcePlacementStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>clusterName</code> <em>string</em></td><td>ClusterName is the name of the cluster this resource is assigned to.<br>If it is not empty, its value should be unique cross all placement decisions for the Placement.</td><td></td><td></td></tr><tr><td><code>applicableResourceOverrides</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#namespacedname>NamespacedName</a> array</em></td><td>ApplicableResourceOverrides contains a list of applicable ResourceOverride snapshots associated with the selected<br>resources.<br>This field is alpha-level and is for the override policy feature.</td><td></td><td></td></tr><tr><td><code>applicableClusterResourceOverrides</code> <em>string array</em></td><td>ApplicableClusterResourceOverrides contains a list of applicable ClusterResourceOverride snapshots associated with<br>the selected resources.<br>This field is alpha-level and is for the override policy feature.</td><td></td><td></td></tr><tr><td><code>failedPlacements</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#failedresourceplacement>FailedResourcePlacement</a> array</em></td><td>FailedPlacements is a list of all the resources failed to be placed to the given cluster or the resource is unavailable.<br>Note that we only include 100 failed resource placements even if there are more than 100.<br>This field is only meaningful if the <code>ClusterName</code> is not empty.</td><td></td><td>MaxItems: 100<br></td></tr><tr><td><code>driftedPlacements</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#driftedresourceplacement>DriftedResourcePlacement</a> array</em></td><td>DriftedPlacements is a list of resources that have drifted from their desired states<br>kept in the hub cluster, as found by Fleet using the drift detection mechanism.<br>To control the object size, only the first 100 drifted resources will be included.<br>This field is only meaningful if the <code>ClusterName</code> is not empty.</td><td></td><td>MaxItems: 100<br>Optional: {}<br></td></tr><tr><td><code>diffedPlacements</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#diffedresourceplacement>DiffedResourcePlacement</a> array</em></td><td>DiffedPlacements is a list of resources that have configuration differences from their<br>corresponding hub cluster manifests. Fleet will report such differences when:<br>* The CRP uses the ReportDiff apply strategy, which instructs Fleet to compare the hub<br>cluster manifests against the live resources without actually performing any apply op; or<br>* Fleet finds a pre-existing resource on the member cluster side that does not match its<br>hub cluster counterpart, and the CRP has been configured to only take over a resource if<br>no configuration differences are found.<br>To control the object size, only the first 100 diffed resources will be included.<br>This field is only meaningful if the <code>ClusterName</code> is not empty.</td><td></td><td>MaxItems: 100<br>Optional: {}<br></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for ResourcePlacementStatus.</td><td></td><td></td></tr></tbody></table><h4 id=resourcescope>ResourceScope</h4><p><em>Underlying type:</em> <em>string</em></p><p>ResourceScope defines the scope of placement reference.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#placementref>PlacementRef</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Cluster</code></td><td>ClusterScoped indicates placement is cluster-scoped.<br></td></tr><tr><td><code>Namespaced</code></td><td>NamespaceScoped indicates placement is namespace-scoped.<br></td></tr></tbody></table><h4 id=resourceselector>ResourceSelector</h4><p>ResourceSelector is used to select namespace scoped resources as the target resources to be placed.
All the fields are <code>ANDed</code>. In other words, a resource must match all the fields to be selected.
The resource namespace will inherit from the parent object scope.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourceoverridespec>ResourceOverrideSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>group</code> <em>string</em></td><td>Group name of the namespace-scoped resource.<br>Use an empty string to select resources under the core API group (e.g., services).</td><td></td><td></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version of the namespace-scoped resource.</td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind of the namespace-scoped resource.</td><td></td><td></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name of the namespace-scoped resource.</td><td></td><td></td></tr></tbody></table><h4 id=resourcesnapshotspec>ResourceSnapshotSpec</h4><p>ResourceSnapshotSpec defines the desired state of ResourceSnapshot.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourcesnapshot>ClusterResourceSnapshot</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>selectedResources</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#resourcecontent>ResourceContent</a> array</em></td><td>SelectedResources contains a list of resources selected by ResourceSelectors.</td><td></td><td></td></tr></tbody></table><h4 id=resourcesnapshotstatus>ResourceSnapshotStatus</h4><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourcesnapshot>ClusterResourceSnapshot</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for ResourceSnapshot.</td><td></td><td></td></tr></tbody></table><h4 id=rollingupdateconfig>RollingUpdateConfig</h4><p>RollingUpdateConfig contains the config to control the desired behavior of rolling update.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#rolloutstrategy>RolloutStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>maxUnavailable</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#intorstring-intstr-util>IntOrString</a></em></td><td>The maximum number of clusters that can be unavailable during the rolling update<br>comparing to the desired number of clusters.<br>The desired number equals to the <code>NumberOfClusters</code> field when the placement type is <code>PickN</code>.<br>The desired number equals to the number of clusters scheduler selected when the placement type is <code>PickAll</code>.<br>Value can be an absolute number (ex: 5) or a percentage of the desired number of clusters (ex: 10%).<br>Absolute number is calculated from percentage by rounding up.<br>We consider a resource unavailable when we either remove it from a cluster or in-place<br>upgrade the resources content on the same cluster.<br>The minimum of MaxUnavailable is 0 to allow no downtime moving a placement from one cluster to another.<br>Please set it to be greater than 0 to avoid rolling out stuck during in-place resource update.<br>Defaults to 25%.</td><td>25%</td><td>Pattern: <code>^((100|[0-9]\{1,2\})%|[0-9]+)$</code><br>XIntOrString: {}<br></td></tr><tr><td><code>maxSurge</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#intorstring-intstr-util>IntOrString</a></em></td><td>The maximum number of clusters that can be scheduled above the desired number of clusters.<br>The desired number equals to the <code>NumberOfClusters</code> field when the placement type is <code>PickN</code>.<br>The desired number equals to the number of clusters scheduler selected when the placement type is <code>PickAll</code>.<br>Value can be an absolute number (ex: 5) or a percentage of desire (ex: 10%).<br>Absolute number is calculated from percentage by rounding up.<br>This does not apply to the case that we do in-place update of resources on the same cluster.<br>This can not be 0 if MaxUnavailable is 0.<br>Defaults to 25%.</td><td>25%</td><td>Pattern: <code>^((100|[0-9]\{1,2\})%|[0-9]+)$</code><br>XIntOrString: {}<br></td></tr><tr><td><code>unavailablePeriodSeconds</code> <em>integer</em></td><td>UnavailablePeriodSeconds is used to configure the waiting time between rollout phases when we<br>cannot determine if the resources have rolled out successfully or not.<br>We have a built-in resource state detector to determine the availability status of following well-known Kubernetes<br>native resources: Deployment, StatefulSet, DaemonSet, Service, Namespace, ConfigMap, Secret,<br>ClusterRole, ClusterRoleBinding, Role, RoleBinding.<br>Please see <a href=https://github.com/Azure/fleet/tree/main/docs/concepts/SafeRollout/README.md>SafeRollout</a> for more details.<br>For other types of resources, we consider them as available after <code>UnavailablePeriodSeconds</code> seconds<br>have passed since they were successfully applied to the target cluster.<br>Default is 60.</td><td>60</td><td></td></tr></tbody></table><h4 id=rolloutstrategy>RolloutStrategy</h4><p>RolloutStrategy describes how to roll out a new change in selected resources to target clusters.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterresourceplacementspec>ClusterResourcePlacementSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>type</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#rolloutstrategytype>RolloutStrategyType</a></em></td><td>Type of rollout. The only supported type is &ldquo;RollingUpdate&rdquo;. Default is &ldquo;RollingUpdate&rdquo;.</td><td>RollingUpdate</td><td>Enum: [RollingUpdate]<br></td></tr><tr><td><code>rollingUpdate</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#rollingupdateconfig>RollingUpdateConfig</a></em></td><td>Rolling update config params. Present only if RolloutStrategyType = RollingUpdate.</td><td></td><td></td></tr><tr><td><code>applyStrategy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#applystrategy>ApplyStrategy</a></em></td><td>ApplyStrategy describes how to resolve the conflict if the resource to be placed already exists in the target cluster<br>and is owned by other appliers.<br>This field is a beta-level feature.</td><td></td><td></td></tr></tbody></table><h4 id=rolloutstrategytype>RolloutStrategyType</h4><p><em>Underlying type:</em> <em>string</em></p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#rolloutstrategy>RolloutStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>RollingUpdate</code></td><td>RollingUpdateRolloutStrategyType replaces the old placed resource using rolling update<br>i.e. gradually create the new one while replace the old ones.<br></td></tr></tbody></table><h4 id=schedulingpolicysnapshotspec>SchedulingPolicySnapshotSpec</h4><p>SchedulingPolicySnapshotSpec defines the desired state of SchedulingPolicySnapshot.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterschedulingpolicysnapshot>ClusterSchedulingPolicySnapshot</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>policy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#placementpolicy>PlacementPolicy</a></em></td><td>Policy defines how to select member clusters to place the selected resources.<br>If unspecified, all the joined member clusters are selected.</td><td></td><td></td></tr><tr><td><code>policyHash</code> <em>integer array</em></td><td>PolicyHash is the sha-256 hash value of the Policy field.</td><td></td><td></td></tr></tbody></table><h4 id=schedulingpolicysnapshotstatus>SchedulingPolicySnapshotStatus</h4><p>SchedulingPolicySnapshotStatus defines the observed state of SchedulingPolicySnapshot.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterschedulingpolicysnapshot>ClusterSchedulingPolicySnapshot</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>observedCRPGeneration</code> <em>integer</em></td><td>ObservedCRPGeneration is the generation of the CRP which the scheduler uses to perform<br>the scheduling cycle and prepare the scheduling status.</td><td></td><td></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for SchedulingPolicySnapshot.</td><td></td><td></td></tr><tr><td><code>targetClusters</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#clusterdecision>ClusterDecision</a> array</em></td><td>ClusterDecisions contains a list of names of member clusters considered by the scheduler.<br>Note that all the selected clusters must present in the list while not all the<br>member clusters are guaranteed to be listed due to the size limit. We will try to<br>add the clusters that can provide the most insight to the list first.</td><td></td><td>MaxItems: 1000<br></td></tr></tbody></table><h4 id=serversideapplyconfig>ServerSideApplyConfig</h4><p>ServerSideApplyConfig defines the configuration for server side apply.
Details: <a href=https://kubernetes.io/docs/reference/using-api/server-side-apply/#conflicts>https://kubernetes.io/docs/reference/using-api/server-side-apply/#conflicts</a></p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#applystrategy>ApplyStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>force</code> <em>boolean</em></td><td>Force represents to force apply to succeed when resolving the conflicts<br>For any conflicting fields,<br>- If true, use the values from the resource to be applied to overwrite the values of the existing resource in the<br>target cluster, as well as take over ownership of such fields.<br>- If false, apply will fail with the reason ApplyConflictWithOtherApplier.<br>For non-conflicting fields, values stay unchanged and ownership are shared between appliers.</td><td></td><td></td></tr></tbody></table><h4 id=toleration>Toleration</h4><p>Toleration allows ClusterResourcePlacement to tolerate any taint that matches
the triple &lt;key,value,effect> using the matching operator <operator>.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#placementpolicy>PlacementPolicy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>key</code> <em>string</em></td><td>Key is the taint key that the toleration applies to. Empty means match all taint keys.<br>If the key is empty, operator must be Exists; this combination means to match all values and all keys.</td><td></td><td></td></tr><tr><td><code>operator</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#tolerationoperator-v1-core>TolerationOperator</a></em></td><td>Operator represents a key&rsquo;s relationship to the value.<br>Valid operators are Exists and Equal. Defaults to Equal.<br>Exists is equivalent to wildcard for value, so that a<br>ClusterResourcePlacement can tolerate all taints of a particular category.</td><td>Equal</td><td>Enum: [Equal Exists]<br></td></tr><tr><td><code>value</code> <em>string</em></td><td>Value is the taint value the toleration matches to.<br>If the operator is Exists, the value should be empty, otherwise just a regular string.</td><td></td><td></td></tr><tr><td><code>effect</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#tainteffect-v1-core>TaintEffect</a></em></td><td>Effect indicates the taint effect to match. Empty means match all taint effects.<br>When specified, only allowed value is NoSchedule.</td><td></td><td>Enum: [NoSchedule]<br></td></tr></tbody></table><h4 id=topologyspreadconstraint>TopologySpreadConstraint</h4><p>TopologySpreadConstraint specifies how to spread resources among the given cluster topology.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#placementpolicy>PlacementPolicy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>maxSkew</code> <em>integer</em></td><td>MaxSkew describes the degree to which resources may be unevenly distributed.<br>When <code>whenUnsatisfiable=DoNotSchedule</code>, it is the maximum permitted difference<br>between the number of resource copies in the target topology and the global minimum.<br>The global minimum is the minimum number of resource copies in a domain.<br>When <code>whenUnsatisfiable=ScheduleAnyway</code>, it is used to give higher precedence<br>to topologies that satisfy it.<br>It&rsquo;s an optional field. Default value is 1 and 0 is not allowed.</td><td>1</td><td>Minimum: 1<br></td></tr><tr><td><code>topologyKey</code> <em>string</em></td><td>TopologyKey is the key of cluster labels. Clusters that have a label with this key<br>and identical values are considered to be in the same topology.<br>We consider each &lt;key, value> as a &ldquo;bucket&rdquo;, and try to put balanced number<br>of replicas of the resource into each bucket honor the <code>MaxSkew</code> value.<br>It&rsquo;s a required field.</td><td></td><td></td></tr><tr><td><code>whenUnsatisfiable</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#unsatisfiableconstraintaction>UnsatisfiableConstraintAction</a></em></td><td>WhenUnsatisfiable indicates how to deal with the resource if it doesn&rsquo;t satisfy<br>the spread constraint.<br>- DoNotSchedule (default) tells the scheduler not to schedule it.<br>- ScheduleAnyway tells the scheduler to schedule the resource in any cluster,<br>but giving higher precedence to topologies that would help reduce the skew.<br>It&rsquo;s an optional field.</td><td></td><td></td></tr></tbody></table><h4 id=unsatisfiableconstraintaction>UnsatisfiableConstraintAction</h4><p><em>Underlying type:</em> <em>string</em></p><p>UnsatisfiableConstraintAction defines the type of actions that can be taken if a constraint is not satisfied.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#topologyspreadconstraint>TopologySpreadConstraint</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>DoNotSchedule</code></td><td>DoNotSchedule instructs the scheduler not to schedule the resource<br>onto the cluster when constraints are not satisfied.<br></td></tr><tr><td><code>ScheduleAnyway</code></td><td>ScheduleAnyway instructs the scheduler to schedule the resource<br>even if constraints are not satisfied.<br></td></tr></tbody></table><h4 id=whentoapplytype>WhenToApplyType</h4><p><em>Underlying type:</em> <em>string</em></p><p>WhenToApplyType describes when Fleet would apply the manifests on the hub cluster to
the member clusters.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#applystrategy>ApplyStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Always</code></td><td>WhenToApplyTypeAlways instructs Fleet to periodically apply hub cluster manifests<br>on the member cluster side; this will effectively overwrite any change in the fields<br>managed by Fleet (i.e., specified in the hub cluster manifest).<br></td></tr><tr><td><code>IfNotDrifted</code></td><td>WhenToApplyTypeIfNotDrifted instructs Fleet to stop applying hub cluster manifests on<br>clusters that have drifted from the desired state; apply ops would still continue on<br>the rest of the clusters.<br></td></tr></tbody></table><h4 id=whentotakeovertype>WhenToTakeOverType</h4><p><em>Underlying type:</em> <em>string</em></p><p>WhenToTakeOverType describes the type of the action to take when we first apply the
resources to the member cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#applystrategy>ApplyStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>IfNoDiff</code></td><td>WhenToTakeOverTypeIfNoDiff instructs Fleet to apply a manifest with a corresponding<br>pre-existing resource on a member cluster if and only if the pre-existing resource<br>looks the same as the manifest. Should there be any inconsistency, Fleet will skip<br>the apply op; no change will be made on the resource and Fleet will not claim<br>ownership on it.<br>Note that this will not stop Fleet from processing other manifests in the same<br>placement that do not concern the takeover process (e.g., the manifests that have<br>not been created yet, or that are already under the management of Fleet).<br></td></tr><tr><td><code>Always</code></td><td>WhenToTakeOverTypeAlways instructs Fleet to always apply manifests to a member cluster,<br>even if there are some corresponding pre-existing resources. Some fields on these<br>resources might be overwritten, and Fleet will claim ownership on them.<br></td></tr><tr><td><code>Never</code></td><td>WhenToTakeOverTypeNever instructs Fleet to never apply a manifest to a member cluster<br>if there is a corresponding pre-existing resource.<br>Note that this will not stop Fleet from processing other manifests in the same placement<br>that do not concern the takeover process (e.g., the manifests that have not been created<br>yet, or that are already under the management of Fleet).<br>If you would like Fleet to stop processing manifests all together and do not assume<br>ownership on any pre-existing resources, use this option along with the ReportDiff<br>apply strategy type. This setup would instruct Fleet to touch nothing on the member<br>cluster side but still report configuration differences between the hub cluster<br>and member clusters. Fleet will not give up ownership that it has already assumed, though.<br></td></tr></tbody></table><h4 id=work>Work</h4><p>Work is the Schema for the works API.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#worklist>WorkList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>Work</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#workspec>WorkSpec</a></em></td><td>spec defines the workload of a work.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#workstatus>WorkStatus</a></em></td><td>status defines the status of each applied manifest on the spoke cluster.</td><td></td><td></td></tr></tbody></table><h4 id=worklist>WorkList</h4><p>WorkList contains a list of Work.</p><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>WorkList</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#listmeta-v1-meta>ListMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>items</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#work>Work</a> array</em></td><td>List of works.</td><td></td><td></td></tr></tbody></table><h4 id=workresourceidentifier>WorkResourceIdentifier</h4><p>WorkResourceIdentifier provides the identifiers needed to interact with any arbitrary object.
Renamed original &ldquo;ResourceIdentifier&rdquo; so that it won&rsquo;t conflict with ResourceIdentifier defined in the clusterresourceplacement_types.go.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#appliedresourcemeta>AppliedResourceMeta</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#manifestcondition>ManifestCondition</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>ordinal</code> <em>integer</em></td><td>Ordinal represents an index in manifests list, so the condition can still be linked<br>to a manifest even though manifest cannot be parsed successfully.</td><td></td><td></td></tr><tr><td><code>group</code> <em>string</em></td><td>Group is the group of the resource.</td><td></td><td></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version is the version of the resource.</td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind is the kind of the resource.</td><td></td><td></td></tr><tr><td><code>resource</code> <em>string</em></td><td>Resource is the resource type of the resource</td><td></td><td></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the resource, the resource is cluster scoped if the value<br>is empty</td><td></td><td></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name is the name of the resource</td><td></td><td></td></tr></tbody></table><h4 id=workspec>WorkSpec</h4><p>WorkSpec defines the desired state of Work.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#work>Work</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>workload</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#workloadtemplate>WorkloadTemplate</a></em></td><td>Workload represents the manifest workload to be deployed on spoke cluster</td><td></td><td></td></tr><tr><td><code>applyStrategy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#applystrategy>ApplyStrategy</a></em></td><td>ApplyStrategy describes how to resolve the conflict if the resource to be placed already exists in the target cluster<br>and is owned by other appliers.<br>This field is a beta-level feature.</td><td></td><td></td></tr></tbody></table><h4 id=workstatus>WorkStatus</h4><p>WorkStatus defines the observed state of Work.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#work>Work</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions contains the different condition statuses for this work.<br>Valid condition types are:<br>1. Applied represents workload in Work is applied successfully on the spoke cluster.<br>2. Progressing represents workload in Work in the transitioning from one state to another the on the spoke cluster.<br>3. Available represents workload in Work exists on the spoke cluster.<br>4. Degraded represents the current state of workload does not match the desired<br>state for a certain period.</td><td></td><td></td></tr><tr><td><code>manifestConditions</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#manifestcondition>ManifestCondition</a> array</em></td><td>ManifestConditions represents the conditions of each resource in work deployed on<br>spoke cluster.</td><td></td><td></td></tr></tbody></table><h4 id=workloadtemplate>WorkloadTemplate</h4><p>WorkloadTemplate represents the manifest workload to be deployed on spoke cluster</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#workspec>WorkSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>manifests</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1/#manifest>Manifest</a> array</em></td><td>Manifests represents a list of kubernetes resources to be deployed on the spoke cluster.</td><td></td><td></td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-68613d45807859d8e7bca8a9142e8162>7.4 - placement.kubernetes-fleet.io/v1beta1</h1><h1 id=api-reference>API Reference</h1><h2 id=packages>Packages</h2><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementkubernetes-fleetiov1beta1>placement.kubernetes-fleet.io/v1beta1</a></li></ul><h2 id=placementkubernetes-fleetiov1beta1>placement.kubernetes-fleet.io/v1beta1</h2><h3 id=resource-types>Resource Types</h3><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#appliedwork>AppliedWork</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#appliedworklist>AppliedWorkList</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#approvalrequest>ApprovalRequest</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterapprovalrequest>ClusterApprovalRequest</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourcebinding>ClusterResourceBinding</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceenvelope>ClusterResourceEnvelope</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceoverride>ClusterResourceOverride</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceoverridesnapshot>ClusterResourceOverrideSnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacement>ClusterResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacementdisruptionbudget>ClusterResourcePlacementDisruptionBudget</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacementeviction>ClusterResourcePlacementEviction</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacementstatus>ClusterResourcePlacementStatus</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourcesnapshot>ClusterResourceSnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterschedulingpolicysnapshot>ClusterSchedulingPolicySnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterstagedupdaterun>ClusterStagedUpdateRun</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterstagedupdatestrategy>ClusterStagedUpdateStrategy</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebinding>ResourceBinding</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceenvelope>ResourceEnvelope</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceoverride>ResourceOverride</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceoverridesnapshot>ResourceOverrideSnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceplacement>ResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcesnapshot>ResourceSnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#schedulingpolicysnapshot>SchedulingPolicySnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagedupdaterun>StagedUpdateRun</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagedupdatestrategy>StagedUpdateStrategy</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#work>Work</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#worklist>WorkList</a></li></ul><h4 id=affinity>Affinity</h4><p>Affinity is a group of cluster affinity scheduling rules. More to be added.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementpolicy>PlacementPolicy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>clusterAffinity</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusteraffinity>ClusterAffinity</a></em></td><td>ClusterAffinity contains cluster affinity scheduling rules for the selected resources.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=appliedresourcemeta>AppliedResourceMeta</h4><p>AppliedResourceMeta represents the group, version, resource, name and namespace of a resource.
Since these resources have been created, they must have valid group, version, resource, namespace, and name.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#appliedworkstatus>AppliedWorkStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>ordinal</code> <em>integer</em></td><td>Ordinal represents an index in manifests list, so the condition can still be linked<br>to a manifest even though manifest cannot be parsed successfully.</td><td></td><td></td></tr><tr><td><code>group</code> <em>string</em></td><td>Group is the group of the resource.</td><td></td><td></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version is the version of the resource.</td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind is the kind of the resource.</td><td></td><td></td></tr><tr><td><code>resource</code> <em>string</em></td><td>Resource is the resource type of the resource.</td><td></td><td></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the resource, the resource is cluster scoped if the value<br>is empty.</td><td></td><td></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name is the name of the resource.</td><td></td><td></td></tr><tr><td><code>uid</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#uid-types-pkg>UID</a></em></td><td>UID is set on successful deletion of the Kubernetes resource by controller. The<br>resource might be still visible on the managed cluster after this field is set.<br>It is not directly settable by a client.</td><td></td><td></td></tr></tbody></table><h4 id=appliedwork>AppliedWork</h4><p>AppliedWork represents an applied work on managed cluster that is placed
on a managed cluster. An appliedwork links to a work on a hub recording resources
deployed in the managed cluster.
When the agent is removed from managed cluster, cluster-admin on managed cluster
can delete appliedwork to remove resources deployed by the agent.
The name of the appliedwork must be the same as {work name}
The namespace of the appliedwork should be the same as the resource applied on
the managed cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#appliedworklist>AppliedWorkList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>AppliedWork</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#appliedworkspec>AppliedWorkSpec</a></em></td><td>Spec represents the desired configuration of AppliedWork.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#appliedworkstatus>AppliedWorkStatus</a></em></td><td>Status represents the current status of AppliedWork.</td><td></td><td></td></tr></tbody></table><h4 id=appliedworklist>AppliedWorkList</h4><p>AppliedWorkList contains a list of AppliedWork.</p><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>AppliedWorkList</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#listmeta-v1-meta>ListMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>items</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#appliedwork>AppliedWork</a> array</em></td><td>List of works.</td><td></td><td></td></tr></tbody></table><h4 id=appliedworkspec>AppliedWorkSpec</h4><p>AppliedWorkSpec represents the desired configuration of AppliedWork.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#appliedwork>AppliedWork</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>workName</code> <em>string</em></td><td>WorkName represents the name of the related work on the hub.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>workNamespace</code> <em>string</em></td><td>WorkNamespace represents the namespace of the related work on the hub.</td><td></td><td>Required: {}<br></td></tr></tbody></table><h4 id=appliedworkstatus>AppliedWorkStatus</h4><p>AppliedWorkStatus represents the current status of AppliedWork.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#appliedwork>AppliedWork</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>appliedResources</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#appliedresourcemeta>AppliedResourceMeta</a> array</em></td><td>AppliedResources represents a list of resources defined within the Work that are applied.<br>Only resources with valid GroupVersionResource, namespace, and name are suitable.<br>An item in this slice is deleted when there is no mapped manifest in Work.Spec or by finalizer.<br>The resource relating to the item will also be removed from managed cluster.<br>The deleted resource may still be present until the finalizers for that resource are finished.<br>However, the resource will not be undeleted, so it can be removed from this list and eventual consistency is preserved.</td><td></td><td></td></tr></tbody></table><h4 id=applystrategy>ApplyStrategy</h4><p>ApplyStrategy describes when and how to apply the selected resource to the target cluster.
Note: If multiple CRPs try to place the same resource with different apply strategy, the later ones will fail with the
reason ApplyConflictBetweenPlacements.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebindingspec>ResourceBindingSpec</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#rolloutstrategy>RolloutStrategy</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#updaterunstatus>UpdateRunStatus</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#workspec>WorkSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>comparisonOption</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#comparisonoptiontype>ComparisonOptionType</a></em></td><td>ComparisonOption controls how Fleet compares the desired state of a resource, as kept in<br>a hub cluster manifest, with the current state of the resource (if applicable) in the<br>member cluster.<br>Available options are:<br>* PartialComparison: with this option, Fleet will compare only fields that are managed by<br>Fleet, i.e., the fields that are specified explicitly in the hub cluster manifest.<br>Unmanaged fields are ignored. This is the default option.<br>* FullComparison: with this option, Fleet will compare all fields of the resource,<br>even if the fields are absent from the hub cluster manifest.<br>Consider using the PartialComparison option if you would like to:<br>* use the default values for certain fields; or<br>* let another agent, e.g., HPAs, VPAs, etc., on the member cluster side manage some fields; or<br>* allow ad-hoc or cluster-specific settings on the member cluster side.<br>To use the FullComparison option, it is recommended that you:<br>* specify all fields as appropriate in the hub cluster, even if you are OK with using default<br>values;<br>* make sure that no fields are managed by agents other than Fleet on the member cluster<br>side, such as HPAs, VPAs, or other controllers.<br>See the Fleet documentation for further explanations and usage examples.</td><td>PartialComparison</td><td>Enum: [PartialComparison FullComparison]<br>Optional: {}<br></td></tr><tr><td><code>whenToApply</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#whentoapplytype>WhenToApplyType</a></em></td><td>WhenToApply controls when Fleet would apply the manifests on the hub cluster to the member<br>clusters.<br>Available options are:<br>* Always: with this option, Fleet will periodically apply hub cluster manifests<br>on the member cluster side; this will effectively overwrite any change in the fields<br>managed by Fleet (i.e., specified in the hub cluster manifest). This is the default<br>option.<br>Note that this option would revert any ad-hoc changes made on the member cluster side in the<br>managed fields; if you would like to make temporary edits on the member cluster side<br>in the managed fields, switch to IfNotDrifted option. Note that changes in unmanaged<br>fields will be left alone; if you use the FullDiff compare option, such changes will<br>be reported as drifts.<br>* IfNotDrifted: with this option, Fleet will stop applying hub cluster manifests on<br>clusters that have drifted from the desired state; apply ops would still continue on<br>the rest of the clusters. Drifts are calculated using the ComparisonOption,<br>as explained in the corresponding field.<br>Use this option if you would like Fleet to detect drifts in your multi-cluster setup.<br>A drift occurs when an agent makes an ad-hoc change on the member cluster side that<br>makes affected resources deviate from its desired state as kept in the hub cluster;<br>and this option grants you an opportunity to view the drift details and take actions<br>accordingly. The drift details will be reported in the CRP status.<br>To fix a drift, you may:<br>* revert the changes manually on the member cluster side<br>* update the hub cluster manifest; this will trigger Fleet to apply the latest revision<br>of the manifests, which will overwrite the drifted fields<br>(if they are managed by Fleet)<br>* switch to the Always option; this will trigger Fleet to apply the current revision<br>of the manifests, which will overwrite the drifted fields (if they are managed by Fleet).<br>* if applicable and necessary, delete the drifted resources on the member cluster side; Fleet<br>will attempt to re-create them using the hub cluster manifests</td><td>Always</td><td>Enum: [Always IfNotDrifted]<br>Optional: {}<br></td></tr><tr><td><code>type</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#applystrategytype>ApplyStrategyType</a></em></td><td>Type is the apply strategy to use; it determines how Fleet applies manifests from the<br>hub cluster to a member cluster.<br>Available options are:<br>* ClientSideApply: Fleet uses three-way merge to apply manifests, similar to how kubectl<br>performs a client-side apply. This is the default option.<br>Note that this strategy requires that Fleet keep the last applied configuration in the<br>annotation of an applied resource. If the object gets so large that apply ops can no longer<br>be executed, Fleet will switch to server-side apply.<br>Use ComparisonOption and WhenToApply settings to control when an apply op can be executed.<br>* ServerSideApply: Fleet uses server-side apply to apply manifests; Fleet itself will<br>become the field manager for specified fields in the manifests. Specify<br>ServerSideApplyConfig as appropriate if you would like Fleet to take over field<br>ownership upon conflicts. This is the recommended option for most scenarios; it might<br>help reduce object size and safely resolve conflicts between field values. For more<br>information, please refer to the Kubernetes documentation<br>(<a href=https://kubernetes.io/docs/reference/using-api/server-side-apply/#comparison-with-client-side-apply%29>https://kubernetes.io/docs/reference/using-api/server-side-apply/#comparison-with-client-side-apply)</a>.<br>Use ComparisonOption and WhenToApply settings to control when an apply op can be executed.<br>* ReportDiff: Fleet will compare the desired state of a resource as kept in the hub cluster<br>with its current state (if applicable) on the member cluster side, and report any<br>differences. No actual apply ops would be executed, and resources will be left alone as they<br>are on the member clusters.<br>If configuration differences are found on a resource, Fleet will consider this as an apply<br>error, which might block rollout depending on the specified rollout strategy.<br>Use ComparisonOption setting to control how the difference is calculated.<br>ClientSideApply and ServerSideApply apply strategies only work when Fleet can assume<br>ownership of a resource (e.g., the resource is created by Fleet, or Fleet has taken over<br>the resource). See the comments on the WhenToTakeOver field for more information.<br>ReportDiff apply strategy, however, will function regardless of Fleet&rsquo;s ownership<br>status. One may set up a CRP with the ReportDiff strategy and the Never takeover option,<br>and this will turn Fleet into a detection tool that reports only configuration differences<br>but do not touch any resources on the member cluster side.<br>For a comparison between the different strategies and usage examples, refer to the<br>Fleet documentation.</td><td>ClientSideApply</td><td>Enum: [ClientSideApply ServerSideApply ReportDiff]<br>Optional: {}<br></td></tr><tr><td><code>allowCoOwnership</code> <em>boolean</em></td><td>AllowCoOwnership controls whether co-ownership between Fleet and other agents are allowed<br>on a Fleet-managed resource. If set to false, Fleet will refuse to apply manifests to<br>a resource that has been owned by one or more non-Fleet agents.<br>Note that Fleet does not support the case where one resource is being placed multiple<br>times by different CRPs on the same member cluster. An apply error will be returned if<br>Fleet finds that a resource has been owned by another placement attempt by Fleet, even<br>with the AllowCoOwnership setting set to true.</td><td></td><td></td></tr><tr><td><code>serverSideApplyConfig</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#serversideapplyconfig>ServerSideApplyConfig</a></em></td><td>ServerSideApplyConfig defines the configuration for server side apply. It is honored only when type is ServerSideApply.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>whenToTakeOver</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#whentotakeovertype>WhenToTakeOverType</a></em></td><td>WhenToTakeOver determines the action to take when Fleet applies resources to a member<br>cluster for the first time and finds out that the resource already exists in the cluster.<br>This setting is most relevant in cases where you would like Fleet to manage pre-existing<br>resources on a member cluster.<br>Available options include:<br>* Always: with this action, Fleet will apply the hub cluster manifests to the member<br>clusters even if the affected resources already exist. This is the default action.<br>Note that this might lead to fields being overwritten on the member clusters, if they<br>are specified in the hub cluster manifests.<br>* IfNoDiff: with this action, Fleet will apply the hub cluster manifests to the member<br>clusters if (and only if) pre-existing resources look the same as the hub cluster manifests.<br>This is a safer option as pre-existing resources that are inconsistent with the hub cluster<br>manifests will not be overwritten; Fleet will ignore them until the inconsistencies<br>are resolved properly: any change you make to the hub cluster manifests would not be<br>applied, and if you delete the manifests or even the ClusterResourcePlacement itself<br>from the hub cluster, these pre-existing resources would not be taken away.<br>Fleet will check for inconsistencies in accordance with the ComparisonOption setting. See also<br>the comments on the ComparisonOption field for more information.<br>If a diff has been found in a field that is <strong>managed</strong> by Fleet (i.e., the field<br>*<em>is specified ** in the hub cluster manifest), consider one of the following actions:<br>* set the field in the member cluster to be of the same value as that in the hub cluster<br>manifest.<br>* update the hub cluster manifest so that its field value matches with that in the member<br>cluster.<br>* switch to the Always action, which will allow Fleet to overwrite the field with the<br>value in the hub cluster manifest.<br>If a diff has been found in a field that is <strong>not managed</strong> by Fleet (i.e., the field<br><strong>is not specified</strong> in the hub cluster manifest), consider one of the following actions:<br>* remove the field from the member cluster.<br>* update the hub cluster manifest so that the field is included in the hub cluster manifest.<br>If appropriate, you may also delete the object from the member cluster; Fleet will recreate<br>it using the hub cluster manifest.<br></em>Never: with this action, Fleet will not apply a hub cluster manifest to the member<br>clusters if there is a corresponding pre-existing resource. However, if a manifest<br>has never been applied yet; or it has a corresponding resource which Fleet has assumed<br>ownership, apply op will still be executed.<br>This is the safest option; one will have to remove the pre-existing resources (so that<br>Fleet can re-create them) or switch to a different<br>WhenToTakeOver option before Fleet starts processing the corresponding hub cluster<br>manifests.<br>If you prefer Fleet stop processing all manifests, use this option along with the<br>ReportDiff apply strategy type. This setup would instruct Fleet to touch nothing<br>on the member cluster side but still report configuration differences between the<br>hub cluster and member clusters. Fleet will not give up ownership<br>that it has already assumed though.</td><td>Always</td><td>Enum: [Always IfNoDiff Never]<br>Optional: {}<br></td></tr></tbody></table><h4 id=applystrategytype>ApplyStrategyType</h4><p><em>Underlying type:</em> <em>string</em></p><p>ApplyStrategyType describes the type of the strategy used to apply the resource to the target cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#applystrategy>ApplyStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>ClientSideApply</code></td><td>ApplyStrategyTypeClientSideApply will use three-way merge patch similar to how <code>kubectl apply</code> does by storing<br>last applied state in the <code>last-applied-configuration</code> annotation.<br>When the <code>last-applied-configuration</code> annotation size is greater than 256kB, it falls back to the server-side apply.<br></td></tr><tr><td><code>ServerSideApply</code></td><td>ApplyStrategyTypeServerSideApply will use server-side apply to resolve conflicts between the resource to be placed<br>and the existing resource in the target cluster.<br>Details: <a href=https://kubernetes.io/docs/reference/using-api/server-side-apply>https://kubernetes.io/docs/reference/using-api/server-side-apply</a><br></td></tr><tr><td><code>ReportDiff</code></td><td>ApplyStrategyTypeReportDiff will report differences between the desired state of a<br>resource as kept in the hub cluster and its current state (if applicable) on the member<br>cluster side. No actual apply ops would be executed.<br></td></tr></tbody></table><h4 id=approvalrequest>ApprovalRequest</h4><p>ApprovalRequest defines a request for user approval for staged update run.
The request object MUST have the following labels:</p><ul><li><code>TargetUpdateRun</code>: Points to the staged update run that this approval request is for.</li><li><code>TargetStage</code>: The name of the stage that this approval request is for.</li><li><code>IsLatestUpdateRunApproval</code>: Indicates whether this approval request is the latest one related to this update run.</li></ul><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#approvalrequestlist>ApprovalRequestList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ApprovalRequest</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#approvalrequestspec>ApprovalRequestSpec</a></em></td><td>The desired state of ApprovalRequest.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#approvalrequeststatus>ApprovalRequestStatus</a></em></td><td>The observed state of ApprovalRequest.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=approvalrequestspec>ApprovalRequestSpec</h4><p>ApprovalRequestSpec defines the desired state of the update run approval request.
The entire spec is immutable.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#approvalrequest>ApprovalRequest</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterapprovalrequest>ClusterApprovalRequest</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>parentStageRollout</code> <em>string</em></td><td>The name of the staged update run that this approval request is for.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>targetStage</code> <em>string</em></td><td>The name of the update stage that this approval request is for.</td><td></td><td>Required: {}<br></td></tr></tbody></table><h4 id=approvalrequeststatus>ApprovalRequestStatus</h4><p>ApprovalRequestStatus defines the observed state of the ClusterApprovalRequest.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#approvalrequest>ApprovalRequest</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterapprovalrequest>ClusterApprovalRequest</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for the specific type of post-update task.<br>Known conditions are &ldquo;Approved&rdquo; and &ldquo;ApprovalAccepted&rdquo;.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=backreportedstatus>BackReportedStatus</h4><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#manifestcondition>ManifestCondition</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>observedStatus</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#rawextension-runtime-pkg>RawExtension</a></em></td><td></td><td></td><td>EmbeddedResource: {}<br></td></tr><tr><td><code>observationTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>ObservationTime is the timestamp when the status was last back reported.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr></tbody></table><h4 id=bindingstate>BindingState</h4><p><em>Underlying type:</em> <em>string</em></p><p>BindingState is the state of the binding.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebindingspec>ResourceBindingSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Scheduled</code></td><td>BindingStateScheduled means the binding is scheduled but need to be bound to the target cluster.<br></td></tr><tr><td><code>Bound</code></td><td>BindingStateBound means the binding is bound to the target cluster.<br></td></tr><tr><td><code>Unscheduled</code></td><td>BindingStateUnscheduled means the binding is not scheduled on to the target cluster anymore.<br>This is a state that rollout controller cares about.<br>The work generator still treat this as bound until rollout controller deletes the binding.<br></td></tr></tbody></table><h4 id=clusteraffinity>ClusterAffinity</h4><p>ClusterAffinity contains cluster affinity scheduling rules for the selected resources.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#affinity>Affinity</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>requiredDuringSchedulingIgnoredDuringExecution</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterselector>ClusterSelector</a></em></td><td>If the affinity requirements specified by this field are not met at<br>scheduling time, the resource will not be scheduled onto the cluster.<br>If the affinity requirements specified by this field cease to be met<br>at some point after the placement (e.g. due to an update), the system<br>may or may not try to eventually remove the resource from the cluster.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>preferredDuringSchedulingIgnoredDuringExecution</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#preferredclusterselector>PreferredClusterSelector</a> array</em></td><td>The scheduler computes a score for each cluster at schedule time by iterating<br>through the elements of this field and adding &ldquo;weight&rdquo; to the sum if the cluster<br>matches the corresponding matchExpression. The scheduler then chooses the first<br><code>N</code> clusters with the highest sum to satisfy the placement.<br>This field is ignored if the placement type is &ldquo;PickAll&rdquo;.<br>If the cluster score changes at some point after the placement (e.g. due to an update),<br>the system may or may not try to eventually move the resource from a cluster with a lower score<br>to a cluster with higher score.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=clusterapprovalrequest>ClusterApprovalRequest</h4><p>ClusterApprovalRequest defines a request for user approval for cluster staged update run.
The request object MUST have the following labels:</p><ul><li><code>TargetUpdateRun</code>: Points to the cluster staged update run that this approval request is for.</li><li><code>TargetStage</code>: The name of the stage that this approval request is for.</li><li><code>IsLatestUpdateRunApproval</code>: Indicates whether this approval request is the latest one related to this update run.</li></ul><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterapprovalrequestlist>ClusterApprovalRequestList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterApprovalRequest</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#approvalrequestspec>ApprovalRequestSpec</a></em></td><td>The desired state of ClusterApprovalRequest.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#approvalrequeststatus>ApprovalRequestStatus</a></em></td><td>The observed state of ClusterApprovalRequest.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=clusterdecision>ClusterDecision</h4><p>ClusterDecision represents a decision from a placement
An empty ClusterDecision indicates it is not scheduled yet.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebindingspec>ResourceBindingSpec</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#schedulingpolicysnapshotstatus>SchedulingPolicySnapshotStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>clusterName</code> <em>string</em></td><td>ClusterName is the name of the ManagedCluster. If it is not empty, its value should be unique cross all<br>placement decisions for the Placement.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>selected</code> <em>boolean</em></td><td>Selected indicates if this cluster is selected by the scheduler.</td><td></td><td></td></tr><tr><td><code>clusterScore</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterscore>ClusterScore</a></em></td><td>ClusterScore represents the score of the cluster calculated by the scheduler.</td><td></td><td></td></tr><tr><td><code>reason</code> <em>string</em></td><td>Reason represents the reason why the cluster is selected or not.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourcebinding>ClusterResourceBinding</h4><p>ClusterResourceBinding represents a scheduling decision that binds a group of resources to a cluster.
It MUST have a label named <code>CRPTrackingLabel</code> that points to the cluster resource policy that creates it.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourcebindinglist>ClusterResourceBindingList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourceBinding</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebindingspec>ResourceBindingSpec</a></em></td><td>The desired state of ClusterResourceBinding.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebindingstatus>ResourceBindingStatus</a></em></td><td>The observed status of ClusterResourceBinding.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceenvelope>ClusterResourceEnvelope</h4><p>ClusterResourceEnvelope wraps cluster-scoped resources for placement.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceenvelopelist>ClusterResourceEnvelopeList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourceEnvelope</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>data</code> <em>object (keys:string, values:<a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#rawextension-runtime-pkg>RawExtension</a>)</em></td><td>The manifests wrapped in this envelope.<br>Each manifest is uniquely identified by a string key, typically a filename that represents<br>the manifest. The value is the manifest object itself.</td><td></td><td>MaxProperties: 50<br>MinProperties: 1<br>Required: {}<br></td></tr></tbody></table><h4 id=clusterresourceoverride>ClusterResourceOverride</h4><p>ClusterResourceOverride defines a group of override policies about how to override the selected cluster scope resources
to target clusters.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceoverridelist>ClusterResourceOverrideList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourceOverride</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceoverridespec>ClusterResourceOverrideSpec</a></em></td><td>The desired state of ClusterResourceOverrideSpec.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceoverridesnapshot>ClusterResourceOverrideSnapshot</h4><p>ClusterResourceOverrideSnapshot is used to store a snapshot of ClusterResourceOverride.
Its spec is immutable.
We assign an ever-increasing index for snapshots.
The naming convention of a ClusterResourceOverrideSnapshot is {ClusterResourceOverride}-{resourceIndex}.
resourceIndex will begin with 0.
Each snapshot MUST have the following labels:</p><ul><li><code>OverrideTrackingLabel</code> which points to its owner ClusterResourceOverride.</li><li><code>IsLatestSnapshotLabel</code> which indicates whether the snapshot is the latest one.</li></ul><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceoverridesnapshotlist>ClusterResourceOverrideSnapshotList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourceOverrideSnapshot</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceoverridesnapshotspec>ClusterResourceOverrideSnapshotSpec</a></em></td><td>The desired state of ClusterResourceOverrideSnapshotSpec.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceoverridesnapshotspec>ClusterResourceOverrideSnapshotSpec</h4><p>ClusterResourceOverrideSnapshotSpec defines the desired state of ClusterResourceOverride.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceoverridesnapshot>ClusterResourceOverrideSnapshot</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>overrideSpec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceoverridespec>ClusterResourceOverrideSpec</a></em></td><td>OverrideSpec stores the spec of ClusterResourceOverride.</td><td></td><td></td></tr><tr><td><code>overrideHash</code> <em>integer array</em></td><td>OverrideHash is the sha-256 hash value of the OverrideSpec field.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceoverridespec>ClusterResourceOverrideSpec</h4><p>ClusterResourceOverrideSpec defines the desired state of the Override.
The ClusterResourceOverride create or update will fail when the resource has been selected by the existing ClusterResourceOverride.
If the resource is selected by both ClusterResourceOverride and ResourceOverride, ResourceOverride will win when resolving
conflicts.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceoverride>ClusterResourceOverride</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceoverridesnapshotspec>ClusterResourceOverrideSnapshotSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>placement</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementref>PlacementRef</a></em></td><td>Placement defines whether the override is applied to a specific placement or not.<br>If set, the override will trigger the placement rollout immediately when the rollout strategy type is RollingUpdate.<br>Otherwise, it will be applied to the next rollout.<br>The recommended way is to set the placement so that the override can be rolled out immediately.</td><td></td><td></td></tr><tr><td><code>clusterResourceSelectors</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceselectorterm>ResourceSelectorTerm</a> array</em></td><td>ClusterResourceSelectors is an array of selectors used to select cluster scoped resources. The selectors are <code>ORed</code>.<br>If a namespace is selected, ALL the resources under the namespace are selected automatically.<br>LabelSelector is not supported.<br>You can have 1-20 selectors.<br>We only support Name selector for now.</td><td></td><td>MaxItems: 20<br>MinItems: 1<br>Required: {}<br></td></tr><tr><td><code>policy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#overridepolicy>OverridePolicy</a></em></td><td>Policy defines how to override the selected resources on the target clusters.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceplacement>ClusterResourcePlacement</h4><p>ClusterResourcePlacement is used to select cluster scoped resources, including built-in resources and custom resources,
and placement them onto selected member clusters in a fleet.</p><p>If a namespace is selected, ALL the resources under the namespace are placed to the target clusters.
Note that you can&rsquo;t select the following resources:</p><ul><li>reserved namespaces including: default, kube-* (reserved for Kubernetes system namespaces),
fleet-* (reserved for fleet system namespaces).</li><li>reserved fleet resource types including: MemberCluster, InternalMemberCluster, ClusterResourcePlacement,
ClusterSchedulingPolicySnapshot, ClusterResourceSnapshot, ClusterResourceBinding, etc.</li></ul><p><code>ClusterSchedulingPolicySnapshot</code> and <code>ClusterResourceSnapshot</code> objects are created when there are changes in the
system to keep the history of the changes affecting a <code>ClusterResourcePlacement</code>.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacementlist>ClusterResourcePlacementList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourcePlacement</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementspec>PlacementSpec</a></em></td><td>The desired state of ClusterResourcePlacement.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementstatus>PlacementStatus</a></em></td><td>The observed status of ClusterResourcePlacement.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=clusterresourceplacementdisruptionbudget>ClusterResourcePlacementDisruptionBudget</h4><p>ClusterResourcePlacementDisruptionBudget is the policy applied to a ClusterResourcePlacement
object that specifies its disruption budget, i.e., how many placements (clusters) can be
down at the same time due to voluntary disruptions (e.g., evictions). Involuntary
disruptions are not subject to this budget, but will still count against it.</p><p>To apply a ClusterResourcePlacementDisruptionBudget to a ClusterResourcePlacement, use the
same name for the ClusterResourcePlacementDisruptionBudget object as the ClusterResourcePlacement
object. This guarantees a 1:1 link between the two objects.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacementdisruptionbudgetlist>ClusterResourcePlacementDisruptionBudgetList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourcePlacementDisruptionBudget</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementdisruptionbudgetspec>PlacementDisruptionBudgetSpec</a></em></td><td>Spec is the desired state of the ClusterResourcePlacementDisruptionBudget.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceplacementeviction>ClusterResourcePlacementEviction</h4><p>ClusterResourcePlacementEviction is an eviction attempt on a specific placement from
a ClusterResourcePlacement object; one may use this API to force the removal of specific
resources from a cluster.</p><p>An eviction is a voluntary disruption; its execution is subject to the disruption budget
linked with the target ClusterResourcePlacement object (if present).</p><p>Beware that an eviction alone does not guarantee that a placement will not re-appear; i.e.,
after an eviction, the Fleet scheduler might still pick the previous target cluster for
placement. To prevent this, considering adding proper taints to the target cluster before running
an eviction that will exclude it from future placements; this is especially true in scenarios
where one would like to perform a cluster replacement.</p><p>For safety reasons, Fleet will only execute an eviction once; the spec in this object is immutable,
and once executed, the object will be ignored after. To trigger another eviction attempt on the
same placement from the same ClusterResourcePlacement object, one must re-create (delete and
create) the same Eviction object. Note also that an Eviction object will be
ignored once it is deemed invalid (e.g., such an object might be targeting a CRP object or
a placement that does not exist yet), even if it does become valid later
(e.g., the CRP object or the placement appears later). To fix the situation, re-create the
Eviction object.</p><p>Note: Eviction of resources from a cluster propagated by a PickFixed CRP is not allowed.
If the user wants to remove resources from a cluster propagated by a PickFixed CRP simply
remove the cluster name from cluster names field from the CRP spec.</p><p>Executed evictions might be kept around for a while for auditing purposes; the Fleet controllers might
have a TTL set up for such objects and will garbage collect them automatically. For further
information, see the Fleet documentation.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacementevictionlist>ClusterResourcePlacementEvictionList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourcePlacementEviction</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementevictionspec>PlacementEvictionSpec</a></em></td><td>Spec is the desired state of the ClusterResourcePlacementEviction.<br>Note that all fields in the spec are immutable.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementevictionstatus>PlacementEvictionStatus</a></em></td><td>Status is the observed state of the ClusterResourcePlacementEviction.</td><td></td><td></td></tr></tbody></table><h4 id=clusterresourceplacementstatus>ClusterResourcePlacementStatus</h4><p>ClusterResourcePlacementStatus is a namespaced resource that mirrors the PlacementStatus of a corresponding
ClusterResourcePlacement object. This allows namespace-scoped access to cluster-scoped placement status.
The LastUpdatedTime field is updated whenever the CRPS object is updated.</p><p>This object will be created within the target namespace that contains resources being managed by the CRP.
When multiple ClusterResourcePlacements target the same namespace, each ClusterResourcePlacementStatus within that
namespace is uniquely identified by its object name, which corresponds to the specific ClusterResourcePlacement
that created it.</p><p>The name of this object should be the same as the name of the corresponding ClusterResourcePlacement.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacementstatuslist>ClusterResourcePlacementStatusList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourcePlacementStatus</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>sourceStatus</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementstatus>PlacementStatus</a></em></td><td>Source status copied from the corresponding ClusterResourcePlacement.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>lastUpdatedTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>LastUpdatedTime is the timestamp when this CRPS object was last updated.<br>This field is set to the current time whenever the CRPS object is created or modified.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr></tbody></table><h4 id=clusterresourcesnapshot>ClusterResourceSnapshot</h4><p>ClusterResourceSnapshot is used to store a snapshot of selected resources by a resource placement policy.
Its spec is immutable.
We may need to produce more than one resourceSnapshot for all the resources a ResourcePlacement selected to get around the 1MB size limit of k8s objects.
We assign an ever-increasing index for each such group of resourceSnapshots.
The naming convention of a clusterResourceSnapshot is {CRPName}-{resourceIndex}-{subindex}
where the name of the first snapshot of a group has no subindex part so its name is {CRPName}-{resourceIndex}-snapshot.
resourceIndex will begin with 0.
Each snapshot MUST have the following labels:</p><ul><li><code>CRPTrackingLabel</code> which points to its owner CRP.</li><li><code>ResourceIndexLabel</code> which is the index of the snapshot group.</li><li><code>IsLatestSnapshotLabel</code> which indicates whether the snapshot is the latest one.</li></ul><p>All the snapshots within the same index group must have the same ResourceIndexLabel.</p><p>The first snapshot of the index group MUST have the following annotations:</p><ul><li><code>NumberOfResourceSnapshotsAnnotation</code> to store the total number of resource snapshots in the index group.</li><li><code>ResourceGroupHashAnnotation</code> whose value is the sha-256 hash of all the snapshots belong to the same snapshot index.</li></ul><p>Each snapshot (excluding the first snapshot) MUST have the following annotations:</p><ul><li><code>SubindexOfResourceSnapshotAnnotation</code> to store the subindex of resource snapshot in the group.</li></ul><p>Snapshot may have the following annotations to indicate the time of next resourceSnapshot candidate detected by the controller:</p><ul><li><code>NextResourceSnapshotCandidateDetectionTimeAnnotation</code> to store the time of next resourceSnapshot candidate detected by the controller.</li></ul><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourcesnapshotlist>ClusterResourceSnapshotList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterResourceSnapshot</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcesnapshotspec>ResourceSnapshotSpec</a></em></td><td>The desired state of ResourceSnapshot.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcesnapshotstatus>ResourceSnapshotStatus</a></em></td><td>The observed status of ResourceSnapshot.</td><td></td><td></td></tr></tbody></table><h4 id=clusterschedulingpolicysnapshot>ClusterSchedulingPolicySnapshot</h4><p>ClusterSchedulingPolicySnapshot is used to store a snapshot of cluster placement policy.
Its spec is immutable.
The naming convention of a ClusterSchedulingPolicySnapshot is {CRPName}-{PolicySnapshotIndex}.
PolicySnapshotIndex will begin with 0.
Each snapshot must have the following labels:</p><ul><li><code>CRPTrackingLabel</code> which points to its owner CRP.</li><li><code>PolicyIndexLabel</code> which is the index of the policy snapshot.</li><li><code>IsLatestSnapshotLabel</code> which indicates whether the snapshot is the latest one.</li></ul><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterschedulingpolicysnapshotlist>ClusterSchedulingPolicySnapshotList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterSchedulingPolicySnapshot</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#schedulingpolicysnapshotspec>SchedulingPolicySnapshotSpec</a></em></td><td>The desired state of SchedulingPolicySnapshot.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#schedulingpolicysnapshotstatus>SchedulingPolicySnapshotStatus</a></em></td><td>The observed status of SchedulingPolicySnapshot.</td><td></td><td></td></tr></tbody></table><h4 id=clusterscore>ClusterScore</h4><p>ClusterScore represents the score of the cluster calculated by the scheduler.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterdecision>ClusterDecision</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>affinityScore</code> <em>integer</em></td><td>AffinityScore represents the affinity score of the cluster calculated by the last<br>scheduling decision based on the preferred affinity selector.<br>An affinity score may not present if the cluster does not meet the required affinity.</td><td></td><td></td></tr><tr><td><code>priorityScore</code> <em>integer</em></td><td>TopologySpreadScore represents the priority score of the cluster calculated by the last<br>scheduling decision based on the topology spread applied to the cluster.<br>A priority score may not present if the cluster does not meet the topology spread.</td><td></td><td></td></tr></tbody></table><h4 id=clusterselector>ClusterSelector</h4><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusteraffinity>ClusterAffinity</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#overriderule>OverrideRule</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>clusterSelectorTerms</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterselectorterm>ClusterSelectorTerm</a> array</em></td><td>ClusterSelectorTerms is a list of cluster selector terms. The terms are <code>ORed</code>.</td><td></td><td>MaxItems: 10<br>Required: {}<br></td></tr></tbody></table><h4 id=clusterselectorterm>ClusterSelectorTerm</h4><p><em>Underlying type:</em> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#struct%7blabelselector-*k8sioapimachinerypkgapismetav1labelselector-%22json:%5c%22labelselector,omitempty%5c%22%22;-propertyselector-*propertyselector-%22json:%5c%22propertyselector,omitempty%5c%22%22;-propertysorter-*propertysorter-%22json:%5c%22propertysorter,omitempty%5c%22%22%7d>struct{LabelSelector *k8s.io/apimachinery/pkg/apis/meta/v1.LabelSelector &ldquo;json:"labelSelector,omitempty"&rdquo;; PropertySelector *PropertySelector &ldquo;json:"propertySelector,omitempty"&rdquo;; PropertySorter *PropertySorter &ldquo;json:"propertySorter,omitempty"&rdquo;}</a></em></p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#preferredclusterselector>PreferredClusterSelector</a></li></ul><h4 id=clusterstagedupdaterun>ClusterStagedUpdateRun</h4><p>ClusterStagedUpdateRun represents a stage by stage update process that applies ClusterResourcePlacement
selected resources to specified clusters.
Resources from unselected clusters are removed after all stages in the update strategy are completed.
Each ClusterStagedUpdateRun object corresponds to a single release of a specific resource version.
The release is abandoned if the ClusterStagedUpdateRun object is deleted or the scheduling decision changes.
The name of the ClusterStagedUpdateRun must conform to RFC 1123.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterstagedupdaterunlist>ClusterStagedUpdateRunList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterStagedUpdateRun</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#updaterunspec>UpdateRunSpec</a></em></td><td>The desired state of ClusterStagedUpdateRun.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#updaterunstatus>UpdateRunStatus</a></em></td><td>The observed status of ClusterStagedUpdateRun.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=clusterstagedupdatestrategy>ClusterStagedUpdateStrategy</h4><p>ClusterStagedUpdateStrategy defines a reusable strategy that specifies the stages and the sequence
in which the selected cluster resources will be updated on the member clusters.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterstagedupdatestrategylist>ClusterStagedUpdateStrategyList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ClusterStagedUpdateStrategy</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#updatestrategyspec>UpdateStrategySpec</a></em></td><td>The desired state of ClusterStagedUpdateStrategy.</td><td></td><td>Required: {}<br></td></tr></tbody></table><h4 id=clusterupdatingstatus>ClusterUpdatingStatus</h4><p>ClusterUpdatingStatus defines the status of the update run on a cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stageupdatingstatus>StageUpdatingStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>clusterName</code> <em>string</em></td><td>The name of the cluster.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>resourceOverrideSnapshots</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#namespacedname>NamespacedName</a> array</em></td><td>ResourceOverrideSnapshots is a list of ResourceOverride snapshots associated with the cluster.<br>The list is computed at the beginning of the update run and not updated during the update run.<br>The list is empty if there are no resource overrides associated with the cluster.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>clusterResourceOverrideSnapshots</code> <em>string array</em></td><td>ClusterResourceOverrides contains a list of applicable ClusterResourceOverride snapshot names<br>associated with the cluster.<br>The list is computed at the beginning of the update run and not updated during the update run.<br>The list is empty if there are no cluster overrides associated with the cluster.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for clusters. Empty if the cluster has not started updating.<br>Known conditions are &ldquo;Started&rdquo;, &ldquo;Succeeded&rdquo;.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=comparisonoptiontype>ComparisonOptionType</h4><p><em>Underlying type:</em> <em>string</em></p><p>ComparisonOptionType describes the compare option that Fleet uses to detect drifts and/or
calculate differences.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#applystrategy>ApplyStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>PartialComparison</code></td><td>ComparisonOptionTypePartialComparison will compare only fields that are managed by Fleet, i.e.,<br>fields that are specified explicitly in the hub cluster manifest. Unmanaged fields<br>are ignored.<br></td></tr><tr><td><code>FullComparison</code></td><td>ComparisonOptionTypeFullDiff will compare all fields of the resource, even if the fields<br>are absent from the hub cluster manifest.<br></td></tr></tbody></table><h4 id=deletepropagationpolicy>DeletePropagationPolicy</h4><p><em>Underlying type:</em> <em>string</em></p><p>DeletePropagationPolicy identifies the propagation policy when a placement is deleted.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#deletestrategy>DeleteStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Abandon</code></td><td>DeletePropagationPolicyAbandon instructs Fleet to leave (abandon) all placed resources on member<br>clusters when the placement is deleted.<br></td></tr><tr><td><code>Delete</code></td><td>DeletePropagationPolicyDelete instructs Fleet to delete all placed resources on member clusters<br>when the placement is deleted. This is the default behavior.<br></td></tr></tbody></table><h4 id=deletestrategy>DeleteStrategy</h4><p>DeleteStrategy configures the deletion behavior when a placement is deleted.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#rolloutstrategy>RolloutStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>propagationPolicy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#deletepropagationpolicy>DeletePropagationPolicy</a></em></td><td>PropagationPolicy controls whether to delete placed resources when placement is deleted.<br>Available options:<br>* Delete: all placed resources on member clusters will be deleted when<br>the placement is deleted. This is the default behavior.<br>* Abandon: all placed resources on member clusters will be left intact (abandoned)<br>when the placement is deleted.</td><td>Delete</td><td>Enum: [Abandon Delete]<br>Optional: {}<br></td></tr></tbody></table><h4 id=diffdetails>DiffDetails</h4><p>DiffDetails describes the observed configuration differences.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#manifestcondition>ManifestCondition</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>observationTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>ObservationTime is the timestamp when the configuration difference was last detected.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>observedInMemberClusterGeneration</code> <em>integer</em></td><td>ObservedInMemberClusterGeneration is the generation of the applied manifest on the member<br>cluster side.<br>This might be nil if the resource has not been created yet in the member cluster.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>firstDiffedObservedTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>FirstDiffedObservedTime is the timestamp when the configuration difference<br>was first detected.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>observedDiffs</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#patchdetail>PatchDetail</a> array</em></td><td>ObservedDiffs describes each field with configuration difference as found from the<br>member cluster side.<br>Fleet might truncate the details as appropriate to control object size.<br>Each entry specifies how the live state (the state on the member cluster side) compares<br>against the desired state (the state kept in the hub cluster manifest).</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=diffedresourceplacement>DiffedResourcePlacement</h4><p>DiffedResourcePlacement contains the details of a resource with configuration differences.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#perclusterplacementstatus>PerClusterPlacementStatus</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebindingstatus>ResourceBindingStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>group</code> <em>string</em></td><td>Group is the group name of the selected resource.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version is the version of the selected resource.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind represents the Kind of the selected resources.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name of the target resource.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the resource. Empty if the resource is cluster scoped.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>envelope</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#envelopeidentifier>EnvelopeIdentifier</a></em></td><td>Envelope identifies the envelope object that contains this resource.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>observationTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>ObservationTime is the time when we observe the configuration differences for the resource.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>targetClusterObservedGeneration</code> <em>integer</em></td><td>TargetClusterObservedGeneration is the generation of the resource on the target cluster<br>that contains the configuration differences.<br>This might be nil if the resource has not been created yet on the target cluster.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>firstDiffedObservedTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>FirstDiffedObservedTime is the first time the resource on the target cluster is<br>observed to have configuration differences.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>observedDiffs</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#patchdetail>PatchDetail</a> array</em></td><td>ObservedDiffs are the details about the found configuration differences. Note that<br>Fleet might truncate the details as appropriate to control the object size.<br>Each detail entry specifies how the live state (the state on the member<br>cluster side) compares against the desired state (the state kept in the hub cluster manifest).<br>An event about the details will be emitted as well.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=driftdetails>DriftDetails</h4><p>DriftDetails describes the observed configuration drifts.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#manifestcondition>ManifestCondition</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>observationTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>ObservationTime is the timestamp when the drift was last detected.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>observedInMemberClusterGeneration</code> <em>integer</em></td><td>ObservedInMemberClusterGeneration is the generation of the applied manifest on the member<br>cluster side.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>firstDriftedObservedTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>FirstDriftedObservedTime is the timestamp when the drift was first detected.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>observedDrifts</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#patchdetail>PatchDetail</a> array</em></td><td>ObservedDrifts describes each drifted field found from the applied manifest.<br>Fleet might truncate the details as appropriate to control object size.<br>Each entry specifies how the live state (the state on the member cluster side) compares<br>against the desired state (the state kept in the hub cluster manifest).</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=driftedresourceplacement>DriftedResourcePlacement</h4><p>DriftedResourcePlacement contains the details of a resource with configuration drifts.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#perclusterplacementstatus>PerClusterPlacementStatus</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebindingstatus>ResourceBindingStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>group</code> <em>string</em></td><td>Group is the group name of the selected resource.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version is the version of the selected resource.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind represents the Kind of the selected resources.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name of the target resource.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the resource. Empty if the resource is cluster scoped.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>envelope</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#envelopeidentifier>EnvelopeIdentifier</a></em></td><td>Envelope identifies the envelope object that contains this resource.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>observationTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>ObservationTime is the time when we observe the configuration drifts for the resource.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>targetClusterObservedGeneration</code> <em>integer</em></td><td>TargetClusterObservedGeneration is the generation of the resource on the target cluster<br>that contains the configuration drifts.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>firstDriftedObservedTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>FirstDriftedObservedTime is the first time the resource on the target cluster is<br>observed to have configuration drifts.</td><td></td><td>Format: date-time<br>Required: {}<br>Type: string<br></td></tr><tr><td><code>observedDrifts</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#patchdetail>PatchDetail</a> array</em></td><td>ObservedDrifts are the details about the found configuration drifts. Note that<br>Fleet might truncate the details as appropriate to control the object size.<br>Each detail entry specifies how the live state (the state on the member<br>cluster side) compares against the desired state (the state kept in the hub cluster manifest).<br>An event about the details will be emitted as well.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=envelopeidentifier>EnvelopeIdentifier</h4><p>EnvelopeIdentifier identifies the envelope object that contains the selected resource.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#diffedresourceplacement>DiffedResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#driftedresourceplacement>DriftedResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#failedresourceplacement>FailedResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceidentifier>ResourceIdentifier</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>name</code> <em>string</em></td><td>Name of the envelope object.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the envelope object. Empty if the envelope object is cluster scoped.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>type</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#envelopetype>EnvelopeType</a></em></td><td>Type of the envelope object.</td><td>ConfigMap</td><td>Enum: [ConfigMap ClusterResourceEnvelope ResourceEnvelope]<br>Optional: {}<br></td></tr></tbody></table><h4 id=envelopetype>EnvelopeType</h4><p><em>Underlying type:</em> <em>string</em></p><p>EnvelopeType defines the type of the envelope object.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#envelopeidentifier>EnvelopeIdentifier</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>ConfigMap</code></td><td>ConfigMapEnvelopeType means the envelope object is of type <code>ConfigMap</code>.<br>TO-DO (chenyu1): drop this type after the configMap-based envelopes become obsolete.<br></td></tr><tr><td><code>ClusterResourceEnvelope</code></td><td>ClusterResourceEnvelopeType is the envelope type that represents the ClusterResourceEnvelope custom resource.<br></td></tr><tr><td><code>ResourceEnvelope</code></td><td>ResourceEnvelopeType is the envelope type that represents the ResourceEnvelope custom resource.<br></td></tr></tbody></table><h4 id=failedresourceplacement>FailedResourcePlacement</h4><p>FailedResourcePlacement contains the failure details of a failed resource placement.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#perclusterplacementstatus>PerClusterPlacementStatus</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebindingstatus>ResourceBindingStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>group</code> <em>string</em></td><td>Group is the group name of the selected resource.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version is the version of the selected resource.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind represents the Kind of the selected resources.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name of the target resource.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the resource. Empty if the resource is cluster scoped.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>envelope</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#envelopeidentifier>EnvelopeIdentifier</a></em></td><td>Envelope identifies the envelope object that contains this resource.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>condition</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a></em></td><td>The failed condition status.</td><td></td><td>Required: {}<br></td></tr></tbody></table><h4 id=jsonpatchoverride>JSONPatchOverride</h4><p>JSONPatchOverride applies a JSON patch on the selected resources following <a href=https://datatracker.ietf.org/doc/html/rfc6902>RFC 6902</a>.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#overriderule>OverrideRule</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>op</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#jsonpatchoverrideoperator>JSONPatchOverrideOperator</a></em></td><td>Operator defines the operation on the target field.</td><td></td><td>Enum: [add remove replace]<br></td></tr><tr><td><code>path</code> <em>string</em></td><td>Path defines the target location.<br>Note: override will fail if the resource path does not exist.</td><td></td><td></td></tr><tr><td><code>value</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#json-v1-apiextensions-k8s-io>JSON</a></em></td><td>Value defines the content to be applied on the target location.<br>Value should be empty when operator is <code>remove</code>.<br>We have reserved a few variables in this field that will be replaced by the actual values.<br>Those variables all start with <code>$</code> and are case sensitive.<br>Here is the list of currently supported variables:<br><code>$\{MEMBER-CLUSTER-NAME\}</code>: this will be replaced by the name of the memberCluster CR that represents this cluster.</td><td></td><td></td></tr></tbody></table><h4 id=jsonpatchoverrideoperator>JSONPatchOverrideOperator</h4><p><em>Underlying type:</em> <em>string</em></p><p>JSONPatchOverrideOperator defines the supported JSON patch operator.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#jsonpatchoverride>JSONPatchOverride</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>add</code></td><td>JSONPatchOverrideOpAdd adds the value to the target location.<br>An example target JSON document:<br>{ &ldquo;foo&rdquo;: [ &ldquo;bar&rdquo;, &ldquo;baz&rdquo; ] }<br>A JSON Patch override:<br>[<br>{ &ldquo;op&rdquo;: &ldquo;add&rdquo;, &ldquo;path&rdquo;: &ldquo;/foo/1&rdquo;, &ldquo;value&rdquo;: &ldquo;qux&rdquo; }<br>]<br>The resulting JSON document:<br>{ &ldquo;foo&rdquo;: [ &ldquo;bar&rdquo;, &ldquo;qux&rdquo;, &ldquo;baz&rdquo; ] }<br></td></tr><tr><td><code>remove</code></td><td>JSONPatchOverrideOpRemove removes the value from the target location.<br>An example target JSON document:<br>{<br>&ldquo;baz&rdquo;: &ldquo;qux&rdquo;,<br>&ldquo;foo&rdquo;: &ldquo;bar&rdquo;<br>}<br>A JSON Patch override:<br>[<br>{ &ldquo;op&rdquo;: &ldquo;remove&rdquo;, &ldquo;path&rdquo;: &ldquo;/baz&rdquo; }<br>]<br>The resulting JSON document:<br>{ &ldquo;foo&rdquo;: &ldquo;bar&rdquo; }<br></td></tr><tr><td><code>replace</code></td><td>JSONPatchOverrideOpReplace replaces the value at the target location with a new value.<br>An example target JSON document:<br>{<br>&ldquo;baz&rdquo;: &ldquo;qux&rdquo;,<br>&ldquo;foo&rdquo;: &ldquo;bar&rdquo;<br>}<br>A JSON Patch override:<br>[<br>{ &ldquo;op&rdquo;: &ldquo;replace&rdquo;, &ldquo;path&rdquo;: &ldquo;/baz&rdquo;, &ldquo;value&rdquo;: &ldquo;boo&rdquo; }<br>]<br>The resulting JSON document:<br>{<br>&ldquo;baz&rdquo;: &ldquo;boo&rdquo;,<br>&ldquo;foo&rdquo;: &ldquo;bar&rdquo;<br>}<br></td></tr></tbody></table><h4 id=manifest>Manifest</h4><p>Manifest represents a resource to be deployed on spoke cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#workloadtemplate>WorkloadTemplate</a></li></ul><h4 id=manifestcondition>ManifestCondition</h4><p>ManifestCondition represents the conditions of the resources deployed on
spoke cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#workstatus>WorkStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>identifier</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#workresourceidentifier>WorkResourceIdentifier</a></em></td><td>resourceId represents a identity of a resource linking to manifests in spec.</td><td></td><td></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions represents the conditions of this resource on spoke cluster</td><td></td><td></td></tr><tr><td><code>driftDetails</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#driftdetails>DriftDetails</a></em></td><td>DriftDetails explains about the observed configuration drifts.<br>Fleet might truncate the details as appropriate to control object size.<br>Note that configuration drifts can only occur on a resource if it is currently owned by<br>Fleet and its corresponding placement is set to use the ClientSideApply or ServerSideApply<br>apply strategy. In other words, DriftDetails and DiffDetails will not be populated<br>at the same time.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>diffDetails</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#diffdetails>DiffDetails</a></em></td><td>DiffDetails explains the details about the observed configuration differences.<br>Fleet might truncate the details as appropriate to control object size.<br>Note that configuration differences can only occur on a resource if it is not currently owned<br>by Fleet (i.e., it is a pre-existing resource that needs to be taken over), or if its<br>corresponding placement is set to use the ReportDiff apply strategy. In other words,<br>DiffDetails and DriftDetails will not be populated at the same time.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>backReportedStatus</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#backreportedstatus>BackReportedStatus</a></em></td><td>BackReportedStatus is the status reported back from the member cluster (if applicable).</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=namespacedname>NamespacedName</h4><p>NamespacedName comprises a resource name, with a mandatory namespace.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterupdatingstatus>ClusterUpdatingStatus</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#perclusterplacementstatus>PerClusterPlacementStatus</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebindingspec>ResourceBindingSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>name</code> <em>string</em></td><td>Name is the name of the namespaced scope resource.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is namespace of the namespaced scope resource.</td><td></td><td>Required: {}<br></td></tr></tbody></table><h4 id=overridepolicy>OverridePolicy</h4><p>OverridePolicy defines how to override the selected resources on the target clusters.
More is to be added.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceoverridespec>ClusterResourceOverrideSpec</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceoverridespec>ResourceOverrideSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>overrideRules</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#overriderule>OverrideRule</a> array</em></td><td>OverrideRules defines an array of override rules to be applied on the selected resources.<br>The order of the rules determines the override order.<br>When there are two rules selecting the same fields on the target cluster, the last one will win.<br>You can have 1-20 rules.</td><td></td><td>MaxItems: 20<br>MinItems: 1<br>Required: {}<br></td></tr></tbody></table><h4 id=overriderule>OverrideRule</h4><p>OverrideRule defines how to override the selected resources on the target clusters.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#overridepolicy>OverridePolicy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>clusterSelector</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterselector>ClusterSelector</a></em></td><td>ClusterSelectors selects the target clusters.<br>The resources will be overridden before applying to the matching clusters.<br>An empty clusterSelector selects ALL the member clusters.<br>A nil clusterSelector selects NO member clusters.<br>For now, only labelSelector is supported.</td><td></td><td></td></tr><tr><td><code>overrideType</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#overridetype>OverrideType</a></em></td><td>OverrideType defines the type of the override rules.</td><td>JSONPatch</td><td>Enum: [JSONPatch Delete]<br></td></tr><tr><td><code>jsonPatchOverrides</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#jsonpatchoverride>JSONPatchOverride</a> array</em></td><td>JSONPatchOverrides defines a list of JSON patch override rules.<br>This field is only allowed when OverrideType is JSONPatch.</td><td></td><td>MaxItems: 20<br>MinItems: 1<br></td></tr></tbody></table><h4 id=overridetype>OverrideType</h4><p><em>Underlying type:</em> <em>string</em></p><p>OverrideType defines the type of Override</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#overriderule>OverrideRule</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>JSONPatch</code></td><td>JSONPatchOverrideType applies a JSON patch on the selected resources following <a href=https://datatracker.ietf.org/doc/html/rfc6902>RFC 6902</a>.<br></td></tr><tr><td><code>Delete</code></td><td>DeleteOverrideType deletes the selected resources on the target clusters.<br></td></tr></tbody></table><h4 id=patchdetail>PatchDetail</h4><p>PatchDetail describes a patch that explains an observed configuration drift or
difference.</p><p>A patch detail can be transcribed as a JSON patch operation, as specified in RFC 6902.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#diffdetails>DiffDetails</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#diffedresourceplacement>DiffedResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#driftdetails>DriftDetails</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#driftedresourceplacement>DriftedResourcePlacement</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>path</code> <em>string</em></td><td>The JSON path that points to a field that has drifted or has configuration differences.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>valueInMember</code> <em>string</em></td><td>The value at the JSON path from the member cluster side.<br>This field can be empty if the JSON path does not exist on the member cluster side; i.e.,<br>applying the manifest from the hub cluster side would add a new field.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>valueInHub</code> <em>string</em></td><td>The value at the JSON path from the hub cluster side.<br>This field can be empty if the JSON path does not exist on the hub cluster side; i.e.,<br>applying the manifest from the hub cluster side would remove the field.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=perclusterplacementstatus>PerClusterPlacementStatus</h4><p>PerClusterPlacementStatus represents the placement status of selected resources for one target cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementstatus>PlacementStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>clusterName</code> <em>string</em></td><td>ClusterName is the name of the cluster this resource is assigned to.<br>If it is not empty, its value should be unique cross all placement decisions for the Placement.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>observedResourceIndex</code> <em>string</em></td><td>ObservedResourceIndex is the index of the resource snapshot that is currently being rolled out to the given cluster.<br>This field is only meaningful if the <code>ClusterName</code> is not empty.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>applicableResourceOverrides</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#namespacedname>NamespacedName</a> array</em></td><td>ApplicableResourceOverrides contains a list of applicable ResourceOverride snapshots associated with the selected<br>resources.<br>This field is alpha-level and is for the override policy feature.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>applicableClusterResourceOverrides</code> <em>string array</em></td><td>ApplicableClusterResourceOverrides contains a list of applicable ClusterResourceOverride snapshots associated with<br>the selected resources.<br>This field is alpha-level and is for the override policy feature.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>failedPlacements</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#failedresourceplacement>FailedResourcePlacement</a> array</em></td><td>FailedPlacements is a list of all the resources failed to be placed to the given cluster or the resource is unavailable.<br>Note that we only include 100 failed resource placements even if there are more than 100.<br>This field is only meaningful if the <code>ClusterName</code> is not empty.</td><td></td><td>MaxItems: 100<br>Optional: {}<br></td></tr><tr><td><code>driftedPlacements</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#driftedresourceplacement>DriftedResourcePlacement</a> array</em></td><td>DriftedPlacements is a list of resources that have drifted from their desired states<br>kept in the hub cluster, as found by Fleet using the drift detection mechanism.<br>To control the object size, only the first 100 drifted resources will be included.<br>This field is only meaningful if the <code>ClusterName</code> is not empty.</td><td></td><td>MaxItems: 100<br>Optional: {}<br></td></tr><tr><td><code>diffedPlacements</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#diffedresourceplacement>DiffedResourcePlacement</a> array</em></td><td>DiffedPlacements is a list of resources that have configuration differences from their<br>corresponding hub cluster manifests. Fleet will report such differences when:<br>* The CRP uses the ReportDiff apply strategy, which instructs Fleet to compare the hub<br>cluster manifests against the live resources without actually performing any apply op; or<br>* Fleet finds a pre-existing resource on the member cluster side that does not match its<br>hub cluster counterpart, and the CRP has been configured to only take over a resource if<br>no configuration differences are found.<br>To control the object size, only the first 100 diffed resources will be included.<br>This field is only meaningful if the <code>ClusterName</code> is not empty.</td><td></td><td>MaxItems: 100<br>Optional: {}<br></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions on the cluster.<br>Each condition corresponds to the resource snapshot at the index specified by <code>ObservedResourceIndex</code>.<br>For example, the condition of type <code>RolloutStarted</code> is observing the rollout status of the resource snapshot with index <code>ObservedResourceIndex</code>.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=placementdisruptionbudgetspec>PlacementDisruptionBudgetSpec</h4><p>PlacementDisruptionBudgetSpec is the desired state of the PlacementDisruptionBudget.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacementdisruptionbudget>ClusterResourcePlacementDisruptionBudget</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>maxUnavailable</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#intorstring-intstr-util>IntOrString</a></em></td><td>MaxUnavailable is the maximum number of placements (clusters) that can be down at the<br>same time due to voluntary disruptions. For example, a setting of 1 would imply that<br>a voluntary disruption (e.g., an eviction) can only happen if all placements (clusters)<br>from the linked Placement object are applied and available.<br>This can be either an absolute value (e.g., 1) or a percentage (e.g., 10%).<br>If a percentage is specified, Fleet will calculate the corresponding absolute values<br>as follows:<br>* if the linked Placement object is of the PickFixed placement type,<br>we don&rsquo;t perform any calculation because eviction is not allowed for PickFixed CRP.<br>* if the linked Placement object is of the PickAll placement type, MaxUnavailable cannot<br>be specified since we cannot derive the total number of clusters selected.<br>* if the linked Placement object is of the PickN placement type,<br>the percentage is against the number of clusters specified in the placement (i.e., the<br>value of the NumberOfClusters fields in the placement policy).<br>The end result will be rounded up to the nearest integer if applicable.<br>One may use a value of 0 for this field; in this case, no voluntary disruption would be<br>allowed.<br>This field is mutually exclusive with the MinAvailable field in the spec; exactly one<br>of them can be set at a time.</td><td></td><td>XIntOrString: {}<br></td></tr><tr><td><code>minAvailable</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#intorstring-intstr-util>IntOrString</a></em></td><td>MinAvailable is the minimum number of placements (clusters) that must be available at any<br>time despite voluntary disruptions. For example, a setting of 10 would imply that<br>a voluntary disruption (e.g., an eviction) can only happen if there are at least 11<br>placements (clusters) from the linked Placement object are applied and available.<br>This can be either an absolute value (e.g., 1) or a percentage (e.g., 10%).<br>If a percentage is specified, Fleet will calculate the corresponding absolute values<br>as follows:<br>* if the linked Placement object is of the PickFixed placement type,<br>we don&rsquo;t perform any calculation because eviction is not allowed for PickFixed CRP.<br>* if the linked Placement object is of the PickAll placement type, MinAvailable can be<br>specified but only as an integer since we cannot derive the total number of clusters selected.<br>* if the linked Placement object is of the PickN placement type,<br>the percentage is against the number of clusters specified in the placement (i.e., the<br>value of the NumberOfClusters fields in the placement policy).<br>The end result will be rounded up to the nearest integer if applicable.<br>One may use a value of 0 for this field; in this case, voluntary disruption would be<br>allowed at any time.<br>This field is mutually exclusive with the MaxUnavailable field in the spec; exactly one<br>of them can be set at a time.</td><td></td><td>XIntOrString: {}<br></td></tr></tbody></table><h4 id=placementevictionspec>PlacementEvictionSpec</h4><p>PlacementEvictionSpec is the desired state of the parent PlacementEviction.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacementeviction>ClusterResourcePlacementEviction</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>placementName</code> <em>string</em></td><td>PlacementName is the name of the Placement object which<br>the Eviction object targets.</td><td></td><td>MaxLength: 255<br>Required: {}<br></td></tr><tr><td><code>clusterName</code> <em>string</em></td><td>ClusterName is the name of the cluster that the Eviction object targets.</td><td></td><td>MaxLength: 255<br>Required: {}<br></td></tr></tbody></table><h4 id=placementevictionstatus>PlacementEvictionStatus</h4><p>PlacementEvictionStatus is the observed state of the parent PlacementEviction.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacementeviction>ClusterResourcePlacementEviction</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is the list of currently observed conditions for the<br>PlacementEviction object.<br>Available condition types include:<br>* Valid: whether the Eviction object is valid, i.e., it targets at a valid placement.<br>* Executed: whether the Eviction object has been executed.</td><td></td><td></td></tr></tbody></table><h4 id=placementpolicy>PlacementPolicy</h4><p>PlacementPolicy contains the rules to select target member clusters to place the selected resources.
Note that only clusters that are both joined and satisfying the rules will be selected.</p><p>You can only specify at most one of the two fields: ClusterNames and Affinity.
If none is specified, all the joined clusters are selected.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementspec>PlacementSpec</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#schedulingpolicysnapshotspec>SchedulingPolicySnapshotSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>placementType</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementtype>PlacementType</a></em></td><td>Type of placement. Can be &ldquo;PickAll&rdquo;, &ldquo;PickN&rdquo; or &ldquo;PickFixed&rdquo;. Default is PickAll.</td><td>PickAll</td><td>Enum: [PickAll PickN PickFixed]<br>Optional: {}<br></td></tr><tr><td><code>clusterNames</code> <em>string array</em></td><td>ClusterNames contains a list of names of MemberCluster to place the selected resources.<br>Only valid if the placement type is &ldquo;PickFixed&rdquo;</td><td></td><td>MaxItems: 100<br>Optional: {}<br></td></tr><tr><td><code>numberOfClusters</code> <em>integer</em></td><td>NumberOfClusters of placement. Only valid if the placement type is &ldquo;PickN&rdquo;.</td><td></td><td>Minimum: 0<br>Optional: {}<br></td></tr><tr><td><code>affinity</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#affinity>Affinity</a></em></td><td>Affinity contains cluster affinity scheduling rules. Defines which member clusters to place the selected resources.<br>Only valid if the placement type is &ldquo;PickAll&rdquo; or &ldquo;PickN&rdquo;.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>topologySpreadConstraints</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#topologyspreadconstraint>TopologySpreadConstraint</a> array</em></td><td>TopologySpreadConstraints describes how a group of resources ought to spread across multiple topology<br>domains. Scheduler will schedule resources in a way which abides by the constraints.<br>All topologySpreadConstraints are ANDed.<br>Only valid if the placement type is &ldquo;PickN&rdquo;.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>tolerations</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#toleration>Toleration</a> array</em></td><td>If specified, the ClusterResourcePlacement&rsquo;s Tolerations.<br>Tolerations cannot be updated or deleted.<br>This field is beta-level and is for the taints and tolerations feature.</td><td></td><td>MaxItems: 100<br>Optional: {}<br></td></tr></tbody></table><h4 id=placementref>PlacementRef</h4><p>PlacementRef is the reference to a placement.
For now, we only support ClusterResourcePlacement.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceoverridespec>ClusterResourceOverrideSpec</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceoverridespec>ResourceOverrideSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>name</code> <em>string</em></td><td>Name is the reference to the name of placement.</td><td></td><td></td></tr><tr><td><code>scope</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcescope>ResourceScope</a></em></td><td>Scope defines the scope of the placement.<br>A clusterResourceOverride can only reference a clusterResourcePlacement (cluster-scoped),<br>and a resourceOverride can reference either a clusterResourcePlacement or resourcePlacement (namespaced).<br>The referenced resourcePlacement must be in the same namespace as the resourceOverride.</td><td>Cluster</td><td>Enum: [Cluster Namespaced]<br></td></tr></tbody></table><h4 id=placementspec>PlacementSpec</h4><p>PlacementSpec defines the desired state of ClusterResourcePlacement and ResourcePlacement.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacement>ClusterResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceplacement>ResourcePlacement</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>resourceSelectors</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceselectorterm>ResourceSelectorTerm</a> array</em></td><td>ResourceSelectors is an array of selectors used to select cluster scoped resources. The selectors are <code>ORed</code>.<br>You can have 1-100 selectors.</td><td></td><td>MaxItems: 100<br>MinItems: 1<br>Required: {}<br></td></tr><tr><td><code>policy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementpolicy>PlacementPolicy</a></em></td><td>Policy defines how to select member clusters to place the selected resources.<br>If unspecified, all the joined member clusters are selected.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>strategy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#rolloutstrategy>RolloutStrategy</a></em></td><td>The rollout strategy to use to replace existing placement with new ones.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>revisionHistoryLimit</code> <em>integer</em></td><td>The number of old SchedulingPolicySnapshot or ResourceSnapshot resources to retain to allow rollback.<br>This is a pointer to distinguish between explicit zero and not specified.<br>Defaults to 10.</td><td>10</td><td>Maximum: 1000<br>Minimum: 1<br>Optional: {}<br></td></tr><tr><td><code>statusReportingScope</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#statusreportingscope>StatusReportingScope</a></em></td><td>StatusReportingScope controls where ClusterResourcePlacement status information is made available.<br>When set to &ldquo;ClusterScopeOnly&rdquo;, status is accessible only through the cluster-scoped ClusterResourcePlacement object.<br>When set to &ldquo;NamespaceAccessible&rdquo;, a ClusterResourcePlacementStatus object is created in the target namespace,<br>providing namespace-scoped access to the placement status alongside the cluster-scoped status. This option is only<br>supported when the ClusterResourcePlacement targets exactly one namespace.<br>Defaults to &ldquo;ClusterScopeOnly&rdquo;.</td><td>ClusterScopeOnly</td><td>Enum: [ClusterScopeOnly NamespaceAccessible]<br>Optional: {}<br></td></tr></tbody></table><h4 id=placementstatus>PlacementStatus</h4><p>PlacementStatus defines the observed status of the ClusterResourcePlacement and ResourcePlacement object.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacement>ClusterResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceplacementstatus>ClusterResourcePlacementStatus</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceplacement>ResourcePlacement</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>selectedResources</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceidentifier>ResourceIdentifier</a> array</em></td><td>SelectedResources contains a list of resources selected by ResourceSelectors.<br>This field is only meaningful if the <code>ObservedResourceIndex</code> is not empty.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>observedResourceIndex</code> <em>string</em></td><td>Resource index logically represents the generation of the selected resources.<br>We take a new snapshot of the selected resources whenever the selection or their content change.<br>Each snapshot has a different resource index.<br>One resource snapshot can contain multiple clusterResourceSnapshots CRs in order to store large amount of resources.<br>To get clusterResourceSnapshot of a given resource index, use the following command:<br><code>kubectl get ClusterResourceSnapshot --selector=kubernetes-fleet.io/resource-index=$ObservedResourceIndex</code><br>If the rollout strategy type is <code>RollingUpdate</code>, <code>ObservedResourceIndex</code> is the default-latest resource snapshot index.<br>If the rollout strategy type is <code>External</code>, rollout and version control are managed by an external controller,<br>and this field is not empty only if all targeted clusters observe the same resource index in <code>PlacementStatuses</code>.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>placementStatuses</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#perclusterplacementstatus>PerClusterPlacementStatus</a> array</em></td><td>PerClusterPlacementStatuses contains a list of placement status on the clusters that are selected by PlacementPolicy.<br>Each selected cluster according to the observed resource placement is guaranteed to have a corresponding placementStatuses.<br>In the pickN case, there are N placement statuses where N = NumberOfClusters; Or in the pickFixed case, there are<br>N placement statuses where N = ClusterNames.<br>In these cases, some of them may not have assigned clusters when we cannot fill the required number of clusters.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for ClusterResourcePlacement.<br>All conditions except <code>ClusterResourcePlacementScheduled</code> correspond to the resource snapshot at the index specified by <code>ObservedResourceIndex</code>.<br>For example, a condition of <code>ClusterResourcePlacementWorkSynchronized</code> type<br>is observing the synchronization status of the resource snapshot with index <code>ObservedResourceIndex</code>.<br>If the rollout strategy type is <code>External</code>, and <code>ObservedResourceIndex</code> is unset due to clusters reporting different resource indices,<br>conditions except <code>ClusterResourcePlacementScheduled</code> will be empty or set to Unknown.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=placementtype>PlacementType</h4><p><em>Underlying type:</em> <em>string</em></p><p>PlacementType identifies the type of placement.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementpolicy>PlacementPolicy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>PickAll</code></td><td>PickAllPlacementType picks all clusters that satisfy the rules.<br></td></tr><tr><td><code>PickN</code></td><td>PickNPlacementType picks N clusters that satisfy the rules.<br></td></tr><tr><td><code>PickFixed</code></td><td>PickFixedPlacementType picks a fixed set of clusters.<br></td></tr></tbody></table><h4 id=preferredclusterselector>PreferredClusterSelector</h4><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusteraffinity>ClusterAffinity</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>weight</code> <em>integer</em></td><td>Weight associated with matching the corresponding clusterSelectorTerm, in the range [-100, 100].</td><td></td><td>Maximum: 100<br>Minimum: -100<br>Required: {}<br></td></tr><tr><td><code>preference</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterselectorterm>ClusterSelectorTerm</a></em></td><td>A cluster selector term, associated with the corresponding weight.</td><td></td><td>Required: {}<br></td></tr></tbody></table><h4 id=propertyselectoroperator>PropertySelectorOperator</h4><p><em>Underlying type:</em> <em>string</em></p><p>PropertySelectorOperator is the operator that can be used with PropertySelectorRequirements.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#propertyselectorrequirement>PropertySelectorRequirement</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Gt</code></td><td>PropertySelectorGreaterThan dictates Fleet to select cluster if its observed value of a given<br>property is greater than the value specified in the requirement.<br></td></tr><tr><td><code>Ge</code></td><td>PropertySelectorGreaterThanOrEqualTo dictates Fleet to select cluster if its observed value<br>of a given property is greater than or equal to the value specified in the requirement.<br></td></tr><tr><td><code>Eq</code></td><td>PropertySelectorEqualTo dictates Fleet to select cluster if its observed value of a given<br>property is equal to the values specified in the requirement.<br></td></tr><tr><td><code>Ne</code></td><td>PropertySelectorNotEqualTo dictates Fleet to select cluster if its observed value of a given<br>property is not equal to the values specified in the requirement.<br></td></tr><tr><td><code>Lt</code></td><td>PropertySelectorLessThan dictates Fleet to select cluster if its observed value of a given<br>property is less than the value specified in the requirement.<br></td></tr><tr><td><code>Le</code></td><td>PropertySelectorLessThanOrEqualTo dictates Fleet to select cluster if its observed value of a<br>given property is less than or equal to the value specified in the requirement.<br></td></tr></tbody></table><h4 id=propertyselectorrequirement>PropertySelectorRequirement</h4><p>PropertySelectorRequirement is a specific property requirement when picking clusters for
resource placement.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#propertyselector>PropertySelector</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>name</code> <em>string</em></td><td>Name is the name of the property; it should be a Kubernetes label name.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>operator</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#propertyselectoroperator>PropertySelectorOperator</a></em></td><td>Operator specifies the relationship between a cluster&rsquo;s observed value of the specified<br>property and the values given in the requirement.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>values</code> <em>string array</em></td><td>Values are a list of values of the specified property which Fleet will compare against<br>the observed values of individual member clusters in accordance with the given<br>operator.<br>At this moment, each value should be a Kubernetes quantity. For more information, see<br><a href=https://pkg.go.dev/k8s.io/apimachinery/pkg/api/resource#Quantity>https://pkg.go.dev/k8s.io/apimachinery/pkg/api/resource#Quantity</a>.<br>If the operator is Gt (greater than), Ge (greater than or equal to), Lt (less than),<br>or <code>Le</code> (less than or equal to), Eq (equal to), or Ne (ne), exactly one value must be<br>specified in the list.</td><td></td><td>MaxItems: 1<br>Required: {}<br></td></tr></tbody></table><h4 id=propertysortorder>PropertySortOrder</h4><p><em>Underlying type:</em> <em>string</em></p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#propertysorter>PropertySorter</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Descending</code></td><td>Descending instructs Fleet to sort in descending order, that is, the clusters with higher<br>observed values of a property are most preferred and should have higher weights. We will<br>use linear scaling to calculate the weight for each cluster based on the observed values.<br>For example, with this order, if Fleet sorts all clusters by a specific property where the<br>observed values are in the range [10, 100], and a weight of 100 is specified;<br>Fleet will assign:<br>* a weight of 100 to the cluster with the maximum observed value (100); and<br>* a weight of 0 to the cluster with the minimum observed value (10); and<br>* a weight of 11 to the cluster with an observed value of 20.<br>It is calculated using the formula below:<br>((20 - 10)) / (100 - 10)) * 100 = 11<br></td></tr><tr><td><code>Ascending</code></td><td>Ascending instructs Fleet to sort in ascending order, that is, the clusters with lower<br>observed values are most preferred and should have higher weights. We will use linear scaling<br>to calculate the weight for each cluster based on the observed values.<br>For example, with this order, if Fleet sorts all clusters by a specific property where<br>the observed values are in the range [10, 100], and a weight of 100 is specified;<br>Fleet will assign:<br>* a weight of 0 to the cluster with the maximum observed value (100); and<br>* a weight of 100 to the cluster with the minimum observed value (10); and<br>* a weight of 89 to the cluster with an observed value of 20.<br>It is calculated using the formula below:<br>(1 - ((20 - 10) / (100 - 10))) * 100 = 89<br></td></tr></tbody></table><h4 id=reportbackdestination>ReportBackDestination</h4><p><em>Underlying type:</em> <em>string</em></p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#reportbackstrategy>ReportBackStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>OriginalResource</code></td><td>ReportBackDestinationOriginalResource implies the status fields will be copied verbatim to the<br>the original resource on the hub cluster side. This is only performed when the placement object has a<br>scheduling policy that selects exactly one member cluster (i.e., a pickFixed scheduling policy with<br>exactly one cluster name, or a pickN scheduling policy with the numberOfClusters field set to 1).<br></td></tr><tr><td><code>WorkAPI</code></td><td>ReportBackDestinationWorkAPI implies the status fields will be copied verbatim via the Work API<br>on the hub cluster side. Users may look up the status of a specific resource applied to a specific<br>member cluster by inspecting the corresponding Work object on the hub cluster side.<br></td></tr></tbody></table><h4 id=reportbackstrategy>ReportBackStrategy</h4><p>ReportBackStrategy describes how to report back the resource status from member clusters.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#rolloutstrategy>RolloutStrategy</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#workspec>WorkSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>type</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#reportbackstrategytype>ReportBackStrategyType</a></em></td><td>Type dictates the type of the report back strategy to use.<br>Available options include:<br>* Disabled: status back-reporting is disabled. This is the default behavior.<br>* Mirror: status back-reporting is enabled by copying the status fields verbatim to<br>a destination on the hub cluster side; see the Destination field for more information.</td><td>Disabled</td><td>Enum: [Disabled Mirror]<br>Required: {}<br></td></tr><tr><td><code>destination</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#reportbackdestination>ReportBackDestination</a></em></td><td>Destination dictates where to copy the status fields to when the report back strategy type is Mirror.<br>Available options include:<br>* OriginalResource: the status fields will be copied verbatim to the original resource on the hub cluster side.<br>This is only performed when the placement object has a scheduling policy that selects exactly one member cluster<br>(i.e., a pickFixed scheduling policy with exactly one cluster name, or a pickN scheduling policy with the numberOfClusters<br>field set to 1).<br>* WorkAPI: the status fields will be copied verbatim via the Work API on the hub cluster side. Users may look up<br>the status of a specific resource applied to a specific member cluster by inspecting the corresponding Work object<br>on the hub cluster side. This is the default behavior.</td><td></td><td>Enum: [OriginalResource WorkAPI]<br>Optional: {}<br></td></tr></tbody></table><h4 id=reportbackstrategytype>ReportBackStrategyType</h4><p><em>Underlying type:</em> <em>string</em></p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#reportbackstrategy>ReportBackStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Disabled</code></td><td>ReportBackStrategyTypeDisabled disables status back-reporting from the member clusters.<br></td></tr><tr><td><code>Mirror</code></td><td>ReportBackStrategyTypeMirror enables status back-reporting by<br>copying the status fields verbatim to some destination on the hub cluster side.<br></td></tr></tbody></table><h4 id=resourcebinding>ResourceBinding</h4><p>ResourceBinding represents a scheduling decision that binds a group of resources to a cluster.
It MUST have a label named <code>CRPTrackingLabel</code> that points to the resource placement that creates it.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebindinglist>ResourceBindingList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ResourceBinding</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebindingspec>ResourceBindingSpec</a></em></td><td>The desired state of ResourceBinding.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebindingstatus>ResourceBindingStatus</a></em></td><td>The observed status of ResourceBinding.</td><td></td><td></td></tr></tbody></table><h4 id=resourcebindingspec>ResourceBindingSpec</h4><p>ResourceBindingSpec defines the desired state of ClusterResourceBinding.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourcebinding>ClusterResourceBinding</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebinding>ResourceBinding</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>state</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#bindingstate>BindingState</a></em></td><td>The desired state of the binding. Possible values: Scheduled, Bound, Unscheduled.</td><td></td><td></td></tr><tr><td><code>resourceSnapshotName</code> <em>string</em></td><td>ResourceSnapshotName is the name of the resource snapshot that this resource binding points to.<br>If the resources are divided into multiple snapshots because of the resource size limit,<br>it points to the name of the leading snapshot of the index group.</td><td></td><td></td></tr><tr><td><code>resourceOverrideSnapshots</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#namespacedname>NamespacedName</a> array</em></td><td>ResourceOverrideSnapshots is a list of ResourceOverride snapshots associated with the selected resources.</td><td></td><td></td></tr><tr><td><code>clusterResourceOverrideSnapshots</code> <em>string array</em></td><td>ClusterResourceOverrides contains a list of applicable ClusterResourceOverride snapshot names associated with the<br>selected resources.</td><td></td><td></td></tr><tr><td><code>schedulingPolicySnapshotName</code> <em>string</em></td><td>SchedulingPolicySnapshotName is the name of the scheduling policy snapshot that this resource binding<br>points to; more specifically, the scheduler creates this bindings in accordance with this<br>scheduling policy snapshot.</td><td></td><td></td></tr><tr><td><code>targetCluster</code> <em>string</em></td><td>TargetCluster is the name of the cluster that the scheduler assigns the resources to.</td><td></td><td></td></tr><tr><td><code>clusterDecision</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterdecision>ClusterDecision</a></em></td><td>ClusterDecision explains why the scheduler selected this cluster.</td><td></td><td></td></tr><tr><td><code>applyStrategy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#applystrategy>ApplyStrategy</a></em></td><td>ApplyStrategy describes how to resolve the conflict if the resource to be placed already exists in the target cluster<br>and is owned by other appliers.</td><td></td><td></td></tr></tbody></table><h4 id=resourcebindingstatus>ResourceBindingStatus</h4><p>ResourceBindingStatus represents the current status of a ClusterResourceBinding.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourcebinding>ClusterResourceBinding</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcebinding>ResourceBinding</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>failedPlacements</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#failedresourceplacement>FailedResourcePlacement</a> array</em></td><td>FailedPlacements is a list of all the resources failed to be placed to the given cluster or the resource is unavailable.<br>Note that we only include 100 failed resource placements even if there are more than 100.</td><td></td><td>MaxItems: 100<br></td></tr><tr><td><code>driftedPlacements</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#driftedresourceplacement>DriftedResourcePlacement</a> array</em></td><td>DriftedPlacements is a list of resources that have drifted from their desired states<br>kept in the hub cluster, as found by Fleet using the drift detection mechanism.<br>To control the object size, only the first 100 drifted resources will be included.<br>This field is only meaningful if the <code>ClusterName</code> is not empty.</td><td></td><td>MaxItems: 100<br>Optional: {}<br></td></tr><tr><td><code>diffedPlacements</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#diffedresourceplacement>DiffedResourcePlacement</a> array</em></td><td>DiffedPlacements is a list of resources that have configuration differences from their<br>corresponding hub cluster manifests. Fleet will report such differences when:<br>* The CRP uses the ReportDiff apply strategy, which instructs Fleet to compare the hub<br>cluster manifests against the live resources without actually performing any apply op; or<br>* Fleet finds a pre-existing resource on the member cluster side that does not match its<br>hub cluster counterpart, and the CRP has been configured to only take over a resource if<br>no configuration differences are found.<br>To control the object size, only the first 100 diffed resources will be included.<br>This field is only meaningful if the <code>ClusterName</code> is not empty.</td><td></td><td>MaxItems: 100<br>Optional: {}<br></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for ClusterResourceBinding.</td><td></td><td></td></tr></tbody></table><h4 id=resourcecontent>ResourceContent</h4><p>ResourceContent contains the content of a resource</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcesnapshotspec>ResourceSnapshotSpec</a></li></ul><h4 id=resourceenvelope>ResourceEnvelope</h4><p>ResourceEnvelope wraps namespaced resources for placement.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceenvelopelist>ResourceEnvelopeList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ResourceEnvelope</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>data</code> <em>object (keys:string, values:<a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#rawextension-runtime-pkg>RawExtension</a>)</em></td><td>The manifests wrapped in this envelope.<br>Each manifest is uniquely identified by a string key, typically a filename that represents<br>the manifest. The value is the manifest object itself.</td><td></td><td>MaxProperties: 50<br>MinProperties: 1<br>Required: {}<br></td></tr></tbody></table><h4 id=resourceidentifier>ResourceIdentifier</h4><p>ResourceIdentifier identifies one Kubernetes resource.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#diffedresourceplacement>DiffedResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#driftedresourceplacement>DriftedResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#failedresourceplacement>FailedResourcePlacement</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementstatus>PlacementStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>group</code> <em>string</em></td><td>Group is the group name of the selected resource.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version is the version of the selected resource.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind represents the Kind of the selected resources.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name of the target resource.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the resource. Empty if the resource is cluster scoped.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>envelope</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#envelopeidentifier>EnvelopeIdentifier</a></em></td><td>Envelope identifies the envelope object that contains this resource.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=resourceoverride>ResourceOverride</h4><p>ResourceOverride defines a group of override policies about how to override the selected namespaced scope resources
to target clusters.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceoverridelist>ResourceOverrideList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ResourceOverride</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceoverridespec>ResourceOverrideSpec</a></em></td><td>The desired state of ResourceOverrideSpec.</td><td></td><td></td></tr></tbody></table><h4 id=resourceoverridesnapshot>ResourceOverrideSnapshot</h4><p>ResourceOverrideSnapshot is used to store a snapshot of ResourceOverride.
Its spec is immutable.
We assign an ever-increasing index for snapshots.
The naming convention of a ResourceOverrideSnapshot is {ResourceOverride}-{resourceIndex}.
resourceIndex will begin with 0.
Each snapshot MUST have the following labels:</p><ul><li><code>OverrideTrackingLabel</code> which points to its owner ResourceOverride.</li><li><code>IsLatestSnapshotLabel</code> which indicates whether the snapshot is the latest one.</li></ul><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceoverridesnapshotlist>ResourceOverrideSnapshotList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ResourceOverrideSnapshot</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceoverridesnapshotspec>ResourceOverrideSnapshotSpec</a></em></td><td>The desired state of ResourceOverrideSnapshot.</td><td></td><td></td></tr></tbody></table><h4 id=resourceoverridesnapshotspec>ResourceOverrideSnapshotSpec</h4><p>ResourceOverrideSnapshotSpec defines the desired state of ResourceOverride.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceoverridesnapshot>ResourceOverrideSnapshot</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>overrideSpec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceoverridespec>ResourceOverrideSpec</a></em></td><td>OverrideSpec stores the spec of ResourceOverride.</td><td></td><td></td></tr><tr><td><code>overrideHash</code> <em>integer array</em></td><td>OverrideHash is the sha-256 hash value of the OverrideSpec field.</td><td></td><td></td></tr></tbody></table><h4 id=resourceoverridespec>ResourceOverrideSpec</h4><p>ResourceOverrideSpec defines the desired state of the Override.
The ResourceOverride create or update will fail when the resource has been selected by the existing ResourceOverride.
If the resource is selected by both ClusterResourceOverride and ResourceOverride, ResourceOverride will win when resolving
conflicts.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceoverride>ResourceOverride</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceoverridesnapshotspec>ResourceOverrideSnapshotSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>placement</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementref>PlacementRef</a></em></td><td>Placement defines whether the override is applied to a specific placement or not.<br>If set, the override will trigger the placement rollout immediately when the rollout strategy type is RollingUpdate.<br>Otherwise, it will be applied to the next rollout.<br>The recommended way is to set the placement so that the override can be rolled out immediately.</td><td></td><td></td></tr><tr><td><code>resourceSelectors</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceselector>ResourceSelector</a> array</em></td><td>ResourceSelectors is an array of selectors used to select namespace scoped resources. The selectors are <code>ORed</code>.<br>You can have 1-20 selectors.</td><td></td><td>MaxItems: 20<br>MinItems: 1<br>Required: {}<br></td></tr><tr><td><code>policy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#overridepolicy>OverridePolicy</a></em></td><td>Policy defines how to override the selected resources on the target clusters.</td><td></td><td></td></tr></tbody></table><h4 id=resourceplacement>ResourcePlacement</h4><p>ResourcePlacement is used to select namespace scoped resources, including built-in resources and custom resources,
and placement them onto selected member clusters in a fleet.
<code>SchedulingPolicySnapshot</code> and <code>ResourceSnapshot</code> objects are created in the same namespace when there are changes in the
system to keep the history of the changes affecting a <code>ResourcePlacement</code>. We will also create <code>ResourceBinding</code> objects in the same namespace.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceplacementlist>ResourcePlacementList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ResourcePlacement</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementspec>PlacementSpec</a></em></td><td>The desired state of ResourcePlacement.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementstatus>PlacementStatus</a></em></td><td>The observed status of ResourcePlacement.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=resourcescope>ResourceScope</h4><p><em>Underlying type:</em> <em>string</em></p><p>ResourceScope defines the scope of placement reference.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementref>PlacementRef</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Cluster</code></td><td>ClusterScoped indicates placement is cluster-scoped.<br></td></tr><tr><td><code>Namespaced</code></td><td>NamespaceScoped indicates placement is namespace-scoped.<br></td></tr></tbody></table><h4 id=resourceselector>ResourceSelector</h4><p>ResourceSelector is used to select namespace scoped resources as the target resources to be placed.
All the fields are <code>ANDed</code>. In other words, a resource must match all the fields to be selected.
The resource namespace will inherit from the parent object scope.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceoverridespec>ResourceOverrideSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>group</code> <em>string</em></td><td>Group name of the namespace-scoped resource.<br>Use an empty string to select resources under the core API group (e.g., services).</td><td></td><td></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version of the namespace-scoped resource.</td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind of the namespace-scoped resource.</td><td></td><td></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name of the namespace-scoped resource.</td><td></td><td></td></tr></tbody></table><h4 id=resourceselectorterm>ResourceSelectorTerm</h4><p>ResourceSelectorTerm is used to select resources as the target resources to be placed.
All the fields are <code>ANDed</code>. In other words, a resource must match all the fields to be selected.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourceoverridespec>ClusterResourceOverrideSpec</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementspec>PlacementSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>group</code> <em>string</em></td><td>Group name of the be selected resource.<br>Use an empty string to select resources under the core API group (e.g., namespaces).</td><td></td><td>Required: {}<br></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version of the to be selected resource.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind of the to be selected resource.<br>Note: When <code>Kind</code> is <code>namespace</code>, by default ALL the resources under the selected namespaces are selected.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name of the be selected resource.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>labelSelector</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#labelselector-v1-meta>LabelSelector</a></em></td><td>A label query over all the be selected resources. Resources matching the query are selected.<br>Note that namespace-scoped resources can&rsquo;t be selected even if they match the query.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>selectionScope</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#selectionscope>SelectionScope</a></em></td><td>SelectionScope defines the scope of resource selections when the Kind is <code>namespace</code>.</td><td>NamespaceWithResources</td><td>Enum: [NamespaceOnly NamespaceWithResources]<br>Optional: {}<br></td></tr></tbody></table><h4 id=resourcesnapshot>ResourceSnapshot</h4><p>ResourceSnapshot is used to store a snapshot of selected resources by a resource placement policy.
Its spec is immutable.
We may need to produce more than one resourceSnapshot for all the resources a ResourcePlacement selected to get around the 1MB size limit of k8s objects.
We assign an ever-increasing index for each such group of resourceSnapshots.
The naming convention of a resourceSnapshot is {RPName}-{resourceIndex}-{subindex}
where the name of the first snapshot of a group has no subindex part so its name is {RPName}-{resourceIndex}-snapshot.
resourceIndex will begin with 0.
Each snapshot MUST have the following labels:</p><ul><li><code>CRPTrackingLabel</code> which points to its owner resource placement.</li><li><code>ResourceIndexLabel</code> which is the index of the snapshot group.</li></ul><p>The first snapshot of the index group MAY have the following labels:</p><ul><li><code>IsLatestSnapshotLabel</code> which indicates whether the snapshot is the latest one.</li></ul><p>All the snapshots within the same index group must have the same ResourceIndexLabel.</p><p>The first snapshot of the index group MUST have the following annotations:</p><ul><li><code>NumberOfResourceSnapshotsAnnotation</code> to store the total number of resource snapshots in the index group.</li><li><code>ResourceGroupHashAnnotation</code> whose value is the sha-256 hash of all the snapshots belong to the same snapshot index.</li></ul><p>Each snapshot (excluding the first snapshot) MUST have the following annotations:</p><ul><li><code>SubindexOfResourceSnapshotAnnotation</code> to store the subindex of resource snapshot in the group.</li></ul><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcesnapshotlist>ResourceSnapshotList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>ResourceSnapshot</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcesnapshotspec>ResourceSnapshotSpec</a></em></td><td>The desired state of ResourceSnapshot.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcesnapshotstatus>ResourceSnapshotStatus</a></em></td><td>The observed status of ResourceSnapshot.</td><td></td><td></td></tr></tbody></table><h4 id=resourcesnapshotspec>ResourceSnapshotSpec</h4><p>ResourceSnapshotSpec defines the desired state of ResourceSnapshot.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourcesnapshot>ClusterResourceSnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcesnapshot>ResourceSnapshot</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>selectedResources</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcecontent>ResourceContent</a> array</em></td><td>SelectedResources contains a list of resources selected by ResourceSelectors.</td><td></td><td></td></tr></tbody></table><h4 id=resourcesnapshotstatus>ResourceSnapshotStatus</h4><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterresourcesnapshot>ClusterResourceSnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourcesnapshot>ResourceSnapshot</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for ResourceSnapshot.</td><td></td><td></td></tr></tbody></table><h4 id=rollingupdateconfig>RollingUpdateConfig</h4><p>RollingUpdateConfig contains the config to control the desired behavior of rolling update.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#rolloutstrategy>RolloutStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>maxUnavailable</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#intorstring-intstr-util>IntOrString</a></em></td><td>The maximum number of clusters that can be unavailable during the rolling update<br>comparing to the desired number of clusters.<br>The desired number equals to the <code>NumberOfClusters</code> field when the placement type is <code>PickN</code>.<br>The desired number equals to the number of clusters scheduler selected when the placement type is <code>PickAll</code>.<br>Value can be an absolute number (ex: 5) or a percentage of the desired number of clusters (ex: 10%).<br>Absolute number is calculated from percentage by rounding up.<br>We consider a resource unavailable when we either remove it from a cluster or in-place<br>upgrade the resources content on the same cluster.<br>The minimum of MaxUnavailable is 0 to allow no downtime moving a placement from one cluster to another.<br>Please set it to be greater than 0 to avoid rolling out stuck during in-place resource update.<br>Defaults to 25%.</td><td>25%</td><td>Optional: {}<br>Pattern: <code>^((100|[0-9]\{1,2\})%|[0-9]+)$</code><br>XIntOrString: {}<br></td></tr><tr><td><code>maxSurge</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#intorstring-intstr-util>IntOrString</a></em></td><td>The maximum number of clusters that can be scheduled above the desired number of clusters.<br>The desired number equals to the <code>NumberOfClusters</code> field when the placement type is <code>PickN</code>.<br>The desired number equals to the number of clusters scheduler selected when the placement type is <code>PickAll</code>.<br>Value can be an absolute number (ex: 5) or a percentage of desire (ex: 10%).<br>Absolute number is calculated from percentage by rounding up.<br>This does not apply to the case that we do in-place update of resources on the same cluster.<br>This can not be 0 if MaxUnavailable is 0.<br>Defaults to 25%.</td><td>25%</td><td>Optional: {}<br>Pattern: <code>^((100|[0-9]\{1,2\})%|[0-9]+)$</code><br>XIntOrString: {}<br></td></tr><tr><td><code>unavailablePeriodSeconds</code> <em>integer</em></td><td>UnavailablePeriodSeconds is used to configure the waiting time between rollout phases when we<br>cannot determine if the resources have rolled out successfully or not.<br>We have a built-in resource state detector to determine the availability status of following well-known Kubernetes<br>native resources: Deployment, StatefulSet, DaemonSet, Service, Namespace, ConfigMap, Secret,<br>ClusterRole, ClusterRoleBinding, Role, RoleBinding.<br>Please see <a href=https://github.com/Azure/fleet/tree/main/docs/concepts/SafeRollout/README.md>SafeRollout</a> for more details.<br>For other types of resources, we consider them as available after <code>UnavailablePeriodSeconds</code> seconds<br>have passed since they were successfully applied to the target cluster.<br>Default is 60.</td><td>60</td><td>Optional: {}<br></td></tr></tbody></table><h4 id=rolloutstrategy>RolloutStrategy</h4><p>RolloutStrategy describes how to roll out a new change in selected resources to target clusters.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementspec>PlacementSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>type</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#rolloutstrategytype>RolloutStrategyType</a></em></td><td>Type of rollout. The only supported types are &ldquo;RollingUpdate&rdquo; and &ldquo;External&rdquo;.<br>Default is &ldquo;RollingUpdate&rdquo;.</td><td>RollingUpdate</td><td>Enum: [RollingUpdate External]<br>Optional: {}<br></td></tr><tr><td><code>rollingUpdate</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#rollingupdateconfig>RollingUpdateConfig</a></em></td><td>Rolling update config params. Present only if RolloutStrategyType = RollingUpdate.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>applyStrategy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#applystrategy>ApplyStrategy</a></em></td><td>ApplyStrategy describes when and how to apply the selected resources to the target cluster.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>deleteStrategy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#deletestrategy>DeleteStrategy</a></em></td><td>DeleteStrategy configures the deletion behavior when the ClusterResourcePlacement is deleted.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>reportBackStrategy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#reportbackstrategy>ReportBackStrategy</a></em></td><td>ReportBackStrategy describes how to report back the status of applied resources on the member cluster.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=rolloutstrategytype>RolloutStrategyType</h4><p><em>Underlying type:</em> <em>string</em></p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#rolloutstrategy>RolloutStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>RollingUpdate</code></td><td>RollingUpdateRolloutStrategyType replaces the old placed resource using rolling update<br>i.e. gradually create the new one while replace the old ones.<br></td></tr><tr><td><code>External</code></td><td>ExternalRolloutStrategyType means there is an external rollout controller that will<br>handle the rollout of the resources.<br></td></tr></tbody></table><h4 id=schedulingpolicysnapshot>SchedulingPolicySnapshot</h4><p>SchedulingPolicySnapshot is used to store a snapshot of cluster placement policy.
Its spec is immutable.
The naming convention of a SchedulingPolicySnapshot is {RPName}-{PolicySnapshotIndex}.
PolicySnapshotIndex will begin with 0.
Each snapshot must have the following labels:</p><ul><li><code>CRPTrackingLabel</code> which points to its placement owner.</li><li><code>PolicyIndexLabel</code> which is the index of the policy snapshot.</li><li><code>IsLatestSnapshotLabel</code> which indicates whether the snapshot is the latest one.</li></ul><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#schedulingpolicysnapshotlist>SchedulingPolicySnapshotList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>SchedulingPolicySnapshot</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#schedulingpolicysnapshotspec>SchedulingPolicySnapshotSpec</a></em></td><td>The desired state of SchedulingPolicySnapshot.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#schedulingpolicysnapshotstatus>SchedulingPolicySnapshotStatus</a></em></td><td>The observed status of SchedulingPolicySnapshot.</td><td></td><td></td></tr></tbody></table><h4 id=schedulingpolicysnapshotspec>SchedulingPolicySnapshotSpec</h4><p>SchedulingPolicySnapshotSpec defines the desired state of SchedulingPolicySnapshot.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterschedulingpolicysnapshot>ClusterSchedulingPolicySnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#schedulingpolicysnapshot>SchedulingPolicySnapshot</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>policy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementpolicy>PlacementPolicy</a></em></td><td>Policy defines how to select member clusters to place the selected resources.<br>If unspecified, all the joined member clusters are selected.</td><td></td><td></td></tr><tr><td><code>policyHash</code> <em>integer array</em></td><td>PolicyHash is the sha-256 hash value of the Policy field.</td><td></td><td></td></tr></tbody></table><h4 id=schedulingpolicysnapshotstatus>SchedulingPolicySnapshotStatus</h4><p>SchedulingPolicySnapshotStatus defines the observed state of SchedulingPolicySnapshot.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterschedulingpolicysnapshot>ClusterSchedulingPolicySnapshot</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#schedulingpolicysnapshot>SchedulingPolicySnapshot</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>observedCRPGeneration</code> <em>integer</em></td><td>ObservedCRPGeneration is the generation of the resource placement which the scheduler uses to perform<br>the scheduling cycle and prepare the scheduling status.</td><td></td><td></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for SchedulingPolicySnapshot.</td><td></td><td></td></tr><tr><td><code>targetClusters</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterdecision>ClusterDecision</a> array</em></td><td>ClusterDecisions contains a list of names of member clusters considered by the scheduler.<br>Note that all the selected clusters must present in the list while not all the<br>member clusters are guaranteed to be listed due to the size limit. We will try to<br>add the clusters that can provide the most insight to the list first.</td><td></td><td>MaxItems: 1000<br></td></tr></tbody></table><h4 id=selectionscope>SelectionScope</h4><p><em>Underlying type:</em> <em>string</em></p><p>SelectionScope defines the scope of resource selections.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#resourceselectorterm>ResourceSelectorTerm</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>NamespaceOnly</code></td><td>NamespaceOnly means only the namespace itself is selected.<br></td></tr><tr><td><code>NamespaceWithResources</code></td><td>NamespaceWithResources means all the resources under the namespace including namespace itself are selected.<br></td></tr></tbody></table><h4 id=serversideapplyconfig>ServerSideApplyConfig</h4><p>ServerSideApplyConfig defines the configuration for server side apply.
Details: <a href=https://kubernetes.io/docs/reference/using-api/server-side-apply/#conflicts>https://kubernetes.io/docs/reference/using-api/server-side-apply/#conflicts</a></p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#applystrategy>ApplyStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>force</code> <em>boolean</em></td><td>Force represents to force apply to succeed when resolving the conflicts<br>For any conflicting fields,<br>- If true, use the values from the resource to be applied to overwrite the values of the existing resource in the<br>target cluster, as well as take over ownership of such fields.<br>- If false, apply will fail with the reason ApplyConflictWithOtherApplier.<br>For non-conflicting fields, values stay unchanged and ownership are shared between appliers.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=stageconfig>StageConfig</h4><p>StageConfig describes a single update stage.
The clusters in each stage are updated sequentially.
The update stops if any of the updates fail.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#updatestrategyspec>UpdateStrategySpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>name</code> <em>string</em></td><td>The name of the stage. This MUST be unique within the same StagedUpdateStrategy.</td><td></td><td>MaxLength: 63<br>Pattern: <code>^[a-z0-9]+$</code><br>Required: {}<br></td></tr><tr><td><code>labelSelector</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#labelselector-v1-meta>LabelSelector</a></em></td><td>LabelSelector is a label query over all the joined member clusters. Clusters matching the query are selected<br>for this stage. There cannot be overlapping clusters between stages when the stagedUpdateRun is created.<br>If the label selector is empty, the stage includes all the selected clusters.<br>If the label selector is nil, the stage does not include any selected clusters.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>sortingLabelKey</code> <em>string</em></td><td>The label key used to sort the selected clusters.<br>The clusters within the stage are updated sequentially following the rule below:<br>- primary: Ascending order based on the value of the label key, interpreted as integers if present.<br>- secondary: Ascending order based on the name of the cluster if the label key is absent or the label value is the same.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>maxConcurrency</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#intorstring-intstr-util>IntOrString</a></em></td><td>MaxConcurrency specifies the maximum number of clusters that can be updated concurrently within this stage.<br>Value can be an absolute number (ex: 5) or a percentage of the total clusters in the stage (ex: 50%).<br>Fractional results are rounded down. A minimum of 1 update is enforced.<br>If not specified, all clusters in the stage are updated sequentially (effectively maxConcurrency = 1).<br>Defaults to 1.</td><td>1</td><td>Optional: {}<br>Pattern: <code>^(100|[1-9][0-9]?)%$</code><br>XIntOrString: {}<br></td></tr><tr><td><code>afterStageTasks</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagetask>StageTask</a> array</em></td><td>The collection of tasks that each stage needs to complete successfully before moving to the next stage.<br>Each task is executed in parallel and there cannot be more than one task of the same type.</td><td></td><td>MaxItems: 2<br>Optional: {}<br></td></tr><tr><td><code>beforeStageTasks</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagetask>StageTask</a> array</em></td><td>The collection of tasks that needs to completed successfully by each stage before starting the stage.<br>Each task is executed in parallel and there cannot be more than one task of the same type.</td><td></td><td>MaxItems: 1<br>Optional: {}<br></td></tr></tbody></table><h4 id=stagetask>StageTask</h4><p>StageTask is the pre or post stage task that needs to be completed before starting or moving to the next stage.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stageconfig>StageConfig</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>type</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagetasktype>StageTaskType</a></em></td><td>The type of the before or after stage task.</td><td></td><td>Enum: [TimedWait Approval]<br>Required: {}<br></td></tr><tr><td><code>waitTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#duration-v1-meta>Duration</a></em></td><td>The time to wait after all the clusters in the current stage complete the update before moving to the next stage.</td><td></td><td>Optional: {}<br>Pattern: <code>^0|([0-9]+(\.[0-9]+)?(s|m|h))+$</code><br>Type: string<br></td></tr></tbody></table><h4 id=stagetaskstatus>StageTaskStatus</h4><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stageupdatingstatus>StageUpdatingStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>type</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagetasktype>StageTaskType</a></em></td><td>The type of the pre or post update task.</td><td></td><td>Enum: [TimedWait Approval]<br>Required: {}<br></td></tr><tr><td><code>approvalRequestName</code> <em>string</em></td><td>The name of the approval request object that is created for this stage.<br>Only valid if the AfterStageTaskType is Approval.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for the specific type of pre or post update task.<br>Known conditions are &ldquo;ApprovalRequestCreated&rdquo;, &ldquo;WaitTimeElapsed&rdquo;, and &ldquo;ApprovalRequestApproved&rdquo;.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=stagetasktype>StageTaskType</h4><p><em>Underlying type:</em> <em>string</em></p><p>StageTaskType identifies a specific type of the AfterStageTask or BeforeStageTask.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagetask>StageTask</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagetaskstatus>StageTaskStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>TimedWait</code></td><td>StageTaskTypeTimedWait indicates the stage task is a timed wait.<br></td></tr><tr><td><code>Approval</code></td><td>StageTaskTypeApproval indicates the stage task is an approval.<br></td></tr></tbody></table><h4 id=stageupdatingstatus>StageUpdatingStatus</h4><p>StageUpdatingStatus defines the status of the update run in a stage.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#updaterunstatus>UpdateRunStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>stageName</code> <em>string</em></td><td>The name of the stage.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>clusters</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterupdatingstatus>ClusterUpdatingStatus</a> array</em></td><td>The list of each cluster&rsquo;s updating status in this stage.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>afterStageTaskStatus</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagetaskstatus>StageTaskStatus</a> array</em></td><td>The status of the post-update tasks associated with the current stage.<br>Empty if the stage has not finished updating all the clusters.</td><td></td><td>MaxItems: 2<br>Optional: {}<br></td></tr><tr><td><code>beforeStageTaskStatus</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagetaskstatus>StageTaskStatus</a> array</em></td><td>The status of the pre-update tasks associated with the current stage.</td><td></td><td>MaxItems: 1<br>Optional: {}<br></td></tr><tr><td><code>startTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>The time when the update started on the stage. Empty if the stage has not started updating.</td><td></td><td>Format: date-time<br>Optional: {}<br>Type: string<br></td></tr><tr><td><code>endTime</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#time-v1-meta>Time</a></em></td><td>The time when the update finished on the stage. Empty if the stage has not started updating.</td><td></td><td>Format: date-time<br>Optional: {}<br>Type: string<br></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed updating conditions for the stage. Empty if the stage has not started updating.<br>Known conditions are &ldquo;Progressing&rdquo;, &ldquo;Succeeded&rdquo;.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=stagedupdaterun>StagedUpdateRun</h4><p>StagedUpdateRun represents a stage by stage update process that applies ResourcePlacement
selected resources to specified clusters.
Resources from unselected clusters are removed after all stages in the update strategy are completed.
Each StagedUpdateRun object corresponds to a single release of a specific resource version.
The release is abandoned if the StagedUpdateRun object is deleted or the scheduling decision changes.
The name of the StagedUpdateRun must conform to RFC 1123.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagedupdaterunlist>StagedUpdateRunList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>StagedUpdateRun</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#updaterunspec>UpdateRunSpec</a></em></td><td>The desired state of StagedUpdateRun.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#updaterunstatus>UpdateRunStatus</a></em></td><td>The observed status of StagedUpdateRun.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=stagedupdatestrategy>StagedUpdateStrategy</h4><p>StagedUpdateStrategy defines a reusable strategy that specifies the stages and the sequence
in which the selected cluster resources will be updated on the member clusters.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagedupdatestrategylist>StagedUpdateStrategyList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>StagedUpdateStrategy</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#updatestrategyspec>UpdateStrategySpec</a></em></td><td>The desired state of StagedUpdateStrategy.</td><td></td><td>Required: {}<br></td></tr></tbody></table><h4 id=state>State</h4><p><em>Underlying type:</em> <em>string</em></p><p>State represents the desired state of an update run.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#updaterunspec>UpdateRunSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>NotStarted</code></td><td>StateNotStarted describes user intent to initialize but not execute the update run.<br>This is the default state when an update run is created.<br></td></tr><tr><td><code>Started</code></td><td>StateStarted describes user intent to execute (or resume execution if paused).<br>Users can subsequently set the state to Stopped or Abandoned.<br></td></tr><tr><td><code>Stopped</code></td><td>StateStopped describes user intent to pause the update run.<br>Users can subsequently set the state to Started or Abandoned.<br></td></tr><tr><td><code>Abandoned</code></td><td>StateAbandoned describes user intent to abandon the update run.<br>This is a terminal state; once set, it cannot be changed.<br></td></tr></tbody></table><h4 id=statusreportingscope>StatusReportingScope</h4><p><em>Underlying type:</em> <em>string</em></p><p>StatusReportingScope defines where ClusterResourcePlacement status information is made available.
This setting only applies to ClusterResourcePlacements that select resources from a single namespace.
It enables different levels of access to placement status across cluster and namespace scopes.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementspec>PlacementSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>ClusterScopeOnly</code></td><td>ClusterScopeOnly makes status available only through the cluster-scoped ClusterResourcePlacement object.<br>This is the default behavior where status information is accessible only to users with cluster-level permissions.<br></td></tr><tr><td><code>NamespaceAccessible</code></td><td>NamespaceAccessible makes status available in both cluster and namespace scopes.<br>In addition to the cluster-scoped status, a ClusterResourcePlacementStatus object is created<br>in the target namespace, enabling namespace-scoped users to access placement status information.<br></td></tr></tbody></table><h4 id=toleration>Toleration</h4><p>Toleration allows ClusterResourcePlacement to tolerate any taint that matches
the triple &lt;key,value,effect> using the matching operator <operator>.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementpolicy>PlacementPolicy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>key</code> <em>string</em></td><td>Key is the taint key that the toleration applies to. Empty means match all taint keys.<br>If the key is empty, operator must be Exists; this combination means to match all values and all keys.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>operator</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#tolerationoperator-v1-core>TolerationOperator</a></em></td><td>Operator represents a key&rsquo;s relationship to the value.<br>Valid operators are Exists and Equal. Defaults to Equal.<br>Exists is equivalent to wildcard for value, so that a<br>ClusterResourcePlacement can tolerate all taints of a particular category.</td><td>Equal</td><td>Enum: [Equal Exists]<br>Optional: {}<br></td></tr><tr><td><code>value</code> <em>string</em></td><td>Value is the taint value the toleration matches to.<br>If the operator is Exists, the value should be empty, otherwise just a regular string.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>effect</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#tainteffect-v1-core>TaintEffect</a></em></td><td>Effect indicates the taint effect to match. Empty means match all taint effects.<br>When specified, only allowed value is NoSchedule.</td><td></td><td>Enum: [NoSchedule]<br>Optional: {}<br></td></tr></tbody></table><h4 id=topologyspreadconstraint>TopologySpreadConstraint</h4><p>TopologySpreadConstraint specifies how to spread resources among the given cluster topology.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#placementpolicy>PlacementPolicy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>maxSkew</code> <em>integer</em></td><td>MaxSkew describes the degree to which resources may be unevenly distributed.<br>When <code>whenUnsatisfiable=DoNotSchedule</code>, it is the maximum permitted difference<br>between the number of resource copies in the target topology and the global minimum.<br>The global minimum is the minimum number of resource copies in a domain.<br>When <code>whenUnsatisfiable=ScheduleAnyway</code>, it is used to give higher precedence<br>to topologies that satisfy it.<br>It&rsquo;s an optional field. Default value is 1 and 0 is not allowed.</td><td>1</td><td>Minimum: 1<br>Optional: {}<br></td></tr><tr><td><code>topologyKey</code> <em>string</em></td><td>TopologyKey is the key of cluster labels. Clusters that have a label with this key<br>and identical values are considered to be in the same topology.<br>We consider each &lt;key, value> as a &ldquo;bucket&rdquo;, and try to put balanced number<br>of replicas of the resource into each bucket honor the <code>MaxSkew</code> value.<br>It&rsquo;s a required field.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>whenUnsatisfiable</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#unsatisfiableconstraintaction>UnsatisfiableConstraintAction</a></em></td><td>WhenUnsatisfiable indicates how to deal with the resource if it doesn&rsquo;t satisfy<br>the spread constraint.<br>- DoNotSchedule (default) tells the scheduler not to schedule it.<br>- ScheduleAnyway tells the scheduler to schedule the resource in any cluster,<br>but giving higher precedence to topologies that would help reduce the skew.<br>It&rsquo;s an optional field.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=unsatisfiableconstraintaction>UnsatisfiableConstraintAction</h4><p><em>Underlying type:</em> <em>string</em></p><p>UnsatisfiableConstraintAction defines the type of actions that can be taken if a constraint is not satisfied.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#topologyspreadconstraint>TopologySpreadConstraint</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>DoNotSchedule</code></td><td>DoNotSchedule instructs the scheduler not to schedule the resource<br>onto the cluster when constraints are not satisfied.<br></td></tr><tr><td><code>ScheduleAnyway</code></td><td>ScheduleAnyway instructs the scheduler to schedule the resource<br>even if constraints are not satisfied.<br></td></tr></tbody></table><h4 id=updaterunspec>UpdateRunSpec</h4><p>UpdateRunSpec defines the desired rollout strategy and the snapshot indices of the resources to be updated.
It specifies a stage-by-stage update process across selected clusters for the given ResourcePlacement object.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterstagedupdaterun>ClusterStagedUpdateRun</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagedupdaterun>StagedUpdateRun</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>placementName</code> <em>string</em></td><td>PlacementName is the name of placement that this update run is applied to.<br>There can be multiple active update runs for each placement, but<br>it&rsquo;s up to the DevOps team to ensure they don&rsquo;t conflict with each other.</td><td></td><td>MaxLength: 255<br>Required: {}<br></td></tr><tr><td><code>resourceSnapshotIndex</code> <em>string</em></td><td>The resource snapshot index of the selected resources to be updated across clusters.<br>The index represents a group of resource snapshots that includes all the resources a ResourcePlacement selected.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>stagedRolloutStrategyName</code> <em>string</em></td><td>The name of the update strategy that specifies the stages and the sequence<br>in which the selected resources will be updated on the member clusters. The stages<br>are computed according to the referenced strategy when the update run starts<br>and recorded in the status field.</td><td></td><td>Required: {}<br></td></tr><tr><td><code>state</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#state>State</a></em></td><td>State indicates the desired state of the update run.<br>NotStarted: The update run is initialized but execution has not started (default).<br>Started: The update run should execute or resume execution.<br>Stopped: The update run should pause execution.<br>Abandoned: The update run should be abandoned and terminated.</td><td>NotStarted</td><td>Enum: [NotStarted Started Stopped Abandoned]<br>Optional: {}<br></td></tr></tbody></table><h4 id=updaterunstatus>UpdateRunStatus</h4><p>UpdateRunStatus defines the observed state of the ClusterStagedUpdateRun.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterstagedupdaterun>ClusterStagedUpdateRun</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagedupdaterun>StagedUpdateRun</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>policySnapshotIndexUsed</code> <em>string</em></td><td>PolicySnapShotIndexUsed records the policy snapshot index of the ClusterResourcePlacement (CRP) that<br>the update run is based on. The index represents the latest policy snapshot at the start of the update run.<br>If a newer policy snapshot is detected after the run starts, the staged update run is abandoned.<br>The scheduler must identify all clusters that meet the current policy before the update run begins.<br>All clusters involved in the update run are selected from the list of clusters scheduled by the CRP according<br>to the current policy.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>policyObservedClusterCount</code> <em>integer</em></td><td>PolicyObservedClusterCount records the number of observed clusters in the policy snapshot.<br>It is recorded at the beginning of the update run from the policy snapshot object.<br>If the <code>ObservedClusterCount</code> value is updated during the update run, the update run is abandoned.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>resourceSnapshotIndexUsed</code> <em>string</em></td><td>ResourceSnapshotIndexUsed records the resource snapshot index that the update run is based on.<br>The index represents the same resource snapshots as specified in the spec field, or the latest.</td><td></td><td></td></tr><tr><td><code>appliedStrategy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#applystrategy>ApplyStrategy</a></em></td><td>ApplyStrategy is the apply strategy that the stagedUpdateRun is using.<br>It is the same as the apply strategy in the CRP when the staged update run starts.<br>The apply strategy is not updated during the update run even if it changes in the CRP.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>stagedUpdateStrategySnapshot</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#updatestrategyspec>UpdateStrategySpec</a></em></td><td>UpdateStrategySnapshot is the snapshot of the UpdateStrategy used for the update run.<br>The snapshot is immutable during the update run.<br>The strategy is applied to the list of clusters scheduled by the CRP according to the current policy.<br>The update run fails to initialize if the strategy fails to produce a valid list of stages where each selected<br>cluster is included in exactly one stage.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>stagesStatus</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stageupdatingstatus>StageUpdatingStatus</a> array</em></td><td>StagesStatus lists the current updating status of each stage.<br>The list is empty if the update run is not started or failed to initialize.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>deletionStageStatus</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stageupdatingstatus>StageUpdatingStatus</a></em></td><td>DeletionStageStatus lists the current status of the deletion stage. The deletion stage<br>removes all the resources from the clusters that are not selected by the<br>current policy after all the update stages are completed.</td><td></td><td>Optional: {}<br></td></tr><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions is an array of current observed conditions for StagedUpdateRun.<br>Known conditions are &ldquo;Initialized&rdquo;, &ldquo;Progressing&rdquo;, &ldquo;Succeeded&rdquo;.</td><td></td><td>Optional: {}<br></td></tr></tbody></table><h4 id=updatestrategyspec>UpdateStrategySpec</h4><p>UpdateStrategySpec defines the desired state of the StagedUpdateStrategy.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#clusterstagedupdatestrategy>ClusterStagedUpdateStrategy</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stagedupdatestrategy>StagedUpdateStrategy</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#updaterunstatus>UpdateRunStatus</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>stages</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#stageconfig>StageConfig</a> array</em></td><td>Stage specifies the configuration for each update stage.</td><td></td><td>MaxItems: 31<br>Required: {}<br></td></tr></tbody></table><h4 id=whentoapplytype>WhenToApplyType</h4><p><em>Underlying type:</em> <em>string</em></p><p>WhenToApplyType describes when Fleet would apply the manifests on the hub cluster to
the member clusters.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#applystrategy>ApplyStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>Always</code></td><td>WhenToApplyTypeAlways instructs Fleet to periodically apply hub cluster manifests<br>on the member cluster side; this will effectively overwrite any change in the fields<br>managed by Fleet (i.e., specified in the hub cluster manifest).<br></td></tr><tr><td><code>IfNotDrifted</code></td><td>WhenToApplyTypeIfNotDrifted instructs Fleet to stop applying hub cluster manifests on<br>clusters that have drifted from the desired state; apply ops would still continue on<br>the rest of the clusters.<br></td></tr></tbody></table><h4 id=whentotakeovertype>WhenToTakeOverType</h4><p><em>Underlying type:</em> <em>string</em></p><p>WhenToTakeOverType describes the type of the action to take when we first apply the
resources to the member cluster.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#applystrategy>ApplyStrategy</a></li></ul><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>IfNoDiff</code></td><td>WhenToTakeOverTypeIfNoDiff instructs Fleet to apply a manifest with a corresponding<br>pre-existing resource on a member cluster if and only if the pre-existing resource<br>looks the same as the manifest. Should there be any inconsistency, Fleet will skip<br>the apply op; no change will be made on the resource and Fleet will not claim<br>ownership on it.<br>Note that this will not stop Fleet from processing other manifests in the same<br>placement that do not concern the takeover process (e.g., the manifests that have<br>not been created yet, or that are already under the management of Fleet).<br></td></tr><tr><td><code>Always</code></td><td>WhenToTakeOverTypeAlways instructs Fleet to always apply manifests to a member cluster,<br>even if there are some corresponding pre-existing resources. Some fields on these<br>resources might be overwritten, and Fleet will claim ownership on them.<br></td></tr><tr><td><code>Never</code></td><td>WhenToTakeOverTypeNever instructs Fleet to never apply a manifest to a member cluster<br>if there is a corresponding pre-existing resource.<br>Note that this will not stop Fleet from processing other manifests in the same placement<br>that do not concern the takeover process (e.g., the manifests that have not been created<br>yet, or that are already under the management of Fleet).<br>If you would like Fleet to stop processing manifests all together and do not assume<br>ownership on any pre-existing resources, use this option along with the ReportDiff<br>apply strategy type. This setup would instruct Fleet to touch nothing on the member<br>cluster side but still report configuration differences between the hub cluster<br>and member clusters. Fleet will not give up ownership that it has already assumed, though.<br></td></tr></tbody></table><h4 id=work>Work</h4><p>Work is the Schema for the works API.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#worklist>WorkList</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>Work</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#objectmeta-v1-meta>ObjectMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>spec</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#workspec>WorkSpec</a></em></td><td>spec defines the workload of a work.</td><td></td><td></td></tr><tr><td><code>status</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#workstatus>WorkStatus</a></em></td><td>status defines the status of each applied manifest on the spoke cluster.</td><td></td><td></td></tr></tbody></table><h4 id=worklist>WorkList</h4><p>WorkList contains a list of Work.</p><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>apiVersion</code> <em>string</em></td><td><code>placement.kubernetes-fleet.io/v1beta1</code></td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td><code>WorkList</code></td><td></td><td></td></tr><tr><td><code>metadata</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#listmeta-v1-meta>ListMeta</a></em></td><td>Refer to Kubernetes API documentation for fields of <code>metadata</code>.</td><td></td><td></td></tr><tr><td><code>items</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#work>Work</a> array</em></td><td>List of works.</td><td></td><td></td></tr></tbody></table><h4 id=workresourceidentifier>WorkResourceIdentifier</h4><p>WorkResourceIdentifier provides the identifiers needed to interact with any arbitrary object.
Renamed original &ldquo;ResourceIdentifier&rdquo; so that it won&rsquo;t conflict with ResourceIdentifier defined in the clusterresourceplacement_types.go.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#appliedresourcemeta>AppliedResourceMeta</a></li><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#manifestcondition>ManifestCondition</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>ordinal</code> <em>integer</em></td><td>Ordinal represents an index in manifests list, so the condition can still be linked<br>to a manifest even though manifest cannot be parsed successfully.</td><td></td><td></td></tr><tr><td><code>group</code> <em>string</em></td><td>Group is the group of the resource.</td><td></td><td></td></tr><tr><td><code>version</code> <em>string</em></td><td>Version is the version of the resource.</td><td></td><td></td></tr><tr><td><code>kind</code> <em>string</em></td><td>Kind is the kind of the resource.</td><td></td><td></td></tr><tr><td><code>resource</code> <em>string</em></td><td>Resource is the resource type of the resource.</td><td></td><td></td></tr><tr><td><code>namespace</code> <em>string</em></td><td>Namespace is the namespace of the resource, the resource is cluster scoped if the value<br>is empty.</td><td></td><td></td></tr><tr><td><code>name</code> <em>string</em></td><td>Name is the name of the resource.</td><td></td><td></td></tr></tbody></table><h4 id=workspec>WorkSpec</h4><p>WorkSpec defines the desired state of Work.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#work>Work</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>workload</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#workloadtemplate>WorkloadTemplate</a></em></td><td>Workload represents the manifest workload to be deployed on spoke cluster</td><td></td><td></td></tr><tr><td><code>applyStrategy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#applystrategy>ApplyStrategy</a></em></td><td>ApplyStrategy describes how to resolve the conflict if the resource to be placed already exists in the target cluster<br>and is owned by other appliers.</td><td></td><td></td></tr><tr><td><code>reportBackStrategy</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#reportbackstrategy>ReportBackStrategy</a></em></td><td>ReportBackStrategy describes how to report back the status of applied resources on the member cluster.</td><td></td><td></td></tr></tbody></table><h4 id=workstatus>WorkStatus</h4><p>WorkStatus defines the observed state of Work.</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#work>Work</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>conditions</code> <em><a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.31/#condition-v1-meta>Condition</a> array</em></td><td>Conditions contains the different condition statuses for this work.<br>Valid condition types are:<br>1. Applied represents workload in Work is applied successfully on the spoke cluster.<br>2. Progressing represents workload in Work in the transitioning from one state to another the on the spoke cluster.<br>3. Available represents workload in Work exists on the spoke cluster.<br>4. Degraded represents the current state of workload does not match the desired<br>state for a certain period.</td><td></td><td></td></tr><tr><td><code>manifestConditions</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#manifestcondition>ManifestCondition</a> array</em></td><td>ManifestConditions represents the conditions of each resource in work deployed on<br>spoke cluster.</td><td></td><td></td></tr></tbody></table><h4 id=workloadtemplate>WorkloadTemplate</h4><p>WorkloadTemplate represents the manifest workload to be deployed on spoke cluster</p><p><em>Appears in:</em></p><ul><li><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#workspec>WorkSpec</a></li></ul><table><thead><tr><th>Field</th><th>Description</th><th>Default</th><th>Validation</th></tr></thead><tbody><tr><td><code>manifests</code> <em><a href=/docs/api-reference/placement.kubernetes-fleet.io/v1beta1/#manifest>Manifest</a> array</em></td><td>Manifests represents a list of kubernetes resources to be deployed on the spoke cluster.</td><td></td><td></td></tr></tbody></table></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/kubefleet-dev/kubefleet aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2025&ndash;2025
<span class=td-footer__authors>KubeFleet Contributors | The Linux FoundationÂ® (TLF) has registered trademarks and uses trademarks. For a list of TLF trademarks, see <a href=https://www.linuxfoundation.org/trademark-usage/>Trademark Usage</a> | <a href=https://creativecommons.org/licenses/by/4.0>CC BY 4.0</a> |</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=https://www.linuxfoundation.org/legal/privacy-policy target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/js/main.min.032ba2ecbd3ce89b96bffcfec71c5da352125ee752e9873c3e0098f7c32a6497.js integrity="sha256-Ayui7L086JuWv/z+xxxdo1ISXudS6Yc8PgCY98MqZJc=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>